<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-11-02 Tue 11:34 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>计算机网络：自顶向下方法 题解</title>
<meta name="author" content="Shi-Chao Xia" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="css/org.css">
</head>
<body>
<div id="content" class="content">
<h1 class="title">计算机网络：自顶向下方法 题解</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org06fbdcf">1. Wireshark实验</a></li>
</ul>
</div>
</div>
<div id="outline-container-org06fbdcf" class="outline-2">
<h2 id="org06fbdcf"><span class="section-number-2">1.</span> Wireshark实验</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="code/ch4-ws-ip/wireshark-ip-v7.0.pdf">Wireshark Lab: IP v7.0</a><br />
</p>

<p>
下面的traceroute<a href="code/ch4-ws-ip/my-trace.pcapng">结果</a>不理想，采用实验附带的数据。<br />
</p>

<pre class="example" id="org452aaf5">
❯ traceroute -I -w 1 gaia.cs.umass.edu
traceroute to gaia.cs.umass.edu (128.119.245.12), 64 hops max, 72 byte packets
 1  www.huaweimobilewifi.com (192.168.8.1)  19.915 ms  26.711 ms  29.840 ms
 2  * * *
 3  192.168.208.65 (192.168.208.65)  38.351 ms  39.267 ms  40.085 ms
 4  192.168.191.77 (192.168.191.77)  39.732 ms  39.413 ms  39.948 ms
 5  * * *
 6  * * *
 7  * * *
 8  * * *
 9  * * *
10  * * *
11  * * *
12  * * *
13  * * *
14  * * *
15  * * *
16  * * *
17  * * *
18  * * *
19  * * *
20  * * *
21  * * *
22  * * *
23  * * *
24  * * *
25  * * *
26  * * *
27  * * *
28  gaia.cs.umass.edu (128.119.245.12)  280.594 ms  279.113 ms  299.696 ms
</pre>

<ol class="org-ol">
<li><p>
Select the first ICMP Echo Request message sent by your computer, and expand the Internet Protocol part of the packet in the packet details window.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
      8 6.163045       192.168.1.102         128.59.23.100         ICMP     98     Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=20483/848, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 8: 98 bytes on wire (784 bits), 98 bytes captured (784 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 84
    Identification: 0x32d0 (13008)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2d2c [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
Internet Control Message Protocol
</pre>
</div>

<p>
What is the IP address of your computer?<br />
</p>

<p>
Source Address: 192.168.1.102<br />
</p></li>

<li><p>
Within the IP packet header, what is the value in the upper layer protocol field?<br />
</p>

<p>
Protocol: ICMP (1)<br />
</p></li>

<li>&#x00ad;<br />

<ul class="org-ul">
<li><p>
How many bytes are in the IP header?<br />
</p>

<p>
Header Length: 20 bytes<br />
</p></li>

<li><p>
How many bytes are in the payload of the IP datagram? Explain how you determined the number of payload bytes.<br />
</p>

<p>
Total Length: 84<br />
</p>

<p>
payload length = 84 - 20 = 64 bytes<br />
</p></li>
</ul></li>

<li><p>
Has this IP datagram been fragmented? Explain how you determined whether or not the datagram has been fragmented.<br />
</p>

<p>
没有被分片，More fragments: Not set<br />
</p></li>

<li><p>
Which fields in the IP datagram always change from one datagram to the next within this series of ICMP messages sent by your computer?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
    355 53.678468      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49155/960, <span class="org-variable-name">ttl</span>=9 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 355: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3346 (13126)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 9
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2160 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #353(1480), #354(1480), #355(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    358 53.714979      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49411/961, <span class="org-variable-name">ttl</span>=10 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 358: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3347 (13127)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 10
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x205f [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #356(1480), #357(1480), #358(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    361 53.728518      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49667/962, <span class="org-variable-name">ttl</span>=11 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 361: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3348 (13128)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 11
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1f5e [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #359(1480), #360(1480), #361(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    365 53.758584      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49923/963, <span class="org-variable-name">ttl</span>=12 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 365: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3349 (13129)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 12
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1e5d [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #363(1480), #364(1480), #365(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    368 53.778721      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=50179/964, <span class="org-variable-name">ttl</span>=13 (<span class="org-type">reply</span> <span class="org-variable-name">in</span> 380)

Frame 368: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x334a (13130)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 13
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1d5c [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #366(1480), #367(1480), #368(548)]
Internet Control Message Protocol
</pre>
</div>

<p>
Identification<br />
Time to Live<br />
Header Checksum<br />
</p></li>

<li>Which fields stay constant? Which of the fields must stay constant? Which fields must change? Why?<br />

<ul class="org-ul">
<li>Stay constant:<br />
Version<br />
Header Length<br />
Protocol<br />
Source Address<br />
Destination Address<br /></li>

<li>Must stay constant:<br />
Source Address<br />
Destination Address<br />
Protocol<br /></li>

<li>Must change:<br />
Identification<br />
Time to Live<br /></li>
</ul></li>

<li><p>
Describe the pattern you see in the values in the Identification field of the IP datagram<br />
</p>

<ol class="org-ol">
<li>128.119.40.128<br /></li>
<p>
从13008开始，逐个IP数据报加一。<br />
</p></li>

<li><p>
What is the value in the Identification field and the TTL field?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
      9 6.176826       10.216.228.1          192.168.1.102         ICMP     70     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 9: 70 bytes on wire (560 bits), 70 bytes captured (560 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: LinksysG_da:af:73 (00:06:25:da:af:73), <span class="org-function-name">Dst</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 10.216.228.1, <span class="org-variable-name">Dst</span>: 192.168.1.102
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 56
    Identification: 0x9d7c (40316)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 255
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x6ca0 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 10.216.228.1
    Destination Address: 192.168.1.102
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
     40 11.174495      10.216.228.1          192.168.1.102         ICMP     70     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 40: 70 bytes on wire (560 bits), 70 bytes captured (560 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: LinksysG_da:af:73 (00:06:25:da:af:73), <span class="org-function-name">Dst</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 10.216.228.1, <span class="org-variable-name">Dst</span>: 192.168.1.102
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 56
    Identification: 0x9d98 (40344)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 255
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x6c84 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 10.216.228.1
    Destination Address: 192.168.1.102
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
     65 16.179649      10.216.228.1          192.168.1.102         ICMP     70     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 65: 70 bytes on wire (560 bits), 70 bytes captured (560 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: LinksysG_da:af:73 (00:06:25:da:af:73), <span class="org-function-name">Dst</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 10.216.228.1, <span class="org-variable-name">Dst</span>: 192.168.1.102
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 56
    Identification: 0x9db8 (40376)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 255
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x6c64 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 10.216.228.1
    Destination Address: 192.168.1.102
Internet Control Message Protocol
</pre>
</div>

<p>
Identification: 0x9d7c (40316)<br />
Time to Live: 255<br />
</p></li>

<li><p>
Do these values remain unchanged for all of the ICMP TTL-exceeded replies sent to your computer by the nearest (first hop) router? Why?<br />
</p>

<p>
Identification会变化，TTL不变。<br />
</p></li>

<li><p>
Find the first ICMP Echo Request message that was sent by your computer after you changed the Packet Size in pingplotter to be 2000. Has that message been fragmented across more than one IP datagram?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     93 28.442185      192.168.1.102         128.59.23.100         ICMP     562    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=30467/887, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 93: 562 bytes on wire (4496 bits), 562 bytes captured (4496 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 548
    Identification: 0x32f9 (13049)
    Flags: 0x00
        0... .... = Reserved bit: Not set
        .0.. .... = Don<span class="org-warning">'</span>t fragment: Not set
        ..0. .... = More fragments: Not set
    Fragment Offset: 1480
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2a7a [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [2 IPv4 Fragments (2008 bytes): #92(1480), #93(528)]
        [Frame: 92, payload: 0-1479 (1480 bytes)]
        [Frame: 93, payload: 1480-2007 (528 bytes)]
        [Fragment count: 2]
        [Reassembled IPv4 length: 2008]
        [Reassembled IPv4 data: 0800d0c603007703373620aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#8230;]
Internet Control Message Protocol
</pre>
</div></li>

<li>&#x00ad;<br />

<ul class="org-ul">
<li><p>
Print out the first fragment of the fragmented IP datagram.<br />
</p>

<p>
⌈5e6/(1500-20TCP-20IP)⌉ = 3425<br />
<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     92 28.441511      192.168.1.102         128.59.23.100         IPv4     1514   Fragmented IP protocol (proto=ICMP 1, off=0, ID=32f9) [Reassembled in #93]

Frame 92: 1514 bytes on wire (12112 bits), 1514 bytes captured (12112 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 1500
    Identification: 0x32f9 (13049)
    Flags: 0x20, <span class="org-variable-name">More</span> fragments
        0... .... = Reserved bit: Not set
        .0.. .... = Don<span class="org-warning">'</span>t fragment: Not set
        ..1. .... = More fragments: Set
    Fragment Offset: 0
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x077b [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [Reassembled IPv4 in frame: 93]
Data (1480 bytes)
</pre>
</div></li>

<li><p>
What information in the IP header indicates that the datagram been fragmented?<br />
</p>

<p>
Flags: 0x20, More fragments<br />
</p></li>

<li><p>
What information in the IP header indicates whether this is the first fragment versus a latter fragment?<br />
</p>

<p>
Flags: 0x20, More fragments<br />
Fragment Offset: 0<br />
</p></li>

<li><p>
How long is this IP datagram?<br />
</p>

<p>
Total Length: 1500<br />
</p></li>
</ul></li>

<li>&#x00ad;<br />
<ul class="org-ul">
<li><p>
Print out the second fragment of the fragmented IP datagram.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     93 28.442185      192.168.1.102         128.59.23.100         ICMP     562    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=30467/887, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 93: 562 bytes on wire (4496 bits), 562 bytes captured (4496 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 548
    Identification: 0x32f9 (13049)
    Flags: 0x00
    Fragment Offset: 1480
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2a7a [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [2 IPv4 Fragments (2008 bytes): #92(1480), #93(528)]
Internet Control Message Protocol
</pre>
</div></li>

<li>What information in the IP header indicates that this is not the first datagram fragment?<br />
Fragment Offset: 1480<br /></li>

<li><p>
Are the more fragments?<br />
</p>

<p>
No.<br />
</p></li>

<li><p>
How can you tell?<br />
</p>

<p>
Flags: 0x00<br />
</p></li>
</ul></li>

<li><p>
What fields change in the IP header between the first and second fragment?<br />
</p>

<p>
Total Length<br />
Flags<br />
Header Checksum<br />
</p></li>

<li><p>
How many fragments were created from the original datagram?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
    218 43.467629      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=40451/926, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 218: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3323 (13091)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2983 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #216(1480), #217(1480), #218(548)]
Internet Control Message Protocol
</pre>
</div>

<p>
3<br />
</p></li>
</ol>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Shi-Chao Xia</p>
<p class="date">Created: 2021-11-02 Tue 11:34</p>
</div>
</body>
</html>
