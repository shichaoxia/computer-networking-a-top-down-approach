<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-12-07 Tue 12:21 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>计算机网络：自顶向下方法 题解</title>
<meta name="author" content="Shi-Chao Xia" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="css/org.css">
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">计算机网络：自顶向下方法 题解</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org58cd609">1. 计算机网络和英特网</a>
<ul>
<li><a href="#orgafce4fd">1.1. 复习题</a>
<ul>
<li><a href="#org20abe66">R1</a></li>
<li><a href="#org71aeeb2">R2</a></li>
<li><a href="#org14fdfd3">R3</a></li>
<li><a href="#org16fc562">R4</a></li>
<li><a href="#orgead6e6f">R5</a></li>
<li><a href="#orgca6c1d2">R6</a></li>
<li><a href="#orgf040e26">R7</a></li>
<li><a href="#orgd8b9d05">R8</a></li>
<li><a href="#orgb5f5f53">R9</a></li>
<li><a href="#org98dfe3a">R10</a></li>
<li><a href="#org4954ab5">R11</a></li>
<li><a href="#org3e697e9">R12</a></li>
<li><a href="#org20bd919">R13</a></li>
<li><a href="#orge6d36e0">R14</a></li>
<li><a href="#org787991b">R15</a></li>
<li><a href="#org0115d3c">R16</a></li>
<li><a href="#org7d00078">R17</a></li>
<li><a href="#org5106e4c">R18</a></li>
<li><a href="#orga5015ec">R19</a></li>
<li><a href="#orgee9901d">R20</a></li>
<li><a href="#org9252fa5">R21</a></li>
<li><a href="#org4215da9">R22</a></li>
<li><a href="#org215ba7d">R23</a></li>
<li><a href="#org836ba0d">R24</a></li>
<li><a href="#org4af1b9e">R25</a></li>
<li><a href="#org1bb022c">R26</a></li>
<li><a href="#org7f0d359">R27</a></li>
<li><a href="#orgb0cd95c">R28</a></li>
</ul>
</li>
<li><a href="#orgc5467a8">1.2. 习题</a>
<ul>
<li><a href="#orgb3667dd">P1</a></li>
<li><a href="#org0bab727">P2</a></li>
<li><a href="#org447c6bc">P3</a></li>
<li><a href="#org48b212c">P4</a></li>
<li><a href="#org022cf6e">P5</a></li>
<li><a href="#orge3e7800">P6</a></li>
<li><a href="#org7bddee0">P7</a></li>
<li><a href="#orgf16b81b">P8</a></li>
<li><a href="#orgf8eb32b">P9</a></li>
<li><a href="#orgda42c52">P10</a></li>
<li><a href="#orgfe25e28">P11</a></li>
<li><a href="#orgeada0a9">P12</a></li>
<li><a href="#org201d424">P13</a></li>
<li><a href="#org7e57e1e">P14</a></li>
<li><a href="#org09bacad">P15</a></li>
<li><a href="#orgbcff42a">P16</a></li>
<li><a href="#org6045ad1">P17</a></li>
<li><a href="#orgf87aac7">P18</a></li>
<li><a href="#org3d0e285">P19</a></li>
<li><a href="#org3368285">P20</a></li>
<li><a href="#org5c301c1">P21</a></li>
<li><a href="#orgbaacee8">P22</a></li>
<li><a href="#orgca1359a">P23</a></li>
<li><a href="#orgb36f549">P24</a></li>
<li><a href="#orgf01cbd9">P25</a></li>
<li><a href="#orga6c2ed7">P26</a></li>
<li><a href="#org5d10402">P27</a></li>
<li><a href="#orgd3910b2">P28</a></li>
<li><a href="#org5b7da1f">P29</a></li>
<li><a href="#org479020b">P30</a></li>
<li><a href="#org02c947d">P31</a></li>
<li><a href="#org56b513c">P32</a></li>
<li><a href="#org6d6608c">P33</a></li>
<li><a href="#org4309b32">P34</a></li>
</ul>
</li>
<li><a href="#orgff9b9ff">1.3. Wireshark实验</a></li>
</ul>
</li>
<li><a href="#orgea6f865">2. 应用层</a>
<ul>
<li><a href="#org585f600">2.1. 笔记</a>
<ul>
<li><a href="#org7193a1a">HTTP请求 p.70</a></li>
<li><a href="#org3a761ef">使用SMTP通过Gmail发送邮件 p.78</a></li>
<li><a href="#org92591f3">使用POP收取Gmail邮件 p.81</a></li>
<li><a href="#org9906301">UDPClient.py p.107</a></li>
<li><a href="#orga76e2a5">UDPServer.py p.108</a></li>
<li><a href="#org18b2c56">TCPClient.py p.111</a></li>
<li><a href="#org592a400">TCPServer.py p.112</a></li>
</ul>
</li>
<li><a href="#orgf2816d6">2.2. 复习题</a>
<ul>
<li><a href="#orgf9e5939">R1</a></li>
<li><a href="#org7352a12">R2</a></li>
<li><a href="#org88d8123">R3</a></li>
<li><a href="#orgc88a723">R4</a></li>
<li><a href="#org42483c8">R5</a></li>
<li><a href="#org9fb1b1b">R6</a></li>
<li><a href="#org11dfec2">R7</a></li>
<li><a href="#org081242e">R8</a></li>
<li><a href="#org7cea3fd">R9</a></li>
<li><a href="#orgc43a7ad">R10</a></li>
<li><a href="#org7a76d88">R11</a></li>
<li><a href="#orge67d00b">R12</a></li>
<li><a href="#org577c19f">R13</a></li>
<li><a href="#orgca9e67f">R14</a></li>
<li><a href="#orgc323e72">R15</a></li>
<li><a href="#orgc7b0f5c">R16</a></li>
<li><a href="#orgacecbec">R17</a></li>
<li><a href="#org4df4d39">R18</a></li>
<li><a href="#orgb1fc889">R19</a></li>
<li><a href="#orgb3475c4">R20</a></li>
<li><a href="#org2b08d97">R21</a></li>
<li><a href="#orgdeb73fa">R22</a></li>
<li><a href="#orga97ca65">R23</a></li>
<li><a href="#org918c0aa">R24</a></li>
<li><a href="#org682cc31">R25</a></li>
<li><a href="#orga78830b">R26</a></li>
<li><a href="#orgb6bce3b">R27 </a></li>
</ul>
</li>
<li><a href="#orgd506ead">2.3. 习题</a>
<ul>
<li><a href="#org8885aef">P1</a></li>
<li><a href="#org02c9c72">P2</a></li>
<li><a href="#org772c071">P3</a></li>
<li><a href="#orga9aac9a">P4</a></li>
<li><a href="#orgf4d9956">P5</a></li>
<li><a href="#orgeb3c4f0">P6</a></li>
<li><a href="#org7a511f2">P7</a></li>
<li><a href="#orge56ee03">P8</a></li>
<li><a href="#org34e531b">P9</a></li>
<li><a href="#org02e964f">P10</a></li>
<li><a href="#org01ac134">P11</a></li>
<li><a href="#org8b9a46d">P12</a></li>
<li><a href="#org2062ee7">P13</a></li>
<li><a href="#orgfcf0249">P14</a></li>
<li><a href="#orgb2d28fd">P15</a></li>
<li><a href="#orgbd6fe08">P16</a></li>
<li><a href="#orgae11780">P17</a></li>
<li><a href="#org97c69b3">P18</a></li>
<li><a href="#orge572725">P19</a></li>
<li><a href="#org78df085">P20</a></li>
<li><a href="#org8d56cc6">P21</a></li>
<li><a href="#org10361d0">P22</a></li>
<li><a href="#org841ebb7">P23</a></li>
<li><a href="#orgd746358">P24</a></li>
<li><a href="#org8d6d9df">P25</a></li>
<li><a href="#org1f20b1a">P26</a></li>
<li><a href="#org3a6f70c">P27</a></li>
<li><a href="#orgd3c073e">P28</a></li>
<li><a href="#org0ea9f1c">P29</a></li>
<li><a href="#orgf49270d">P30</a></li>
<li><a href="#orgc27f15a">P31</a></li>
<li><a href="#orgb1ed060">P32</a></li>
</ul>
</li>
<li><a href="#orgc60dfa4">2.4. 套接字编程作业</a>
<ul>
<li><a href="#orgdb6d8d9">作业1：Web服务器</a></li>
<li><a href="#org8efd80f">作业2：UDP ping程序</a></li>
<li><a href="#orgbb60eef">作业3：邮件客户</a></li>
<li><a href="#orgf2acc39">作业4：多线程Web代理服务器</a></li>
</ul>
</li>
<li><a href="#org2d22f5f">2.5. Wireshark实验：HTTP</a>
<ul>
<li><a href="#orge99a17c">1. The Basic HTTP GET/response interaction</a></li>
<li><a href="#org4ce62a2">2. The HTTP CONDITIONAL GET/response interaction</a></li>
<li><a href="#org88d3d82">3. Retrieving Long Documents</a></li>
<li><a href="#orgba528dd">4. HTML Documents with Embedded Objects</a></li>
<li><a href="#orgc475623">5. HTTP Authentication</a></li>
</ul>
</li>
<li><a href="#org60caf9f">2.6. Wireshark实验：DNS</a>
<ul>
<li><a href="#orgdfe0d75">1. nslookup</a></li>
<li><a href="#orge0e288f">2. ipconfig</a></li>
<li><a href="#org9ececa0">3. Tracing DNS with Wireshark</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8736638">3. 运输层</a>
<ul>
<li><a href="#org25db268">3.1. 笔记</a></li>
<li><a href="#org69ee336">3.2. 复习题</a>
<ul>
<li><a href="#org61ed0c2">R1 UDP提供的服务模型、运输层协议工作的位置</a></li>
<li><a href="#org7e96da4">R2 信件邮政服务类比传输层协议</a></li>
<li><a href="#org6aa9f36">R3 发送方和接受方的源端口号和目的端口号的关系</a></li>
<li><a href="#org7bb44da">R4 UDP相较于TCP的优势 p.131</a></li>
<li><a href="#org72ecdd1">R5 流媒体应用在UDP更具有优势的前提下选择TCP的原因 p.131</a></li>
<li><a href="#orgef46da5">R6 在UDP之上的应用层协议中实现可靠性传输 p.132</a></li>
<li><a href="#org0ff6d1e">R7 UDP套接字由二元组（目的IP地址、目的端口号）标识 p.127</a></li>
<li><a href="#org7a5a8e0">R8 TCP套接字由一个四元组标识 p.128</a></li>
<li><a href="#orgfd51073">R9 为什么引入序号 p.138</a></li>
<li><a href="#org652f4a9">R10 为什么引入定时器 p.141</a></li>
<li><a href="#org17c1237">R11</a></li>
<li><a href="#org9040b42">R12 Go-Back-N动画演示</a></li>
<li><a href="#org029bc9c">R13 Selective Repeat动画演示</a></li>
<li><a href="#org9500538">R14</a></li>
<li><a href="#org6fba991">R15 TCP报文段的序号和确认号</a></li>
<li><a href="#org9606ceb">R16 Telnet中的TCP序号和确认号</a></li>
<li><a href="#orgcbe1341">R17 公平性</a></li>
<li><a href="#orgf6ac426">R18</a></li>
<li><a href="#org472f1d8">R19 TCP分叉 p.179</a></li>
</ul>
</li>
<li><a href="#org3480b4f">3.3. 习题</a>
<ul>
<li><a href="#orge6921d6">P1 源端口号和目的端口号</a></li>
<li><a href="#org444879d">P2</a></li>
<li><a href="#org7e080d5">P3 UDP检验和 p.133</a></li>
<li><a href="#orgf19c59f">P4 和的反码</a></li>
<li><a href="#org30abd9b">P5 UDP差错检测</a></li>
<li><a href="#org9bea6e4">P6 rdt2.1进入死锁的改动</a></li>
<li><a href="#orgb1cae2a">P7 序号的作用</a></li>
<li><a href="#orga00ffca">P8 rdt3.0</a></li>
<li><a href="#orgdbd3af3">P9 rdt3.0分组发生篡改的时序图</a></li>
<li><a href="#orgbda17d7">P10 为rdt2.1增加超时重传</a></li>
<li><a href="#org1dd30e9">P11 rdt2.2进入死锁的改动</a></li>
<li><a href="#org03b0744">P12 rdt3.0</a></li>
<li><a href="#orgbafa936">P13 rdt3.0</a></li>
<li><a href="#org46a4551">P14 只是用NAK的协议</a></li>
<li><a href="#org8ce93c8">P15 信道利用率</a></li>
<li><a href="#org8d1c01a">P16 流水线</a></li>
<li><a href="#orgbf4bf60">P17 严格交替发送的状态机</a></li>
<li><a href="#org773a877">P18 选择重传</a></li>
<li><a href="#orgb94cb3a">P19 由rdt3.0衍生的发送给多个接收方的停等模型</a></li>
<li><a href="#orgc91f35a">P20 由rdt3.0衍生的多个发送方的停等模型</a></li>
<li><a href="#orgef6e034">P21 停等协议中超时重传和序号的作用</a></li>
<li><a href="#org5ba60ba">P22 GBN协议中发送方窗口长度和接收方期待序号间的关系</a></li>
<li><a href="#org974f870">P23 序号空间和窗口长度的关系</a></li>
<li><a href="#orge2d1741">P24 SR和SBN的窗口长度</a></li>
<li><a href="#org877d9ef">P25 UDP提供了更好的应用层控制</a></li>
<li><a href="#org0d9a2bf">P26 TCP报文段的序号</a></li>
<li><a href="#org662d03a">P27 TCP报文段的序号、重传和确认</a></li>
<li><a href="#org496f9b7">P28 流量控制</a></li>
<li><a href="#org3ae4285">P29 SYN cookie</a></li>
<li><a href="#orgc52d30b">P30 有限缓存的路由器对拥塞的影响</a></li>
<li><a href="#org04e0bf2">P31 往返时间的估计与超时</a></li>
<li><a href="#orgcbccebc">P32 指数移动平均</a></li>
<li><a href="#org00e5eee">P33 避免测量重传报文段的SampleRTT</a></li>
<li><a href="#orgb254f4e">P34 SendBase和LastByteRcvd</a></li>
<li><a href="#org333c1ea">P35 确认序号y和LastByteRcvd</a></li>
<li><a href="#org3500411">P36 快速重传的时机</a></li>
<li><a href="#org6d2b41e">P37 相较于GBN、SR，TCP的快速重传的优点</a></li>
<li><a href="#orgdfcddb5">P38 发送速率与cwnd</a></li>
<li><a href="#org7ef0e43">P39 有限缓存路由器的丢包分析</a></li>
<li><a href="#orga260798">P40 TCP拥塞控制的过程</a></li>
<li><a href="#org3153fee">P41 TCP拥塞控制的公平性</a></li>
<li><a href="#org54f1bb2">P42 加倍超时间隔与拥塞控制</a></li>
<li><a href="#org628236f">P43 流量控制和拥塞控制工作的前提</a></li>
<li><a href="#orgc2509a5">P44 cwnd与平均吞吐量</a></li>
<li><a href="#org04f1299">P45 对TCP吞吐量的宏观描述</a></li>
<li><a href="#org425e1b9">P46 计算TCP吞吐量与窗口长度</a></li>
<li><a href="#org0891683">P47 TCP吞吐量与链路缓存</a></li>
<li><a href="#org1eca47f">P48 高带宽链路的窗口扩大速度</a></li>
<li><a href="#org80ffeb1">P49 拥塞窗口增加的时间与平均吞吐量</a></li>
<li><a href="#orgc356f0f">P50 具有较小RTT的连接享有更高的吞吐量</a></li>
<li><a href="#org45879dc">P51 TCP拥塞控制的公平性</a></li>
<li><a href="#org25de95f">P52 修改为乘性增的吞吐量</a></li>
<li><a href="#org71b6f84">P53 经高带宽路径的TCP</a></li>
<li><a href="#org5efa19e">P54 拥塞控制的实效性</a></li>
<li><a href="#org07d2a31">P55 SYN cookie与地址欺骗</a></li>
<li><a href="#org47835a7">P56 TCP慢启动引入的时延</a></li>
</ul>
</li>
<li><a href="#orge900be6">3.4. 编程作业 实现一个可靠运输协议</a>
<ul>
<li><a href="#orgb0d80aa">比特交替协议</a></li>
<li><a href="#org9d73e83">GBN</a></li>
</ul>
</li>
<li><a href="#orgebd3a02">3.5. Wireshark实验：探究TCP</a></li>
<li><a href="#org413b264">3.6. Wireshark实验：探究UDP</a></li>
</ul>
</li>
<li><a href="#org8344628">4. 网络层：数据平面</a>
<ul>
<li><a href="#org4a9a75f">4.1. 复习题</a>
<ul>
<li><a href="#org7e54060">R1 路由器和链路层交换机的区别</a></li>
<li><a href="#orgea5ab61">R2 数据平面和控制平面的功能</a></li>
<li><a href="#org81a6772">R3 路由选择和转发的区别</a></li>
<li><a href="#orgd0f8eca">R4 转发表的作用</a></li>
<li><a href="#org73f0d5e">R5 网络层的服务模型</a></li>
<li><a href="#org1607da7">R6 数据平面和控制平面的软硬件实现</a></li>
<li><a href="#org1cc568d">R7 转发表的影子副本</a></li>
<li><a href="#orgc9aaca7">R8 基于目的转发和通用转发</a></li>
<li><a href="#orgdbd3bae">R9 最长前缀匹配</a></li>
<li><a href="#orgac9b028">R10 三种交换结构</a></li>
<li><a href="#org2ffbbe7">R11 输入端口分组丢失</a></li>
<li><a href="#orga7ce6cf">R12 输出端口分组丢失</a></li>
<li><a href="#orgbbf7a64">R13 HOL阻塞</a></li>
<li><a href="#org9073c88">R14 分组调度规则</a></li>
<li><a href="#org1e2ce27">R15 分组的优先权</a></li>
<li><a href="#orgb40de8c">R16 循环和加权公平排队</a></li>
<li><a href="#org075cc2d">R17 IP数据报格式</a></li>
<li><a href="#orgf4fdc8b">R18</a></li>
<li><a href="#org74e002b">R19 与运输层检验和的区别</a></li>
<li><a href="#org234a681">R20 分片</a></li>
<li><a href="#orgbecb13d">R21 接口与IP地址</a></li>
<li><a href="#orgac62090">R22</a></li>
<li><a href="#orge1afbcd">R23</a></li>
<li><a href="#org9c64c5c">R24</a></li>
<li><a href="#org0e2e6a6">R25</a></li>
<li><a href="#org3e32423">R26</a></li>
<li><a href="#orgad4c893">R27 路由聚合</a></li>
<li><a href="#org0c434c0">R28</a></li>
<li><a href="#org17ca912">R29 专用网络地址</a></li>
<li><a href="#org7633559">R30 IP首部</a></li>
<li><a href="#orgab9451a">R31 隧道</a></li>
<li><a href="#org512477d">R32 通用转发与基于目的地转发的区别</a></li>
<li><a href="#org1a24cd8">R33</a></li>
<li><a href="#org79a1e9e">R34</a></li>
<li><a href="#org6832673">R35</a></li>
</ul>
</li>
<li><a href="#org9a90aaf">4.2. 习题</a>
<ul>
<li><a href="#org44bc230">P1 基于目的地转发的限制</a></li>
<li><a href="#org7ecaaab">P2</a></li>
<li><a href="#org498f24e">P3 交换结构时延</a></li>
<li><a href="#org5fa36e2">P4 交换结构调度</a></li>
<li><a href="#org259aade">P5 地址范围转换为最长前缀匹配</a></li>
<li><a href="#org90ebb5f">P6 最长前缀匹配与地址范围</a></li>
<li><a href="#org0be2924">P7</a></li>
<li><a href="#org419e25b">P8 子网与接口数量</a></li>
<li><a href="#org7573491">P9 子网掩码记法</a></li>
<li><a href="#orgbc9a548">P10</a></li>
<li><a href="#orge5fe8c6">P11</a></li>
<li><a href="#org596b1c5">P12 子网划分</a></li>
<li><a href="#orgf88ce71">P13 大学IP地址块和服务器位置</a></li>
<li><a href="#orgd8e3ea4">P14 分片</a></li>
<li><a href="#orgd4357ba">P15</a></li>
<li><a href="#orgeda16a7">P16 NAT</a></li>
<li><a href="#org21fc295">P17</a></li>
<li><a href="#org5d32d71">P18 NAT与TCP连接</a></li>
<li><a href="#org41e6a2c">P19 通用转发与流表</a></li>
<li><a href="#org97c526b">P20</a></li>
<li><a href="#orgadb7412">P21</a></li>
<li><a href="#org0c59482">P22</a></li>
</ul>
</li>
<li><a href="#org0fa9698">4.3. Wireshark实验</a></li>
</ul>
</li>
<li><a href="#org4c84186">5. 网络层：控制平面</a>
<ul>
<li><a href="#org843811b">5.1. 笔记</a></li>
<li><a href="#orgd0ca986">5.2. 复习题</a>
<ul>
<li><a href="#orgdd27b9e">R1 每路由器控制</a></li>
<li><a href="#orgcff195f">R2 逻辑集中式控制</a></li>
<li><a href="#org11520d3">R3 集中式和分散式路由选择算法</a></li>
<li><a href="#org5e1f375">R4 链路状态和距离矢量路由选择选法</a></li>
<li><a href="#orga69bced">R5 距离矢量路由选择中的无穷计数</a></li>
<li><a href="#org5a010d2">R6</a></li>
<li><a href="#orga233e86">R7 AS内部协议的必要性</a></li>
<li><a href="#org9be127c">R8</a></li>
<li><a href="#orge8b7a4b">R9 OSPF AS中的区域</a></li>
<li><a href="#orgef80b4a">R10 子网、前缀和BGP路由</a></li>
<li><a href="#org6a01f07">R11 AS-PATH NEXT-HOP</a></li>
<li><a href="#orgc0d57af">R12 BGP策略</a></li>
<li><a href="#org9ba86b8">R13</a></li>
<li><a href="#orgf8665de">R14</a></li>
<li><a href="#org457c0da">R15</a></li>
<li><a href="#org5c21383">R16</a></li>
<li><a href="#org088ff41">R17</a></li>
<li><a href="#org136e381">R18</a></li>
<li><a href="#org2806042">R19</a></li>
<li><a href="#org05700bc">R20</a></li>
<li><a href="#orgff3349f">R21</a></li>
<li><a href="#orgb565dc0">R22 SNMP报文</a></li>
<li><a href="#org59db029">R23</a></li>
</ul>
</li>
<li><a href="#org3059d56">5.3. 习题</a>
<ul>
<li><a href="#orgc7f3e86">P1 图中的路径</a></li>
<li><a href="#orge660157">P2</a></li>
<li><a href="#orga51342d">P3 Dijkstra最短路算法</a></li>
<li><a href="#orgf195fc3">P4</a></li>
<li><a href="#orgb68e8fc">P5 距离向量算法</a></li>
<li><a href="#orgc2eb5c6">P6 距离向量算法收敛所需的迭代次数</a></li>
<li><a href="#org4ec2929">P7</a></li>
<li><a href="#orged83f89">P8</a></li>
<li><a href="#org3648d75">P9 无穷计数与链路开销减小</a></li>
<li><a href="#org2a2372c">P10 距离向量算法的收敛性</a></li>
<li><a href="#org9bae0fc">P11 距离向量算法的计算过程</a></li>
<li><a href="#org2fe322a">P12</a></li>
<li><a href="#orgcfcabf2">P13</a></li>
<li><a href="#orgbe39078">P14 eBGP和iBGP</a></li>
<li><a href="#orgd46f6ba">P15</a></li>
<li><a href="#org0c2e591">P16</a></li>
<li><a href="#org2f5da61">P17</a></li>
<li><a href="#orga6b575d">P18 P2P与BGP</a></li>
<li><a href="#org633a7f1">P19</a></li>
<li><a href="#org69615aa">P20 BGP通告与策略</a></li>
<li><a href="#org8a21f06">P21 SNMP的请求响应和陷阱方式</a></li>
<li><a href="#org9f83d78">P22 SNMP选择UDP而不是TCP</a></li>
</ul>
</li>
<li><a href="#org09d3647">5.4. 套接字编程作业 ICMP ping</a></li>
<li><a href="#org9189175">5.5. 编程作业 分布式异步距离向量路由选择算法</a>
<ul>
<li><a href="#org60bed5e">Basic</a></li>
<li><a href="#orgc9ac83e">Advanced</a></li>
</ul>
</li>
<li><a href="#orgaac2cae">5.6. Wireshark实验：ICMP</a>
<ul>
<li><a href="#orgcf11288">ICMP and Ping</a></li>
<li><a href="#org89b8b84">ICMP and Traceroute</a></li>
<li><a href="#org0e86947">Extra Credit</a></li>
</ul>
</li>
<li><a href="#org036fe44">5.7. Wireshark 实验：DHCP</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
<a href="https://wps.pearsoned.com/ecs_kurose_compnetw_6/216/55463/14198700.cw/index.html">Interactive Animations</a><br />
<a href="https://gaia.cs.umass.edu/kurose_ross/wireshark.htm">Wireshark Labs</a><br />
</p>

<div id="outline-container-org58cd609" class="outline-2">
<h2 id="org58cd609"><span class="section-number-2">1.</span> 计算机网络和英特网</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgafce4fd" class="outline-3">
<h3 id="orgafce4fd"><span class="section-number-3">1.1.</span> 复习题</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org20abe66" class="outline-4">
<h4 id="org20abe66">R1</h4>
<div class="outline-text-4" id="text-org20abe66">
<p>
”主机”和“端系统”之间有什么不同？列举几种不同类型的端系统。Web服务器是一种端系统吗？<br />
</p>

<p>
这两种说法是对同一种事物的不同表述。对于运行在计算机上的应用来说，该计算机就可以称之为主机（host）；而对于整个计算机网络，处于网络外围的设备可以称之为末端系统（end system）。<br />
</p>

<blockquote>
<p>
There is no difference. Throughout this text, the words “host” and “end system” are used interchangeably. End systems include PCs, workstations, Web servers, mail servers, PDAs, Internet-connected game consoles, etc.<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org71aeeb2" class="outline-4">
<h4 id="org71aeeb2">R2</h4>
<div class="outline-text-4" id="text-org71aeeb2">
<p>
“协议”一词常被用于描述外交关系。维基百科是怎样描述外交协议的？<br />
</p>
<blockquote>
<p>
A protocol is a rule which describes how an activity should be performed. Protocols specify the proper and generally accepted behavior in matters of state and diplomacy. Protocol is commonly described as a set of international courtesy rules. ---<a href="https://en.wikipedia.org/wiki/Protocol_(diplomacy)">Wikipedia</a><br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org14fdfd3" class="outline-4">
<h4 id="org14fdfd3">R3</h4>
<div class="outline-text-4" id="text-org14fdfd3">
<p>
标准对于协议为什么重要？<br />
</p>

<p>
标准是每个人就各个协议及其作用取得的一致认识，使得人们就能够创造协同工作的系统和产品。<br />
</p>
</div>
</div>

<div id="outline-container-org16fc562" class="outline-4">
<h4 id="org16fc562">R4</h4>
<div class="outline-text-4" id="text-org16fc562">
<p>
列出6种接入技术。将它们分类为住宅接入、公司接入或广域无线接入。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">DSL over 电话线</td>
<td class="org-left">住宅</td>
</tr>

<tr>
<td class="org-left">电缆 to HFC</td>
<td class="org-left">住宅</td>
</tr>

<tr>
<td class="org-left">FTTH</td>
<td class="org-left">住宅、公司</td>
</tr>

<tr>
<td class="org-left">以太网</td>
<td class="org-left">住宅、公司</td>
</tr>

<tr>
<td class="org-left">Wi-Fi</td>
<td class="org-left">住宅、公司</td>
</tr>

<tr>
<td class="org-left">3G、4G</td>
<td class="org-left">广域</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgead6e6f" class="outline-4">
<h4 id="orgead6e6f">R5</h4>
<div class="outline-text-4" id="text-orgead6e6f">
<p>
HFC传输速率在用户间是专用的还是共享的？在下行HFC信道中，可能出现碰撞吗？为什么？<br />
</p>

<p>
HFC带宽由用户共享。在下行信道中，所有数据包都来自一个源，即头端。因此，在下行信道中没有碰撞。<br />
</p>
</div>
</div>

<div id="outline-container-orgca6c1d2" class="outline-4">
<h4 id="orgca6c1d2">R6</h4>
<div class="outline-text-4" id="text-orgca6c1d2">
<p>
列出你所在城市中的可供使用的住宅接入技术。对于每种类型的接入方式，给出所宜称的下行速率、上行速率和每月的价格。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">接入方式</td>
<td class="org-left">下行速率</td>
<td class="org-left">上行速率</td>
<td class="org-left">价格</td>
</tr>

<tr>
<td class="org-left">FTTH</td>
<td class="org-left">1000Mbps</td>
<td class="org-left">50Mbps</td>
<td class="org-left">¥269</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf040e26" class="outline-4">
<h4 id="orgf040e26">R7</h4>
<div class="outline-text-4" id="text-orgf040e26">
<p>
以太LAN的传输速率是多少？<br />
</p>

<p>
<a href="https://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E7%BD%91#%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%B1%BB%E5%9E%8B">10Mbps~10Gbps</a><br />
</p>
</div>
</div>

<div id="outline-container-orgd8b9d05" class="outline-4">
<h4 id="orgd8b9d05">R8</h4>
<div class="outline-text-4" id="text-orgd8b9d05">
<p>
能够运行以太网的一些物理媒体是什么？<br />
</p>

<p>
同轴电缆、双绞线、光纤。<br />
</p>
</div>
</div>

<div id="outline-container-orgb5f5f53" class="outline-4">
<h4 id="orgb5f5f53">R9</h4>
<div class="outline-text-4" id="text-orgb5f5f53">
<p>
拨号调制解调器、HFC、DSL和FTTH都用于住宅接入。对于这些技术，给出每种技术的传输速率的范围，并讨论它们的传输速率是共享的还是专用的。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">接入技术</td>
<td class="org-left">传输速率</td>
<td class="org-left">共享或专用</td>
</tr>

<tr>
<td class="org-left">Dial-up</td>
<td class="org-left">56kbps</td>
<td class="org-left">专用</td>
</tr>

<tr>
<td class="org-left">DSL</td>
<td class="org-left">55Mbps</td>
<td class="org-left">专用</td>
</tr>

<tr>
<td class="org-left">HFC</td>
<td class="org-left">42.8Mbps</td>
<td class="org-left">共享</td>
</tr>

<tr>
<td class="org-left">FTTH</td>
<td class="org-left">Gbps</td>
<td class="org-left">专用</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org98dfe3a" class="outline-4">
<h4 id="org98dfe3a">R10</h4>
<div class="outline-text-4" id="text-org98dfe3a">
<p>
描述今天最为流行的无线因特网接入技术。对它们进行比较和对照。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Wi-Fi+FTTX</td>
</tr>

<tr>
<td class="org-left">4G/5G</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org4954ab5" class="outline-4">
<h4 id="org4954ab5">R11</h4>
<div class="outline-text-4" id="text-org4954ab5">
<p>
假定在发送主机和接收主机间只有一台分组交换机。发送主机和交换机间以及交换机和接收主机间的传输速率分别是R<sub>1</sub>和R<sub>2</sub>。假设该交换机使用存储转发分组交换方式，发送一个长度为L的分组的端到端总时延是什么？（忽略排队时延、传播时延和处理时延。）<br />
</p>

<p>
\[ \frac{L}{R_1}+\frac{L}{R_2}. \]<br />
</p>
</div>
</div>

<div id="outline-container-org3e697e9" class="outline-4">
<h4 id="org3e697e9">R12</h4>
<div class="outline-text-4" id="text-org3e697e9">
<p>
与分组交换网络相比，电路交换网络有哪些优点？在电路交换网络中，TDM比FDM有哪些优点？<br />
</p>

<p>
与分组交换网络相比，电路交换网络预留了端系统沿路径所需要的资源，因此带宽是有保证的。FDM需要复杂的模拟硬件来将信号移动到适当的频段。<br />
</p>
</div>
</div>

<div id="outline-container-org20bd919" class="outline-4">
<h4 id="org20bd919">R13</h4>
<div class="outline-text-4" id="text-org20bd919">
<p>
假定用户共享一条2Mbps链路。同时假定当每个用户传输时连续以1Mbps传输，但每个用户仅传输20%的时间。<br />
</p>
<ol class="org-ol">
<li>当使用电路交换时，能够支持多少用户？<br /></li>
<li>作为该题的后继问题，假定使用分组交换。为什么如果两个或更少的用户同时传输的话，在链路前面基本上没有排队时延？为什么如果3个用户同时传输的话，将有排队时延？<br /></li>
<li>求出某指定用户正在传输的概率。<br /></li>
<li>假定现在有3个用户。求出在任何给定的时间，所有3个用户在同时传输的概率。求出队列增长的时间比率。<br /></li>
</ol>


<ol class="org-ol">
<li>使用电路交换时，能支持2（2Mbps/1Mbps）个并发用户。<br /></li>
<li>2个用户同时传输要求链路的传输速率至少是2Mbps，而链路的传输速率正好是2Mbps，因此没有排队时延。3个用户同时传输要求链路的传输速率至少是3Mbps，因此有排队时延。<br /></li>
<li>0.2<br /></li>
<li>在任何给定时间3个用户同时传输的概率是8‱（0.2^3），队列增长的时间比率等于3个用户同时传输的概率。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orge6d36e0" class="outline-4">
<h4 id="orge6d36e0">R14</h4>
<div class="outline-text-4" id="text-orge6d36e0">
<p>
为什么等级结构中级别相同的两个ISP通常互相对等？某IXP是如何挣钱的？<br />
</p>

<blockquote>
<p>
如果两个ISP不互相对等，那么当他们向对方发送流量时，他们必须通过供应商ISP来发送流量，从而必须向其支付流量费用。ISP通过直接对等可以减少通过供应商ISP的流量，从而节省费用。IXP可以向连接到自身的每个ISP收取相对较少的费用来赚钱，这些费用可能取决于发往或来自IXP的流量。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org787991b" class="outline-4">
<h4 id="org787991b">R15</h4>
<div class="outline-text-4" id="text-org787991b">
<p>
某些内容提供商构建了自己的网络。描述谷歌的网络。内容提供商构建这些网络的动机是什么？<br />
</p>

<p>
谷歌数据中心都经过专用的 TCP/IP 网络互联，该网络跨越全球，不过独立于公共因特网。 谷歌专用网络仅承载出入谷歌服务器的流量。谷歌专用网络通过与较低层 ISP 对等，尝试绕过因特网的较高层，采用的方式可以是直接与它们连接，或者在 IXP 处与它们连接。 然而因为许多接入 ISP 仍然仅能通过第一层网络的传输到达，所以谷歌网络也与第一层 ISP 连接，并就与这些 ISP 交换的流量向它们付费。<br />
</p>

<p>
通过创建自己的网络，内谷提供商不仅减少了向顶层 ISP 支付的费用，而且对其服务最终如何交付给端用户有了更多的控制。<br />
</p>
</div>
</div>

<div id="outline-container-org0115d3c" class="outline-4">
<h4 id="org0115d3c">R16</h4>
<div class="outline-text-4" id="text-org0115d3c">
<p>
考虑从某源主机跨越一条固定路由向某目的主机发送一分组。列出端到端时延中的时延组成成分。这些时延中的哪些是固定的，哪些是变化的？<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">处理延时</td>
<td class="org-left">固定</td>
</tr>

<tr>
<td class="org-left">排队延时</td>
<td class="org-left">变化</td>
</tr>

<tr>
<td class="org-left">传输延时</td>
<td class="org-left">固定</td>
</tr>

<tr>
<td class="org-left">传播延时</td>
<td class="org-left">固定</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org7d00078" class="outline-4">
<h4 id="org7d00078">R17</h4>
<div class="outline-text-4" id="text-org7d00078">
<p>
访问配套Web网站上有关传输时延与传播时延的Java小程序。在速率、传播时延和可用的分组长度之中找出一种组合，使得该分组的第一个比特到达接收方之前发送方结束了传输。找出另一种组合，使得发送方完成传输之前，该分组的第一个比特到达了接收方。<br />
</p>

<p>
<a href="https://media.pearsoncmg.com/aw/ecs_kurose_compnetwork_7/cw/content/interactiveanimations/transmission-vs-propogation-delay/transmission-propagation-delay-ch1/index.html">Transmission versus Propagation Delay</a><br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">length</td>
<td class="org-left">propagation</td>
<td class="org-left">rate</td>
<td class="org-left">size</td>
<td class="org-left">传输延时</td>
<td class="org-left">传播延时</td>
</tr>

<tr>
<td class="org-left">1000km</td>
<td class="org-left">2.8e8 m/s</td>
<td class="org-left">1Mbps</td>
<td class="org-left">100B</td>
<td class="org-left">0.8ms</td>
<td class="org-left">3.57143ms</td>
</tr>

<tr>
<td class="org-left">10km</td>
<td class="org-left">2.8e8 m/s</td>
<td class="org-left">1Mbps</td>
<td class="org-left">100B</td>
<td class="org-left">0.8ms</td>
<td class="org-left">0.03571ms</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5106e4c" class="outline-4">
<h4 id="org5106e4c">R18</h4>
<div class="outline-text-4" id="text-org5106e4c">
<p>
一个长度为1000字节的分组经距离为2500km的链路传播，传播速率为2.5×10<sup>8</sup>m/s并且传输速率为2Mbps，它需要用多长时间？更为一般地，一个长度为L的分组经距离为d的链路传播，传播速率为s并且传输速率为Rbps，它需要用多长时间？该时延与传输速率相关吗？<br />
</p>

<p>
d<sub>trans</sub> = 1000B÷2Mbps = 4ms<br />
d<sub>prop</sub> = 2500km÷2.5e8m/s = 10ms<br />
d = d<sub>trans</sub> + d<sub>prop</sub> = 14ms<br />
</p>

<p>
更一般地，\(\text{延时}= \frac{d}{s}+\frac{L}{R} \)，该延时与传输速率有关。<br />
</p>
</div>
</div>

<div id="outline-container-orga5015ec" class="outline-4">
<h4 id="orga5015ec">R19</h4>
<div class="outline-text-4" id="text-orga5015ec">
<p>
假定主机A要向主机B发送一个大文件。从主机A到主机B的路径上有3段链路，其速率分别为R<sub>1</sub>=500kbps，R<sub>2</sub>=2Mbps，R<sub>3</sub>=1Mbps。<br />
</p>
<ol class="org-ol">
<li>假定该网络中没有其他流最，该文件传送的吞吐量是多少？<br /></li>
<li>假定该文件为4MB。用吞吐量除以文件长度，将该文件传输到主机B大致需要多长时间？<br /></li>
<li>重复（a）和（b），只是这时凡减小到100kbps。<br /></li>
</ol>


<ol class="org-ol">
<li>瓶颈链路R<sub>1</sub>的传输速率决定了该路径的吞吐量是500kbps。<br /></li>
<li>4MB/500kbps = 64s。<br /></li>
<li>100kbps，4MB/100kbps = 320s。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgee9901d" class="outline-4">
<h4 id="orgee9901d">R20</h4>
<div class="outline-text-4" id="text-orgee9901d">
<p>
假定端系统A要向端系统B发送一个大文件。在一个非常高的层次上，描述端系统怎样从该文件生成分组。当这些分组之一到达某分组交换机时，该交换机使用分组中的什么信息来决定将该分组转发到哪一条链路上？因特网中的分组交换为什么可以与驱车从一个城市到另一个城市并沿途询问方向相类比？<br />
</p>

<p>
终端系统A将大文件分成几块。它给每个块添加头，从而产生多个分组。每个分组的头部包括目的地端系统B的IP地址。分组交换机使用数据包中的目的地IP地址来决定出链路。询问走哪条路类似于一个分组询问它应该被转发到哪条出链路。<br />
</p>
</div>
</div>

<div id="outline-container-org9252fa5" class="outline-4">
<h4 id="org9252fa5">R21</h4>
<div class="outline-text-4" id="text-org9252fa5">
<p>
访问配套Web站点的排队和丢包Java小程序。最大发送速率和最小的传输速率是多少？对于这些速率，流量强度是多大？用这些速率运行该Java小程序并确定出现丢包要花费多长时间？然后第二次重复该实验，再次确定出现丢包花费多长时间。这些值有什么不同？为什么会有这种现象？<br />
</p>

<p>
<a href="https://media.pearsoncmg.com/aw/ecs_kurose_compnetwork_7/cw/content/interactiveanimations/queuing-loss-applet/index.html">Queuing and Loss</a><br />
</p>

<p>
最大发送速率是500pkt/s，最小传输速率是350pkt/s，此时流量强度是500÷350≈1.43。第一次出现丢包花费9.7ms，第二次出现丢包花费8.5ms，之所以出现丢包花费的时间不同是因为两个包之间的间隔时间是不确定的。<br />
</p>
</div>
</div>

<div id="outline-container-org4215da9" class="outline-4">
<h4 id="org4215da9">R22</h4>
<div class="outline-text-4" id="text-org4215da9">
<p>
列出一个层次能够执行的5个任务。这些任务中的一个（或两个）可能由两个（或更多）层次执行吗？<br />
</p>

<p>
5个任务分别是差错控制、流程控制、分段和重组、多路传输、建立连接，这些任务可以分布在不同的层次，例如链路层和应用层都有差错控制。<br />
</p>
</div>
</div>

<div id="outline-container-org215ba7d" class="outline-4">
<h4 id="org215ba7d">R23</h4>
<div class="outline-text-4" id="text-org215ba7d">
<p>
因特网协议栈中的5个层次有哪些？在这些层次中，每层的主要任务是什么？<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">层次</th>
<th scope="col" class="org-left">任务</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">应用层</td>
<td class="org-left">端系统中的应用程序与另一个端系统中的应用程序交换报文</td>
</tr>

<tr>
<td class="org-left">运输层</td>
<td class="org-left">在应用程序端点之间传送报文段</td>
</tr>

<tr>
<td class="org-left">网络层</td>
<td class="org-left">将数据报从一台主机移动到另一台主机</td>
</tr>

<tr>
<td class="org-left">链路层</td>
<td class="org-left">将帧从一个节点移动到路径上的下一个节点</td>
</tr>

<tr>
<td class="org-left">物理层</td>
<td class="org-left">将帧中的一个个比特从一个节点移动到下一个节点</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org836ba0d" class="outline-4">
<h4 id="org836ba0d">R24</h4>
<div class="outline-text-4" id="text-org836ba0d">
<p>
什么是应用层报文？什么是运输层报文段？什么是网络层数据报？什么是链路层帧？<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">应用层报文</td>
<td class="org-left">message</td>
<td class="org-left">应用传输给另一个应用的数据</td>
</tr>

<tr>
<td class="org-left">运输层报文</td>
<td class="org-left">segment</td>
<td class="org-left">应用层报文+运输层首部（接收端应用信息、差错检测信息）</td>
</tr>

<tr>
<td class="org-left">网络层数据报</td>
<td class="org-left">datagram</td>
<td class="org-left">运输层报文+网络层首部（源和目的端系统地址）</td>
</tr>

<tr>
<td class="org-left">链路层帧</td>
<td class="org-left">frame</td>
<td class="org-left">网络层报文+链路层首部</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org4af1b9e" class="outline-4">
<h4 id="org4af1b9e">R25</h4>
<div class="outline-text-4" id="text-org4af1b9e">
<p>
路由器处理因特网协议栈中的哪些层次？链路层交换机处理的是哪些层次？主机处理的是哪些层次？<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">路由器</td>
<td class="org-left">网络层、链路层、物理层</td>
</tr>

<tr>
<td class="org-left">链路层交换机</td>
<td class="org-left">链路层、物理层</td>
</tr>

<tr>
<td class="org-left">主机</td>
<td class="org-left">应用层、运输层、网络层、链路层、物理层</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org1bb022c" class="outline-4">
<h4 id="org1bb022c">R26</h4>
<div class="outline-text-4" id="text-org1bb022c">
<p>
病毒和蠕虫之间有什么不同？<br />
</p>

<p>
病毒（virus）是一种需要某种形式的用户交互来感染用户设备的恶意软件。蠕虫（worm）是一种无须任何明显用户交互就能进入设备的恶意软件。<br />
</p>
</div>
</div>

<div id="outline-container-org7f0d359" class="outline-4">
<h4 id="org7f0d359">R27</h4>
<div class="outline-text-4" id="text-org7f0d359">
<p>
描述如何产生一个僵尸网络，以及僵尸网络是怎样被用于DDoS攻击的。<br />
</p>

<p>
创建僵尸网络需要攻击者在一些应用程序或系统中找到漏洞（例如利用应用程序中可能存在的缓冲区溢出漏洞）。找到漏洞后，攻击者需要扫描有漏洞的主机，然后利用该特定的漏洞来破坏一系列的系统。作为僵尸网络一部分的系统都可以自动扫描其环境，并通过该漏洞进行传播。这种僵尸网络的一个重要特性是，僵尸网络的发起者可以远程控制并向僵尸网络中的所有节点发布命令。攻击者可以控制多个源并让每个源向目标发起DoS攻击（带宽泛洪或者连接泛洪）。<br />
</p>
</div>
</div>

<div id="outline-container-orgb0cd95c" class="outline-4">
<h4 id="orgb0cd95c">R28</h4>
<div class="outline-text-4" id="text-orgb0cd95c">
<p>
假定Alice和Bob经计算机网络互相发送分组。假定Trudy将自己安置在网络中，使得她能够俘获由Alice发送的所有分组，并发送她希望给Bob的东西；她也能够俘获由Bob发送的所有分组，并发送她希望给Alice的东西。列出在这种情况下Trudy能够做的某些恶意的事情。<br />
</p>

<p>
Trudy可以修改、伪造、丢弃或者重复发送Alice和Bob之间发送的分组。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgc5467a8" class="outline-3">
<h3 id="orgc5467a8"><span class="section-number-3">1.2.</span> 习题</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orgb3667dd" class="outline-4">
<h4 id="orgb3667dd">P1</h4>
<div class="outline-text-4" id="text-orgb3667dd">
<p>
设计并描述在自动柜员机和银行的中央计算机之间使用的一种应用层协议。你的协议应当允许验证用户卡和口令，查询账目结算（这些都在中央计算机中进行维护），支取账目（即向用户支付钱）。你的协议实体应当能够处理取钱时账目中钱不够的常见问题。通过列出自动柜员机和银行中央计算机在报文传输和接收过程中交换的报文和采取的动作来定义你的协议。使用类似于图1-2所示的图，拟定在简单无差错取钱情况下该协议的操作。明确地阐述在该协议中关于底层端到端运输服务所做的假设。<br />
</p>


<div id="org7d18190" class="figure">
<p><img src="./img/fig1-2.png" alt="fig1-2.png" style="width:100%; max-width:400px;" /><br />
</p>
</div>


<div id="org267b82c" class="figure">
<p><img src="img/ch1-p1.svg" alt="ch1-p1.svg" class="org-svg" style="width:100%; max-width:400px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org0bab727" class="outline-4">
<h4 id="org0bab727">P2</h4>
<div class="outline-text-4" id="text-org0bab727">
<p>
式（1-1）给出了经传输速率为R的N段链路发送长度L的一个分组的端到端时延。对于经过N段链路一个接一个地发送P个这样的分组，一般化地表示出这个公式。<br />
</p>

\begin{align}
  d_{端到端} &= N\frac{L}{R} \tag{1-1} \\
\end{align}

<p>
在时刻 \( N\frac{L}{R} \)，第1个分组被目的地接收，此时第2个分组在最后的路由器；<br />
在时刻 \( \frac{L}{R}+N\frac{L}{R} \)，第2个分组被目的地接收，此时第3个分组在最后一个路由器；<br />
在时刻 \( 2\frac{L}{R}+N\frac{L}{R} \)，第3个分组被目的地接收，此时第4个分组在最后一个路由器；<br />
依此类推，在时刻 \( (P-1)\frac{L}{R}+N\frac{L}{R} \) 第P个分组被目的地接收。<br />
</p>
</div>
</div>

<div id="outline-container-org447c6bc" class="outline-4">
<h4 id="org447c6bc">P3</h4>
<div class="outline-text-4" id="text-org447c6bc">
<p>
考虑一个应用程序以稳定的速率传输数据（例如，发送方每k个时间单元产生一个N比特的数据单元，其中k较小且固定）。另外，当这个应用程序启动时，它将连续运行相当长的一段时间。回答下列问题，简要论证你的回答：<br />
</p>
<ol class="org-ol">
<li>是分组交换网还是电路交换网更为适合这种应用？为什么？<br /></li>
<li>假定使用了分组交换网，并且该网中的所有流量都来自如上所述的这种应用程序。此外，假定该应用程序数据传输速率的总和小于每条链路的各自容量。需要某种形式的拥塞控制吗？为什么？<br /></li>
</ol>


<ol class="org-ol">
<li>电路交换网络将很适合该应用，因为该应用涉及到具有可预测的平滑带宽需求的长会话。由于传输率是已知的，而不是突发的，因此可以为每个应用会话保留带宽，而不会造成重大浪费。此外，建立和断开连接的开销成本可以在典型应用会话的漫长时间内摊销。<br /></li>
<li>在最坏的情况下，所有的应用程序同时在一个或多个网络链接上传输。然而，由于每条链路都有足够的带宽来处理所有应用程序的数据速率之和，因此不会发生拥堵（很少排队）。鉴于这样充足的链接能力，网络不需要拥堵控制机制。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org48b212c" class="outline-4">
<h4 id="org48b212c">P4</h4>
<div class="outline-text-4" id="text-org48b212c">
<p>
考虑在图1-13中的电路交换网。回想在每条链路上有4条链路，以顺时针方向标记四台交换机A、B、C和D。<br />
</p>
<ol class="org-ol">
<li>在该网络中，任何时候能够进行同时连接的最大数量是多少？<br /></li>
<li>假定所有连接位于交换机A和C之间。能够进行同时连接的最大数量是多少？<br /></li>
<li><p>
假定我们要在交换机A和C之间建立4条连接，在交换机B和D之间建立另外4条连接。我们能够让这些呼叫通过这4条链路建立路由以容纳所有8条连接吗？<br />
</p>


<div id="orgda03e5e" class="figure">
<p><img src="./img/fig1-13.png" alt="fig1-13.png" style="width:100%; max-width:300px;" /><br />
</p>
</div></li>
</ol>


<ol class="org-ol">
<li>交换机之间两两连接，最大数量是4×4=16。<br /></li>
<li>4+4=8。<br /></li>
<li><p>
可以，如下图所示，A、C之间利用红色链路连接，B、D之间利用蓝色链路连接。<br />
</p>


<div id="orgab72a37" class="figure">
<p><img src="./img/ch1-p4.png" alt="ch1-p4.png" style="width:100%; max-width:300px;" /><br />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org022cf6e" class="outline-4">
<h4 id="org022cf6e">P5</h4>
<div class="outline-text-4" id="text-org022cf6e">
<p>
回顾在1.4节中的车队的类比。假定传播速度为100km/h。<br />
</p>
<ol class="org-ol">
<li>假定车队旅行150km：在一个收费站前面开始，通过第二个收费站，并且正好在第三个收费站后面结束。其端到端时延是多少？<br /></li>
<li>重复（a），现在假定车队中有8辆汽车而不是10辆。<br /></li>
</ol>


<ol class="org-ol">
<li>按题目的意思收费站之间间隔75km，一共需要经过3个收费站。在时刻47min（通过第一个收费站花费2min，行驶75km花费45min，）车队全部抵达第二个收费站，在时刻94min车队抵达第三个收费站，最后在时刻96min车队通过第三个收费站。<br /></li>
<li>8辆车通过收费站需要8辆÷5辆/min=1.6min，因此总时间是90+1.6*3=94.8min。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orge3e7800" class="outline-4">
<h4 id="orge3e7800">P6</h4>
<div class="outline-text-4" id="text-orge3e7800">
<p>
这个习题开始探讨传播时延和传输时延，这是数据网络中的两个重要概念。考虑两台主机A和B由一条速率为Rbps的链路相连。假定这两台主机相隔m米，沿该链路的传播速率为s m/s。主机A向主机B发送长度L比特的分组。<br />
</p>
<ol class="org-ol">
<li>用m和s来表示传播时延d<sub>prop</sub>。<br /></li>
<li>用L和R来确定该分组的传输时间d<sub>trans</sub>。<br /></li>
<li>忽略处理和排队时延，得出端到端时延的表达式。<br /></li>
<li>假定主机A在时刻t=0开始传输该分组。在时刻t=d<sub>trans</sub>，该分组的最后一个比特在什么地方？<br /></li>
<li>假定d<sub>prop</sub>大于d<sub>trans</sub>。在时刻t=d<sub>trans</sub>，该分组的第一个比特在何处？<br /></li>
<li>假定d<sub>prop</sub>小于d<sub>trans</sub>。在时刻t=d<sub>trans</sub>，该分组的第一个比特在何处？<br /></li>
<li>假定s=2.5x10<sup>8</sup>，L=120比特，R=56kbps。求出使d<sub>prop</sub>等于d<sub>trans</sub>的距离m。<br /></li>
</ol>


<ol class="org-ol">
<li>\[ d_\mathrm{prop} = m\mathrm{m} \div s\mathrm{m/s} = \frac{m}{s} \mathrm{s}. \]<br /></li>
<li>\[ d_\mathrm{trans} = L\mathrm{bit} \div R\mathrm{bps} = \frac LR \mathrm{s}. \]<br /></li>
<li>\[ d_\mathrm{端到端} = (\frac ms + \frac LR) \mathrm{s}. \]<br /></li>
<li>该分组的最后一个比特被路由器推上链路。<br /></li>
<li>链路。<br /></li>
<li>目的主机。<br /></li>
<li>\[ \frac ms = \frac LR \implies \frac{m\mathrm{m}}{2.5×10^8\mathrm{m/s}} = \frac{120\mathrm{b}}{56\mathrm{kbps}} \implies m ≈ 536km.\]<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org7bddee0" class="outline-4">
<h4 id="org7bddee0">P7</h4>
<div class="outline-text-4" id="text-org7bddee0">
<p>
在这个习题中，我们考虑从主机A向主机B通过分组交换网发送语音（VoIP）。主机A将模拟语音转换为传输中的64kbps数字比特流。然后主机A将这些比特分为56字节的分组。A和B之间有一条链路：它的传输速率是2Mbps，传播时延是1Oms。一旦A收集了一个分组，就将它向主机B发送。一旦主机B接收到一个完整的分组，它将该分组的比特转换成模拟信号。从比特产生（从位于主机A的初始模拟信号起）的时刻起，到该比特被解码（在主机B上作为模拟信号的一部分），花了多少时间？<br />
</p>

<p>
分组由模拟语音转换为数字比特流的时间为56B÷64kbps=7ms；<br />
传输时间为56B÷2Mbps=0.224ms；<br />
总时间为7+0.224+10=17.224ms。<br />
</p>
</div>
</div>

<div id="outline-container-orgf16b81b" class="outline-4">
<h4 id="orgf16b81b">P8</h4>
<div class="outline-text-4" id="text-orgf16b81b">
<p>
假定用户共享一条3Mbps的链路。又设每个用户传输时要求150kbps，但是每个用户仅有10%的时间传输。（参见1.3节中关于“分组交换与电路交换的对比”的讨论。）<br />
</p>
<ol class="org-ol">
<li>当使用电路交换时，能够支持多少用户？<br /></li>
<li>对于本习题的后续小题，假定使用分组交换。求出某给定用户正在传输的概率。<br /></li>
<li>假定有120个用户。求出在任何给定时刻，实际有n个用户在同时传输的概率。（提示：使用二项式分布。）<br /></li>
<li>求出有21个或更多用户同时传输的概率。<br /></li>
</ol>


<ol class="org-ol">
<li>能够支持3Mbps÷150kbps=20个用户。<br /></li>
<li>p=0.1。<br /></li>
<li>\[ \binom{120}{n}p^n(1-p)^{120-n}. \]<br /></li>
<li><p>
&#x00ad;<br />
</p>

<p>
\[ 1 - \sum_{n=0}^{20} \binom{120}{n}p^n(1-p)^{120-n} ≈ 0.008. \]<br />
</p>

<div class="org-src-container">
<pre class="src src-R">1 - pbinom(20, size=120, prob=0.1)
</pre>
</div>

<pre class="example">
0.00794119224839696
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-orgf8eb32b" class="outline-4">
<h4 id="orgf8eb32b">P9</h4>
<div class="outline-text-4" id="text-orgf8eb32b">
<p>
考虑在1.3节”分组交换与电路交换的对比”的讨论中，给出了一个具有一条1Mbps链路的例子。用户在忙时以100kbps速率产生数据，但忙时仅以p=0.1的概率产生数据。假定用1Gbps链路替代1Mbps的链路。<br />
</p>
<ol class="org-ol">
<li>当采用电路交换技术时，能被同时支持的最大用户数量N是多少？<br /></li>
<li>现在考虑分组交换和有M个用户的情况。给出多于N用户发送数据的概率公式（用p、M、N表示）。<br /></li>
</ol>


<ol class="org-ol">
<li>N=1Gbps÷100kbps=10000.<br /></li>
<li>\[ \sum_{k=N+1}^M \binom{M}{k}p^k(1-p)^{M-k}. \]<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgda42c52" class="outline-4">
<h4 id="orgda42c52">P10</h4>
<div class="outline-text-4" id="text-orgda42c52">
<p>
考虑一个长度为L的分组从端系统A开始，经3段链路传送到目的端系统。令d<sub>i</sub>、s<sub>i</sub> 和R<sub>i</sub>，表示链路i的长度、传播速度和传输速率（i=1，2，3）。该分组交换机对每个分组的时延为d<sub>proc</sub>。假定没有排队时延，用d<sub>i</sub>、s<sub>i</sub>、R<sub>i</sub>（i=1，2，3）和L表示，该分组总的端到端时延是什么？现在假定该分组是1500字节，在所有3条链路上的传播时延是2.5×10<sup>8</sup>m/s，所有3条链路的传输速率是2Mbps，分组交换机的处理时延是3ms，第一段链路的长度是5000km，第二段链路的长度是4000km，并且最后一段链路的长度是1000km。对于这些值，该端到端时延为多少？<br />
</p>

\begin{align*}
  d_{端到端} &= \sum_{i=1}^3 (\frac{d_i}{s_i} + \frac{L}{R_i}) + 2×d_{proc} \\
  &= 3×(1500B÷2Mbps)+2×3ms+(5000+4000+1000km)÷2.5×10^8m/s \\
  &= 64ms
\end{align*}
</div>
</div>

<div id="outline-container-orgfe25e28" class="outline-4">
<h4 id="orgfe25e28">P11</h4>
<div class="outline-text-4" id="text-orgfe25e28">
<p>
在上述习题中，假定R<sub>1</sub>=R<sub>2</sub>=R<sub>3</sub>=R且d<sub>proc</sub>=0。进一步假定该分组交换机不存储转发分组，而是在等待分组到达前立即传输它收到的每个比特。这时端到端时延为多少?<br />
</p>

\begin{equation*}
  d_{端到端} = \frac LR + \sum_{i=1}^3 (\frac{d_i}{s_i})
  = 46ms.
\end{equation*}
</div>
</div>

<div id="outline-container-orgeada0a9" class="outline-4">
<h4 id="orgeada0a9">P12</h4>
<div class="outline-text-4" id="text-orgeada0a9">
<p>
一台分组交换机接收一个分组并决定该分组应当转发的出链路。当某分组到达时，另一个分组正在该出链路上被发送到一半，还有4个其他分组正等待传输。这些分组以到达的次序传输。假定所有分组是1500字节并且链路速率是2Mbps。该分组的排队时延是多少？在更一般的情况下，当所有分组的长度是L，传输速率是R，当前正在传输的分组已经传输了x比特，并且已经在队列中有n个分组。其排队时延是多少？<br />
</p>

\begin{align*}
  d_{queue} & = \frac{nL+(L-x)}{R} \\
  & = \frac{4.5×1500B}{2Mbps} \\
  & = 27ms
\end{align*}
</div>
</div>

<div id="outline-container-org201d424" class="outline-4">
<h4 id="org201d424">P13</h4>
<div class="outline-text-4" id="text-org201d424">
<ol class="org-ol">
<li>假定有N个分组同时到达一条当前没有分组传输或排队的链路。每个分组长为L，链路传输速率为R。对N个分组而言。其平均排队时延是多少？<br /></li>
<li>现在假定每隔LN/R秒有N个分组同时到达链路。一个分组的平均排队时延是多少？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
第1个分组的排队时延是0，第二个分组是L/R，第n个分组是(n-1)L/R，因此平均排队时延是<br />
</p>

\begin{align*}
  & (\frac LR + 2\frac LR + \dotsb + (N-1)\frac LR) \div N \\
  = & \frac{LR}{N}(1+2+ \dotsb + (N-1)) \\
  = & (N-1)\frac{L}{2R}.
\end{align*}</li>

<li>N个L长的分组总的传输时间是NL/R，因此每隔LN/R秒有N个分组同时到达时队列是空的，因此平均排队时延与a相同。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org7e57e1e" class="outline-4">
<h4 id="org7e57e1e">P14</h4>
<div class="outline-text-4" id="text-org7e57e1e">
<p>
考虑某路由器缓存中的排队时延。令I表示流量强度；即I=La/R。假定排队时延的形式为IL/R(1-I)，其中I&lt;1.<br />
</p>
<ol class="org-ol">
<li>写出总时延即排队时延加上传输时延的公式。<br /></li>
<li>以L/R为函数画出总时延的图。<br /></li>
</ol>


<ol class="org-ol">
<li>\[ d = \frac{IL}{R(1-I)} +\frac LR = \frac LR\frac{1}{1-I}. \]<br /></li>
<li><p>
令x=L/R，总时延为<br />
</p>

\begin{align*}
  d & = \frac{x}{1-ax}
  = \begin{cases}
    0, & \text{if $x=0$} \\
    +\infty, & \text{if x$\to \frac 1a$}
  \end{cases}
\end{align*}

<div class="org-src-container">
<pre class="src src-R"><span class="org-function-name">delay</span> <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">function</span>(a) {
  <span class="org-ess-keyword">function</span>(x) 1/(1-a*x)
}

coes <span class="org-ess-assignment">&lt;-</span> c(0.5, 1, 2, 2.5)
cols <span class="org-ess-assignment">&lt;-</span> c(<span class="org-string">"yellow"</span>, <span class="org-string">"black"</span>, <span class="org-string">"red"</span>, <span class="org-string">"blue"</span>)

<span class="org-ess-keyword">for</span> (i <span class="org-ess-keyword">in</span> 1:length(coes)) {
  f <span class="org-ess-assignment">&lt;-</span> delay(coes[i])
  add <span class="org-ess-assignment">&lt;-</span> <span class="org-ess-keyword">if</span>( i == 1 ) <span class="org-ess-constant">FALSE</span> <span class="org-ess-keyword">else</span> <span class="org-ess-constant">TRUE</span>
  curve(f, 0, 2,
        ylim = c(0, 20),
        col = cols[i],
        xlab = <span class="org-string">"L/R"</span>,
        ylab = <span class="org-string">"delay"</span>,
        xaxs = <span class="org-string">"i"</span>,
        yaxs = <span class="org-string">"i"</span>,
        add = add)
}

lgd <span class="org-ess-assignment">&lt;-</span> Map(<span class="org-ess-keyword">function</span>(x) {
  paste0(<span class="org-string">"a="</span>, x, collapse = <span class="org-string">""</span>)
}, coes)

legend(<span class="org-string">"bottomright"</span>,
       legend = lgd,
       col = cols,
       lwd = 3)
</pre>
</div>


<div id="org0cbd4cb" class="figure">
<p><img src="img/ch1-p13.png" alt="ch1-p13.png" style="width:100%; max-width:400px;" /><br />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org09bacad" class="outline-4">
<h4 id="org09bacad">P15</h4>
<div class="outline-text-4" id="text-org09bacad">
<p>
令a表示在一条链路上分组的到达率（以分组/秒计），令μ表示一条链路上分组的传输率（以分组/秒计）。基于上述习题中推导出的总时延公式（即排队时延加传输时延），推导出以a和μ，表示的总时延公式。<br />
</p>

\begin{align*}
  μ & = \frac RL, \\
  d & = \frac{L/R}{1-I}
  = \frac{L/R}{1-aL/R}
  = \frac{1/μ}{1-a/μ}
  = \frac{1}{μ-a}.
\end{align*}
</div>
</div>

<div id="outline-container-orgbcff42a" class="outline-4">
<h4 id="orgbcff42a">P16</h4>
<div class="outline-text-4" id="text-orgbcff42a">
<p>
考虑一台路由器缓存前面的一条出链路。在这个习题中，将使用李特尔（Little）公式，这是排队论中的一个著名公式。令N表示在缓存中的分组加上被传输的分组的平均数。令a表示到达该链路的分组速率。令d表示一个分组历经的平均总时延（即排队时延加传输时延）。李特尔公式是N=a×d。假定该缓存平均包含10个分组，并且平均分组排队时延是10ms。该链路的传输速率是100分组/秒。使用李特尔公式，在没有丢包的情况下，平均分组到达率是多少？<br />
</p>

\begin{align*}
  &         &N         &= a\times d \\
  &\implies &(10+1)pkg &= a\times (d_{queue} + d_{trans}) \\
  &\implies &11pkg     &= a\times (10ms + 1pkg÷100pkg/s) \\
  &\implies &a         &= 550pkg/s
\end{align*}
</div>
</div>

<div id="outline-container-org6045ad1" class="outline-4">
<h4 id="org6045ad1">P17</h4>
<div class="outline-text-4" id="text-org6045ad1">
<ol class="org-ol">
<li>对于不同的处理速率、传输速率和传播时延，给出1.4.3节中式（1-2）的一般表达式。<br /></li>
<li>重复（a），不过此时假定在每个节点有平均排队时延d<sub>queue</sub>。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
\begin{align*}
  d_{end-end} &= N(d_{proc}+d_{trans}+d_{prop}) \tag{1-2} \\
  &= \sum_{i=1}^N N(d_{proc_i}+d_{trans_i}+d_{prop_i}+d_{queue_i})
\end{align*}</li>
</ol>
</div>
</div>

<div id="outline-container-orgf87aac7" class="outline-4">
<h4 id="orgf87aac7">P18</h4>
<div class="outline-text-4" id="text-orgf87aac7">
<p>
在一天的3个不同的小时内，在同一个大陆上的源和目的地之间执行Traceroule。<br />
</p>
<ol class="org-ol">
<li>在这3个小时的每个小时中，求出往返时延的均值和方差。<br /></li>
<li>在这3个小时的每个小时中，求出路径上的路由器数量。在这些时段中，该路径发生变化了吗？<br /></li>
<li>试图根据源到目的地Traceroule分组通过的情况，辨明ISP网络的数量。具有类似名字和/或类似的IP地址的路由器应当被认为是同一个ISP的一部分。在你的实验中，在相邻的ISP间的对等接口处出现最大的时延了吗？<br /></li>
<li>对位于不同大陆上的源和目的地重复上述内容。比较大陆内部和大陆之间的这些结果。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
可用节点：<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">位置</th>
<th scope="col" class="org-left">名称</th>
<th scope="col" class="org-left">站点</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">美国新泽西州普林斯顿</td>
<td class="org-left">Princeton University</td>
<td class="org-left"><a href="https://www.net.princeton.edu/traceroute.html">https://www.net.princeton.edu/traceroute.html</a></td>
</tr>

<tr>
<td class="org-left">美国加利福尼亚州旧金山</td>
<td class="org-left">ARPNetworks</td>
<td class="org-left"><a href="http://4or6.com/traceroute.php">http://4or6.com/traceroute.php</a></td>
</tr>

<tr>
<td class="org-left">法国大东部大区斯特拉斯堡</td>
<td class="org-left">SDV</td>
<td class="org-left"><a href="http://traceroute.sdv.fr/index.php?v6=0">http://traceroute.sdv.fr/index.php?v6=0</a></td>
</tr>

<tr>
<td class="org-left">德国萨克森自由州法尔肯施泰因</td>
<td class="org-left">Insode</td>
<td class="org-left"><a href="http://traceroute.insode.de/">http://traceroute.insode.de/</a></td>
</tr>

<tr>
<td class="org-left">德国下萨克森州不伦瑞克</td>
<td class="org-left">Gaertner Datensysteme</td>
<td class="org-left"><a href="https://noc.gaertner.de/cgi-bin/looking-glass.cgi">https://noc.gaertner.de/cgi-bin/looking-glass.cgi</a></td>
</tr>
</tbody>
</table>

<p>
美国加利福尼亚州旧金山ARPNetworks → 美国新泽西州普林斯Princeton University<br />
</p>

<ul class="org-ul">
<li><p>
&#x00ad;<br />
</p>
<pre class="example" id="orgb2904e8">
traceroute to www.net.princeton.edu (128.112.128.55), 30 hops max, 60 byte packets
1  104.236.128.253 (104.236.128.253)  4.121 ms  4.103 ms  4.105 ms
2  138.197.248.222 (138.197.248.222)  1.258 ms  1.367 ms  1.359 ms
3  ae-13.r06.plalca01.us.bb.gin.ntt.net (157.238.179.217)  2.317 ms  2.403 ms  2.148 ms
4  ae-12.r25.snjsca04.us.bb.gin.ntt.net (129.250.4.44)  7.778 ms  7.808 ms  7.809 ms
5  ae-5.r24.snjsca04.us.bb.gin.ntt.net (129.250.3.146)  2.507 ms  2.468 ms  2.498 ms
6  ae-8.r23.chcgil09.us.bb.gin.ntt.net (129.250.5.16)  52.092 ms  51.157 ms  51.059 ms
7  ae-0.r22.chcgil09.us.bb.gin.ntt.net (129.250.2.26)  50.564 ms  50.807 ms  50.929 ms
8  ae-6.r21.nwrknj03.us.bb.gin.ntt.net (129.250.2.167)  69.739 ms  69.536 ms  69.524 ms
9  ae-2.r00.nwrknj03.us.bb.gin.ntt.net (129.250.6.87)  66.337 ms  66.294 ms  66.216 ms
10  ae-0.njedge.nwrknj03.us.bb.gin.ntt.net (168.143.228.205)  66.672 ms  66.261 ms  66.126 ms
11  130.156.34.246 (130.156.34.246)  68.722 ms  68.612 ms  68.643 ms
12  130.156.251.50 (130.156.251.50)  89.881 ms  78.395 ms  78.111 ms
13  fw-border-hpcrc-router.princeton.edu (204.153.48.254)  71.115 ms  71.005 ms  70.634 ms
14  rtr-core-west-router.princeton.edu (128.112.12.13)  70.578 ms  70.509 ms  70.449 ms
15  core-ns-router.princeton.edu (128.112.12.230)  71.103 ms  71.216 ms  71.562 ms
16  www.net.princeton.edu (128.112.128.55)  70.354 ms  70.395 ms  70.342 ms
</pre>

<div class="org-src-container">
<pre class="src src-R">d <span class="org-ess-assignment">&lt;-</span> c(70.354, 70.395, 70.342)
print((paste(<span class="org-string">"&#22343;&#20540;"</span>, mean(d))))
print((paste(<span class="org-string">"&#26041;&#24046;"</span>, var(d))))
print((paste(<span class="org-string">"&#26631;&#20934;&#24046;"</span>, sd(d))))
</pre>
</div>

<pre class="example">
[1] "均值 70.3636666666667"
[1] "方差 0.000772333333333243"
[1] "标准差 0.0277908857961247"
</pre></li>
<li><p>
&#x00ad;<br />
</p>
<pre class="example" id="org7963df2">
traceroute to www.net.princeton.edu (128.112.128.55), 30 hops max, 60 byte packets
1  104.236.128.253 (104.236.128.253)  0.508 ms  0.465 ms  0.440 ms
2  138.197.248.222 (138.197.248.222)  0.513 ms  0.497 ms  0.476 ms
3  ae-13.r06.plalca01.us.bb.gin.ntt.net (157.238.179.217)  2.067 ms  2.165 ms  2.324 ms
4  ae-12.r25.snjsca04.us.bb.gin.ntt.net (129.250.4.44)  1.834 ms  1.812 ms  1.794 ms
5  ae-5.r24.snjsca04.us.bb.gin.ntt.net (129.250.3.146)  3.482 ms  3.507 ms  3.434 ms
6  ae-8.r23.chcgil09.us.bb.gin.ntt.net (129.250.5.16)  50.558 ms  50.923 ms  50.793 ms
7  ae-0.r22.chcgil09.us.bb.gin.ntt.net (129.250.2.26)  51.202 ms  50.658 ms  50.503 ms
8  ae-6.r21.nwrknj03.us.bb.gin.ntt.net (129.250.2.167)  67.456 ms  67.428 ms  67.265 ms
9  ae-2.r00.nwrknj03.us.bb.gin.ntt.net (129.250.6.87)  66.237 ms  66.249 ms  66.137 ms
10  ae-0.njedge.nwrknj03.us.bb.gin.ntt.net (168.143.228.205)  66.594 ms  66.543 ms  66.521 ms
11  130.156.34.246 (130.156.34.246)  68.712 ms  68.749 ms  68.718 ms
12  130.156.251.50 (130.156.251.50)  69.315 ms  69.449 ms  69.552 ms
13  fw-border-hpcrc-router.princeton.edu (204.153.48.254)  70.530 ms  70.461 ms  70.463 ms
14  rtr-core-west-router.princeton.edu (128.112.12.13)  70.571 ms  70.332 ms  70.351 ms
15  core-ns-router.princeton.edu (128.112.12.230)  71.465 ms  71.273 ms  71.292 ms
16  www.net.princeton.edu (128.112.128.55)  70.436 ms  70.547 ms  70.345 ms
</pre>

<div class="org-src-container">
<pre class="src src-R">d <span class="org-ess-assignment">&lt;-</span> c(70.436, 70.547, 70.345)
print((paste(<span class="org-string">"&#22343;&#20540;"</span>, mean(d))))
print((paste(<span class="org-string">"&#26041;&#24046;"</span>, var(d))))
print((paste(<span class="org-string">"&#26631;&#20934;&#24046;"</span>, sd(d))))
</pre>
</div>

<pre class="example">
[1] "均值 70.4426666666667"
[1] "方差 0.0102343333333331"
[1] "标准差 0.10116488191726"
</pre></li>
<li><p>
&#x00ad;<br />
</p>
<pre class="example" id="orga38cc10">
traceroute to www.net.princeton.edu (128.112.128.55), 30 hops max, 60 byte packets
1  104.236.128.253 (104.236.128.253)  0.501 ms  0.456 ms  0.442 ms
2  138.197.248.222 (138.197.248.222)  0.493 ms  0.479 ms  0.459 ms
3  ae-13.r06.plalca01.us.bb.gin.ntt.net (157.238.179.217)  1.512 ms  1.519 ms  1.546 ms
4  ae-12.r25.snjsca04.us.bb.gin.ntt.net (129.250.4.44)  4.263 ms  4.271 ms  4.159 ms
<span id="coderef-5" class="coderef-off">5  ae-5.r24.snjsca04.us.bb.gin.ntt.net (129.250.3.146)  2.807 ms  2.837 ms  2.828 ms (5)</span>
<span id="coderef-6" class="coderef-off">6  ae-8.r23.chcgil09.us.bb.gin.ntt.net (129.250.5.16)  50.735 ms  50.298 ms  50.237 ms (6)</span>
<span id="coderef-7" class="coderef-off">7  ae-0.r22.chcgil09.us.bb.gin.ntt.net (129.250.2.26)  50.988 ms  50.477 ms  50.460 ms (7)</span>
<span id="coderef-8" class="coderef-off">8  ae-6.r21.nwrknj03.us.bb.gin.ntt.net (129.250.2.167)  67.766 ms  67.371 ms  68.140 ms (8)</span>
9  ae-2.r00.nwrknj03.us.bb.gin.ntt.net (129.250.6.87)  66.668 ms  66.636 ms  66.736 ms
10  ae-0.njedge.nwrknj03.us.bb.gin.ntt.net (168.143.228.205)  66.287 ms  66.326 ms  66.209 ms
11  130.156.34.246 (130.156.34.246)  68.728 ms  68.656 ms  68.651 ms
12  130.156.251.50 (130.156.251.50)  69.353 ms  69.663 ms  69.476 ms
13  fw-border-hpcrc-router.princeton.edu (204.153.48.254)  70.573 ms  70.608 ms  70.592 ms
14  rtr-core-west-router.princeton.edu (128.112.12.13)  70.521 ms  70.554 ms  70.641 ms
15  core-ns-router.princeton.edu (128.112.12.230)  71.360 ms  71.570 ms  71.295 ms
16  www.net.princeton.edu (128.112.128.55)  70.649 ms  70.457 ms  70.280 ms
</pre>

<div class="org-src-container">
<pre class="src src-R">d <span class="org-ess-assignment">&lt;-</span> c(70.649, 70.457, 70.280)
print((paste(<span class="org-string">"&#22343;&#20540;"</span>, mean(d))))
print((paste(<span class="org-string">"&#26041;&#24046;"</span>, var(d))))
print((paste(<span class="org-string">"&#26631;&#20934;&#24046;"</span>, sd(d))))
</pre>
</div>

<pre class="example">
[1] "均值 70.462"
[1] "方差 0.034059"
[1] "标准差 0.18455080601287"
</pre></li>
</ul></li>

<li>路由器数量为15，路径没有发生变化。<br /></li>

<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">以主机名和IP的相似程度可以把路由器分为4组</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">1 2</td>
</tr>

<tr>
<td class="org-left">3 4 5 6 7 8 9 10</td>
</tr>

<tr>
<td class="org-left">11 12</td>
</tr>

<tr>
<td class="org-left">13 14 15</td>
</tr>
</tbody>
</table>

<p>
最大时延不仅出现在了在相邻的ISP间的对等接口处，还出现在似乎是同一ISP的路由器<a href="#coderef-5" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-5');" onmouseout="CodeHighlightOff(this, 'coderef-5');">5</a>、<a href="#coderef-6" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-6');" onmouseout="CodeHighlightOff(this, 'coderef-6');">6</a>和<a href="#coderef-7" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-7');" onmouseout="CodeHighlightOff(this, 'coderef-7');">7</a>、<a href="#coderef-8" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-8');" onmouseout="CodeHighlightOff(this, 'coderef-8');">8</a>之间。<br />
</p></li>

<li><p>
法国大东部大区斯特拉斯堡SDV → 美国新泽西州普林斯顿Princeton University<br />
</p>

<pre class="example" id="org6fb8b2c">
traceroute to www.net.princeton.edu (128.112.128.55), 30 hops max, 60 byte packets
 1  vsn0057.vs.mass.systems (10.92.36.120)  0.025 ms  0.010 ms  0.014 ms
 2  ae3-u100.sxb1-cr-nunki.bb.gdinf.net (87.230.112.2)  2.797 ms  2.772 ms  0.299 ms
 3  ae73.edge1.Milan1.Level3.net (212.73.201.217)  15.998 ms  15.973 ms  15.965 ms
 4  Telia-level3-Milan1.Level3.net (4.68.38.238)  9.275 ms  9.547 ms  9.532 ms
 5  prs-bb1-link.ip.twelve99.net (62.115.135.224)  110.670 ms  110.417 ms  110.636 ms
 6  ash-bb2-link.ip.twelve99.net (62.115.112.242)  105.691 ms  106.353 ms  105.810 ms
 7  rest-b1-link.ip.twelve99.net (62.115.125.151)  106.451 ms ash-b1-link.ip.twelve99.net (62.115.143.121)  106.460 ms  106.552 ms
 8  rest-bb1-link.ip.twelve99.net (62.115.125.48)  110.643 ms rest-bb1-link.ip.twelve99.net (62.115.125.38)  109.223 ms rest-bb1-link.ip.twelve99.net (62.115.123.40)  109.115 ms
 9  phm-b2-link.ip.twelve99.net (62.115.121.157)  109.214 ms  110.326 ms  110.327 ms
10  njedge-svc069531-ic354798.ip.twelve99-cust.net (62.115.189.197)  110.832 ms  109.395 ms  110.291 ms
11  130.156.33.65 (130.156.33.65)  110.255 ms  110.180 ms  110.145 ms
12  130.156.252.58 (130.156.252.58)  110.491 ms  110.473 ms  110.443 ms
13  fw-border-87-router.princeton.edu (204.153.48.2)  112.207 ms  111.945 ms  111.794 ms
14  rtr-core-east-router.princeton.edu (128.112.12.9)  112.226 ms  112.531 ms  112.316 ms
15  core-ns-router.princeton.edu (128.112.12.226)  112.260 ms  112.766 ms  112.357 ms
16  www.net.princeton.edu (128.112.128.55)  112.287 ms  111.335 ms  112.296 ms
</pre>

<ul class="org-ul">
<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-R">d <span class="org-ess-assignment">&lt;-</span> c(112.287, 111.335, 112.296)
print((paste(<span class="org-string">"&#22343;&#20540;"</span>, mean(d))))
print((paste(<span class="org-string">"&#26041;&#24046;"</span>, var(d))))
print((paste(<span class="org-string">"&#26631;&#20934;&#24046;"</span>, sd(d))))
</pre>
</div>

<pre class="example">
[1] "均值 111.972666666667"
[1] "方差 0.304984333333341"
[1] "标准差 0.552253866743676"
</pre></li>

<li>路由器的数量为15。<br /></li>

<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">ISP</th>
<th scope="col" class="org-left">路由器</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">1</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">2</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">3 4</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">5 6 7 8 9 10</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">11 12</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">13 14 15</td>
</tr>
</tbody>
</table>

<p>
这次最大时延确实是出现在相邻的ISP间的对等接口处。<br />
</p></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org3d0e285" class="outline-4">
<h4 id="org3d0e285">P19</h4>
<div class="outline-text-4" id="text-org3d0e285">
<ol class="org-ol">
<li>访问站点www.traceroute.org，并从法国两个不同的城市向位于美国的相同的目的主机执行Traceroute。在这两个Traceroute中，有多少条链路是相同的？大西洋沿岸国家的链路相同吗？<br /></li>
<li>重复（1），但此时选择位于法国的一个城市和位于德国的另一个城市。<br /></li>
<li>在美国挑选一个城市。然后向位于中国的两个不同城市的主机执行Traceroute。在这两次Traceroute中有多少链路是相同的？在到达中国前这两个Traceroute分开了吗？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
使用<a href="https://tools.ipip.net/traceroute.php">ipip</a>提供的traceroute。<br />
</p>

<p>
法国巴黎gcorelabs → 美国新泽西州普林斯顿Princeton University<br />
</p>

<pre class="example" id="orgde80688">
跳数	IP	主机名	地区（仅供参考）	AS号（仅供参考）	时间（毫秒）
1	5.188.70.1	gw.gcore.lu	法国法兰西岛大区巴黎 gcore.lu	AS199524	0.3 / 0.9 / 0.2
2	10.255.30.182	10.255.30.182	局域网		0.2 / 0.3 / 0.2
3	10.255.30.178	10.255.30.178	局域网		0.3 / 0.4 / 0.4
4	10.255.30.162	10.255.30.162	局域网		0.4 / 0.7 / 0.3
5	62.115.155.238	prs-b7-link.ip.twelve99.net	法国法兰西岛大区巴黎 telia.com	AS1299	1.1 / 0.9 / 1.5
6	62.115.137.90	prs-bb2-link.ip.twelve99.net	法国法兰西岛大区巴黎 telia.com	AS1299	81.7 / 81.5 / 81.8
7	62.115.122.159	rest-bb1-link.ip.twelve99.net	美国弗吉尼亚州雷斯顿 telia.com	AS1299	82 / 82 / 81.5
8	62.115.121.157	phm-b2-link.ip.twelve99.net	美国宾夕法尼亚州费城 telia.com	AS1299	82 / 83.2 / 82
9	62.115.189.197	njedge-svc069531-ic354798.ip.twelve99-cust.net	美国宾夕法尼亚州费城 telia.com	AS1299	82.2 / 82.4 / 81.9
10	130.156.33.65	130.156.33.65	美国新泽西州 njedge.net	AS21976	82 / 81.9 / 82
11	130.156.252.58	130.156.252.58	美国新泽西州 njedge.net	AS21976	83 / 82.9 / 83.2
12	204.153.48.2	fw-border-87-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	83.2 / 83.1 / 83.2
13	128.112.12.9	rtr-core-east-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	83.9 / 84 / 83.5
14	128.112.12.226	core-ns-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	84.6 / 83.9 / 84.1
15	128.112.128.55	www.net.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	83.6 / 83.7 / 84.3
</pre>

<p>
法国马赛ZENLAYER-MRS1 → 美国新泽西州普林斯顿Princeton University<br />
</p>

<pre class="example" id="orgb1e39b2">
跳数	IP	主机名	地区（仅供参考）	AS号（仅供参考）	时间（毫秒）
1	193.118.62.33	193.118.62.33	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 zenlayer.com	AS21859	7.4 / 2.3 / 2.4
2	193.118.62.66	193.118.62.66	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 zenlayer.com	AS21859	63.3 / 5.2 / 1.6
3	104.254.116.102	104.254.116.102	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 zenlayer.com		5.4 / 0.3 / 0.4
4	104.254.116.94	104.254.116.94	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 zenlayer.com		0.4 / 0.3 / 0.3
5	62.115.191.16	mei-b3-link.ip.twelve99.net	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 telia.com	AS1299	8 / 0.7 / 0.7
6	62.115.125.194	mei-b5-link.ip.twelve99.net	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 telia.com	AS1299	0.9 / 1.1 / 0.9
7	62.115.125.197	mei-b2-link.ip.twelve99.net	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 telia.com	AS1299	0.9 / 0.9 / 0.9
8	62.115.116.27	mei-b1-link.ip.twelve99.net	法国普罗旺斯－阿尔卑斯－蓝色海岸大区马赛 telia.com	AS1299	0.9 / 0.9 / 1
9	62.115.124.214	prs-bb2-link.ip.twelve99.net	法国法兰西岛大区巴黎 telia.com	AS1299	94 / 94.2 / 94.2
10	62.115.122.159	rest-bb1-link.ip.twelve99.net	美国弗吉尼亚州雷斯顿 telia.com	AS1299	93.8 / 93.7 / 93.8
11	62.115.121.157	phm-b2-link.ip.twelve99.net	美国宾夕法尼亚州费城 telia.com	AS1299	93.9 / 94.1 / 93.9
12	62.115.189.197	njedge-svc069531-ic354798.ip.twelve99-cust.net	美国宾夕法尼亚州费城 telia.com	AS1299	94.3 / 94.2 / 94.2
13	130.156.33.65	130.156.33.65	美国新泽西州 njedge.net	AS21976	94.1 / 94.1 / 94.1
14	130.156.252.58	130.156.252.58	美国新泽西州 njedge.net	AS21976	96.2 / 96.7 / 95.3
15	204.153.48.2	fw-border-87-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	95.3 / 95.6 / 95.4
16	128.112.12.9	rtr-core-east-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	95.8 / 96.1 / 96.1
17	128.112.12.226	core-ns-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	98.5 / 96.3 / 96.3
18	128.112.128.55	www.net.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	96.2 / 96.2 / 96.4
</pre>

<p>
在这两个Traceroute中62.115.122.159~128.112.128.55这8条链路是相同的。<br />
</p>

<p>
英国伦敦linode → 美国新泽西州普林斯顿Princeton University<br />
</p>

<pre class="example" id="org47acbc8">
跳数	IP	主机名	地区（仅供参考）	AS号（仅供参考）	时间（毫秒）
1	212.111.33.230	router2-lon.linode.com	英国伦敦 telecity.com	AS15830	0.7 / 0.6 / 3
2	109.74.207.28	if-11-1-0-1-0.gw2.lon1.gb.linode.com	英国伦敦 linode.com	AS63949	1.3 / 0.7 / 0.5
3	62.115.41.64	ldn-b2-link.ip.twelve99.net	英国伦敦 telia.com	AS1299	1.5 / 1.5 / 1.8
4	62.115.122.188	ldn-bb1-link.ip.twelve99.net	英国伦敦 telia.com	AS1299	1.5 / 1.8 / 1.5
5	62.115.113.20	nyk-bb2-link.ip.twelve99.net	美国纽约州纽约 telia.com	AS1299	73.5 / 73.3 / 73.4
6	62.115.137.99	nyk-b2-link.ip.twelve99.net	美国纽约州纽约 telia.com	AS1299	76.6 / 75.8 / 75.8
7	62.115.54.158	njedge-ic312218-nyk-b2.ip.twelve99-cust.net	美国纽约州纽约 telia.com	AS1299	75.9 / 76.1 / 76.1
8	130.156.34.246	130.156.34.246	美国新泽西州 njedge.net	AS21976	73.5 / 73.3 / 73.4
9	130.156.251.50	130.156.251.50	美国新泽西州 njedge.net	AS21976	76.3 / 75.3 / 74.5
10	204.153.48.254	fw-border-hpcrc-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	76.9 / 76.8 / 78
11	128.112.12.13	rtr-core-west-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	77.9 / 77.5 / 77.7
12	128.112.12.230	core-ns-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	75.5 / 75.4 / 75.4
13	128.112.128.55	www.net.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	75.2 / 75 / 74.9
</pre>

<p>
西班牙马德里gcorelabs → 美国新泽西州普林斯顿Princeton University<br />
</p>

<pre class="example" id="org3a28431">
跳数	IP	主机名	地区（仅供参考）	AS号（仅供参考）	时间（毫秒）
1	5.189.222.2	vrrp.example.com	西班牙马德里自治区马德里 pinspb.ru	AS199524	0.5 / 0.3 / 0.4
2	10.255.32.226	10.255.32.226	局域网		0.4 / 0.4 / 0.3
3	10.255.37.169	10.255.37.169	局域网		4.6 / 1.7 / 1.7
4	80.239.194.252	mad-b2-link.ip.twelve99.net	西班牙马德里自治区马德里 telia.com	AS1299	1.8 / 17.6 / 1.9
5	80.91.248.130	prs-bb2-link.ip.twelve99.net	法国法兰西岛大区巴黎 telia.com	AS1299	103.4 / 104.8 / 103.3
6	62.115.122.159	rest-bb1-link.ip.twelve99.net	美国弗吉尼亚州雷斯顿 telia.com	AS1299	103.7 / 103 / 103
7	62.115.121.157	phm-b2-link.ip.twelve99.net	美国宾夕法尼亚州费城 telia.com	AS1299	103 / 103.4 / 103.3
8	62.115.189.197	njedge-svc069531-ic354798.ip.twelve99-cust.net	美国宾夕法尼亚州费城 telia.com	AS1299	103.3 / 103.2 / 103.2
9	130.156.33.65	130.156.33.65	美国新泽西州 njedge.net	AS21976	103.3 / 103.5 / 103.7
10	130.156.252.58	130.156.252.58	美国新泽西州 njedge.net	AS21976	104.9 / 104.5 / 104.7
11	204.153.48.2	fw-border-87-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	104.9 / 105.1 / 104.9
12	128.112.12.9	rtr-core-east-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	105.3 / 105.5 / 105.5
13	128.112.12.226	core-ns-router.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	105.7 / 105.7 / 105.6
14	128.112.128.55	www.net.princeton.edu	美国新泽西州普林斯顿 princeton.edu	AS88	108.7 / 105 / 104.9
</pre>

<p>
从法国巴黎、法国马赛、英国伦敦、西班牙马德里到普林斯顿的四个Traceroute可以看出，链路中大部分ISP是相同的，但是路由器IP可能不同。<br />
</p></li>

<li>见1<br /></li>

<li><p>
这里从法国向位于美国两个不同城市的主机执行Traceroute。<br />
</p>

<p>
法国SDV → www.net.princeton.edu<br />
</p>

<pre class="example" id="orgca600e4">
1	wblindix.sdv.fr      	212.95.66.126      	0.15 ms
2	border-gateway2.sdv.fr      	212.95.69.227      	0.842 ms
3	6k-2-sfr-str-e2-3-sdv-plurimedia.customers-sfr-str.ielo.net      	212.85.149.172      	0.792 ms
4	be3.frpar-th2-n55h2.as29075.net      	185.96.186.74      	6.398 ms
5	Hu0-0-1-2.frpar-th2-n55h3.as29075.net      	185.18.173.73      	6.495 ms
6	prs-b5-link.ip.twelve99.net      	62.115.54.161      	7.255 ms
7	prs-bb2-link.ip.twelve99.net      	213.155.130.22      	87.971 ms
8	rest-bb1-link.ip.twelve99.net      	62.115.122.159      	87.746 ms
9	phm-b2-link.ip.twelve99.net      	62.115.121.157      	88.061 ms
10	njedge-svc069531-ic354798.ip.twelve99-cust.net      	62.115.189.197      	88.402 ms
11	130.156.33.65      	130.156.33.65      	88.002 ms
12	130.156.252.58      	130.156.252.58      	99.437 ms
13	fw-border-87-router.princeton.edu      	204.153.48.2      	89.356 ms
14	rtr-core-east-router.princeton.edu      	128.112.12.9      	89.649 ms
15	core-ns-router.princeton.edu      	128.112.12.226      	90.279 ms
16	www.net.princeton.edu      	128.112.128.55      	90.265 ms
</pre>

<p>
法国SDV → www.net.cmu.edu<br />
</p>

<pre class="example" id="orgf0aaaa3">
1	wblindix.sdv.fr      	212.95.66.126      	0.162 ms
2	border-gateway2.sdv.fr      	212.95.69.227      	0.812 ms
3	th2-10g-0003.sdv.fr      	212.95.64.54      	6.804 ms
4	10gigabitethernet-2-2.par2.he.net      	195.42.144.104      	6.317 ms
5	100ge11-2.core1.nyc4.he.net      	72.52.92.113      	78.134 ms
6	ve951.core2.nyc4.he.net      	184.104.195.170      	77.423 ms
7	port-channel4.core3.chi1.he.net      	184.104.196.218      	96.535 ms
9	216.56.50.86      	216.56.50.86      	105.588 ms
10	100.121.0.41      	100.121.0.41      	106.773 ms
11	CORE0-POD-I-CYH.GW.CMU.NET      	128.2.0.249      	107.026 ms
12	POD-D-DCNS-CORE0.GW.CMU.NET      	128.2.0.210      	107.181 ms
13	SII-FIRE.GW.CMU.NET      	128.2.5.92      	107.422 ms
14	WEB-01.NET.CMU.EDU      	128.2.106.134      	108.413 ms
</pre>

<p>
有2条链路是相同的，在到达美国之前就分开了。<br />
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org3368285" class="outline-4">
<h4 id="org3368285">P20</h4>
<div class="outline-text-4" id="text-org3368285">
<p>
考虑对应于图1-20b吞吐量的例子。现在假定有M对客户-服务器而不是10对。用R<sub>s</sub>、R<sub>c</sub>和R分别表示服务器链路、客户链路和网络链路的速率。假设所有的其他链路都有充足容量，并且除了由这M对客户-服务器产生的流量外，网络中没有其他流量。推导出由R<sub>s</sub>、R<sub>c</sub>、R和M表示的通用吞吐量表达式。<br />
</p>


<div id="org86cb1d1" class="figure">
<p><img src="./img/fig1-20.png" alt="fig1-20.png" style="width:100%; max-width:500px;" /><br />
</p>
</div>

<p>
\[ \text{吞吐量} = min\{R_s, R_c, R/M\} \]<br />
</p>
</div>
</div>

<div id="outline-container-org5c301c1" class="outline-4">
<h4 id="org5c301c1">P21</h4>
<div class="outline-text-4" id="text-org5c301c1">
<p>
考虑图1-19b。现在假定在服务器和客户之间有M条路径。任两条路径都不共享任何链路。路径k（k=1，···，M）由传输速率为R<sub>1</sub><sup>k</sup>，R<sub>2</sub><sup>k</sup>，···，R<sub>N</sub><sup>k</sup>的N条链路组成。如果服务器仅能够使用一条路径向客户发送数据，则该服务器能够取得的最大吞吐量是多少？如果该服务器能够使用所有M条路径发送数据，则该服务器能够取得的最大吞吐址是多少？<br />
</p>


<div id="org72fd06c" class="figure">
<p><img src="./img/fig1-19.png" alt="fig1-19.png" style="width:100%; max-width:500px;" /><br />
</p>
</div>

<ol class="org-ol">
<li><p>
路径k的吞吐量<br />
</p>

<p>
\[ T_k = \min \{R_1^k,R_2^k,\dotsc ,R_N^k \}. \]<br />
</p>

<p>
如果仅能使用一条路径，最大吞吐量为：<br />
</p>

<p>
\[ \max \{T_1, T_2, \dotsc, T_M\}. \]<br />
</p></li>

<li><p>
如果使用所有M条路径，最大吞吐量为<br />
</p>

<p>
\[ \sum_{k=1}^M T_k. \]<br />
</p></li>
</ol>
</div>
</div>

<div id="outline-container-orgbaacee8" class="outline-4">
<h4 id="orgbaacee8">P22</h4>
<div class="outline-text-4" id="text-orgbaacee8">
<p>
考虑图1-19b。假定服务器与客户之间的每条链路的丢包概率为p，且这些链路的丢包率是独立的。一个（由服务器发送的）分组成功地被接收方收到的概率是多少？如果在从服务器到客户的路径上分组丢失了，则服务器将重传该分组。平均来说，为了使客户成功地接收该分组，服务器将要重传该分组多少次？<br />
</p>

<ol class="org-ol">
<li>成功收到的概率 \[ p_s = (1-p)^N. \]<br /></li>
<li>根据（1），分组从服务器成功传送给客户的概率是p<sub>s</sub>，那么得到一次成功的试验次数服从几何分布，期望是1/p<sub>s</sub>，因此平均的重传次数是1+1/p<sub>s</sub>。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgca1359a" class="outline-4">
<h4 id="orgca1359a">P23</h4>
<div class="outline-text-4" id="text-orgca1359a">
<p>
考虑图1-19a。假定我们知道沿着从服务器到客户的路径的瓶颈链路是速率为R<sub>s</sub>bps的第一段链路。假定我们从服务器向客户发送紧密相连的一对分组，且沿这条路径没有其他流量。假定每个分组的长度为L比特，两条链路具有相同的传播时延d<sub>prop</sub>。<br />
</p>
<ol class="org-ol">
<li>在目的地，分组的到达间隔时间有多大？也就是说，从第一个分组的最后一个比特到达到第二个分组最后一个比特到达所经过的时间有多长？<br /></li>
<li>现在假定第二段链路是瓶颈链路（即R<sub>c</sub>&lt;R<sub>s</sub>）。第二个分组在第二段链路输入队列中排队是可能的吗？请解释原因。现在假定服务器在发送第一个分组T秒之后再发送第二个分组。为确保在第二段链路之前没有排队，T必须要有多长？试解释原因。<br /></li>
</ol>


<ol class="org-ol">
<li>第一个分组最后一个比特在时刻L/R<sub>s</sub>+d<sub>prop</sub>到达路由器，又经过L/R<sub>c</sub>+d<sub>prop</sub>时间到达客户。第二个分组最后一个比特在时刻2L/R<sub>s</sub>+d<sub>prop</sub>到达路由器，比第一个分组最后一个比特到达路由器的时间晚了L/R<sub>s</sub>，这个时间大于路由器传输第一个分组所需的时间L/R<sub>c</sub>（由于R<sub>s</sub>&lt;R<sub>c</sub>），因此第二个分组最后一个比特到达路由器时不用排队可以直接开始传输。再经过L/R<sub>c</sub>+d<sub>prop</sub>时间第二个分组最后一个比特到达客户。分组到达的间隔为L/R<sub>s</sub>。<br /></li>
<li>根据（1），第二个分组最后一个比特比第一个分组最后一个比特到达路由器晚了L/R<sub>s</sub>时间，当R<sub>s</sub>&gt;R<sub>c</sub>时，这个时间是小于L/R<sub>c</sub>的，也就是说第二个分组最后一个比特到达路由器时，第一个分组还没传输完，这时第一个分组就要排队了。为确保没有排队，T⩾L/R<sub>c</sub>-L/R<sub>S</sub>。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgb36f549" class="outline-4">
<h4 id="orgb36f549">P24</h4>
<div class="outline-text-4" id="text-orgb36f549">
<p>
假设你希望从波士顿向洛杉矶紧急传送40×10<sup>12</sup>字节数据。你有一条1OOMbps专用链路可用于传输数据。你是愿意通过这条链路传输数据，还是愿意使用FedEx夜间快递来交付？解释你的理由。<br />
</p>

<p>
用链路传输需要的时间是40e12B÷100Mbps≈889h，因此夜间快递更好。<br />
</p>
</div>
</div>

<div id="outline-container-orgf01cbd9" class="outline-4">
<h4 id="orgf01cbd9">P25</h4>
<div class="outline-text-4" id="text-orgf01cbd9">
<p>
假定两台主机A和B相隔20 000km，由一条直接的R=2Mbps的链路相连。假定跨越该链路的传播速率是2.5×10<sup>8</sup>m/s。<br />
</p>
<ol class="org-ol">
<li>计算带宽-时延积R⋅t<sub>prop</sub>。<br /></li>
<li>考虑从主机A到主机B发送一个800 000比特的文件。假定该文件作为一个大的报文连续发送。在任何给定的时间，在链路上具有的比特数量最大值是多少？<br /></li>
<li>给出带宽时延积的一种解释。<br /></li>
<li>在该链路上一个比特的宽度（以米计）是多少？它比一个足球场更长吗？<br /></li>
<li>用传播速率s、带宽R和链路m的长度表示，推导出一个比特宽度的一般表示式。<br /></li>
</ol>


<ol class="org-ol">
<li>\[ R \cdot t_{prop} = 2Mbps \cdot 20000km \div 2.5e8m/s = 160000 b \]<br /></li>
<li>链路传输一个比特需要的时间是1/R=0.0005ms，一比特从A传播到B需要的时间是m/s=20000km÷2.5e8m/s=80ms，因此比特数量的最大值是80/0.0005=160 000。<br /></li>
<li>链路上具有的最大比特数。<br /></li>
<li>一个比特的宽度是20 000km/160 000=125m，比足球场（长度100~110米）更长。<br /></li>
<li>\[ m/\frac{Rm}{s} = \frac sR. \]<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orga6c2ed7" class="outline-4">
<h4 id="orga6c2ed7">P26</h4>
<div class="outline-text-4" id="text-orga6c2ed7">
<p>
对于习题P25，假定我们能够修改R。对什么样的R值，一个比特的宽度能与该链路的长度一样长？<br />
</p>

\begin{align*}
  &         &\frac sR &= m \\
  &\implies &R&=\frac sm = \frac{2.5e8}{2e7} = 12.5bps.
\end{align*}
</div>
</div>

<div id="outline-container-org5d10402" class="outline-4">
<h4 id="org5d10402">P27</h4>
<div class="outline-text-4" id="text-org5d10402">
<p>
考虑习题P25，但此时链路的速率是R=1Gbps。<br />
</p>
<ol class="org-ol">
<li>计算带宽-时延积R·d_prop。<br /></li>
<li>考虑从主机A到主机B发送一个800 000比特的文件。假定该文件作为一个大的报文连续发送。在任何给定的时间，在链路上具有的比特数批最大值是多少？<br /></li>
<li>在该链路上一个比特的宽度（以米计）是多少？<br /></li>
</ol>


<ol class="org-ol">
<li>\[ R \cdot t_{prop} = 1Gbps \cdot 20000km \div 2.5e8m/s = 80Mb. \]<br /></li>
<li>80Mb.<br /></li>
<li>s/R = 2.5e8m/s÷1Gbps = 0.25m.<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgd3910b2" class="outline-4">
<h4 id="orgd3910b2">P28</h4>
<div class="outline-text-4" id="text-orgd3910b2">
<p>
再次考虑习题P25。<br />
</p>
<ol class="org-ol">
<li>假定连续发送，发送该文件需要多长时间？<br /></li>
<li>假定现在该文件被划分为20个分组，每个分组包含40000比特。假定每个分组被接收方确认，确认分组的传输时间可忽略不计。最后，假定前一个分组被确认后，发送方才能发送分组。发送该文件需要多长时间？<br /></li>
<li>比较（1）和（2）的结果。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
\begin{align*}
  d_{total} &= d_{trans} + d_{prop} \\
  &= \frac LR + \frac ms \\
  &= 800,000b÷2Mbps + 20,000km÷2.5×10^8m/s \\
  &= 0.48s
\end{align*}</li>
<li><p>
&#x00ad;<br />
</p>
\begin{align*}
  d_{total} &= 20×(d_{trans} + 2d_{prop}) \\
  &= 20×(0.02s + 0.08s) \\
  &= 2s
\end{align*}</li>
<li>将文件划分为小分组需要花费更多时间，增加的部分主要是由确认分组的传播延时造成的。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org5b7da1f" class="outline-4">
<h4 id="org5b7da1f">P29</h4>
<div class="outline-text-4" id="text-org5b7da1f">
<p>
假定在同步卫星和它的地球基站之间有一条1OMbps的微波链路。每分钟该卫星拍摄一幅数字照片，并将它发送到基站。假定传播速率是2.4×10<sup>8</sup>m/s。<br />
</p>
<ol class="org-ol">
<li>该链路的传播时延是多少？<br /></li>
<li>带宽时延积R•d<sub>prop</sub>是多少？<br /></li>
<li>若x表示该照片的大小。对于这条微波链路，能够连续传输的x最小值是多少？<br /></li>
</ol>


<ol class="org-ol">
<li>\[ d_{prop} = m÷s = 35786km÷2.4e8m/s = 150ms. \]<br /></li>
<li>\[ R\cdot d_{prop} = 10Mbps×150ms = 1.5Mb. \]<br /></li>
<li>\[ 1min×10Mbps = 600Mb. \]<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org479020b" class="outline-4">
<h4 id="org479020b">P30</h4>
<div class="outline-text-4" id="text-org479020b">
<p>
考虑1.5节中我们在分层讨论中对航空旅行的类比，随着协议数据单元向协议栈底层流动，首部在增加。随着旅客和行李移动到航线协议栈底部，有与上述首部信息等价的概念吗？<br />
</p>

<blockquote>
<p>
Let’s suppose the passenger and his/her bags correspond to the data unit arriving to the top of the protocol stack. When the passenger checks in, his/her bags are checked, and a tag is attached to the bags and ticket. This is additional information added in the Baggage layer if Figure 1.20 that allows the Baggage layer to implement the service or separating the passengers and baggage on the sending side, and then reuniting them (hopefully!) on the destination side. When a passenger then passes through security and additional stamp is often added to his/her ticket, indicating that the passenger has passed through a security check. This information is used to ensure (e.g., by later checks for the security information) secure transfer of people.<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org02c947d" class="outline-4">
<h4 id="org02c947d">P31</h4>
<div class="outline-text-4" id="text-org02c947d">
<p>
在包括因特网的现代分组交换网中，源主机将长应用层报文（如一个图像或音乐文件）分段为较小的分组并向网络发送。接收方则将这些分组重新装配为初始报文。我们称这个过程为报文分段。图1-27显示了一个报文在报文不分段或报文分段情况下的端到端传输。考虑一个长度为8×10<sup>6</sup>比特的报文，它在图1-27中从源发送到目的地。假定在该图中的每段链路是2Mbps。忽略传播、排队和处理时延。<br />
</p>


<div id="org40cac0a" class="figure">
<p><img src="./img/fig1-27.png" alt="fig1-27.png" style="width:100%; max-width:400px;" /><br />
</p>
</div>

<ol class="org-ol">
<li>考虑从源到目的地发送该报文且没有报文分段。从源主机到第一台分组交换机移动报文需要多长时间？记住，每台交换机均使用存储转发分组交换，从源主机移动该报文到目的主机需要多长时间？<br /></li>
<li>现在假定该报文被分段为800个分组，每个分组10000比特长。从源主机移动第一个分组到第一台交换机需要多长时间？从第一台交换机发送第一个分组到第二台交换机，从源主机发送第二个分组到第一台交换机各需要多长时间？什么时候第二个分组能被第一台交换机全部收到？<br /></li>
<li>当进行报文分段时，从源主机向目的主机移动该文件需要多长时间？将该结果与（1）的答案进行比较并解释之。<br /></li>
<li>除了减小时延外，使用报文分段还有什么原因？<br /></li>
<li>讨论报文分段的缺点。<br /></li>
</ol>


<ol class="org-ol">
<li>从源主机到第一台分组交换机移动报文需要的时间为 \(L/R=8×10^6b÷2Mbps=4s\)，从源主机移动该报文到目的主机需要的时间为 \(3×4s=12s.\)<br /></li>
<li>从源主机移动第一个分组到第一台交换机需要的时间 \(L/R=10000b÷2Mbps=5ms\)；从第一台交换机发送第一个分组到第二台交换机需要5ms；从源主机发送第二个分组到第一台交换机各需要5ms。在时刻10ms第二个分组能被第一台交换机全部收到。<br /></li>
<li>在时刻15ms第一个分组能被目的地收到，此后每过5ms目的地收到一个分组，在时刻(15+(n-1)×5)ms，第n个分组被目的地收到；因此，从源主机向目的主机移动该文件需要15+799×5 ms=4.01s.<br /></li>
<li>&#x00ad;<br />
<ul class="org-ul">
<li>如果不实用报文分段，分组传输中出现了错误会导致整个报文需要重传；<br /></li>
<li>大的分组会导致链路上的小的分组也出现很大的时延。<br /></li>
</ul></li>
<li>&#x00ad;<br />
<ul class="org-ul">
<li>目的主机必需排序、重组收到的分组。<br /></li>
<li>报文分段后每个分组都要添加头部，如果分组很多，相应地所有报文头部加起来的也会很大。<br /></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org56b513c" class="outline-4">
<h4 id="org56b513c">P32</h4>
<div class="outline-text-4" id="text-org56b513c">
<p>
用本书的Web网站上的报文分段小Java小程序进行实验。该Java程序中的时延与前一个习题中的时延相当吗？链路传播时延是怎样影响分组交换（有报文分段）和报文交换的端到端总时延的？<br />
</p>

<p>
<a href="https://media.pearsoncmg.com/aw/ecs_kurose_compnetwork_7/cw/content/interactiveanimations/message-segmentation/index.html">Message Segmentation</a><br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Simulate</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">Message size (kb)</td>
<td class="org-right">16</td>
<td class="org-right">16</td>
<td class="org-right">16</td>
<td class="org-right">16</td>
</tr>

<tr>
<td class="org-left">Package size (kb</td>
<td class="org-right">16</td>
<td class="org-right">4</td>
<td class="org-right">16</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">Trans rate (kbps)</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">Prop delay (s)</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>
</tbody>
</table>

<ol class="org-ol">
<li>d<sub>total</sub> = 3×(16/4) = 12s.<br /></li>
<li>d<sub>total</sub> = 3×(4/4)+(4-1)×(4/4) = 6s.<br /></li>
<li>d<sub>total</sub> = 3×(16/4+1) = 15s.<br /></li>
<li>d<sub>total</sub> = 3×(4/4+1)+(4-1)×(4/4) = 9s.<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org6d6608c" class="outline-4">
<h4 id="org6d6608c">P33</h4>
<div class="outline-text-4" id="text-org6d6608c">
<p>
考虑从主机A到主机B发送一个F比特的大文件。A和B之间有三段链路（和两台交换机），并且该链路不拥塞（即没有排队时延）。主机A将该文件分为每个为S比特的报文段，并为每个报文段增加一个80比特的首部，形成L=80+S比特的分组。每条链路的传输速率为Rbps。求出从A到B移动该文件时延最小的值S。忽略传播时延。<br />
</p>

\begin{align*}
  &         &D              &= 3 L/R + (F/S-1) L/R \\
  &         &\frac{d}{dS} D &= 0 \\
  &\implies &S              &= \sqrt{40F}
\end{align*}
</div>
</div>

<div id="outline-container-org4309b32" class="outline-4">
<h4 id="org4309b32">P34</h4>
<div class="outline-text-4" id="text-org4309b32">
<p>
Skype提供了一种服务，使你能用PC向普通电话打电话。这意味若语音呼叫必须通过因特网和电话网。讨论这是如何做到的。<br />
</p>

<blockquote>
<p>
电路交换电话网络和互联网通过 "网关 "连接在一起。当Skype用户（连接到互联网）呼叫普通电话时，网关和电话用户之间通过电路交换网络建立了一个电路。Skype用户的语音通过互联网以数据包的形式发送到网关。在网关，语音信号被重新构建，然后通过电路发送。在另一个方向，语音信号通过电路交换网络被发送到网关。网关将语音信号打包，并将语音数据包发送给Skype用户。<br />
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgff9b9ff" class="outline-3">
<h3 id="orgff9b9ff"><span class="section-number-3">1.3.</span> Wireshark实验</h3>
<div class="outline-text-3" id="text-1-3">
<p>
<a href="code/ch1-intro/wireshark-intro-v7.0.pdf">Wireshark Lab: Getting Started v7.0</a><br />
</p>

<ol class="org-ol">
<li><p>
List 3 different protocols that appear in the protocol column in the unfiltered packet-listing window in step 7 above.<br />
</p>

<p>
TCP, HTTP, TLSv1.2.<br />
</p></li>

<li><p>
How long did it take from when the HTTP GET message was sent until the HTTP OK reply was received?<br />
</p>

<p>
3.738087 - 3.465026 = 0.273061s.<br />
</p></li>

<li>&#x00ad;<br />

<ul class="org-ul">
<li><p>
What is the Internet address of the gaia.cs.umass.edu (also known as wwwnet.cs.umass.edu)?<br />
</p>

<p>
128.119.245.12.<br />
</p></li>

<li><p>
What is the Internet address of your computer?<br />
</p>

<p>
192.168.8.100.<br />
</p></li>
</ul></li>

<li><p>
Print the two HTTP messages (GET and OK) referred to in question 2 above.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
      4 3.465026       192.168.8.100         128.119.245.12        HTTP     686    GET /wireshark-labs/INTRO-wireshark-file1.html HTTP/1.1
      6 3.738087       128.119.245.12        192.168.8.100         HTTP     305    HTTP/1.1 304 Not Modified
</pre>
</div></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgea6f865" class="outline-2">
<h2 id="orgea6f865"><span class="section-number-2">2.</span> 应用层</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org585f600" class="outline-3">
<h3 id="org585f600"><span class="section-number-3">2.1.</span> 笔记</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org7193a1a" class="outline-4">
<h4 id="org7193a1a">HTTP请求 p.70</h4>
<div class="outline-text-4" id="text-org7193a1a">
<div class="org-src-container">
<pre class="src src-sh">% telnet gaia.cs.umass.edu 80
Trying 198.18.1.14...
Connected to gaia.cs.umass.edu.
Escape character is <span class="org-string">'^]'</span>.
HEAD /kurose_ross/interactive/index.php HTTP/1.1
Host: gaia.cs.umass.edu

HTTP/1.1 200 OK
Date: Thu, 15 Jul 2021 02:51:17 GMT
Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.14 mod_perl/2.0.11 Perl/v5.16.3
X-Powered-By: PHP/7.4.14
Set-Cookie: <span class="org-variable-name">DevMode</span>=0
Content-Type: text/html; <span class="org-variable-name">charset</span>=UTF-8

Connection closed by foreign host.
</pre>
</div>
</div>
</div>

<div id="outline-container-org3a761ef" class="outline-4">
<h4 id="org3a761ef">使用SMTP通过Gmail发送邮件 p.78</h4>
<div class="outline-text-4" id="text-org3a761ef">
<p>
<a href="https://stackoverflow.com/a/11049483/10422197">Stack Overflow</a><br />
</p>

<ol class="org-ol">
<li>设置账号&gt;安全性&gt;安全性较低的应用的访问权限为开启。<br /></li>
<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-sh">% echo -ne <span class="org-string">'\00user@gmail.com\00password'</span> | base64
AHVzZXJAZ21haWwuY29tAHBhc3N3b3Jk
% openssl s_client -connect smtp.gmail.com:465 -crlf -ign_eof
220 smtp.gmail.com ESMTP r15sm14835219pje.12 - gsmtp
HELO localhost
250-smtp.gmail.com at your service, [10.97.101.35]
250-SIZE 35882577
250-8BITMIME
250-AUTH LOGIN PLAIN XOAUTH2 PLAIN-CLIENTTOKEN OAUTHBEARER XOAUTH
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-CHUNKING
250 SMTPUTF8
AUTH PLAIN AHVzZXJAZ21haWwuY29tAHBhc3N3b3Jk
235 2.7.0 Accepted
MAIL FROM: <a href="mailto:user%40gmail.com">&lt;user@gmail.com&gt;</a>
250 2.1.0 OK r15sm14835219pje.12 - gsmtp
RCPT TO: <a href="mailto:dest%40outlook.com">&lt;dest@outlook.com&gt;</a>
250 2.1.5 OK r15sm14835219pje.12 - gsmtp
DATA
354  Go ahead r15sm14835219pje.12 - gsmtp
Subject: It work!

Hello!
.
250 2.0.0 OK  1626671492 r15sm14835219pje.12 - gsmtp
QUIT
221 2.0.0 closing connection r15sm14835219pje.12 - gsmtp
<span class="org-builtin">read</span>:<span class="org-variable-name">errno</span>=0
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>命令参数解释</label><pre class="src src-sh"><span class="org-builtin">echo</span>
-n  do not append a newline
-e  enable interpretation of the following backslash escapes
\00 \0nnn 0 ASCII NULL

openssl
The s_client command implements a generic SSL/TLS client which connects to a remote host using SSL/TLS.
-connect host[:port] The host and port to connect to.
-crlf   Translate a line feed from the terminal into CR+LF, as required by some servers.
-ign_eof Inhibit shutting down the connection when end of file is reached<span class="org-keyword"> in</span> the input.
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org92591f3" class="outline-4">
<h4 id="org92591f3">使用POP收取Gmail邮件 p.81</h4>
<div class="outline-text-4" id="text-org92591f3">
<div class="org-src-container">
<pre class="src src-sh">shichaoxia@XSCMBP bin % openssl s_client -connect pop.gmail.com:995 -crlf -ign_eof
+OK Gpop ready for requests from 101.93.111.25 f6mb117633262jaj
USER user@gmail.com
+OK send PASS
PASS AdMkfTHj9R3s8V
+OK Welcome.
LIST
+OK 2 messages (1490 bytes)
1 757
2 733
.
RETR 1
+OK message follows
MIME-Version: 1.0
Date: Mon, 19 Jul 2021 14:28:24 +0800
Message-ID: <a href="mailto:CAMoCzMj7D93jYN3robFDOq+n57tEJONE=ZKvvNGRff1KZKcTkg%40mail.gmail.com">&lt;CAMoCzMj7D93jYN3robFDOq+</a><span class="org-variable-name"><a href="mailto:CAMoCzMj7D93jYN3robFDOq+n57tEJONE=ZKvvNGRff1KZKcTkg%40mail.gmail.com">n57tEJONE</a></span><a href="mailto:CAMoCzMj7D93jYN3robFDOq+n57tEJONE=ZKvvNGRff1KZKcTkg%40mail.gmail.com">=ZKvvNGRff1KZKcTkg@mail.gmail.com&gt;</a>
Subject: =?UTF-8?B?6IGa5Lya?=
From: =?UTF-8?B?5aSP5LiW6LaF?= <a href="mailto:mrcoinking%40gmail.com">&lt;mrcoinking@gmail.com&gt;</a>
To: mrcoinking@gmail.com
Content-Type: multipart/alternative; <span class="org-variable-name">boundary</span>=<span class="org-string">"000000000000688ae205c7740b1a"</span>

--000000000000688ae205c7740b1a
Content-Type: text/plain; <span class="org-variable-name">charset</span>=<span class="org-string">"UTF-8"</span>
Content-Transfer-Encoding: base64

5pyJ5LiA5Liq6IGa5Lya6KaB5Y+C5Yqg5ZCX77yfDQoNClRvbQ0K
--000000000000688ae205c7740b1a
Content-Type: text/html; <span class="org-variable-name">charset</span>=<span class="org-string">"UTF-8"</span>
Content-Transfer-Encoding: base64

PGRpdiBkaXI9Imx0ciI+5pyJ5LiA5Liq6IGa5Lya6KaB5Y+C5Yqg5ZCX77yfPGRpdj48YnI+PC9k
aXY+<span class="org-variable-name">PGRpdj5Ub208L2Rpdj48L2Rpdj4NCg</span>==
--000000000000688ae205c7740b1a--
.
DELE 1
+OK marked for deletion
QUIT
+OK Farewell.
<span class="org-builtin">read</span>:<span class="org-variable-name">errno</span>=0
</pre>
</div>
</div>
</div>

<div id="outline-container-org9906301" class="outline-4">
<h4 id="org9906301">UDPClient.py p.107</h4>
<div class="outline-text-4" id="text-org9906301">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> socket <span class="org-keyword">import</span> *
<span class="org-keyword">from</span> code <span class="org-keyword">import</span> *

<span class="org-variable-name">serverName</span> = <span class="org-string">'localhost'</span>
<span class="org-variable-name">serverPort</span> = 12000
<span class="org-variable-name">clientSocket</span> = socket(AF_INET, SOCK_DGRAM)
<span class="org-variable-name">message</span> = InteractiveConsole.<span class="org-builtin">raw_input</span>(<span class="org-string">'Input lowercase sentence:'</span>)
clientSocket.sendto(message.encode(),(serverName, serverPort))
<span class="org-variable-name">modifiedMessage</span>, <span class="org-variable-name">serverAddress</span> = clientSocket.recvfrom(2048)
<span class="org-builtin">print</span>(modifiedMessage.decode())
clientSocket.close()
</pre>
</div>
</div>
</div>

<div id="outline-container-orga76e2a5" class="outline-4">
<h4 id="orga76e2a5">UDPServer.py p.108</h4>
<div class="outline-text-4" id="text-orga76e2a5">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> socket <span class="org-keyword">import</span> *

<span class="org-variable-name">serverPort</span> = 12000
<span class="org-variable-name">serverSocket</span> = socket(AF_INET, SOCK_DGRAM)
serverSocket.bind((<span class="org-string">''</span>, serverPort))
<span class="org-builtin">print</span>(<span class="org-string">"The server is ready to receive"</span>)
<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    <span class="org-variable-name">message</span>, <span class="org-variable-name">clientAddress</span> = serverSocket.recvfrom(2048)
    <span class="org-variable-name">modifiedMessage</span> = message.decode().upper()
    serverSocket.sendto(modifiedMessage.encode(), clientAddress)
</pre>
</div>
</div>
</div>

<div id="outline-container-org18b2c56" class="outline-4">
<h4 id="org18b2c56">TCPClient.py p.111</h4>
<div class="outline-text-4" id="text-org18b2c56">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> socket <span class="org-keyword">import</span> *
<span class="org-keyword">from</span> code <span class="org-keyword">import</span> *

<span class="org-variable-name">serverName</span> = <span class="org-string">'localhost'</span>
<span class="org-variable-name">serverPort</span> = 12000
<span class="org-variable-name">clientSocket</span> = socket(AF_INET, SOCK_STREAM)
clientSocket.connect((serverName, serverPort))
<span class="org-variable-name">sentence</span> = InteractiveConsole.<span class="org-builtin">raw_input</span>(
    <span class="org-string">'Input lowercase sentence:'</span>)
clientSocket.send(sentence.encode())
modifiedSentence = clientSocket.recv(1024)
<span class="org-builtin">print</span>(<span class="org-string">'From Server: '</span>, modifiedSentence.decode())
clientSocket.close()
</pre>
</div>
</div>
</div>

<div id="outline-container-org592a400" class="outline-4">
<h4 id="org592a400">TCPServer.py p.112</h4>
<div class="outline-text-4" id="text-org592a400">
<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> socket <span class="org-keyword">import</span> *

<span class="org-variable-name">serverPort</span> = 12000
<span class="org-variable-name">serverSocket</span> = socket(AF_INET, SOCK_STREAM)
serverSocket.bind((<span class="org-string">''</span>, serverPort))
serverSocket.listen(1)
<span class="org-builtin">print</span>(<span class="org-string">'The server is ready to receive'</span>)
<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    <span class="org-variable-name">connectionSocket</span>, <span class="org-variable-name">addr</span> = serverSocket.accept()
    <span class="org-variable-name">sentence</span> = connectionSocket.recv(1024).decode()
    <span class="org-variable-name">capitalizedSentence</span> = sentence.upper()
    connectionSocket.send(capitalizedSentence.encode())
    connectionSocket.close()
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf2816d6" class="outline-3">
<h3 id="orgf2816d6"><span class="section-number-3">2.2.</span> 复习题</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-orgf9e5939" class="outline-4">
<h4 id="orgf9e5939">R1</h4>
<div class="outline-text-4" id="text-orgf9e5939">
<p>
列出5种非专用的因特网应用及它们所使用的应用层协议。<br />
</p>


<div id="org9e57062" class="figure">
<p><img src="./img/fig2-5.png" alt="fig2-5.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org7352a12" class="outline-4">
<h4 id="org7352a12">R2</h4>
<div class="outline-text-4" id="text-org7352a12">
<p>
网络体系结构与应用程序体系结构之间有什么区别？<br />
</p>

<p>
从应用程序研发者的角度看，网络体系结构是固定的，并为应用程序提供了特定的服务集合。应用程序体系结构由应用程序研发者设计，规定了如何在各种端系统上组织该应用程序。<br />
</p>
</div>
</div>

<div id="outline-container-org88d8123" class="outline-4">
<h4 id="org88d8123">R3</h4>
<div class="outline-text-4" id="text-org88d8123">
<p>
对两进程之间的通信会话而言，哪个进程是客户，哪个进程是服务器？<br />
</p>

<p>
在一对进程之间的通信会话场景中，发起通信的进程被标识为客户，在会话开始时等待联系的进程是服务器。<br />
</p>
</div>
</div>

<div id="outline-container-orgc88a723" class="outline-4">
<h4 id="orgc88a723">R4</h4>
<div class="outline-text-4" id="text-orgc88a723">
<p>
对一个P2P文件共享应用，你同意”一个通信会话不存在客户端和服务器端的概念”的说法吗？为什么？<br />
</p>

<p>
不同意。在P2P文件共享中，当对等方A请求对等方B发送一个特定的文件时，在这个特定的通信会话中对等方A是客户，而对等方B是服务器。<br />
</p>
</div>
</div>

<div id="outline-container-org42483c8" class="outline-4">
<h4 id="org42483c8">R5</h4>
<div class="outline-text-4" id="text-org42483c8">
<p>
运行在一台主机上的一个进程，使用什么信息来标识运行在另一台主机上的进程？<br />
</p>

<p>
端口号。<br />
</p>
</div>
</div>

<div id="outline-container-org9fb1b1b" class="outline-4">
<h4 id="org9fb1b1b">R6</h4>
<div class="outline-text-4" id="text-org9fb1b1b">
<p>
假定你想尽快地处理从远程客户到服务器的事务，你将使用UDP还是TCP？为什么？<br />
</p>

<p>
UDP。使用UDP处理事务仅需要一个RTT：客户是使用UDP套接字发送请求；服务器使用UDP套接字向客户发送响应。使用TCP则至少需要两个RTT：一个RTT用来建立TCP连接；另一个RTT供客户发送请求、服务器发送响应。<br />
</p>
</div>
</div>

<div id="outline-container-org11dfec2" class="outline-4">
<h4 id="org11dfec2">R7</h4>
<div class="outline-text-4" id="text-org11dfec2">
<p>
参见图2-4，我们看到在该图中所列出的应用程序没有一个同时既要求无数据丢失又要求定时的。你能设想一个既要求无数据丢失又高度时间敏感的应用程序吗？<br />
</p>

<p>
远程手术设备控制程序。<br />
</p>
</div>
</div>

<div id="outline-container-org081242e" class="outline-4">
<h4 id="org081242e">R8</h4>
<div class="outline-text-4" id="text-org081242e">
<p>
列出一个运输协议能够提供的4种宽泛类型的服务。对于每种服务类型，指出是UDP还是TCP（或这两种协议）提供这样的服务？<br />
</p>

<ol class="org-ol">
<li>可靠数据传输<br />
TCP可以在客户和服务器之间传输可靠的字节流；UDP不可以。<br /></li>
<li>吞吐量<br />
都不可以。<br /></li>
<li>定时<br />
都不可以。<br /></li>
<li>安全性<br />
都不可以。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org7cea3fd" class="outline-4">
<h4 id="org7cea3fd">R9</h4>
<div class="outline-text-4" id="text-org7cea3fd">
<p>
前面讲过TCP能用SSL来强化，以提供进程到进程的安全性服务，包括加密。SSL运行在运输层还是应用层？如果某应用程序研制者想要用SSL来强化UDP，该研制者应当做些什么工作？<br />
</p>

<p>
SSL运行在应用层。SSL套接字从应用层获取未加密的数据，对其进行加密，然后将其传递给TCP套接字。如果应用程序开发人员希望用SSL来增强UDP，就必须在应用程序中引入SSL代码。<br />
</p>
</div>
</div>

<div id="outline-container-orgc43a7ad" class="outline-4">
<h4 id="orgc43a7ad">R10</h4>
<div class="outline-text-4" id="text-orgc43a7ad">
<p>
握手协议的作用是什么？<br />
</p>

<p>
如果两个通信实体在向对方发送数据之前首先交换控制数据报文，那么协议就会使用握手。SMTP在应用层使用握手，而HTTP不使用。<br />
</p>
</div>
</div>

<div id="outline-container-org7a76d88" class="outline-4">
<h4 id="org7a76d88">R11</h4>
<div class="outline-text-4" id="text-org7a76d88">
<p>
为什么HTTP、SMTP及POP3都运行在TCP，而不是UDP上？<br />
</p>

<p>
因为这些应用层协议需要传输层按顺序、无差错地交付报文。<br />
</p>
</div>
</div>

<div id="outline-container-orge67d00b" class="outline-4">
<h4 id="orge67d00b">R12</h4>
<div class="outline-text-4" id="text-orge67d00b">
<p>
考虑一个电子商务网站需要保留每一个客户的购买记录。描述如何使用cookie来完成该功能？<br />
</p>

<ol class="org-ol">
<li>当请求报文到达该电子商务网站的服务器时，该Web站点将产生一个唯一识别码，并以此作为索引在它的后端数据库中产生一个表项。<br /></li>
<li>接下来Web服务器用一个包含Set-cookie:首部的HTTP响应报文对用户的浏览器进行响应。<br /></li>
<li>当客户的浏览器收到了该HTTP响应报文时，它会看到该Set-cookie:首部。该浏览器在它管理的特定cookie文件中添加一行，该行包含服务器的主机名和在Set-cookie:首部中的识别码。<br /></li>
<li>当用户继续浏览网站时，每请求一个Web页面，其浏览器就会查询该cookie文件并抽取她对这个网站的识别码，并放到HTTP请求报文中包括识别码的cookie首部行中。在这种方式下，服务器可以跟踪用户在站点的活动。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org577c19f" class="outline-4">
<h4 id="org577c19f">R13</h4>
<div class="outline-text-4" id="text-org577c19f">
<p>
描述Web缓存器是如何减少接收被请求对象的时延的。Web缓存器将减少一个用户请求的所有对象或只是其中的某些对象的时延吗？为什么？<br />
</p>

<p>
网络缓存可以使所需的内容离用户“更近”，可能就在用户的主机所连接的同一个局域网中。网络缓存可以减少所有对象的延迟，即使是没有被缓存的对象，因为缓存减少了链接的流量。<br />
</p>
</div>
</div>

<div id="outline-container-orgca9e67f" class="outline-4">
<h4 id="orgca9e67f">R14</h4>
<div class="outline-text-4" id="text-orgca9e67f">
<p>
Telnet到一台Web服务器并发送一个多行的请求报文。在该请求报文中包含If-modified-since:首部行，迫使响应报文中出现“304 Not Modified”状态代码。<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">% telnet gaia.cs.umass.edu 80
Trying 198.18.1.221...
Connected to gaia.cs.umass.edu.
Escape character is <span class="org-string">'^]'</span>.
GET /index.html HTTP/1.1
Host: gaia.cs.umass.edu
If-modified-since: Tue, 01 Mar 2016 22:00:00 GMT

HTTP/1.1 304 Not Modified
Date: Mon, 19 Jul 2021 09:08:24 GMT
Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.14 mod_perl/2.0.11 Perl/v5.16.3
ETag: <span class="org-string">"a5b-52d015789ee9e"</span>

Connection closed by foreign host.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc323e72" class="outline-4">
<h4 id="orgc323e72">R15</h4>
<div class="outline-text-4" id="text-orgc323e72">
<p>
列出几种流行的即时通信应用。它们使用相同的协议作为SMS（Short Message Service）吗？<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">应用</th>
<th scope="col" class="org-left">协议</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">WhatsApp</td>
<td class="org-left">XMPP</td>
</tr>

<tr>
<td class="org-left">Telegram</td>
<td class="org-left">MTProto</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc7b0f5c" class="outline-4">
<h4 id="orgc7b0f5c">R16</h4>
<div class="outline-text-4" id="text-orgc7b0f5c">
<p>
假定Alice使用一个基于Web的电子邮件账户（例如Hotmai或Gmail）向Bob发报文，而Bob使用POP3从他的邮件服务器访问自己的邮件。讨论该报文是如何从Alice主机到Bob主机的。要列出在两台主机间移动该报文时所使用的各种应用层协议。<br />
</p>


<div id="org93f32c6" class="figure">
<p><img src="img/ch2-r16.svg" alt="ch2-r16.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgacecbec" class="outline-4">
<h4 id="orgacecbec">R17</h4>
<div class="outline-text-4" id="text-orgacecbec">
<p>
将你最近收到的报文首部打印出来。其中有多少Received:首部行？分析该报文的首部行中的每一行。<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">Delivered-To: mrcoinking@gmail.com
Received: by 2002:a05:6900:1294:0:0:0:0 with SMTP id s20csp4253317yam;
Mon, 19 Jul 2021 03:46:52 -0700 (PDT)
X-Google-Smtp-Source: ABdhPJzY9W9JH0ophTk1fSVccvDkQPEVXSd9moEC5KTgCUy4GQRxxLN62hg35D4YD5JE6Pg6DOnk
X-Received: by 2002:a17:907:1614:: with SMTP id hb20mr26747648ejc.387.1626691612437;
Mon, 19 Jul 2021 03:46:52 -0700 (PDT)
ARC-Seal: <span class="org-variable-name">i</span>=2; <span class="org-variable-name">a</span>=rsa-sha256; <span class="org-variable-name">t</span>=1626691612; <span class="org-variable-name">cv</span>=pass;
<span class="org-variable-name">d</span>=google.com; <span class="org-variable-name">s</span>=arc-20160816;
<span class="org-variable-name">b</span>=BHjcOyLyIcO3Hib03bbMjAiPU7wKkwJXzlm9HJcqNITM0ApwfosYOMwAG0ss3fgE05
s9/AkNSbu6C7JadPS8cC0CwUKOB9rHP2SHEe4sl1Fz9fCNQyFGz9aQOmAWM+ZzsEpORp
11eQ+JNDvzVE3PHizk6Zd/l0D0zz55muClDP6CTB8gD7t6cqaOWtt5HZxhHdFj1R4I3O
AB/LhWeKdY5W4/R9OqMoqV1XkCpAYVqF4uQktJzJzyKySV+XTkxyiQlVBFDzNxUaFvIh
DUj2nHRjQRiKARwJ/+GG6iSQ3hcgERRpBzux2W3sCSKp9XyzXKI0Z5A1j3aMqoV4cr1s
<span class="org-variable-name">uZKA</span>==
ARC-Message-Signature: <span class="org-variable-name">i</span>=2; <span class="org-variable-name">a</span>=rsa-sha256; <span class="org-variable-name">c</span>=relaxed/relaxed; <span class="org-variable-name">d</span>=google.com; <span class="org-variable-name">s</span>=arc-20160816;
<span class="org-variable-name">h</span>=mime-version:content-language:accept-language:message-id:date
:thread-index:thread-topic:subject:to:from:dkim-signature;
<span class="org-variable-name">bh</span>=fmsy58jE8ul38iId/7Xm/XOLc5OFTh6Q8DzAhj5OOz4=;
<span class="org-variable-name">b</span>=fWIT9tJrFYb6yz5fEfQ7bwOXYj87bY40p/WA2pKqXPCOz3qw4/H5eOYAxPhABs//Ua
dIby303yIIBBf62puAO+M7eb2AtchWVrrMBt9gtHbtpbLIYEEwHpSBjX/CxNkiFdMW+4
2ZLHlCwngtys6TrYRwUJ1j5JXDy1u/5YXRqLJ+W2Y1rPq8apsW+gfLY64Esi1oxSB7jn
kcjiiJNnGsuKHHoadaqy1DjtiCzBigZarQ1VKmnSB6mwbudpmM6fUQ/zUtvgK88qtfUu
8eBtWWuRlVq4EJQGj6OVIEUTCNhYmZ7Q3gcoIteB/yrcjjVU7z2Yt5aZePxzw2hZ1Ayp
<span class="org-variable-name">XUzA</span>==
ARC-Authentication-Results: <span class="org-variable-name">i</span>=2; mx.google.com;
<span class="org-variable-name">dkim</span>=pass header.i=@outlook.com header.s=selector1 header.b=UqTt1AQt;
<span class="org-variable-name">arc</span>=pass (<span class="org-variable-name">i</span>=1);
<span class="org-variable-name">spf</span>=pass (google.com: domain of shichaoxia@outlook.com designates 40.92.62.143 as permitted sender) smtp.mailfrom=shichaoxia@outlook.com;
<span class="org-variable-name">dmarc</span>=pass (<span class="org-variable-name">p</span>=NONE <span class="org-variable-name">sp</span>=QUARANTINE <span class="org-variable-name">dis</span>=NONE) header.from=outlook.com
Return-Path: <a href="mailto:shichaoxia%40outlook.com">&lt;shichaoxia@outlook.com&gt;</a>
Received: from AUS01-SY4-obe.outbound.protection.outlook.com (mail-sy4aus01olkn2143.outbound.protection.outlook.com. [40.92.62.143])
by mx.google.com with ESMTPS id h6si21104650edw.479.2021.07.19.03.46.52
<span class="org-keyword">for</span> <a href="mailto:mrcoinking%40gmail.com">&lt;mrcoinking@gmail.com&gt;</a>
    (<span class="org-variable-name">version</span>=TLS1_2 <span class="org-variable-name">cipher</span>=ECDHE-ECDSA-AES128-GCM-SHA256 <span class="org-variable-name">bits</span>=128/128);
    Mon, 19 Jul 2021 03:46:52 -0700 (PDT)
    Received-SPF: pass (google.com: domain of shichaoxia@outlook.com designates 40.92.62.143 as permitted sender) client-ip=40.92.62.143;
    Authentication-Results: mx.google.com;
    <span class="org-variable-name">dkim</span>=pass header.i=@outlook.com header.s=selector1 header.b=UqTt1AQt;
    <span class="org-variable-name">arc</span>=pass (<span class="org-variable-name">i</span>=1);
    <span class="org-variable-name">spf</span>=pass (google.com: domain of shichaoxia@outlook.com designates 40.92.62.143 as permitted sender) smtp.mailfrom=shichaoxia@outlook.com;
    <span class="org-variable-name">dmarc</span>=pass (<span class="org-variable-name">p</span>=NONE <span class="org-variable-name">sp</span>=QUARANTINE <span class="org-variable-name">dis</span>=NONE) header.from=outlook.com
    ARC-Seal: <span class="org-variable-name">i</span>=1; <span class="org-variable-name">a</span>=rsa-sha256; <span class="org-variable-name">s</span>=arcselector9901; <span class="org-variable-name">d</span>=microsoft.com; <span class="org-variable-name">cv</span>=none;
    <span class="org-variable-name">b</span>=Rhby+n7k/37aAUBFVt/khy0oEvtB6I/aFAXwZEntAyccz2W7Z0VMkD5nh+PiNVKBZRLAlaTJz1FXPXipQ9kLPdmfjh6HOTQMCBqyJ9nSzRhmeR5bAIeXiM83OLfRg+3nFIobBCU33usq69uJmzvXgZWZoTNTOvYe5slMhulKV/irP+uDc/yncnASuD9ugXjHzem1g7KFfykhtuVuqZxKK3FGAix8BYbpDdIa7JdsFm7U9LmODKUFYIzhgLiKQiTpwRthkFpDqJNzlbZ+<span class="org-variable-name">YGdnDQin017Fke4WZm8YQs8bZSRhEa1IiXPCWe5nlegacj8gDj60XkKMgQ1x7NqvTvC0pQ</span>==
    ARC-Message-Signature: <span class="org-variable-name">i</span>=1; <span class="org-variable-name">a</span>=rsa-sha256; <span class="org-variable-name">c</span>=relaxed/relaxed; <span class="org-variable-name">d</span>=microsoft.com;
    <span class="org-variable-name">s</span>=arcselector9901;
    <span class="org-variable-name">h</span>=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
    <span class="org-variable-name">bh</span>=fmsy58jE8ul38iId/7Xm/XOLc5OFTh6Q8DzAhj5OOz4=;
    <span class="org-variable-name">b</span>=Rh1Xi9Uwa/gdarxYaJra4TLZU+0ZWGkGGN2MVsOpK05CL9/ltBXE2eZr+yBOuR+cgmQ5IEZXsO28aUC/7qZ6ZggkAf1falxZxRllVCVKSuVCuuPGgItoo1eQ6CgUr8n2ncdDCcdftTwCYc4RL0ZEvRZXh0mlp/efWf+udSViUjWRky9AnAX/u7+vXvopAF5zJetx0b4VSmpKtQTiFeMlVTbaobipOYUmSaBbeYTuPhW/AHXTriKEWjPTBteQrBU9wF967A5a7psRpNTBo3EhdyWf2qssM2VQzs9NlG3poaXWvt7m/d6lB20oKQORReilhlQm1MEmVbwJaD+<span class="org-variable-name">WtGaSrQ</span>==
    ARC-Authentication-Results: <span class="org-variable-name">i</span>=1; mx.microsoft.com 1; <span class="org-variable-name">spf</span>=none; <span class="org-variable-name">dmarc</span>=none;
    <span class="org-variable-name">dkim</span>=none; <span class="org-variable-name">arc</span>=none
    DKIM-Signature: <span class="org-variable-name">v</span>=1; <span class="org-variable-name">a</span>=rsa-sha256; <span class="org-variable-name">c</span>=relaxed/relaxed; <span class="org-variable-name">d</span>=outlook.com;
    <span class="org-variable-name">s</span>=selector1;
    <span class="org-variable-name">h</span>=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
    <span class="org-variable-name">bh</span>=fmsy58jE8ul38iId/7Xm/XOLc5OFTh6Q8DzAhj5OOz4=;
    <span class="org-variable-name">b</span>=UqTt1AQtMIggtDNY6B99NTCc5YZypkbhlkAfNdS+cM1/EY4yhyZdbNAQHG8iZlz+hiqsVpYKyoog0liOhnuNx1IQZxhDChSxjICKiziFTJhTiy6jot4FKQeHCuoB5dG7bzoPwb/lDx2ke/HI4703dmCWgd7iq+p2A4JCXEIEnuym3K73le1Z+0R3efaHttbGgVFZ0rSJSq9YE9hMH6+M5nXOyFuQe0WODDW2/74XIrI+rRdhWE7oM0myInwNk6GP4OcRtv18xsGsXOCDzutcO07YNhE7Bj1gac+<span class="org-variable-name">1Mdwxurq5qHSjcLFFcO1bhKhaa6o7uXEgI8M4VFRhPQxnbhmvww</span>==
    Received: from ME3P282MB1459.AUSP282.PROD.OUTLOOK.COM (2603:10c6:220:a6::11)
    by ME4P282MB0952.AUSP282.PROD.OUTLOOK.COM (2603:10c6:220:94::13) with
    Microsoft SMTP Server (<span class="org-variable-name">version</span>=TLS1_2,
                           <span class="org-variable-name">cipher</span>=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4331.23; Mon, 19 Jul
    2021 10:46:49 +0000
    Received: from ME3P282MB1459.AUSP282.PROD.OUTLOOK.COM
    ([fe80::8c3b:e921:3345:e11b]) by ME3P282MB1459.AUSP282.PROD.OUTLOOK.COM
    ([fe80::8c3b:e921:3345:e11b%9]) with mapi id 15.20.4331.033; Mon, 19 Jul 2021
    10:46:49 +0000
    From: Xia Shi-Chao <a href="mailto:shichaoxia%40outlook.com">&lt;shichaoxia@outlook.com&gt;</a>
    To: <span class="org-string">"mrcoinking@gmail.com"</span> <a href="mailto:mrcoinking%40gmail.com">&lt;mrcoinking@gmail.com&gt;</a>
    Subject: Test subject xxx!
    Thread-Topic: Test subject xxx!
    Thread-Index: AQHXfItW5GxCI17Vy0uZE+<span class="org-variable-name">G875iDPg</span>==
    Date: Mon, 19 Jul 2021 10:46:49 +0000
    Message-ID:
    <a href="mailto:ME3P282MB1459AEDEB797FB3411DCA0BEDBE19%40ME3P282MB1459.AUSP282.PROD.OUTLOOK.COM">&lt;ME3P282MB1459AEDEB797FB3411DCA0BEDBE19@ME3P282MB1459.AUSP282.PROD.OUTLOOK.COM&gt;</a>
    Accept-Language: zh-CN, en-US
    Content-Language: zh-CN
    X-MS-Has-Attach:
    X-MS-TNEF-Correlator:
    x-tmn: [+aVMvf0XoHBwmnkmkVBdstZrvq4db3oE]
    x-ms-publictraffictype: Email
    x-ms-office365-filtering-correlation-id: aaef0314-2279-4f89-f6c5-08d94aa28333
    x-ms-traffictypediagnostic: ME4P282MB0952:
    x-microsoft-antispam: BCL:0;
    x-microsoft-antispam-message-info:
    Rx/A+Mh1pbQoqX1VUNrRo/uCZFE2Nlt0ZLmrrDTb5Z/VEU5/4itbcYzM1bvlvdA6zmkW5+AsdLwO7Wck6wGMVhzTdC6KNbNE4r2Xcgk0rac23BXshFoD7Tkl+f0p88fJ7KVV6q4XxV6QR+PBlfqwUmRVjMG5k6fxyozabE7r4/iHIjJY8Kq3QjG2KPtnMjcHdEDQIyQgJ0xIuQ9x1v0KhaXGojPjhjAivuWX7u+K4Q1jPRW3M2OMlq1c25FtuA62jeAWLGmaM88l3hkOOH9cdgpNJ/Ol376um+GlAWZa88y5KZ1GSyklzS6b79YOFFnAAoCyhbKdxSn3gjnlJbl1a10fxhh0lB4L/xFwMaEeOd8bcWYxMGfg2a6RHWUTuEpWo7ij37xOgJh/UQtV0YyfTdGCJM7VmDFg+sb7AuoTu2iv9vxUsP4XlHoqE9fhU0f4
    x-ms-exchange-antispam-messagedata-chunkcount: 1
    x-ms-exchange-antispam-messagedata-0:
    MqGrDcs9MMjhe0+liD4+kxzYFAKPfA1dCE/K9FpSKDALTdXZHJJglChVX/oiZCzt309cLi//NS53+oTiMN+etGRdDV7amRpuMSeTx3DRF6v1dmbfaAEFterBZ4RTDzPcapdN/puef/zqmxfFLukgcQ==
    x-ms-exchange-transport-forked: True
    Content-Type: multipart/alternative;
    <span class="org-variable-name">boundary</span>=<span class="org-string">"_000_ME3P282MB1459AEDEB797FB3411DCA0BEDBE19ME3P282MB1459AUSP_"</span>
    MIME-Version: 1.0
    X-OriginatorOrg: outlook.com
    X-MS-Exchange-CrossTenant-AuthAs: Internal
    X-MS-Exchange-CrossTenant-AuthSource: ME3P282MB1459.AUSP282.PROD.OUTLOOK.COM
    X-MS-Exchange-CrossTenant-RMS-PersistedConsumerOrg: 00000000-0000-0000-0000-000000000000
    X-MS-Exchange-CrossTenant-Network-Message-Id: aaef0314-2279-4f89-f6c5-08d94aa28333
    X-MS-Exchange-CrossTenant-originalarrivaltime: 19 Jul 2021 10:46:49.3813
    (UTC)
    X-MS-Exchange-CrossTenant-fromentityheader: Hosted
    X-MS-Exchange-CrossTenant-id: 84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa
    X-MS-Exchange-CrossTenant-rms-persistedconsumerorg: 00000000-0000-0000-0000-000000000000
    X-MS-Exchange-Transport-CrossTenantHeadersStamped: ME4P282MB0952

    --_000_ME3P282MB1459AEDEB797FB3411DCA0BEDBE19ME3P282MB1459AUSP_
    Content-Type: text/plain; <span class="org-variable-name">charset</span>=<span class="org-string">"gb2312"</span>
    Content-Transfer-Encoding: base64

    <span class="org-variable-name">SGksDQoNClRoaXMgaXMgYSB0ZXN0IQ0KDQpUb20NCg</span>==

    --_000_ME3P282MB1459AEDEB797FB3411DCA0BEDBE19ME3P282MB1459AUSP_
    Content-Type: text/html; <span class="org-variable-name">charset</span>=<span class="org-string">"gb2312"</span>
    Content-Transfer-Encoding: quoted-printable

    &lt;html&gt;
    &lt;head&gt;
    &lt;meta http-equiv=3D<span class="org-string">"Content-Type"</span> <span class="org-variable-name">content</span>=3D<span class="org-string">"text/html; charset=3Dgb2312"</span>&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;div <span class="org-variable-name">style</span>=3D<span class="org-string">"font-family: &amp;quot;segoe ui westeuropean&amp;quot;, &amp;quot;segoe u=</span>
<span class="org-string">i&amp;quot;, helvetica, arial, sans-serif; font-size: 9.75pt; color: rgb(0, 0, =</span>
<span class="org-string">0);"</span>&gt;
    Hi,&lt;/div&gt;
    &lt;div <span class="org-variable-name">style</span>=3D<span class="org-string">"font-family: &amp;quot;segoe ui westeuropean&amp;quot;, &amp;quot;segoe u=</span>
<span class="org-string">i&amp;quot;, helvetica, arial, sans-serif; font-size: 9.75pt; color: rgb(0, 0, =</span>
<span class="org-string">0);"</span>&gt;
    &lt;br&gt;
    &lt;/div&gt;
    &lt;div <span class="org-variable-name">style</span>=3D<span class="org-string">"font-family: &amp;quot;segoe ui westeuropean&amp;quot;, &amp;quot;segoe u=</span>
<span class="org-string">i&amp;quot;, helvetica, arial, sans-serif; font-size: 9.75pt; color: rgb(0, 0, =</span>
<span class="org-string">0);"</span>&gt;
    This is a test!&lt;/div&gt;
    &lt;div <span class="org-variable-name">style</span>=3D<span class="org-string">"font-family: &amp;quot;segoe ui westeuropean&amp;quot;, &amp;quot;segoe u=</span>
<span class="org-string">i&amp;quot;, helvetica, arial, sans-serif; font-size: 9.75pt; color: rgb(0, 0, =</span>
<span class="org-string">0);"</span>&gt;
    &lt;br&gt;
    &lt;/div&gt;
    &lt;div <span class="org-variable-name">style</span>=3D<span class="org-string">"font-family: &amp;quot;segoe ui westeuropean&amp;quot;, &amp;quot;segoe u=</span>
<span class="org-string">i&amp;quot;, helvetica, arial, sans-serif; font-size: 9.75pt; color: rgb(0, 0, =</span>
<span class="org-string">0);"</span>&gt;
    Tom&lt;/div&gt;
    &lt;/body&gt;
    &lt;/html&gt;

    --_000_ME3P282MB1459AEDEB797FB3411DCA0BEDBE19ME3P282MB1459AUSP_--

</pre>
</div>

<dl class="org-dl">
<dt>Delivered-To</dt><dd><p>
邮件在被送达目的地址（由SMTP的 <code>RCPT TO</code> 命令提供）之前可能在多个服务器之间传递。 <code>Delivered-To</code> 用于记录这些传递的信息。<br />
</p>

<p>
<a href="https://www.easy365manager.com/rfc-5321-and-rfc-5322/">RFC 5321 and RFC 5322</a><br />
<a href="https://datatracker.ietf.org/doc/draft-crocker-email-deliveredto/">Delivered-To Email Header Field</a><br />
</p></dd>

<dt>Received</dt><dd><a href="https://www.rfc-editor.org/rfc/rfc5321#section-4.4">RFC5321</a>: When an SMTP server receives a message for delivery or further processing, it MUST insert trace ("time stamp" or "Received") information at the beginning of the message content.<br /></dd>
</dl>


<p>
<a href="https://linuxhint.com/email_header_analysis/">Email Header Analysis</a><br />
<a href="https://toolbox.googleapps.com/apps/messageheader/">Google Admin Toolbox Messageheader</a><br />
</p>
</div>
</div>

<div id="outline-container-org4df4d39" class="outline-4">
<h4 id="org4df4d39">R18</h4>
<div class="outline-text-4" id="text-org4df4d39">
<p>
从用户的观点看，POP3协议中下载并删除模式和下载并保留模式有什么区别吗？<br />
</p>

<p>
下载并删除模式在用户代理下载邮件后会将邮件服务器邮箱里的邮件删除，下载保留模式不会删除。<br />
</p>
</div>
</div>

<div id="outline-container-orgb1fc889" class="outline-4">
<h4 id="orgb1fc889">R19</h4>
<div class="outline-text-4" id="text-orgb1fc889">
<p>
一个机构的Web服务器和邮件服务器可以有完全相同的主机名别名（例如，foo.com）吗？包含邮件服务器主机名的RR有什么样的类型？<br />
</p>

<p>
可以，一条类型为MX的记录。<br />
</p>
</div>
</div>

<div id="outline-container-orgb3475c4" class="outline-4">
<h4 id="orgb3475c4">R20</h4>
<div class="outline-text-4" id="text-orgb3475c4">
<p>
仔细检查收到的电子邮件，查找由使用.edu电子邮件地址的用户发送的报文首部。从其首部，能够确定发送该报文的主机的IP地址吗？对于由Gmail账号发送的报文做相同的事。<br />
</p>

<blockquote>
<p>
You should be able to see the sender's IP address for a user with an .edu email address. But you will not be able to see the sender's IP address if the user uses a gmail account.<br />
</p>
</blockquote>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Hop</td>
<td class="org-left">Delay</td>
<td class="org-left">From</td>
<td class="org-left">By</td>
<td class="org-left">With</td>
<td class="org-left">Time (UTC)</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">*</td>
<td class="org-left">named</td>
<td class="org-left">gmailapi.google.com</td>
<td class="org-left">HTTPREST</td>
<td class="org-left">7/20/2021 4:47:30 AM</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">1 Second</td>
<td class="org-left">mail-yb1-f172.google.com</td>
<td class="org-left">SMTP</td>
<td class="org-left">7/20/2021 4:47:31 AM</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">0 seconds</td>
<td class="org-left">mail-yb1-f172.google.com 209.85.219.172</td>
<td class="org-left">VI1EUR06FT043.mail.protection.outlook.com 10.13.6.134</td>
<td class="org-left">Microsoft SMTP Server (version=TLS1.2)</td>
<td class="org-left">7/20/2021 4:47:31 AM</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">0 seconds</td>
<td class="org-left">VI1EUR06FT043.eop-eur06.prod.protection.outlook.com</td>
<td class="org-left">2a01:111:e400:fc37::4f	VI1EUR06HT153.eop-eur06.prod.protection.outlook.com 2a01:111:e400:fc37::474</td>
<td class="org-left">Microsoft SMTP Server (version=TLS1.2)</td>
<td class="org-left">7/20/2021 4:47:31 AM</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">2 seconds</td>
<td class="org-left">VI1EUR06HT153.eop-eur06.prod.protection.outlook.com 2603:10c6:220:80::15</td>
<td class="org-left">ME3P282MB1459.AUSP282.PROD.OUTLOOK.COM</td>
<td class="org-left">HTTPS</td>
<td class="org-left">7/20/2021 4:47:33</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org2b08d97" class="outline-4">
<h4 id="org2b08d97">R21</h4>
<div class="outline-text-4" id="text-org2b08d97">
<p>
在BitTorrent中，假定Alice向Bob提供一个30秒间隔的文件块吞吐量。Bob将必须进行回报，在相同的间隔中向Alice提供文件块吗？为什么？<br />
</p>

<p>
Bob不是必须在相同间隔中向Alice提供文件块。根据对换算法，Bob向以最高速率流入的四个邻居和一个随机的邻居发送块，因此Alice可能在其中也可能不在。<br />
</p>
</div>
</div>

<div id="outline-container-orgdeb73fa" class="outline-4">
<h4 id="orgdeb73fa">R22</h4>
<div class="outline-text-4" id="text-orgdeb73fa">
<p>
考虑一个新对等方Alice加入BitTorrent而不拥有任何文件块。没有任何块，因此她没有任何东西可上载，她无法成为任何其他对等方的前4位上载者。那么Alice将怎样得到她的第一个文件块呢？<br />
</p>

<p>
Alice决定了要请求的块之后，向其临近对等方发出请求。这些被请求的对等方由于要每30秒要向一个随机的邻居发送块，因此Alice迟早会得到块。假设Alice向k个邻居发送了请求，每个邻居响应Alice的概率是p，那么Alice在一次请求中得到块的概率是q=1-(1-p)^k，得到块的请求次数的期望是1/q，请求时间的期望是30/q。<br />
</p>
</div>
</div>

<div id="outline-container-orga97ca65" class="outline-4">
<h4 id="orga97ca65">R23</h4>
<div class="outline-text-4" id="text-orga97ca65">
<p>
覆盖网络是什么？它包括路由器吗？在覆盖网络中边是什么？<br />
</p>

<blockquote>
<p>
参与文件共享系统的节点和节点之间的逻辑链接组成了P2P文件共享系统中的覆盖网络。如果A和B之间有一个半永久性的TCP连接，就有一个从节点A到节点B的逻辑链接（图论术语中的 "边"）。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org918c0aa" class="outline-4">
<h4 id="org918c0aa">R24</h4>
<div class="outline-text-4" id="text-org918c0aa">
<p>
CDN通常采用两种不同的服务器放置方法之一。列举并简单描述它们。<br />
</p>

<ol class="org-ol">
<li>深入<br />
<ul class="org-ul">
<li>该原则是通过在遍及全球的接入ISP中部署服务器集群来深入到ISP的接入网中。其目标是靠近端用户，通过减少端用户和CDN集群之间）链路和路由器的数量，从而改善了用户感受的时延和吞吐量。<br /></li>
<li>因为这种高度分布式设计，维护和管理集群的任务成为挑战。<br /></li>
</ul></li>
<li>邀请做客<br />
<ul class="org-ul">
<li>该原则是通过在少量关键位置建造大集群来邀请到ISP做客。这些CDN通常将它们的集群放置在因特网交换点（IXP）。<br /></li>
<li>与深入设计原则相比，邀请做客设计通常产生较低的维护和管理开销，可能以对端用户的较高时延和较低吞吐量为代价。<br /></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org682cc31" class="outline-4">
<h4 id="org682cc31">R25</h4>
<div class="outline-text-4" id="text-org682cc31">
<p>
除了如时延、丢包和带宽性能等网络相关的考虑外，设计一种CDN服务器选择策略时还有其他重要因素。它们是什么？<br />
</p>

<blockquote>
<p>
除了与网络有关的因素外，还有一些重要的因素需要考虑，如负载平衡、昼夜效应、网络内各DNS服务器之间的变化、很少访问的视频的有限可用性，以及缓解可能因热门视频内容而产生的热点的需要。<br />
</p>

<p>
<a href="https://engineering.purdue.edu/~isl/ICDCS11.pdf">Torres, Ruben, et al. "Dissecting video server selection strategies in the YouTube CDN." The 31st IEEE International Conference on. Distributed Computing Systems (ICDCS), 2011.</a><br />
</p>

<p>
另一个需要考虑的因素是ISP交付成本&#x2013;可以选择集群，以便使用特定的ISP来承载CDN到客户的流量，同时考虑到ISP和集群运营商之间合同关系中的不同成本结构。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orga78830b" class="outline-4">
<h4 id="orga78830b">R26</h4>
<div class="outline-text-4" id="text-orga78830b">
<p>
2.7节中所描述的UDP服务器仅需要一个套接字，而TCP服务器需要两个套接字。为什么？如果TCP服务器支持n个并行连接，每条连接来自不同的客户主机，那么TCP服务器将需要多少个套接字？<br />
</p>

<blockquote>
<p>
对于UDP服务器，没有欢迎套接字，所有来自不同客户的数据都通过这一个套接字进入服务器。对于TCP服务器，有一个欢迎套接字，每次客户启动与服务器的连接时，都会创建一个新的套接字。因此，为了支持n个并行连接，服务器将需要n+1个套接字。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgb6bce3b" class="outline-4">
<h4 id="orgb6bce3b">R27 <a id="org7f2c724"></a></h4>
<div class="outline-text-4" id="text-orgb6bce3b">
<p>
对于2.7节所描述的运行在TCP之上的客户-服务器应用程序，服务器程序为什么必须先于客户程序运行？对于运行在UDP之上的客户-服务器应用程序，客户程序为什么可以先于服务器程序运行？<br />
</p>

<p>
对于TCP应用程序，一旦客户程序被执行，它就会尝试与服务器建立一个TCP连接。如果TCP服务器没有运行，那么客户端将无法建立连接。<br />
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="org-function-name">Traceback</span> (most recent call last):
File <span class="org-string">"TCPClient.py"</span>, line 7,<span class="org-keyword"> in</span> &lt;module&gt;
<span class="org-function-name">clientSocket.connect</span>((serverName, serverPort))
ConnectionRefusedError: [Errno 61] Connection refused
</pre>
</div>

<p>
对于UDP应用程序，客户端在执行时不会立即启动连接。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd506ead" class="outline-3">
<h3 id="orgd506ead"><span class="section-number-3">2.3.</span> 习题</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-org8885aef" class="outline-4">
<h4 id="org8885aef">P1</h4>
<div class="outline-text-4" id="text-org8885aef">
<p>
是非判断题。<br />
</p>
<ol class="org-ol">
<li>假设用户请求由一些文本和3幅图像组成的Web页面。对于这个页面，客户将发送一个请求报文并接收4个响应报文。<br /></li>
<li>两个不同的Web页面（例如，www.mit.edu/research.html及www.mit.edu/students.html）可以通过同一个持续连接发送。<br /></li>
<li>在浏览器和初始服务器之间使用非持续连接的话，一个TCP报文段是可能携带两个不同的HTTP服务请求报文的。<br /></li>
<li>在HTTP响应报文中的Date:首部指出了该响应中对象最后一次修改的时间。<br /></li>
<li>HTTP响应报文决不会具有空的报文体。<br /></li>
</ol>


<ol class="org-ol">
<li>发送4个请求报文，接收4个响应报文。<br /></li>
<li>正确。<br /></li>
<li>使用非持续连接，每个请求/响应对经一个单独的TCP连接发送。<br /></li>
<li>Date:首部行指示服务器产生并发送该响应报文的日期和时间。<br /></li>
<li>错误。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org02c9c72" class="outline-4">
<h4 id="org02c9c72">P2</h4>
<div class="outline-text-4" id="text-org02c9c72">
<p>
SMS、iMessage和WhatsApp都是智能手机即时通信系统。在因特网上进行一些研究后，为这些系统分别写一段它们所使用协议的文字。然后撰文解释它们的差异所在。<br />
</p>

<blockquote>
<p>
The Short Message Service is realised by the use of the Mobile Application Part (MAP) of the SS7 protocol, with Short Message protocol elements being transported across the network as fields within the MAP messages.<br />
--<a href="https://en.wikipedia.org/wiki/Short_Message_Service_technical_realisation_(GSM)#Protocol">Short Message Service technical realisation (GSM)</a><br />
</p>
</blockquote>

<blockquote>
<p>
The iMessage protocol is based on the Apple Push Notification service (APNs)—a proprietary, binary protocol.[19] It sets up a Keep-Alive connection with the Apple servers. Every connection has its own unique code, which acts as an identifier for the route that should be used to send a message to a specific device. The connection is encrypted with TLS using a client-side certificate, that is requested by the device on the activation of iMessage.<br />
--<a href="https://en.wikipedia.org/wiki/IMessage#Technology">iMessage</a><br />
</p>
</blockquote>

<blockquote>
<p>
WhatsApp uses a customized version of the open standard Extensible Messaging and Presence Protocol (XMPP).[157] Upon installation, it creates a user account using one's phone number as the username (Jabber ID: [phone number]@s.whatsapp.net).<br />
--<a href="https://en.wikipedia.org/wiki/WhatsApp#Technical">WhatsApp</a><br />
</p>
</blockquote>

<blockquote>
<p>
The original and "native" transport protocol for XMPP is Transmission Control Protocol (TCP), using open-ended XML streams over long-lived TCP connections. As an alternative to the TCP transport, the XMPP community has also developed an HTTP transport for web clients as well as users behind restricted firewalls.<br />
--<a href="https://en.wikipedia.org/wiki/XMPP#XMPP_via_HTTP">XMPP</a><br />
</p>
</blockquote>

<blockquote>
<p>
iMessage and WhatsApp are different than SMS because they use data plan to send messages and they work on TCP/IP networks, but SMS use the text messaging plan we purchase from our wireless carrier. Moreover, iMessage and WhatsApp support sending photos, videos, files, etc., while the original SMS can only send text message. Finally, iMessage and WhatsApp can work via WiFi, but SMS cannot.<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org772c071" class="outline-4">
<h4 id="org772c071">P3</h4>
<div class="outline-text-4" id="text-org772c071">
<p>
考虑一个要获取给定URL的Web文档的HTTP客户。该HTTP服务器的IP地址开始时并不知道。在这种情况下，除了HTTP外，还需要什么运输层和应用层协议？<br />
</p>

<p>
还需要的运输层协议：HTTP、DNS，应用层协议：TCP、UDP。<br />
</p>
</div>
</div>

<div id="outline-container-orga9aac9a" class="outline-4">
<h4 id="orga9aac9a">P4</h4>
<div class="outline-text-4" id="text-orga9aac9a">
<p>
考虑当浏览器发送一个HTTP GET报文时，通过Wireshark俘获到下列ASCII字符串（即这是一个HTTP GET报文的实际内容）。字符&lt;cr&gt;&lt;lf&gt;是回车和换行符（即下面文本中的斜体字符串&lt;er&gt;表示了单个回车符，该回车符包含在HTTP首部中的相应位置）。回答下列问题，指出你在下面HTTP GET报文中找到答案的地方。<br />
</p>

<pre class="example" id="org310c270">
GET /cs453/index.html HTTP/1.1&lt;cr&gt;&lt;lf&gt;
Host: gaia.cs.umass.edu&lt;cr&gt;&lt;lf&gt;
User-Agent: Mozilla/5.0 ( Windows;U; Windows NT 5.1; en-US; rv:1.7.2) Gec ko/20040804 Netscape/7.2 (ax) &lt;cr&gt;&lt;lf&gt;
Accept:ex t/xml, application/xml, application/xhtml+xml, text/html;q=0.9, text/plain;q=0.8, image/png,*/*;q=0.5 &lt;cr&gt;&lt;lf&gt;
Accept-Language: en-us, en;q=0.5&lt;cr&gt;&lt;lf&gt;
Accept-Encoding: zip, deflate&lt;cr&gt;&lt;lf&gt;
Accept-Charset: ISO -8859-1, utf-8;q=0.7,*;q=0.7&lt;cr&gt;&lt;lf&gt;
Keep-Alive: 300&lt;cr&gt;&lt;lf&gt;
Connection:keep-alive&lt;cr&gt;&lt;lf&gt;
&lt;cr&gt;&lt;lf&gt;
</pre>

<ol class="org-ol">
<li>由浏览器请求的文档的URL是什么？<br /></li>
<li>该浏览器运行的是HTTP的何种版本？<br /></li>
<li>该浏览器请求的是一条非持续连接还是一条持续连接？<br /></li>
<li>该浏览器所运行的主机的IP地址是什么？<br /></li>
<li>发起该报文的浏览器的类型是什么？在一个HTTP请求报文中，为什么需要浏览器类型？<br /></li>
</ol>


<ol class="org-ol">
<li>gaia.cs.umass.edu/cs453/index.html<br /></li>
<li>HTTP/1.1<br /></li>
<li>持续连接<br /></li>
<li>One would need information from the IP datagrams (that carried the TCP segment that carried the HTTP GET request) to answer this question.<br /></li>
<li>Mozilla/5.0。服务器可以有效地为不同类型的用户代理实际发送相同对象的不同版本。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgf4d9956" class="outline-4">
<h4 id="orgf4d9956">P5</h4>
<div class="outline-text-4" id="text-orgf4d9956">
<p>
下面文本中显示的是来自服务器的回答，以响应上述问题中HTTP GET报文。回答下列问题，指出你在下面报文中找到答案的地方。<br />
</p>

<pre class="example" id="org1677270">
HTTP/1.1 200 OK&lt;cr&gt;&lt;lf&gt;
Date: Tue, 07 Mar 2008 12:39:45GMT&lt;cr&gt;&lt;lf&gt;
Server: Apache/2.0.52 (Fedora) &lt;cr&gt;&lt;lf&gt;
Last-Modified: Sat, 10 Dec2005 18:27:46 GMT&lt;cr&gt;&lt;lf&gt;
ETag: ”526c3-f22-a88a4c80”&lt;cr&gt;&lt;lf&gt;
AcceptRanges: bytes&lt;cr&gt;&lt;lf&gt;
Content-Length: 3874&lt;cr&gt;&lt;lf&gt;
Keep-Alive: timeout=max=100&lt;cr&gt;&lt;lf&gt;
Connection: Keep-Alive&lt;cr&gt;&lt;lf&gt;
Content-Type: text/html; charset= ISO-8859-1&lt;cr&gt;&lt;lf&gt;
&lt;cr&gt;&lt;lf&gt;
&lt;!doctype html public ”//w3c//dtd html 4.0 transitional//en”&gt;&lt;lf&gt;
&lt;html&gt;&lt;lf&gt;
&lt;head&gt;&lt;lf&gt;
&lt;meta http-equiv=”Content-Type” content=”text/html; charset=iso-8859-1”&gt;&lt;lf&gt;
&lt;meta name=”GENERATOR” content=”Mozilla/4.79 [en] (Windows NT 5.0; U) Netscape]”&gt;&lt;lf&gt;
&lt;title&gt;CMPSCI 453 / 591 /NTU-ST550ASpring 2005 homepage&lt;/title&gt;&lt;lf&gt;
&lt;/head&gt;&lt;lf&gt;
&lt;much more document text following here (not shown)&gt;
</pre>

<ol class="org-ol">
<li>服务器能否成功地找到那个文档？该文档提供回答是什么时间？<br /></li>
<li>该文档最后修改是什么时间？<br /></li>
<li>文档中被返回的字节有多少？<br /></li>
<li>文档被返回的前5个字节是什么？该服务器同意一条持续连接吗？<br /></li>
</ol>


<ol class="org-ol">
<li>能，Tue, 07 Mar 2008 12:39:45GMT<br /></li>
<li>Sat, 10 Dec2005 18:27:46 GMT<br /></li>
<li>3874<br /></li>
<li>&lt;!doc，是<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgeb3c4f0" class="outline-4">
<h4 id="orgeb3c4f0">P6</h4>
<div class="outline-text-4" id="text-orgeb3c4f0">
<p>
获取HTTP/1.1规范（RFC2616）。回答下面问题:<br />
</p>
<ol class="org-ol">
<li>解释在客户和服务器之间用于指示关闭待续连接的信令机制。客户、服务器或两者都能发送信令通知连接关闭吗？<br /></li>
<li>HTTP提供了什么加密服务？<br /></li>
<li>一个客户能够与一个给定的服务器打开3条或更多条并发连接吗？<br /></li>
<li>如果一个服务器或一个客户检测到连接已经空闲一段时间，该服务器或客户可以关闭两者之间的传输连接。一侧开始关闭连接而另一侧通过该连接传输数据是可能的吗？请解释。<br /></li>
</ol>


<p>
<a href="https://datatracker.ietf.org/doc/html/rfc2616">RFC2616</a><br />
</p>
<ol class="org-ol">
<li>Persistent connections provide a mechanism by which a client and a server can signal the close of a TCP connection. This signaling takes place using the Connection header field (section 14.10). Once a close has been signaled, the client MUST NOT send any more requests on that connection. --<a href="https://datatracker.ietf.org/doc/html/rfc2616#section-8.1.2">8.1.2</a><br /></li>
<li>HTTP没有提供加密服务。<br /></li>
<li>Clients that use persistent connections SHOULD limit the number of simultaneous connections that they maintain to a given server. A single-user client SHOULD NOT maintain more than 2 connections with any server or proxy. --<a href="https://datatracker.ietf.org/doc/html/rfc2616#section-8.1.4">8.1.4</a><br /></li>
<li><p>
A client, server, or proxy MAY close the transport connection at any time. For example, a client might have started to send a new request at the same time that the server has decided to close the "idle" connection. From the server's point of view, the connection is being closed while it was idle, but from the client's point of view, a request is in progress.<br />
</p>

<p>
This means that clients, servers, and proxies MUST be able to recover from asynchronous close events. Client software SHOULD reopen the transport connection and retransmit the aborted sequence of requests without user interaction so long as the request sequence is idempotent (see section 9.1.2). Non-idempotent methods or sequences MUST NOT be automatically retried, although user agents MAY offer a human operator the choice of retrying the request(s). Confirmation by user-agent software with semantic understanding of the application MAY substitute for user confirmation. The automatic retry SHOULD NOT be repeated if the second sequence of requests fails. --<a href="https://datatracker.ietf.org/doc/html/rfc2616#section-8.1.4">8.1.4</a><br />
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org7a511f2" class="outline-4">
<h4 id="org7a511f2">P7</h4>
<div class="outline-text-4" id="text-org7a511f2">
<p>
假定你在浏览器中点击一条超链接获得Web页面。相关联的URL的IP地址没有缓存在本地主机上，因此必须使用DNS lookup以获得该IP地址。如果主机从DNS得到IP地址之前已经访问了n个DNS服务器；相继产生的RTT依次为RTT<sub>1</sub>、…、RTT<sub>n</sub>。进一步假定与链路相关的Web页面只包含一个对象，即由少量的HTML文本组成。令RTT<sub>0</sub>表示本地主机和包含对象的服务器之间的RTT值。假定该对象传输时间为零，则从该客户点击该超链接到它接收到该对象需要多长时间？<br />
</p>

<p>
查询IP地址需要的时间为<br />
\[ RTT_1 + RTT_2 +\dotsb + RTT_n. \]<br />
</p>

<p>
建立TCP连接然后请求并接收对象需要的时间为<br />
\[ 2RTT_0. \]<br />
</p>

<p>
因此总时间为<br />
</p>

<p>
\[ 2RTT_0 + RTT_1 + RTT_2 +\dotsb + RTT_n. \]<br />
</p>
</div>
</div>

<div id="outline-container-orge56ee03" class="outline-4">
<h4 id="orge56ee03">P8</h4>
<div class="outline-text-4" id="text-orge56ee03">
<p>
参照习题P7，假定在同一服务器上某HTML文件引用了8个非常小的对象。忽略发送时间，在下列情况下需要多长时间：<br />
</p>
<ol class="org-ol">
<li>没有并行TCP连接的非持续HTTP。<br /></li>
<li>配置有5个并行连接的非持续HTTP。<br /></li>
<li>持续HTTP。<br /></li>
</ol>


<ol class="org-ol">
<li>\[ \sum_1^n RTT_k + 2RTT_0 + 8\times 2RTT_0. \]<br /></li>
<li>\[ \sum_1^n RTT_k + 2RTT_0 + \lceil \frac85 \rceil \times 2RTT_0. \]<br /></li>
<li>\[ \sum_1^n RTT_k + 2RTT_0 + 8RTT_0 \]<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org34e531b" class="outline-4">
<h4 id="org34e531b">P9</h4>
<div class="outline-text-4" id="text-org34e531b">
<p>
考虑图2-12，其中有一个机构的网络和因特网相连。假定对象的平均长度为850 000比特，从这个机构网的浏览器到初始服务器的平均请求率是每秒16个请求。还假定从接入链路的因特网一侧的路由器转发一个HTTP请求开始，到接收到其响应的平均时间是3秒（参见2.2.5节）。将总的平均响应时间建模为平均接人时延（即从因特网路由器到机构路由器的时延）和平均因特网时延之和。对于平均接入时延，使用Δ/(1-Δβ)，式中Δ是跨越接入链路发送一个对象的平均时间，β是对象对该接入链路的平均到达率。<br />
</p>
<ol class="org-ol">
<li>求出总的平均响应时间。<br /></li>
<li>现在假定在这个机构LAN中安装了一个缓存器。假定命中率为0.4，求出总的响应时间。<br /></li>
</ol>


<div id="orgae721dd" class="figure">
<p><img src="./img/fig2-12.png" alt="fig2-12.png" style="width:100%; max-width:300px;" /><br />
</p>
</div>

<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
\begin{align*}
  Δ &= L/R = 850kb/req ÷ 15Mbps ≈ 0.0567s/req, \\
  Δβ &= βL/R = \text{流量强度} = 16req/s × 0.0567s/req = 0.907, \\
  \text{平均响应时间} &= \text{平均接入时延} + \text{平均因特网时延} \\
  &= 0.0567/(1-0.907) + 3 \\
  &≈ 3.61s.
\end{align*}</li>
<li>命中的请求直接从缓存器获取，剩下需要流经英特网的流量强度为原来的0.6，这部分请求的平均接入时延为<br />
\[ 0.0567/(1-0.6×0.907) ≈ 0.124s. \]<br />
平均响应时间为<br />
\[ 0.124s + 3s = 3.124s. \]<br />
因此总的平均响应时间为<br />
\[ 3.124s×0.6 + 0.01s×0.4 = 1.878s. \]<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org02e964f" class="outline-4">
<h4 id="org02e964f">P10</h4>
<div class="outline-text-4" id="text-org02e964f">
<p>
考虑一条10米短链路，某发送方经过它能够以150bps速率双向传输。假定包含数据的分组是100 000比特长，仅包含控制（如ACK或握手）的分组是200比特长。假定N个并行连接每个都获得1/N的链路带宽。现在考虑HTTP协议，并且假定每个下载对象是1OOKb长，这些初始下载对象包含10个来自相同发送方的引用对象。在这种情况下，经非持续HTTP的并行实例的并行下载有意义吗？现在考虑持续HTTP。你期待这比非持续的情况有很大增益吗？评价并解释你的答案。<br />
</p>

<p>
10米的短链路可以忽略掉传播时延，采用非持续并行HTTP下载需要的时间为<br />
\[ 3 × 200÷150 + 100k÷150 + 3 × 200÷15 + 100k÷15 ≈ 7377s. \]<br />
</p>

<p>
采用持续HTTP下载需要的时间为<br />
\[ 2 × 200÷150 + 11 × (200÷150 + 100k÷150) = 7351s. \]<br />
</p>

<p>
非持续并行HTTP浪费的带宽是11个握手分组的RTT，而控制分组比较小，因此差异不大。<br />
</p>
</div>
</div>

<div id="outline-container-org01ac134" class="outline-4">
<h4 id="org01ac134">P11</h4>
<div class="outline-text-4" id="text-org01ac134">
<p>
考虑在前一个习题中引出的情况。现在假定该链路由Bob和4个其他用户所共享。Bob使用非持续HTTP的并行实例，而其他4个用户使用无并行下载的非待续HTTP。<br />
</p>
<ol class="org-ol">
<li>Bob的并行连接能够帮助他更快地得到Web页面吗？<br /></li>
<li>如果所有5个用户打开5个非持续HTTP并行实例，那么Bob的并行连接仍将是有好处的吗？为什么？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<ul class="org-ul">
<li>Bob不使用并行连接和其他4个用户同时下载，每个人的链路带宽是150bps÷5=50bps，因此需要的时间为<br /></li>
</ul>
<p>
\[ 11×(3×200÷50 + 100k÷50)=22132s. \]<br />
</p>
<ul class="org-ul">
<li>Bob使用5个并行连接时需要的时间为<br /></li>
</ul>
<p>
\[ 3×200÷50 + 100k÷50 + 2×(3×200÷16.7+100k÷16.7) ≈ 14060s. \]<br />
</p></li>
<li>是的，Bob获得的带宽 \(= \frac{\text{Bob的并行连接数}}{\text{总连接数}}×\text{总带宽}. \)<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org8b9a46d" class="outline-4">
<h4 id="org8b9a46d">P12</h4>
<div class="outline-text-4" id="text-org8b9a46d">
<p>
写一个简单的TCP程序，使服务器接收来自客户的行并将其打印在服务器的标准输出上。（可以通过修改本书中的TCPServer.py程序实现上述任务。）编译井执行你的程序。在另一台有浏览器的机器上，设置浏览器的代理服务器为你正在运行服务器程序的机器，同时适当地配笠端口号。这时你的浏览器向服务器发送GET请求报文，你的服务器应当在其标准输出上显示该报文。使用这个平台来确定你的浏览器是否对本地缓存的对象产生了条件GET报文。<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> socket <span class="org-keyword">import</span> *

<span class="org-variable-name">serverPort</span> = 12000
<span class="org-variable-name">serverSocket</span> = socket(AF_INET, SOCK_STREAM)
serverSocket.bind((<span class="org-string">''</span>, serverPort))
serverSocket.listen(1)
<span class="org-builtin">print</span>(<span class="org-string">'The server is ready to receive'</span>)
<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    <span class="org-variable-name">connectionSocket</span>, <span class="org-variable-name">addr</span> = serverSocket.accept()
    <span class="org-variable-name">sentence</span> = connectionSocket.recv(1024).decode()
    <span class="org-builtin">print</span>(sentence)
serverSocket.close()
</pre>
</div>
</div>
</div>

<div id="outline-container-org2062ee7" class="outline-4">
<h4 id="org2062ee7">P13</h4>
<div class="outline-text-4" id="text-org2062ee7">
<p>
SMTP中的MAIL FROM与该邮件报文自身中的From:之间有什么不同？<br />
</p>

<p>
SMTP中的MAIL FROM:是SMTP客户向SMTP服务器发送的信息，用于识别邮件的发送者。邮件信息上的From:本身不是SMTP信息，而只是邮件信息正文中的一行。<br />
</p>
</div>
</div>

<div id="outline-container-orgfcf0249" class="outline-4">
<h4 id="orgfcf0249">P14</h4>
<div class="outline-text-4" id="text-orgfcf0249">
<p>
SMTP是怎样标识一个报文体结束的？HTTP是怎样做的呢？HTTP能够使用与SMTP标识一个报文体结束相同的方法吗？试解释。<br />
</p>

<p>
SMTP：客户通过发送一个只包含一个句点的行，向服务器指示该报文结束了。<br />
HTTP：Content­Length:首部行指示了被发送对象中的字节数。<br />
不能使用相同的方法，因为HTTP消息可能包含二进制数据，而在SMTP中，消息体必须是7比特ASCII码格式。<br />
</p>
</div>
</div>

<div id="outline-container-orgb2d28fd" class="outline-4">
<h4 id="orgb2d28fd">P15</h4>
<div class="outline-text-4" id="text-orgb2d28fd">
<p>
阅读用于SMTP的RFC 5321。MTA代表什么？考虑下面收到的垃圾邮件（从一份真实垃圾邮件修改得到）。假定这封垃圾邮件的唯一始作佣者是恶意的，而其他主机是诚实的，指出产生了这封垃圾邮件的恶意主机。<br />
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>From - Fri Nov 07 13:41:30 2008
<span class="linenr"> 2: </span>Return-Path: <a href="mailto:tennis5%40pp33head.com">&lt;tennis5@pp33head.com&gt;</a>
<span class="linenr"> 3: </span>Received: from barmail.cs.umass.edu (barmail.cs.umass.edu [128.119.240.3]) by cs.umass.edu (8.13.1/8.12.6) <span class="org-keyword">for</span> <a href="mailto:hg%40cs.umass.edu">&lt;hg@cs.umass.edu&gt;</a>; Fri, 7 Nov 2008 13:27:10 -0500
<span class="linenr"> 4: </span>Received: from asusus-4b96 (localhost [127.0.0.1]) by barmail.cs.umass.edu (Spam Firewall) <span class="org-keyword">for</span> <a href="mailto:hg%40cs.umass.edu">&lt;hg@cs.umass.edu&gt;</a>; Fri, 7 Nov 2008 13:27:07 -0500 (EST)
<span id="coderef-2" class="coderef-off"><span class="linenr"> 5: </span>Received: from asusus-4b96 ([58.88.21.177]) by barmail.cs.umass.edu for <a href="mailto:hg%40cs.umass.edu">&lt;hg@cs.umass.edu&gt;</a>; Fri, 07 Nov 2008 13:27:07 -0500 (EST) (2)</span>
<span id="coderef-1" class="coderef-off"><span class="linenr"> 6: </span>Received: from [58.88.21.177] by inbnd55.exchangeddd.com; Sat, 8 Nov 2008 01:27:07 +0700 (1)</span>
<span class="linenr"> 7: </span>From: &#8221;Jonny&#8221; <a href="mailto:tennis5%40pp33head.com">&lt;tennis5@pp33head.com&gt;</a>
<span class="linenr"> 8: </span>To: <a href="mailto:hg%40cs.umass.edu">&lt;hg@cs.umass.edu&gt;</a>
<span class="linenr"> 9: </span>
<span class="linenr">10: </span>Subject: How to secure your savings
</pre>
</div>

<p>
SMTP servers and clients provide a mail transport service and therefore act as "Mail Transfer Agents" (MTAs). --<a href="https://datatracker.ietf.org/doc/html/rfc5321#section-2.3.3">RFC 5321 2.3.3</a><br />
</p>

<p>
<a href="https://helpspot.pobox.com/index.php?pg=kb.page&amp;id=253">The elements of a Received: header</a><br />
</p>

<ul class="org-ul">
<li><b>Received: from</b><br /></li>
<li><span class="underline">the name the sending computer gave for itself</span> ( <span class="underline">the name associated with that computer's IP address</span> [its IP address])<br /></li>
<li><b>by</b><br /></li>
<li>the receiving computer's name (the software that computer uses)<br /></li>
<li><b>with</b> protocol<br /></li>
<li><b>id</b> id assigned by local computer for logging;<br /></li>
<li>timestamp<br /></li>
</ul>


<p>
The elements in <b>bold</b> are the literal words in the header. The <span class="underline">underlined</span> elements are the ones that can be manipulated by spammers and scammers.<br />
</p>

<p>
正常情况下，第<a href="#coderef-1" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-1');" onmouseout="CodeHighlightOff(this, 'coderef-1');">1</a>条记录的接收方 <code>inbnd55.exchangeddd.com</code> 应该是第<a href="#coderef-2" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-2');" onmouseout="CodeHighlightOff(this, 'coderef-2');">2</a>条的发送方。但实际情况是，第二条的发送方是 <code>asusus-4b96</code> ，这个 <code>asusus-4b96</code> 隐藏了自己的发送方。因此，这个 <code>asusus-4b96</code> 就是垃圾邮件的作者。<br />
</p>
</div>
</div>

<div id="outline-container-orgbd6fe08" class="outline-4">
<h4 id="orgbd6fe08">P16</h4>
<div class="outline-text-4" id="text-orgbd6fe08">
<p>
阅读POP3的RFC，即RFC 1939。UIDL POP3命令的目的是什么？<br />
</p>

<blockquote>
<p>
The unique-id of a message is an arbitrary server-determined string which uniquely identifies a message within a maildrop and which persists across sessions.<br />
</p>

<p>
While it is generally preferable for server implementations to store arbitrarily assigned unique-ids in the maildrop, this specification is intended to permit unique-ids to be calculated as a hash of the message.<br />
&#x2013; <a href="https://www.ietf.org/rfc/rfc1939.txt">RFC 1939</a><br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgae11780" class="outline-4">
<h4 id="orgae11780">P17</h4>
<div class="outline-text-4" id="text-orgae11780">
<p>
考虑用POP3访问你的电子邮件。<br />
</p>

<ol class="org-ol">
<li><p>
假定你已经配置以下载并删除模式运行的POP邮件客户。完成下列事务：<br />
</p>
<div class="org-src-container">
<pre class="src src-sh">C: list
S: 1 498
S: 2 912
S: .
C: retr 1
S: blah blah ...
S: ..........blah
S: .
?
?
</pre>
</div></li>

<li><p>
假定你已经配置以下载并保持模式运行的POP邮件客户。完成下列事务：<br />
</p>
<div class="org-src-container">
<pre class="src src-sh">C: list
S: 1 498
S: 2 912
S: .
C: retr 1
S: blah blah ...
S: ..........blah
S: .
&#65311;
&#65311;
</pre>
</div></li>

<li>假定你已经配置以下载并保持模式运行的POP邮件客户。使用（2）中的记录，假定你检索报文1和2，退出POP，5分钟以后，你再访问POP以检索新电子邮件。假定在这5分钟间隔内，没有新报文发送给你。给出第二种POP会话的记录。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org97c69b3" class="outline-4">
<h4 id="org97c69b3">P18</h4>
<div class="outline-text-4" id="text-org97c69b3">
<p>
如题:<br />
</p>
<ol class="org-ol">
<li>什么是whois数据库？<br /></li>
<li>使用因特网上的各种whois数据库，获得两台DNS服务器的名字。指出你使用的是哪个whois数据库。<br /></li>
<li>你本地机器上使用nslookup向3台DNS服务器发送DNS查询：你的本地DNS服务器和两台你在（2）中发现的DNS服务器。尝试对类型A、NS和MX报告进行查询。总结你的发现。<br /></li>
<li>使用nslookup找出一台具有多个IP地址的Web服务器。你所在的机构（学校或公司）的Web服务器具有多个IP地址吗？<br /></li>
<li>使用ARIN whois数据库，确定你所在大学使用的IP地址范围。<br /></li>
<li>描述一个攻击者在发动攻击前，能够怎样利用whois数据库和nslookup工具来执行对一个机构的侦察。<br /></li>
<li>讨论为什么whois数据库应当为公众所用。<br /></li>
</ol>


<ol class="org-ol">
<li>WHOIS is a query and response protocol that is widely used for querying databases that store the registered users or assignees of an Internet resource, such as a domain name, an IP address block or an autonomous system, but is also used for a wider range of other information. The protocol stores and delivers database content in a human-readable format.[1] The current iteration of the WHOIS protocol was drafted by the Internet Society, and is documented in RFC 3912. --<a href="https://en.wikipedia.org/wiki/WHOIS">WHOIS From Wikipedia</a><br /></li>
<li>NS07.DOMAINCONTROL.COM NS1.QQ.COM whois.cloud.tencent.com/domain<br /></li>
<li><p>
&#x00ad;<br />
<a href="https://www.cnblogs.com/EasonJim/p/10017100.html">域名DNS解析工具ping/nslookup/dig/host</a><br />
</p>
<div class="org-src-container">
<pre class="src src-sh">% host -t A 163.com
163.com has address 198.18.5.96
% host -t NS 163.com
163.com name server ns1.nease.net.
163.com name server ns8.166.com.
163.com name server ns5.nease.net.
163.com name server ns4.nease.net.
163.com name server ns6.nease.net.
163.com name server ns3.nease.net.
163.com name server ns2.166.com.
% host -t MX 163.com
163.com mail is handled by 50 163mx00.mxmail.netease.com.
163.com mail is handled by 10 163mx02.mxmail.netease.com.
163.com mail is handled by 10 163mx01.mxmail.netease.com.
163.com mail is handled by 10 163mx03.mxmail.netease.com.
% host -t A 163.com ns1.qq.com
Using domain server:
Name: ns1.qq.com
Address: 198.18.5.121#53
Aliases:

Host 163.com not found: 5(REFUSED)
</pre>
</div></li>
<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-sh">% dig amazon.com

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; amazon.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 42497
<span class="org-sh-heredoc">;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 6, ADDITIONAL: 8</span>

<span class="org-sh-heredoc">;; QUESTION SECTION:</span>
<span class="org-sh-heredoc">;amazon.com.      IN  A</span>

<span class="org-sh-heredoc">;; ANSWER SECTION:</span>
<span class="org-sh-heredoc">amazon.com.   401 IN  A 54.239.28.85</span>
<span class="org-sh-heredoc">amazon.com.   401 IN  A 176.32.103.205</span>
<span class="org-sh-heredoc">amazon.com.   401 IN  A 205.251.242.103</span>

<span class="org-sh-heredoc">;; AUTHORITY SECTION:</span>
<span class="org-sh-heredoc">amazon.com.   2784  IN  NS  pdns1.ultradns.net.</span>
<span class="org-sh-heredoc">amazon.com.   2784  IN  NS  ns2.p31.dynect.net.</span>
<span class="org-sh-heredoc">amazon.com.   2784  IN  NS  ns1.p31.dynect.net.</span>
<span class="org-sh-heredoc">amazon.com.   2784  IN  NS  ns4.p31.dynect.net.</span>
<span class="org-sh-heredoc">amazon.com.   2784  IN  NS  ns3.p31.dynect.net.</span>
<span class="org-sh-heredoc">amazon.com.   2784  IN  NS  pdns6.ultradns.co.uk.</span>

<span class="org-sh-heredoc">;; ADDITIONAL SECTION:</span>
<span class="org-sh-heredoc">pdns1.ultradns.net. 2414  IN  A 204.74.108.1</span>
<span class="org-sh-heredoc">ns4.p31.dynect.net. 85678 IN  A 204.13.251.31</span>
<span class="org-sh-heredoc">ns3.p31.dynect.net. 84329 IN  A 208.78.71.31</span>
<span class="org-sh-heredoc">ns2.p31.dynect.net. 85270 IN  A 204.13.250.31</span>
<span class="org-sh-heredoc">ns1.p31.dynect.net. 79027 IN  A 208.78.70.31</span>
<span class="org-sh-heredoc">pdns6.ultradns.co.uk. 2740  IN  A 204.74.115.1</span>
<span class="org-sh-heredoc">pdns1.ultradns.net. 2367  IN  AAAA  2001:502:f3ff::1</span>
<span class="org-sh-heredoc">pdns6.ultradns.co.uk. 3016  IN  AAAA  2610:a1:1017::1</span>

<span class="org-sh-heredoc">;; Query time: 2 msec</span>
<span class="org-sh-heredoc">;; SERVER: 192.168.2.1#53(192.168.2.1)</span>
<span class="org-sh-heredoc">;; WHEN: Thu Jul 29 11:13:51 CST 2021</span>
<span class="org-sh-heredoc">;; MSG SIZE  rcvd: 377</span>

<span class="org-sh-heredoc">%</span>
</pre>
</div></li>
<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-sh">$ whois 128.2.10.163
% IANA WHOIS server
% for more information on IANA, visit http://www.iana.org
% This query returned 1 object

refer:        whois.arin.net

inetnum:      128.0.0.0 - 128.255.255.255
organisation: Administered by ARIN
status:       LEGACY

whois:        whois.arin.net

changed:      1993-05
<span class="org-builtin">source</span>:       IANA

<span class="org-comment-delimiter"># </span><span class="org-comment">whois.arin.net</span>

NetRange:       128.2.0.0 - 128.2.255.255
CIDR:           128.2.0.0/16
NetName:        CMU-NET
NetHandle:      NET-128-2-0-0-1
Parent:         NET128 (NET-128-0-0-0-0)
NetType:        Direct Assignment
OriginAS:       AS9
Organization:   Carnegie Mellon University (CARNEG-Z)
RegDate:        1984-04-17
Updated:        2012-04-02
Ref:            https://rdap.arin.net/registry/ip/128.2.0.0


OrgName:        Carnegie Mellon University
OrgId:          CARNEG-Z
Address:        Cyert Hall 215
Address:        5000 Forbes Avenue
City:           Pittsburgh
StateProv:      PA
PostalCode:     15213
Country:        US
RegDate:        2009-12-01
Updated:        2020-03-27
Ref:            https://rdap.arin.net/registry/entity/CARNEG-Z
</pre>
</div></li>
<li>攻击者可以使用whois数据库和nslookup工具来确定目标机构的IP地址范围、DNS服务器地址等。<br /></li>
<li>通过分析攻击数据包的源地址，受害者可以使用whois来获得攻击来自的域的信息，并可能通知源域的管理员。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orge572725" class="outline-4">
<h4 id="orge572725">P19</h4>
<div class="outline-text-4" id="text-orge572725">
<p>
在本习题中，我们使用在Unix和Linux主机上可用的dig工具来探索DNS服务器的等级结构。图2-18讲过，在DNS等级结构中较高的DNS服务器授权对该等级结构中较低DNS服务器的DNS请求，这是通过向DNS客户发送回那台较低层次的DNS服务器的名字来实现的。先阅读dig的帮助页，再回答下列问题。<br />
</p>
<ol class="org-ol">
<li>从一台根DNS服务器（从根服务器[a-m].root-server.net之一）开始，通过使用dig得到你所在系的Web服务器的IP地址，发起一系列查询。显示回答你的查询的授权链中的DNS服务器的名字列表。<br /></li>
<li>对几个流行Web站点如google.com、yahoo.com或amazon.com，重复上一小题。<br /></li>
</ol>



<div id="org3514580" class="figure">
<p><img src="./img/fig2-18.png" alt="fig2-18.png" style="width:100%; max-width:300px;" /><br />
</p>
</div>

<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-sh">% dig shichaoxia.com +trace

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; shichaoxia.com +trace
;; global options: +cmd
   .      85537 IN  NS  i.root-servers.net.
   .      85537 IN  NS  a.root-servers.net.
   .      85537 IN  NS  l.root-servers.net.
   .      85537 IN  NS  m.root-servers.net.
   .      85537 IN  NS  g.root-servers.net.
   .      85537 IN  NS  h.root-servers.net.
   .      85537 IN  NS  f.root-servers.net.
   .      85537 IN  NS  d.root-servers.net.
   .      85537 IN  NS  c.root-servers.net.
   .      85537 IN  NS  j.root-servers.net.
   .      85537 IN  NS  e.root-servers.net.
   .      85537 IN  NS  k.root-servers.net.
   .      85537 IN  NS  b.root-servers.net.
;; Received 811 bytes from 192.168.2.1#53(192.168.2.1) <span class="org-keyword">in</span> 1 ms

   com.     172800  IN  NS  a.gtld-servers.net.
   com.     172800  IN  NS  b.gtld-servers.net.
   com.     172800  IN  NS  c.gtld-servers.net.
   com.     172800  IN  NS  d.gtld-servers.net.
   com.     172800  IN  NS  e.gtld-servers.net.
   com.     172800  IN  NS  f.gtld-servers.net.
   com.     172800  IN  NS  g.gtld-servers.net.
   com.     172800  IN  NS  h.gtld-servers.net.
   com.     172800  IN  NS  i.gtld-servers.net.
   com.     172800  IN  NS  j.gtld-servers.net.
   com.     172800  IN  NS  k.gtld-servers.net.
   com.     172800  IN  NS  l.gtld-servers.net.
   com.     172800  IN  NS  m.gtld-servers.net.
   com.     86400 IN  DS  30909 8 2 E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766
   com.     86400 IN  RRSIG DS 8 1 86400 20210810150000 20210728140000 26838 . hduKd0LYz1zToFQsR5rzy3/EVMy9u018rmjgVwmah+FNUnDtOXTnlNtH 7RgifGSTcfLyZzkbHtiFr3LAjZ7SusPNcNZ9JN3/W+VBK+bIBVl3HLm2 2jYLCOWXwzcj6Eh9Ns02Bb18z19YiGjaUqTCnXrNu/xVsboS3snb39Zh kPeqpooTuLzhXXGyBFtujNb0ylqr04hPajlbGt0L+y9xtdpb0wdw6VC1 OYcRDOOOs4fcMmUQQljKEXOJDFx8ZOkRl+IQgmhNVUExTusm4VOvWJCt owRUQzsKmdkM6Zjt9j+NbiQtaaP1QKY+IKvB8rmb0XviFmRkGgMWipc4 <span class="org-variable-name">CMYAdQ</span>==
;; Received 1174 bytes from 199.9.14.201#53(b.root-servers.net) <span class="org-keyword">in</span> 429 ms

   shichaoxia.com.    172800  IN  NS  ns07.domaincontrol.com.
   shichaoxia.com.    172800  IN  NS  ns08.domaincontrol.com.
   CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN NSEC3 1 1 0 - CK0Q1GIN43N1ARRC9OSM6QPQR81H5M9A  NS SOA RRSIG DNSKEY NSEC3PARAM
   CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN RRSIG NSEC3 8 2 86400 20210804042506 20210728031506 39343 com. JbHorESe6bPfTnE7XaDClJq8MAv0wq1AxJO/4JZCLV4iyV5qEMZF1UZp bun8Fu5VHLDxq5aK7PG8AN868DEpCCcCPW6e6ZBfrAvW/5/nsYTJVrog 5xRaHuDwkV90iJpTdKxO1z7kfL8t4cMoAZofS5Idekfg0zNPMZvmnuuf JTTXbLDTzmfgGn/SJDPRA2mn6Coxn14IwaP32yLViHKgpQ==
   7M0BP9VTEHA5TC2H5VRLQ3QV3PB8OV9L.com. 86400 IN NSEC3 1 1 0 - 7M0CLFBKS8DDVS9RV7TU06AL3VQP3C8R  NS DS RRSIG
   7M0BP9VTEHA5TC2H5VRLQ3QV3PB8OV9L.com. 86400 IN RRSIG NSEC3 8 2 86400 20210804051749 20210728040749 39343 com. Dw2TH+tAqcuS8sMe4waYysa4LaX7pWg7fCMTWT2agS956wJt/ICnpwpi biwoCAHcjSUrTmDc91/WI4KoqEiyU3BNGh/afnX7TG1hx5XFc8ifv1MU pj5ZlPb0PfDnq1ItmN2msmr4nKNiJ7gCardn1teWs/ZzvpCeuMQ42I+m <span class="org-variable-name">jw4bV154cbS9WFv0AG52RoweTdtM9zaUGEoNVi1HHNO3Dg</span>==
;; Received 732 bytes from 192.41.162.30#53(l.gtld-servers.net) <span class="org-keyword">in</span> 188 ms

   shichaoxia.com.    600 IN  A 34.102.136.180
   shichaoxia.com.    3600  IN  NS  ns08.domaincontrol.com.
   shichaoxia.com.    3600  IN  NS  ns07.domaincontrol.com.
;; Received 111 bytes from 173.201.71.4#53(ns08.domaincontrol.com) <span class="org-keyword">in</span> 181 ms

   %
</pre>
</div></li>

<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-sh">% dig google.com +trace

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; google.com +trace
;; global options: +cmd
   .      85351 IN  NS  i.root-servers.net.
   .      85351 IN  NS  a.root-servers.net.
   .      85351 IN  NS  l.root-servers.net.
   .      85351 IN  NS  m.root-servers.net.
   .      85351 IN  NS  g.root-servers.net.
   .      85351 IN  NS  h.root-servers.net.
   .      85351 IN  NS  f.root-servers.net.
   .      85351 IN  NS  d.root-servers.net.
   .      85351 IN  NS  c.root-servers.net.
   .      85351 IN  NS  j.root-servers.net.
   .      85351 IN  NS  e.root-servers.net.
   .      85351 IN  NS  k.root-servers.net.
   .      85351 IN  NS  b.root-servers.net.
;; Received 811 bytes from 192.168.2.1#53(192.168.2.1) <span class="org-keyword">in</span> 2 ms

   com.     172800  IN  NS  a.gtld-servers.net.
   com.     172800  IN  NS  b.gtld-servers.net.
   com.     172800  IN  NS  c.gtld-servers.net.
   com.     172800  IN  NS  d.gtld-servers.net.
   com.     172800  IN  NS  e.gtld-servers.net.
   com.     172800  IN  NS  f.gtld-servers.net.
   com.     172800  IN  NS  g.gtld-servers.net.
   com.     172800  IN  NS  h.gtld-servers.net.
   com.     172800  IN  NS  i.gtld-servers.net.
   com.     172800  IN  NS  j.gtld-servers.net.
   com.     172800  IN  NS  k.gtld-servers.net.
   com.     172800  IN  NS  l.gtld-servers.net.
   com.     172800  IN  NS  m.gtld-servers.net.
   com.     86400 IN  DS  30909 8 2 E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766
   com.     86400 IN  RRSIG DS 8 1 86400 20210810150000 20210728140000 26838 . hduKd0LYz1zToFQsR5rzy3/EVMy9u018rmjgVwmah+FNUnDtOXTnlNtH 7RgifGSTcfLyZzkbHtiFr3LAjZ7SusPNcNZ9JN3/W+VBK+bIBVl3HLm2 2jYLCOWXwzcj6Eh9Ns02Bb18z19YiGjaUqTCnXrNu/xVsboS3snb39Zh kPeqpooTuLzhXXGyBFtujNb0ylqr04hPajlbGt0L+y9xtdpb0wdw6VC1 OYcRDOOOs4fcMmUQQljKEXOJDFx8ZOkRl+IQgmhNVUExTusm4VOvWJCt owRUQzsKmdkM6Zjt9j+NbiQtaaP1QKY+IKvB8rmb0XviFmRkGgMWipc4 <span class="org-variable-name">CMYAdQ</span>==
;; Received 1170 bytes from 199.7.83.42#53(l.root-servers.net) <span class="org-keyword">in</span> 24 ms

   google.com.    60  IN  A 8.7.198.46
;; Received 54 bytes from 192.41.162.30#53(l.gtld-servers.net) <span class="org-keyword">in</span> 13 ms

   % dig yahoo.com +trace

   ; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; yahoo.com +trace
;; global options: +cmd
   .      85332 IN  NS  i.root-servers.net.
   .      85332 IN  NS  a.root-servers.net.
   .      85332 IN  NS  l.root-servers.net.
   .      85332 IN  NS  m.root-servers.net.
   .      85332 IN  NS  g.root-servers.net.
   .      85332 IN  NS  h.root-servers.net.
   .      85332 IN  NS  f.root-servers.net.
   .      85332 IN  NS  d.root-servers.net.
   .      85332 IN  NS  c.root-servers.net.
   .      85332 IN  NS  j.root-servers.net.
   .      85332 IN  NS  e.root-servers.net.
   .      85332 IN  NS  k.root-servers.net.
   .      85332 IN  NS  b.root-servers.net.
;; Received 811 bytes from 192.168.2.1#53(192.168.2.1) <span class="org-keyword">in</span> 3 ms

   com.     172800  IN  NS  a.gtld-servers.net.
   com.     172800  IN  NS  b.gtld-servers.net.
   com.     172800  IN  NS  c.gtld-servers.net.
   com.     172800  IN  NS  d.gtld-servers.net.
   com.     172800  IN  NS  e.gtld-servers.net.
   com.     172800  IN  NS  f.gtld-servers.net.
   com.     172800  IN  NS  g.gtld-servers.net.
   com.     172800  IN  NS  h.gtld-servers.net.
   com.     172800  IN  NS  i.gtld-servers.net.
   com.     172800  IN  NS  j.gtld-servers.net.
   com.     172800  IN  NS  k.gtld-servers.net.
   com.     172800  IN  NS  l.gtld-servers.net.
   com.     172800  IN  NS  m.gtld-servers.net.
   com.     86400 IN  DS  30909 8 2 E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766
   com.     86400 IN  RRSIG DS 8 1 86400 20210810150000 20210728140000 26838 . hduKd0LYz1zToFQsR5rzy3/EVMy9u018rmjgVwmah+FNUnDtOXTnlNtH 7RgifGSTcfLyZzkbHtiFr3LAjZ7SusPNcNZ9JN3/W+VBK+bIBVl3HLm2 2jYLCOWXwzcj6Eh9Ns02Bb18z19YiGjaUqTCnXrNu/xVsboS3snb39Zh kPeqpooTuLzhXXGyBFtujNb0ylqr04hPajlbGt0L+y9xtdpb0wdw6VC1 OYcRDOOOs4fcMmUQQljKEXOJDFx8ZOkRl+IQgmhNVUExTusm4VOvWJCt owRUQzsKmdkM6Zjt9j+NbiQtaaP1QKY+IKvB8rmb0XviFmRkGgMWipc4 <span class="org-variable-name">CMYAdQ</span>==
;; Received 1169 bytes from 198.97.190.53#53(h.root-servers.net) <span class="org-keyword">in</span> 314 ms

   yahoo.com.   172800  IN  NS  ns1.yahoo.com.
   yahoo.com.   172800  IN  NS  ns5.yahoo.com.
   yahoo.com.   172800  IN  NS  ns2.yahoo.com.
   yahoo.com.   172800  IN  NS  ns3.yahoo.com.
   yahoo.com.   172800  IN  NS  ns4.yahoo.com.
   CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN NSEC3 1 1 0 - CK0Q1GIN43N1ARRC9OSM6QPQR81H5M9A  NS SOA RRSIG DNSKEY NSEC3PARAM
   CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN RRSIG NSEC3 8 2 86400 20210804042506 20210728031506 39343 com. JbHorESe6bPfTnE7XaDClJq8MAv0wq1AxJO/4JZCLV4iyV5qEMZF1UZp bun8Fu5VHLDxq5aK7PG8AN868DEpCCcCPW6e6ZBfrAvW/5/nsYTJVrog 5xRaHuDwkV90iJpTdKxO1z7kfL8t4cMoAZofS5Idekfg0zNPMZvmnuuf JTTXbLDTzmfgGn/SJDPRA2mn6Coxn14IwaP32yLViHKgpQ==
   GPIOQSOL8RGEVQ13DFAMNDNPA5VTHUEJ.com. 86400 IN NSEC3 1 1 0 - GPIOVE5CC3CA0D1H14G1GI4J0835GEKB  NS DS RRSIG
   GPIOQSOL8RGEVQ13DFAMNDNPA5VTHUEJ.com. 86400 IN RRSIG NSEC3 8 2 86400 20210804051835 20210728040835 39343 com. lfzIQ5PC5O6qeiPxT8aSGHK1ITV0efIye01IZxkAxpZa8l7fzND2tQ9t RFt3ZXuFg0I5nvTja3yIoHNZII99h1/gkSrWBhJ4Cw5Zg7kP/pUUpErB 37DM4/6S8uhoskX2qSpVJBikE1VT04rA0wR5iu/Rjoj9QQVDmf/KFMNR R9RLtVEyIxK6FW+<span class="org-variable-name">Tih8ePbTuygmOFB2AMxqoIo4J3ktCaw</span>==
;; Received 869 bytes from 192.54.112.30#53(h.gtld-servers.net) <span class="org-keyword">in</span> 208 ms

   yahoo.com.   1800  IN  A 74.6.143.26
   yahoo.com.   1800  IN  A 74.6.231.21
   yahoo.com.   1800  IN  A 74.6.231.20
   yahoo.com.   1800  IN  A 98.137.11.163
   yahoo.com.   1800  IN  A 74.6.143.25
   yahoo.com.   1800  IN  A 98.137.11.164
   yahoo.com.   172800  IN  NS  ns1.yahoo.com.
   yahoo.com.   172800  IN  NS  ns2.yahoo.com.
   yahoo.com.   172800  IN  NS  ns3.yahoo.com.
   yahoo.com.   172800  IN  NS  ns4.yahoo.com.
   yahoo.com.   172800  IN  NS  ns5.yahoo.com.
;; Received 416 bytes from 68.180.131.16#53(ns1.yahoo.com) <span class="org-keyword">in</span> 171 ms

   % dig amazon.com +trace

   ; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; amazon.com +trace
;; global options: +cmd
   .      85286 IN  NS  i.root-servers.net.
   .      85286 IN  NS  a.root-servers.net.
   .      85286 IN  NS  l.root-servers.net.
   .      85286 IN  NS  m.root-servers.net.
   .      85286 IN  NS  g.root-servers.net.
   .      85286 IN  NS  h.root-servers.net.
   .      85286 IN  NS  f.root-servers.net.
   .      85286 IN  NS  d.root-servers.net.
   .      85286 IN  NS  c.root-servers.net.
   .      85286 IN  NS  j.root-servers.net.
   .      85286 IN  NS  e.root-servers.net.
   .      85286 IN  NS  k.root-servers.net.
   .      85286 IN  NS  b.root-servers.net.
;; Received 811 bytes from 192.168.2.1#53(192.168.2.1) <span class="org-keyword">in</span> 10 ms

   com.     172800  IN  NS  a.gtld-servers.net.
   com.     172800  IN  NS  b.gtld-servers.net.
   com.     172800  IN  NS  c.gtld-servers.net.
   com.     172800  IN  NS  d.gtld-servers.net.
   com.     172800  IN  NS  e.gtld-servers.net.
   com.     172800  IN  NS  f.gtld-servers.net.
   com.     172800  IN  NS  g.gtld-servers.net.
   com.     172800  IN  NS  h.gtld-servers.net.
   com.     172800  IN  NS  i.gtld-servers.net.
   com.     172800  IN  NS  j.gtld-servers.net.
   com.     172800  IN  NS  k.gtld-servers.net.
   com.     172800  IN  NS  l.gtld-servers.net.
   com.     172800  IN  NS  m.gtld-servers.net.
   com.     86400 IN  DS  30909 8 2 E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766
   com.     86400 IN  RRSIG DS 8 1 86400 20210810150000 20210728140000 26838 . hduKd0LYz1zToFQsR5rzy3/EVMy9u018rmjgVwmah+FNUnDtOXTnlNtH 7RgifGSTcfLyZzkbHtiFr3LAjZ7SusPNcNZ9JN3/W+VBK+bIBVl3HLm2 2jYLCOWXwzcj6Eh9Ns02Bb18z19YiGjaUqTCnXrNu/xVsboS3snb39Zh kPeqpooTuLzhXXGyBFtujNb0ylqr04hPajlbGt0L+y9xtdpb0wdw6VC1 OYcRDOOOs4fcMmUQQljKEXOJDFx8ZOkRl+IQgmhNVUExTusm4VOvWJCt owRUQzsKmdkM6Zjt9j+NbiQtaaP1QKY+IKvB8rmb0XviFmRkGgMWipc4 <span class="org-variable-name">CMYAdQ</span>==
;; Received 1170 bytes from 192.58.128.30#53(j.root-servers.net) <span class="org-keyword">in</span> 209 ms

   amazon.com.    172800  IN  NS  pdns1.ultradns.net.
   amazon.com.    172800  IN  NS  pdns6.ultradns.co.uk.
   amazon.com.    172800  IN  NS  ns1.p31.dynect.net.
   amazon.com.    172800  IN  NS  ns3.p31.dynect.net.
   amazon.com.    172800  IN  NS  ns2.p31.dynect.net.
   amazon.com.    172800  IN  NS  ns4.p31.dynect.net.
   CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN NSEC3 1 1 0 - CK0Q1GIN43N1ARRC9OSM6QPQR81H5M9A  NS SOA RRSIG DNSKEY NSEC3PARAM
   CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN RRSIG NSEC3 8 2 86400 20210804042506 20210728031506 39343 com. JbHorESe6bPfTnE7XaDClJq8MAv0wq1AxJO/4JZCLV4iyV5qEMZF1UZp bun8Fu5VHLDxq5aK7PG8AN868DEpCCcCPW6e6ZBfrAvW/5/nsYTJVrog 5xRaHuDwkV90iJpTdKxO1z7kfL8t4cMoAZofS5Idekfg0zNPMZvmnuuf JTTXbLDTzmfgGn/SJDPRA2mn6Coxn14IwaP32yLViHKgpQ==
   K200LV67UEV5N6PKCVAFB6LH7AOATTMA.com. 86400 IN NSEC3 1 1 0 - K201DAGIUALSSFGADN4DHE7N9Q0IROJ1  NS DS RRSIG
   K200LV67UEV5N6PKCVAFB6LH7AOATTMA.com. 86400 IN RRSIG NSEC3 8 2 86400 20210803043037 20210727032037 39343 com. MbOTx4oAy7msW5CJarPQ61lDToMsXW7oeYigQrUtGjyV0BXcLz4FJbNy 3TwrjB3z63hFUw433Jda4RGzCmQ5xAtTjL64govMb2TIkOg9vJkYxpvZ NiOOICNsRbPShiQnuc9OZTikoKYp+wt1FGJTDnLZDE04CLQn1eKau+EM sL0tOdi1oVZN1qRdiGJpp4vnFa6udXczQroK5h/HRooyYw==
;; Received 737 bytes from 192.52.178.30#53(k.gtld-servers.net) <span class="org-keyword">in</span> 184 ms

   amazon.com.    60  IN  A 205.251.242.103
   amazon.com.    60  IN  A 176.32.103.205
   amazon.com.    60  IN  A 54.239.28.85
   amazon.com.    3600  IN  NS  ns4.p31.dynect.net.
   amazon.com.    3600  IN  NS  ns3.p31.dynect.net.
   amazon.com.    3600  IN  NS  pdns6.ultradns.co.uk.
   amazon.com.    3600  IN  NS  ns1.p31.dynect.net.
   amazon.com.    3600  IN  NS  ns2.p31.dynect.net.
   amazon.com.    3600  IN  NS  pdns1.ultradns.net.
;; Received 239 bytes from 208.78.70.31#53(ns1.p31.dynect.net) <span class="org-keyword">in</span> 328 ms

   %
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org78df085" class="outline-4">
<h4 id="org78df085">P20</h4>
<div class="outline-text-4" id="text-org78df085">
<p>
假定你能够访问所在系的本地DNS服务器中的缓存。你能够提出一种方法来粗略地确定在你所在系的用户中最为流行的Web服务器（你所在系以外）吗？解释原因。<br />
</p>
<blockquote>
<p>
我们可以定期对本地DNS服务器中的DNS缓存进行快照。在DNS缓存中出现频率最高的Web服务器是最受欢迎的服务器。这是因为如果有更多的用户对某个网络服务器感兴趣，那么用户对该服务器的DNS请求就会更频繁地发送。因此，该网络服务器将更频繁地出现在DNS缓存中。<br />
</p>

<p>
<a href="https://conferences.sigcomm.org/imc/2003/papers/p311-wills1.pdf">Wills, Craig E., Mikhail Mikhailov, and Hao Shang. "Inferring relative popularity of internet applications by actively querying dns caches." Proceedings of the 3rd ACM SIGCOMM conference on Internet measurement. 2003.</a><br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org8d56cc6" class="outline-4">
<h4 id="org8d56cc6">P21</h4>
<div class="outline-text-4" id="text-org8d56cc6">
<p>
假设你所在系具有一台用于系里所有计算机的本地DNS服务器。你是普通用户（即你不是网络/系统管理员）。你能够确定是否在几秒前从你系里的一台计算机可能访问过一台外部Web站点吗？解释原因。<br />
</p>

<blockquote>
<p>
是的，我们可以用dig来查询本地DNS服务器中的那个网站。<br />
</p>

<p>
例如，"dig cnn.com"将返回找到cnn.com的查询时间。如果cnn.com在几秒钟前刚被访问过，那么cnn.com的条目就被缓存在本地DNS缓存中，所以查询时间为0毫秒。否则，查询时间就会很大。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org10361d0" class="outline-4">
<h4 id="org10361d0">P22</h4>
<div class="outline-text-4" id="text-org10361d0">
<p>
考虑向N个对等方分发F=15Gb的一个文件。该服务器具有u<sub>s</sub>=30Mbps的上载速率，每个对等方具有d<sub>i</sub>=2Mbps的下载速率和上载速率u。对于N=10、100和1000并且u=300kbps、700kbps和2Mbps，对于N和u的每种组合绘制出确定最小分发时间的图表。需要分别针对客户-服务器分发和P2P分发两种情况制作。<br />
</p>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> 客户-服务器分发时间（s）</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">N \ u(kbps)</th>
<th scope="col" class="org-right">300</th>
<th scope="col" class="org-right">700</th>
<th scope="col" class="org-right">20000</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">10</td>
<td class="org-right">7500</td>
<td class="org-right">7500</td>
<td class="org-right">7500</td>
</tr>

<tr>
<td class="org-right">100</td>
<td class="org-right">50000</td>
<td class="org-right">50000</td>
<td class="org-right">50000</td>
</tr>

<tr>
<td class="org-right">1000</td>
<td class="org-right">500000</td>
<td class="org-right">500000</td>
<td class="org-right">500000</td>
</tr>
</tbody>
</table>

<p>
N=10,u=300kbps时，D=max{10×15Gb/30Mbps,15Gb/2Mbps}=7500s<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 2:</span> P2P分发时间（s）</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">N \ u(kbps)</th>
<th scope="col" class="org-right">300</th>
<th scope="col" class="org-right">700</th>
<th scope="col" class="org-right">20000</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">10</td>
<td class="org-right">7500</td>
<td class="org-right">7500</td>
<td class="org-right">7500</td>
</tr>

<tr>
<td class="org-right">100</td>
<td class="org-right">25000</td>
<td class="org-right">15000</td>
<td class="org-right">6520</td>
</tr>

<tr>
<td class="org-right">1000</td>
<td class="org-right">45500</td>
<td class="org-right">20500</td>
<td class="org-right">7390</td>
</tr>
</tbody>
</table>

<p>
N=10,u=300kbps时，D=max{15Gb/30Mbps,15Gb/2Mbps,10×15Gb/(30Mbps+10×300kbps)}=7500s<br />
</p>
</div>
</div>

<div id="outline-container-org841ebb7" class="outline-4">
<h4 id="org841ebb7">P23</h4>
<div class="outline-text-4" id="text-org841ebb7">
<p>
考虑使用一种客户-服务器体系结构向N个对等方分发一个F比特的文件。假定一种某服务器能够同时向多个对等方传输的流体模型，只要组合速率不超过u<sub>s</sub>，则以不同的速率向每个对等方传输。<br />
</p>
<ol class="org-ol">
<li>假定u<sub>s</sub>/N⩽d<sub>min</sub>。定义一个具有NF/u<sub>s</sub>分发时间的分发方案。<br /></li>
<li>假定u<sub>s</sub>/N⩾d<sub>min</sub>。定义一个具有F/d<sub>min</sub>分发时间的分发方案。<br /></li>
<li>得出最小分发时间通常是由max{NF/u<sub>s</sub>, F/d<sub>min</sub>}所决定的结论。<br /></li>
</ol>


<p>
服务器以u=u<sub>s</sub>/N的速率向每个客户传输文件；客户以速率d=d<sub>min</sub>下载。传输完成的时间取决于慢的一方：如果u小，则结果是F/u=NF/u<sub>s</sub>；如果d小，则结果是F/d=F/d<sub>min</sub>。<br />
</p>
</div>
</div>

<div id="outline-container-orgd746358" class="outline-4">
<h4 id="orgd746358">P24</h4>
<div class="outline-text-4" id="text-orgd746358">
<p>
考虑使用P2P体系结构向N个用户分发F比特的一个文件。假定一种流体模型。为了简化起见，假定d<sub>min</sub>很大，因此对等方下载带宽不会成为瓶颈。<br />
</p>
<ol class="org-ol">
<li>假定u<sub>s</sub>⩽(u<sub>s</sub>+u<sub>1</sub>+&#x2026;+u<sub>N</sub>)/N。定义一个具有F/u<sub>s</sub>分发时间的分发方案。<br /></li>
<li>假定u<sub>s</sub>⩾(u<sub>s</sub>+u<sub>1</sub>+&#x2026;+u<sub>N</sub>)/N。定义一个具有NF/(u<sub>s</sub>+u<sub>1</sub>+&#x2026;+u<sub>N</sub>)分发时间的分发方案。<br /></li>
<li>得出最小分发时间通常是由max{F/u<sub>s</sub>, NF/(u<sub>s</sub>+u<sub>1</sub>+&#x2026;+u<sub>N</sub>)}所决定的结论。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
设u=u<sub>1</sub>+u<sub>2</sub>+&#x2026;u<sub>n</sub>，有<br />
</p>

<p>
\[ u_s ⩽ \frac{u_s+u}{N}, \]<br />
\[ (N-1)u_s ⩽ u. \]<br />
</p>

<p>
将文件分成N块，第i块的文件大小是(u<sub>i</sub>/u)F，服务器以速率r<sub>i</sub>=(u<sub>i</sub>/u)u<sub>s</sub>向第i个对等方传输文件的第i块。接收到文件块的对等方向其余N-1个对等方以r<sub>i</sub>速率发送该块。对等方i的总发送速率为<br />
</p>

<p>
\[ (N-1)r_{i} = \frac{(N-1)u_s}{u}u_i ⩽ u_i, \]<br />
</p>

<p>
满足u_i的传输要求。<br />
</p>

<p>
对等方i的总接收速率为<br />
</p>

<p>
\[ r_i + \sum_{\substack{1⩽k⩽N\\k \not =i}}r_k = u_s. \]<br />
</p>

<p>
因此每个对等方接收文件的时间为 \(F/u_{s}\)。<br />
</p></li>

<li><p>
设 \(u=u_{1}+u_{2}+...u_{n}\)。<br />
</p>

<p>
将文件分为 \(N+1\) 部分，服务器向节点 \(i\) 以速率 \(r_{i}=u_i/(N-1)\) 发送第 \(i\) 部分。每个节点接收到比特后就以 \(r_i\) 的速率向其余 \(N-1\) 个节点发送文件。另外，服务器还以 \(r_{N+1}=(u_s-u/(N-1))/N\) 的速率向 \(N\) 个节点发送第 \(N+1\) 部分。<br />
</p>

<p>
服务器的总发送速率为<br />
</p>

<p>
\[ r_1 +\dotsb + r_N + Nr_{N+1} = u/(N-1) + u_s + u/(N-1) = u_s, \]<br />
</p>

<p>
满足要求。<br />
</p>

<p>
每个节点的总发送速率为<br />
</p>

<p>
\[ (N-1)r_i = u_i, \]<br />
</p>

<p>
满足要求。<br />
</p>

<p>
每个节点的总接收速率为<br />
</p>

<p>
\[ r_i + r_{N+1} + \sum_{\substack{1⩽k⩽N\\k \not =i}}r_k = u/(N-1) + (u_s-u/(N-1))/N = (u_s+u)/N, \]<br />
</p>

<p>
因此需要的时间是 \(NF/(u_s+u)\)。<br />
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org8d6d9df" class="outline-4">
<h4 id="org8d6d9df">P25</h4>
<div class="outline-text-4" id="text-org8d6d9df">
<p>
考虑在一个有N个活跃对等方的覆盖网络中，每对对等方有一条活跃的TCP连接。此外，假定该TCP连接通过总共M台路由器。在对应的覆盖网络中，有多少节点和边？<br />
</p>

<p>
N个节点，N(N-1)/2条边。<br />
</p>
</div>
</div>

<div id="outline-container-org1f20b1a" class="outline-4">
<h4 id="org1f20b1a">P26</h4>
<div class="outline-text-4" id="text-org1f20b1a">
<p>
假定Bob加入BitTorrent，但他不希望向任何其他对等方上载任何数据（因此称为搭便车）。<br />
</p>
<ol class="org-ol">
<li>Bob声称他能够收到由该社区共享的某文件的完整副本。Bob所言是可能的吗？为什么？<br /></li>
<li>Bob进一步声称他还能够更为有效地进行他的"搭便车”，方法是利用所在系的计算机实验室中的多台计算机（具有不同的IP地址）。他怎样才能做到这些呢？<br /></li>
</ol>


<ol class="org-ol">
<li>有可能，只要在洪流中待的够久，Bob总有可能通过接收随机疏通获得文件块。<br /></li>
<li>他可以在每个主机上运行一个客户端，让每个客户端搭便车，并将从不同主机上收集到的数据块合并成一个文件。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org3a6f70c" class="outline-4">
<h4 id="org3a6f70c">P27</h4>
<div class="outline-text-4" id="text-org3a6f70c">
<p>
考虑一个具有N个视频版本（具有N个不同的速率和质拉）和N个音频版本（具有N个不同的速率和质量）的DASH系统。假设我们想允许播放者在任何时间选择N个视频版本和N个音频版本之一：<br />
</p>
<ol class="org-ol">
<li>如果我们生成音频与视频混合的文件，因此服务器在任何时间仅发送一个媒体流，该服务器将需要存储多少个文件（每个文件有一个不同的URL）？<br /></li>
<li>如果该服务器分别发送音频流和视频流并且与客户同步这些流，该服务器将需要存储多少个文件？<br /></li>
</ol>


<ol class="org-ol">
<li>\( N \)<br /></li>
<li>\( N+N \)<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgd3c073e" class="outline-4">
<h4 id="orgd3c073e">P28</h4>
<div class="outline-text-4" id="text-orgd3c073e">
<p>
在一台主机上安装编译TCPCLient和UDPClient Python程序，在另一台主机上安装编译TCPServer和UDPServer程序。<br />
</p>
<ol class="org-ol">
<li>假设你在运行TCPServer之前运行TCPClient，将发生什么现象？为什么？<br /></li>
<li>假设你在运行UDPServer之前运行UDPClient，将发生什么现象？为什么？<br /></li>
<li>如果你对客户端和服务器端使用了不同的端口，将发生什么现象？<br /></li>
</ol>


<p>
见<a href="#org7f2c724">R27</a>。<br />
</p>
</div>
</div>

<div id="outline-container-org0ea9f1c" class="outline-4">
<h4 id="org0ea9f1c">P29</h4>
<div class="outline-text-4" id="text-org0ea9f1c">
<p>
假定在UDPClient.py中在创建套接字后增加了下面一行：<br />
<code>clientSocket.bind((''，5432))</code><br />
有必要修改UDPServer.py吗？UDPClient和UDPServer中的套接字端口号是多少？在变化之前它们是多少？<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> socket <span class="org-keyword">import</span> socket, AF_INET, SOCK_DGRAM

<span class="org-variable-name">localIP</span> = <span class="org-string">"127.0.0.1"</span>
<span class="org-variable-name">localPort</span> = 20001
<span class="org-variable-name">bufferSize</span> = 1024

<span class="org-variable-name">msgFromServer</span> = <span class="org-string">"Hello UDP Client"</span>
<span class="org-variable-name">bytesToSend</span> = <span class="org-builtin">str</span>.encode(msgFromServer)

<span class="org-comment-delimiter"># </span><span class="org-comment">Create a datagram socket</span>
<span class="org-variable-name">UDPServerSocket</span> = socket(family=AF_INET, <span class="org-builtin">type</span>=SOCK_DGRAM)

<span class="org-comment-delimiter"># </span><span class="org-comment">Bind to address and ip</span>
UDPServerSocket.bind((localIP, localPort))

<span class="org-builtin">print</span>(<span class="org-string">"UDP server up and listening"</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Listen for incoming datagrams</span>
<span class="org-keyword">while</span>(<span class="org-constant">True</span>):
    message, address = UDPServerSocket.recvfrom(bufferSize)
    <span class="org-builtin">print</span>(<span class="org-string">"Message from Client: {}"</span>.<span class="org-builtin">format</span>(message))
    <span class="org-builtin">print</span>(<span class="org-string">"Client IP Address: {}"</span>.<span class="org-builtin">format</span>(address))
    <span class="org-comment-delimiter"># </span><span class="org-comment">Sending a reply to client</span>
    UDPServerSocket.sendto(bytesToSend, address)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span class="org-keyword">from</span> socket <span class="org-keyword">import</span> socket, AF_INET, SOCK_DGRAM

<span class="org-variable-name">msgFromClient</span> = <span class="org-string">"Hello UDP Server"</span>
<span class="org-variable-name">bytesToSend</span> = <span class="org-builtin">str</span>.encode(msgFromClient)

<span class="org-variable-name">serverAddressPort</span> = (<span class="org-string">"127.0.0.1"</span>, 20001)
<span class="org-variable-name">bufferSize</span> = 1024

<span class="org-comment-delimiter"># </span><span class="org-comment">Create a UDP socket at client side</span>
<span class="org-variable-name">UDPClientSocket</span> = socket(family=AF_INET, <span class="org-builtin">type</span>=SOCK_DGRAM)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send to server using created UDP socket</span>
UDPClientSocket.sendto(bytesToSend, serverAddressPort)

msgFromServer = UDPClientSocket.recvfrom(bufferSize)
msg = <span class="org-string">"Message from Server {}"</span>.<span class="org-builtin">format</span>(msgFromServer[0])
<span class="org-builtin">print</span>(msg)
</pre>
</div>

<p>
运行程序后，服务器程序打印的结果：<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">UDP server up and listening
Message from Client: b<span class="org-string">'Hello UDP Server'</span>
Client IP Address: (<span class="org-string">'127.0.0.1'</span>, 57156)
</pre>
</div>

<p>
增加 <code>clientSocket.bind((''，5432))</code> 这一行之后没必要修改服务器程序。在修改之前客户程序的端口是系统随机指定的57156，而增加之后是手动设置为5432。服务器程序的端口都是20001。<br />
</p>
</div>
</div>

<div id="outline-container-orgf49270d" class="outline-4">
<h4 id="orgf49270d">P30</h4>
<div class="outline-text-4" id="text-orgf49270d">
<p>
你能够配置浏览器以打开对某Web站点的多个井行连接吗？有大批的并行TCP连接的优点和缺点是什么？<br />
</p>

<p>
Chromium内核的浏览器设置：chrome://flags/#enable-parallel-downloading。<br />
</p>

<p>
优点是提升下载速度，缺点是占用更多物理带宽。<br />
</p>
</div>
</div>

<div id="outline-container-orgc27f15a" class="outline-4">
<h4 id="orgc27f15a">P31</h4>
<div class="outline-text-4" id="text-orgc27f15a">
<p>
我们已经看到因特网TCP套接字将数据处理为字节流，而UDP套接字识别报文边界。面向字节API与显式识别和维护应用程序定义的报文边界的API相比，试给出一个优点和一个缺点。<br />
</p>

<blockquote>
<p>
对于远程登录（telnet和ssh）这样的应用，面向字节流的协议是非常自然的，因为在这些应用中没有消息边界的概念。当用户输入一个字符时，我们只需将该字符放入TCP连接中。<br />
</p>

<p>
在其他应用中，我们可能会发送一系列的消息，这些消息之间有固有的界限。例如，当一个SMTP邮件服务器向另一个SMTP邮件服务器发送几条连续的邮件信息时。由于TCP没有指示边界的机制，应用程序必须自己添加指示，以便应用程序的接收方能够区分一个消息和另一个消息。如果每条消息被放入一个不同的UDP报文段，接收端就能区分各种消息，而不需要应用程序的发送方添加任何指示。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgb1ed060" class="outline-4">
<h4 id="orgb1ed060">P32</h4>
<div class="outline-text-4" id="text-orgb1ed060">
<p>
什么是Apache Web服务器？它值多少钱？它当前有多少功能？为回答这个问题，你也许要看一下维基百科。<br />
</p>

<blockquote>
<p>
Apache HTTP Server（简称Apache）是Apache软件基金会的一个开放源码的网页服务器软件，可以在大多数电脑操作系统中运行。由于其跨平台和安全性[注 1]，被广泛使用，是最流行的Web服务器软件之一。它快速、可靠并且可通过简单的API扩展，将Perl／Python等解释器编译到服务器中。<br />
</p>

<p>
Apache支持许多特性，大部分通过编译的模块实现。这些特性从服务端的编程语言支持到身份认证方案。一些通用的语言接口支持Perl，Python，Tcl， 和PHP。流行的认证模块包括mod_access，mod_auth和mod_digest。其他的例子有SSL和TLS支持（mod_ssl），代理服务器（proxy）模块，很有用的URL重写（由mod_rewrite实现），定制日志文件（mod_log_config），以及过滤支持（mod_include和mod_ext_filter）。Apache日志可以通过网页浏览器使用免费的脚本AWStats或Visitors来进行分析。<br />
--<a href="https://zh.wikipedia.org/wiki/Apache_HTTP_Server">Apache HTTP服务器</a><br />
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgc60dfa4" class="outline-3">
<h3 id="orgc60dfa4"><span class="section-number-3">2.4.</span> 套接字编程作业</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-orgdb6d8d9" class="outline-4">
<h4 id="orgdb6d8d9">作业1：Web服务器</h4>
<div class="outline-text-4" id="text-orgdb6d8d9">
<p>
在这个编程作业中，你将用Python语言开发一个简单的Web服务器，它仅能处理一个请求。具体而言，你的Web服务器将:（1）当一个客户（浏览器）联系时创建一个连接套接字；（2）从这个连接接收HTIP请求；（3）解释该请求以确定所请求的特定文件；（4）从服务器的文件系统获得请求的文件；（5）创建一个由请求的文件组成的HTTP响应报文，报文前面有首部行；（6）经TCP连接向请求的浏览器发送响应。如果浏览器请求一个在该服务器中不存在的文件，服务器应当返回一个"404 Not Found"差错报文。在配套网站中，我们提供了用于该服务器的框架代码。你的任务是完善该代码，运行你的服务器，通过在不同主机上运行的浏览器发送请求来测试该服务器。如果运行你服务器的主机上已经有一个Web服务器在运行，你应当为该Web服务器使用一个不同于80端口的其他端口。<br />
</p>

<p>
<a href="code/ch2-web-server/socket1-webserver.pdf">Socket Programming Assignment 1: Web Server</a><br />
</p>
</div>

<ul class="org-ul">
<li><a id="org58b99e0"></a>Hand in<br />
<div class="outline-text-5" id="text-org58b99e0">
<ul class="org-ul">
<li>You will develop a web server that handles one HTTP request at a time.<br /></li>
<li>Your web server should accept and parse the HTTP request, get the requested file from the server’s file system, create an HTTP response message consisting of the requested file preceded by header lines, and then send the response directly to the client.<br /></li>
<li>If the requested file is not present in the server, the server should send an HTTP “404 Not Found” message back to the client.<br /></li>
</ul>


<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""Web server</span>

<span class="org-doc">Put an HTML file in the same directory that the server is in. Then try to get a</span>
<span class="org-doc">file that is not present at the server. You should get a &#8220;404 Not Found&#8221;</span>
<span class="org-doc">message.</span>
<span class="org-doc">"""</span>

<span class="org-keyword">from</span> socket <span class="org-keyword">import</span> *

<span class="org-variable-name">HOST</span> = <span class="org-string">'127.0.0.1'</span>
<span class="org-variable-name">PORT</span> = 12000
<span class="org-variable-name">BUFSIZE</span> = 1024

<span class="org-variable-name">serverSocket</span> = socket(AF_INET, SOCK_STREAM)
serverSocket.bind((HOST, PORT))
serverSocket.listen()

<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    <span class="org-builtin">print</span>(<span class="org-string">'--&gt; Ready to serve...'</span>)
    <span class="org-variable-name">connectionSocket</span>, <span class="org-variable-name">addr</span> = serverSocket.accept()

    <span class="org-keyword">try</span>:
        message = connectionSocket.recv(BUFSIZE).decode()
        <span class="org-builtin">print</span>(f<span class="org-string">'--&gt; Receive a request:\n</span>{message}<span class="org-string">'</span>)

        <span class="org-comment-delimiter"># </span><span class="org-comment">GET /hello.html HTTP/1.1</span>
        <span class="org-variable-name">filename</span> = message.split()[1]  <span class="org-comment-delimiter"># </span><span class="org-comment">/hello.html</span>
        <span class="org-variable-name">f</span> = <span class="org-builtin">open</span>(filename[1:])  <span class="org-comment-delimiter"># </span><span class="org-comment">hello.html</span>
        <span class="org-variable-name">outputdata</span> = f.read()
        <span class="org-builtin">print</span>(f<span class="org-string">'--&gt; Found local file:\n</span>{outputdata}<span class="org-string">'</span>)
        f.close()

        connectionSocket.send(<span class="org-string">'HTTP/1.1 200 OK'</span>.encode())
        connectionSocket.send(<span class="org-string">'\n'</span>.encode())

        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(0, <span class="org-builtin">len</span>(outputdata)):
            connectionSocket.send(outputdata[i].encode())

        <span class="org-builtin">print</span>(<span class="org-string">'--&gt; Sent the file'</span>)
        connectionSocket.close()

    <span class="org-keyword">except</span> <span class="org-type">IOError</span>:
        <span class="org-builtin">print</span>(<span class="org-string">'--&gt; Local file does not exist'</span>)
        <span class="org-variable-name">resp</span> = (<span class="org-string">'HTTP/1.1 404 Not Found\n'</span>
                <span class="org-string">'\n'</span>
                <span class="org-string">'Try to get a file that is not present at the server.'</span>)
        connectionSocket.send(resp.encode())
        connectionSocket.close()

serverSocket.close()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">&#10095; python http_server.py
--&gt; Ready to serve...
--&gt; Receive a request:
GET /hello.html HTTP/1.1
Host: localhost:12000
Connection: keep-alive
Cache-Control: max-age=0
sec-ch-ua: <span class="org-string">"Chromium"</span>;<span class="org-variable-name">v</span>=<span class="org-string">"94"</span>, <span class="org-string">"Microsoft Edge"</span>;<span class="org-variable-name">v</span>=<span class="org-string">"94"</span>, <span class="org-string">";Not A Brand"</span>;<span class="org-variable-name">v</span>=<span class="org-string">"99"</span>
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: <span class="org-string">"macOS"</span>
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36 Edg/94.0.992.50
Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,image/webp,image/apng,*/*;<span class="org-variable-name">q</span>=0.8,application/signed-exchange;<span class="org-variable-name">v</span>=b3;<span class="org-variable-name">q</span>=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Accept-Language: en,zh-CN;<span class="org-variable-name">q</span>=0.9,zh;<span class="org-variable-name">q</span>=0.8


--&gt; Found local file:
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Hello Title&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
    Hello!
  &lt;/body&gt;
&lt;/html&gt;

--&gt; Ready to serve...
--&gt; Receive a request:
GET /a.html HTTP/1.1
Host: localhost:12000
Connection: keep-alive
sec-ch-ua: <span class="org-string">"Chromium"</span>;<span class="org-variable-name">v</span>=<span class="org-string">"94"</span>, <span class="org-string">"Microsoft Edge"</span>;<span class="org-variable-name">v</span>=<span class="org-string">"94"</span>, <span class="org-string">";Not A Brand"</span>;<span class="org-variable-name">v</span>=<span class="org-string">"99"</span>
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: <span class="org-string">"macOS"</span>
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36 Edg/94.0.992.50
Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,image/webp,image/apng,*/*;<span class="org-variable-name">q</span>=0.8,application/signed-exchange;<span class="org-variable-name">v</span>=b3;<span class="org-variable-name">q</span>=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Accept-Language: en,zh-CN;<span class="org-variable-name">q</span>=0.9,zh;<span class="org-variable-name">q</span>=0.8


--&gt; Local file does not exist
--&gt; Ready to serve...
</pre>
</div>
</div>
</li>

<li><a id="orge3deb15"></a>Optional Exercises<br />
<div class="outline-text-5" id="text-orge3deb15">
<ol class="org-ol">
<li><p>
Currently, the web server handles only one HTTP request at a time. Implement a multithreaded server that is capable of serving multiple requests simultaneously. Using threading, first create a main thread in which your modified server listens for clients at a fixed port. When it receives a TCP connection request from a client, it will set up the TCP connection through another port and services the client request in a separate thread. There will be a separate TCP connection in a separate thread for each request/response pair.<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""Multithreaded server</span>

<span class="org-doc">Implement a multithreaded server that is capable of serving multiple requests</span>
<span class="org-doc">simultaneously.</span>
<span class="org-doc">"""</span>

<span class="org-keyword">from</span> socket <span class="org-keyword">import</span> *
<span class="org-keyword">import</span> threading

<span class="org-variable-name">HOST</span> = <span class="org-string">''</span>
<span class="org-variable-name">PORT</span> = 12000
<span class="org-variable-name">BUFSIZE</span> = 1024

<span class="org-keyword">def</span> <span class="org-function-name">listen_to</span>(connectionSocket, address):
    <span class="org-keyword">try</span>:
        message = connectionSocket.recv(BUFSIZE).decode()
        <span class="org-builtin">print</span>(f<span class="org-string">'--&gt; Receive a request:\n</span>{message}<span class="org-string">'</span>)

        filename = message.split()[1]
        <span class="org-variable-name">f</span> = <span class="org-builtin">open</span>(filename[1:])
        <span class="org-variable-name">outputdata</span> = f.read()
        f.close()

        connectionSocket.send(<span class="org-string">'HTTP/1.1 200 OK'</span>.encode())
        connectionSocket.send(<span class="org-string">'\n'</span>.encode())

        <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(0, <span class="org-builtin">len</span>(outputdata)):
            connectionSocket.send(outputdata[i].encode())

        <span class="org-builtin">print</span>(<span class="org-string">'--&gt; Sent the file'</span>)
        connectionSocket.close()

    <span class="org-keyword">except</span> <span class="org-type">IOError</span>:
        <span class="org-builtin">print</span>(<span class="org-string">'--&gt; File does not exist'</span>)
        <span class="org-variable-name">resp</span> = (<span class="org-string">'HTTP/1.1 404 Not Found\n'</span>
                <span class="org-string">'\n'</span>
                <span class="org-string">'Try to get a file that is not present at the server.'</span>)
        connectionSocket.send(resp.encode())
        connectionSocket.close()

<span class="org-variable-name">serverSocket</span> = socket(AF_INET, SOCK_STREAM)
serverSocket.bind((HOST, PORT))
serverSocket.listen()

<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    <span class="org-builtin">print</span>(<span class="org-string">'--&gt; Ready to serve...'</span>)
    <span class="org-variable-name">connectionSocket</span>, <span class="org-variable-name">addr</span> = serverSocket.accept()
    <span class="org-builtin">print</span>(f<span class="org-string">'--&gt; Connected to: </span>{addr}<span class="org-string">'</span>)

    threading.Thread(target=listen_to, args=(connectionSocket, addr)).start()

serverSocket.close()
</pre>
</div></li>

<li><p>
Instead of using a browser, write your own HTTP client to test your server. Your client will connect to the server using a TCP connection, send an HTTP request to the server, and display the server response as an output. You can assume that the HTTP request sent is a GET method. The client should take command line arguments specifying the server IP address or host name, the port at which the server is listening, and the path at which the requested object is stored at the server. The following is an input command format to run the client.<br />
</p>

<p>
<code>client.py server_host server_port filename</code><br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""HTTP client</span>

<span class="org-doc">Instead of using a browser, write your own HTTP client to test your server.</span>

<span class="org-doc">Your client will connect to the server using a TCP connection, send an HTTP</span>
<span class="org-doc">request to the server, and display the server response as an output.</span>
<span class="org-doc">"""</span>

<span class="org-keyword">import</span> argparse
<span class="org-keyword">import</span> socket

<span class="org-variable-name">BUFSIZE</span> = 2048

<span class="org-variable-name">parser</span> = argparse.ArgumentParser()
parser.add_argument(<span class="org-string">'host'</span>)
parser.add_argument(<span class="org-string">'port'</span>, <span class="org-builtin">type</span>=<span class="org-builtin">int</span>)
parser.add_argument(<span class="org-string">'filename'</span>)
args = parser.parse_args()

clientSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
clientSocket.connect((args.host, args.port))

req = (f<span class="org-string">'GET /</span>{args.filename}<span class="org-string"> HTTP/1.1\n'</span>
       f<span class="org-string">'Host: </span>{args.host}<span class="org-string">:</span>{args.port}<span class="org-string">\n'</span>
       <span class="org-string">'\n'</span>)

clientSocket.send(req.encode())

resp = clientSocket.recv(BUFSIZE)

<span class="org-keyword">while</span> resp:
    <span class="org-builtin">print</span>(resp.decode(), end=<span class="org-string">''</span>)
    resp = clientSocket.recv(BUFSIZE)

clientSocket.close()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">&#10095; python oe2_http_client.py localhost 12000 hello.html
HTTP/1.1 200 OK
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Hello Title&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
    Hello!
  &lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">&#10095; python http_server.py
--&gt; Ready to serve...
--&gt; Receive a request:
GET /hello.html HTTP/1.1
Host: localhost:12000


--&gt; Found local file:
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Hello Title&lt;/title&gt;
  &lt;/head&gt;

  &lt;body&gt;
    Hello!
  &lt;/body&gt;
&lt;/html&gt;

--&gt; Sent the file
--&gt; Ready to serve...
</pre>
</div></li>
</ol>
</div>
</li>
</ul>
</div>

<div id="outline-container-org8efd80f" class="outline-4">
<h4 id="org8efd80f">作业2：UDP ping程序</h4>
<div class="outline-text-4" id="text-org8efd80f">
<p>
在这个编程作业中，你将用Python编写一个客户ping程序。该客户将发送一个简单的ping报文，接收一个从服务器返回的对应pong报文，并确定从该客户发送ping报文到接收到pong报文为止的时延。该时延称为往返时延（RTT）。由该客户和服务器提供的功能类似于在现代操作系统中可用的标准ping程序。然而，标准的ping使用互联网控制报文协议（ICMP）（我们将在第5章中学习ICMP）。此时我们将创建一个非标准（但简单）的基于UDP的ping程序。<br />
你的ping程序经UDP向目标服务器发送10个ping报文。对于每个报文，当对应的pong报文返回时，你的客户要确定和打印RTT。因为UDP是一个不可靠的协议，由客户发送的分组可能会丢失。为此，客户不能无限期地等待对ping报文的回答。客户等待服务器回答的时间至多为1秒；如果没有收到回答，客户假定该分组丢失并相应地打印一条报文。在此作业中，你将给出服务器的完整代码（在配套网站中可找到）。你的任务是编写客户代码，该代码与服务器代码非常类似。建议你先仔细学习服务器的代码，然后编写你的客户代码，可以随意地从服务器代码中剪贴代码行。<br />
</p>

<p>
<a href="code/ch2-udp/socket2-udppinger.pdf">Socket Programming Assignment 2: UDP</a><br />
</p>
</div>

<ul class="org-ul">
<li><a id="org0f5cb05"></a>Hand in<br />
<div class="outline-text-5" id="text-org0f5cb05">
<ul class="org-ul">
<li>The client should send 10 pings to the server.<br /></li>
<li>You should get the client wait up to one second for a reply; if no reply is received within one second, your client program should assume that the packet was lost during transmission across the network.<br /></li>
<li>send the ping message using UDP<br /></li>
<li>print the response message from server, if any<br /></li>
<li>calculate and print the round trip time (RTT), in seconds, of each packet, if server responses<br /></li>
<li>otherwise, print “Request timed out”<br /></li>
</ul>
</div>
</li>

<li><a id="org02d4bd4"></a>Optional Exercises<br />
<div class="outline-text-5" id="text-org02d4bd4">
<ol class="org-ol">
<li><p>
Currently, the program calculates the round-trip time for each packet and prints it out individually. Modify this to correspond to the way the standard ping program works. You will need to report the minimum, maximum, and average RTTs at the end of all pings from the client. In addition, calculate the packet loss rate (in percentage).<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""Ping client</span>

<span class="org-doc">1. send the ping message using UDP</span>
<span class="org-doc">2. print the response message from server, if any</span>
<span class="org-doc">3. calculate and print the round trip time (RTT)</span>
<span class="org-doc">4. otherwise, print &#8220;Request timed out&#8221;</span>
<span class="org-doc">5. report the minimum, maximum, average RTTs and packet loss rate.</span>

<span class="org-doc">Message Format: Ping &lt;sequence_number&gt; &lt;time&gt;</span>
<span class="org-doc">"""</span>

<span class="org-keyword">import</span> socket
<span class="org-keyword">import</span> datetime
<span class="org-keyword">import</span> numpy <span class="org-keyword">as</span> np

<span class="org-variable-name">HOST</span> = <span class="org-string">'127.0.0.1'</span>
<span class="org-variable-name">PORT</span> = 12000
<span class="org-variable-name">BUFSIZE</span> = 1024
<span class="org-variable-name">PKGNUM</span> = 10

<span class="org-variable-name">packets_received</span> = 0
<span class="org-variable-name">rtts</span> = []

<span class="org-variable-name">client_socket</span> = socket.socket(family=socket.AF_INET, <span class="org-builtin">type</span>=socket.SOCK_DGRAM)

<span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(PKGNUM):
    <span class="org-keyword">try</span>:
        send_time = datetime.datetime.now()
        send_time_fmt = send_time.strftime(<span class="org-string">'%H:%M:%S.%f'</span>)

        reqt = f<span class="org-string">'Ping </span>{i+1:02}<span class="org-string"> </span>{send_time_fmt}<span class="org-string">'</span>
        client_socket.sendto(reqt.encode(), (HOST, PORT))
        <span class="org-builtin">print</span>(reqt, end=<span class="org-string">', '</span>)

        client_socket.settimeout(1.0)

        resp, addr = client_socket.recvfrom(BUFSIZE)
        recv_time = datetime.datetime.now()
        rtt = recv_time - send_time
        rtt_fmt = rtt.microseconds/1000
        <span class="org-builtin">print</span>(f<span class="org-string">'time=</span>{rtt_fmt}<span class="org-string">ms'</span>)

        packets_received += 1
        rtts.append(rtt_fmt)
    <span class="org-keyword">except</span> socket.timeout:
        <span class="org-builtin">print</span>(<span class="org-string">'Request timed out'</span>)

<span class="org-builtin">print</span>(f<span class="org-string">'--- </span>{HOST}<span class="org-string"> ping statistics ---'</span>)

lose_percent = <span class="org-string">'{:.1%}'</span>.<span class="org-builtin">format</span>((PKGNUM-packets_received)/PKGNUM)
<span class="org-builtin">print</span>(f<span class="org-string">'</span>{PKGNUM}<span class="org-string"> packets transmitted, '</span>
      f<span class="org-string">'</span>{packets_received}<span class="org-string"> packets received, '</span>
      f<span class="org-string">'</span>{lose_percent}<span class="org-string"> packet loss'</span>)

<span class="org-builtin">print</span>(f<span class="org-string">'round-trip min/avg/max/stddev = '</span>
      f<span class="org-string">'</span>{np.<span class="org-builtin">min</span>(rtts)}<span class="org-string">'</span>
      f<span class="org-string">'/</span>{<span class="org-builtin">round</span>(np.average(rtts), 3)}<span class="org-string">'</span>
      f<span class="org-string">'/</span>{<span class="org-builtin">round</span>(np.<span class="org-builtin">max</span>(rtts), 3)}<span class="org-string">'</span>
      f<span class="org-string">'/</span>{<span class="org-builtin">round</span>(np.std(rtts), 3)}<span class="org-string"> ms'</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">&#10095; python ping_client.py
Ping 01 15:35:12.787722, <span class="org-variable-name">time</span>=0.321ms
Ping 02 15:35:12.788158, <span class="org-variable-name">time</span>=0.173ms
Ping 03 15:35:12.788359, <span class="org-variable-name">time</span>=0.12ms
Ping 04 15:35:12.788503, <span class="org-variable-name">time</span>=0.121ms
Ping 05 15:35:12.788648, <span class="org-variable-name">time</span>=0.124ms
Ping 06 15:35:12.788795, Request timed out
Ping 07 15:35:13.793915, <span class="org-variable-name">time</span>=0.418ms
Ping 08 15:35:13.794384, Request timed out
Ping 09 15:35:14.799174, Request timed out
Ping 10 15:35:15.803596, Request timed out
--- 127.0.0.1 ping statistics ---
10 packets transmitted, 6 packets received, 40.0% packet loss
round-trip min/avg/max/stddev = 0.12/0.213/0.418/0.116 ms
</pre>
</div></li>

<li><p>
Another similar application to the UDP Ping would be the UDP Heartbeat. The Heartbeat can be used to check if an application is up and running and to report one-way packet loss. The client sends a sequence number and current timestamp in the UDP packet to the server, which is listening for the Heartbeat (i.e., the UDP packets) of the client. Upon receiving the packets, the server calculates the time difference and reports any lost packets. If the Heartbeat packets are missing for some specified period of time, we can assume that the client application has stopped. Implement the UDP Heartbeat (both client and server). You will need to modify the given UDPPingerServer.py, and your UDP ping client.<br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""UDP heartbeat server</span>

<span class="org-doc">The client sends a sequence number and current timestamp in the UDP packet to</span>
<span class="org-doc">the server, which is listening for the Heartbeat of the client.</span>

<span class="org-doc">Upon receiving the packets, the server calculates the time difference and</span>
<span class="org-doc">reports any lost packets. If the Heartbeat packets are missing for some</span>
<span class="org-doc">specified period of time, we can assume that the client application has stopped.</span>

<span class="org-doc">Heartbeat message format: &lt;seq_num&gt; &lt;timestamp&gt;</span>
<span class="org-doc">"""</span>

<span class="org-keyword">import</span> random
<span class="org-keyword">import</span> datetime
<span class="org-keyword">import</span> socket

<span class="org-variable-name">serverSocket</span> = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
serverSocket.bind((<span class="org-string">''</span>, 12000))
<span class="org-builtin">print</span>(<span class="org-string">'Ready to serve...'</span>)

<span class="org-variable-name">last_seq</span> = <span class="org-constant">None</span>
<span class="org-variable-name">recv_time</span> = <span class="org-constant">None</span>

<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    <span class="org-keyword">try</span>:
        <span class="org-comment-delimiter"># </span><span class="org-comment">2.5&#31186;&#25910;&#19981;&#21040;&#28040;&#24687;&#23601;&#21028;&#23450;&#20026;&#19979;&#32447;</span>
        serverSocket.settimeout(2.5)

        <span class="org-variable-name">message</span>, <span class="org-variable-name">address</span> = serverSocket.recvfrom(1024)
        <span class="org-variable-name">seq</span>, *<span class="org-variable-name">send_time</span> = message.split()

        <span class="org-variable-name">seq</span> = <span class="org-builtin">int</span>(seq.decode())
        <span class="org-keyword">if</span> last_seq != <span class="org-constant">None</span> <span class="org-keyword">and</span> seq - last_seq != 1:
            <span class="org-keyword">for</span> i <span class="org-keyword">in</span> <span class="org-builtin">range</span>(last_seq+1, seq):
                <span class="org-builtin">print</span>(f<span class="org-string">'hb_seq=</span>{i}<span class="org-string"> lost'</span>)
        last_seq = seq

        send_time = datetime.datetime.fromisoformat(<span class="org-string">' '</span>.join(<span class="org-builtin">map</span>((<span class="org-keyword">lambda</span> x: x.decode()), send_time)))
        recv_time = datetime.datetime.now()
        trans_time = (recv_time-send_time).microseconds/1000
        <span class="org-builtin">print</span>(f<span class="org-string">'hb_seq=</span>{seq}<span class="org-string"> time=</span>{trans_time}<span class="org-string">ms'</span>)

        serverSocket.sendto(<span class="org-string">'ok'</span>.encode(), address)
    <span class="org-keyword">except</span> socket.timeout:
        <span class="org-keyword">if</span> recv_time != <span class="org-constant">None</span>:
            <span class="org-builtin">print</span>(<span class="org-string">'Client stopped'</span>)
            recv_time = <span class="org-constant">None</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""UDP heartbeat client</span>
<span class="org-doc">"""</span>

<span class="org-keyword">import</span> socket
<span class="org-keyword">import</span> datetime
<span class="org-keyword">import</span> random
<span class="org-keyword">import</span> time

<span class="org-variable-name">HOST</span> = <span class="org-string">'127.0.0.1'</span>
<span class="org-variable-name">PORT</span> = 12000
<span class="org-variable-name">BUFSIZE</span> = 1024

<span class="org-variable-name">seq</span> = 0

<span class="org-variable-name">client_socket</span> = socket.socket(family=socket.AF_INET, <span class="org-builtin">type</span>=socket.SOCK_DGRAM)

<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    seq += 1
    r = random.random()
    <span class="org-keyword">if</span> r &lt;= 0.3:
        <span class="org-comment-delimiter"># </span><span class="org-comment">&#27169;&#25311;&#20002;&#21253;</span>
        <span class="org-builtin">print</span>(f<span class="org-string">'</span>{seq}<span class="org-string"> &#27169;&#25311;&#20002;&#21253;'</span>)
    <span class="org-keyword">elif</span> r &gt; 0.3 <span class="org-keyword">and</span> r &lt;= 0.4:
        <span class="org-comment-delimiter"># </span><span class="org-comment">&#27169;&#25311;&#19979;&#32447;</span>
        <span class="org-builtin">print</span>(f<span class="org-string">'</span>{seq}<span class="org-string"> &#27169;&#25311;&#19979;&#32447;&#65292;&#30561;&#30496;4&#31186;'</span>)
        time.sleep(4)
        seq = 0
    <span class="org-keyword">else</span>:
        msg = f<span class="org-string">'</span>{seq}<span class="org-string"> </span>{datetime.datetime.now()}<span class="org-string">'</span>
        client_socket.sendto(msg.encode(), (HOST, PORT))
        <span class="org-builtin">print</span>(f<span class="org-string">'</span>{msg}<span class="org-string">'</span>, end=<span class="org-string">' '</span>)
        resp, addr = client_socket.recvfrom(BUFSIZE)
        <span class="org-builtin">print</span>(f<span class="org-string">'</span>{resp.decode()}<span class="org-string">'</span>)
        time.sleep(1*r)

client_socket.close()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">% python heartbeat_server.py
Ready to serve...
<span class="org-variable-name">hb_seq</span>=1 <span class="org-variable-name">time</span>=0.265ms
<span class="org-variable-name">hb_seq</span>=2 lost
<span class="org-variable-name">hb_seq</span>=3 <span class="org-variable-name">time</span>=0.205ms
<span class="org-variable-name">hb_seq</span>=4 <span class="org-variable-name">time</span>=0.26ms
Client stopped
<span class="org-variable-name">hb_seq</span>=3 <span class="org-variable-name">time</span>=0.3ms
<span class="org-variable-name">hb_seq</span>=4 lost
<span class="org-variable-name">hb_seq</span>=5 <span class="org-variable-name">time</span>=0.292ms
<span class="org-variable-name">hb_seq</span>=6 <span class="org-variable-name">time</span>=0.284ms
<span class="org-variable-name">hb_seq</span>=7 lost
<span class="org-variable-name">hb_seq</span>=8 lost
<span class="org-variable-name">hb_seq</span>=9 lost
<span class="org-variable-name">hb_seq</span>=10 <span class="org-variable-name">time</span>=0.457ms
<span class="org-variable-name">hb_seq</span>=11 <span class="org-variable-name">time</span>=0.279ms
<span class="org-variable-name">hb_seq</span>=12 <span class="org-variable-name">time</span>=0.293ms
<span class="org-variable-name">hb_seq</span>=13 <span class="org-variable-name">time</span>=0.261ms
</pre>
</div></li>
</ol>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgbb60eef" class="outline-4">
<h4 id="orgbb60eef">作业3：邮件客户</h4>
<div class="outline-text-4" id="text-orgbb60eef">
<p>
这个编程作业的目的是创建一个向任何接收方发送电子邮件的简单邮件客户。你的客户将必须与邮件服务器（如谷歌的电子邮件服务器）创建一个TCP连接，使用SMTP协议与邮件服务器进行交谈，经该邮件服务器向某接收方（如你的朋友）发送一个电子邮件报文，最后关闭与该邮件服务器的TCP连接。对本作业，配套Web站点为你的客户提供了框架代码。你的任务是完善该代码并通过向不同的用户账户发送电子邮件来测试你的客户。你也可以尝试通过不同的服务器（例如谷歌的邮件服务器和你所在大学的邮件服务器）进行发送。<br />
</p>

<p>
<a href="code/ch2-smtp/socket3-smtp.pdf">Socket Progrmming Assignment 3: SMTP</a><br />
</p>
</div>

<ul class="org-ul">
<li><a id="orgb5f78ba"></a>Hand in<br />
<div class="outline-text-5" id="text-orgb5f78ba">
<p>
Your task is to develop a simple mail client that sends email to any recipient. Your client will need to connect to a mail server, dialogue with the mail server using the SMTP protocol, and send an email message to the mail server.<br />
</p>
</div>
</li>

<li><a id="org2146f3e"></a>Optional Exercises<br />
<div class="outline-text-5" id="text-org2146f3e">
<ol class="org-ol">
<li>Mail servers like Google mail (address: smtp.gmail.com, port: 587) requires your client to add a Transport Layer Security (TLS) or Secure Sockets Layer (SSL) for authentication and security reasons, before you send MAIL FROM command. Add TLS/SSL commands to your existing ones and implement your client using Google mail server at above address and port.<br /></li>

<li>Your current SMTP mail client only handles sending text messages in the email body. Modify your client such that it can send emails with both text and images.<br /></li>
</ol>


<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""SMTP client with SSL"""</span>

<span class="org-keyword">import</span> base64
<span class="org-keyword">import</span> socket
<span class="org-keyword">import</span> ssl
<span class="org-keyword">import</span> argparse

<span class="org-variable-name">parser</span> = argparse.ArgumentParser()
parser.add_argument(<span class="org-string">'account'</span>, <span class="org-builtin">help</span>=<span class="org-string">'base64&#32534;&#30721;&#30340;&#36134;&#25143;&#21644;&#23494;&#30721;&#65292;echo -ne "\00user@gmail.com\00password" | base64'</span>)
parser.add_argument(<span class="org-string">'mail_from'</span>, <span class="org-builtin">help</span>=<span class="org-string">'&#21457;&#20214;&#20154;'</span>)
parser.add_argument(<span class="org-string">'to'</span>, <span class="org-builtin">help</span>=<span class="org-string">'&#25910;&#20214;&#20154;'</span>)
parser.add_argument(<span class="org-string">'msg'</span>, <span class="org-builtin">help</span>=<span class="org-string">'&#20869;&#23481;'</span>)
parser.add_argument(<span class="org-string">'pic'</span>, <span class="org-builtin">help</span>=<span class="org-string">'&#22270;&#29255;'</span>)
args = parser.parse_args()

ACCOUNT = args.account
BUF_SIZE = 1024
FROM = f<span class="org-string">'&lt;</span>{args.mail_from}<span class="org-string">&gt;'</span>
TO = f<span class="org-string">'&lt;</span>{args.to}<span class="org-string">&gt;'</span>
MSG = f<span class="org-string">'</span>{args.msg}<span class="org-string">\r\n\r\n'</span>
END_MSG = <span class="org-string">'\r\n.\r\n'</span>
PIC = args.pic

MAIL_SERVER = <span class="org-string">'smtp.gmail.com'</span>
PORT = 465

<span class="org-keyword">with</span> <span class="org-builtin">open</span>(PIC, <span class="org-string">'rb'</span>) <span class="org-keyword">as</span> f:
    img = base64.b64encode(f.read())

sock = socket.socket(family=socket.AF_INET, <span class="org-builtin">type</span>=socket.SOCK_STREAM)
client_socket = ssl.wrap_socket(sock)
client_socket.connect((MAIL_SERVER, PORT))

<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send HELO command and print server response.</span>
helo_command = <span class="org-string">'HELO Alice\r\n'</span>.encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{helo_command}<span class="org-string">'</span>)
client_socket.send(helo_command)
<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send AUTH command and print server response.</span>
auth_command = f<span class="org-string">'AUTH PLAIN </span>{ACCOUNT}<span class="org-string">\r\n'</span>.encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{auth_command}<span class="org-string">'</span>)
client_socket.send(auth_command)
<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send MAIL FROM command and print server response.</span>
mail_from_command = f<span class="org-string">'MAIL FROM: </span>{FROM}<span class="org-string">\r\n'</span>.encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{mail_from_command}<span class="org-string">'</span>)
client_socket.send(mail_from_command)
<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send RCPT TO command and print server response.</span>
rcpt_command = f<span class="org-string">'RCPT TO: </span>{TO}<span class="org-string">\r\n'</span>.encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{rcpt_command}<span class="org-string">'</span>)
client_socket.send(rcpt_command)
<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send DATA command and print server response.</span>
data_command = <span class="org-string">'DATA\r\n'</span>.encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{data_command}<span class="org-string">'</span>)
client_socket.send(data_command)
<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send message</span>
mime_header = (<span class="org-string">'MIME-Version: 1.0\r\n'</span>
               <span class="org-string">'Content-Type: multipart/mixed; '</span>
               <span class="org-string">'boundary="simple boundary\r\n\r\n'</span>).encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{mime_header}<span class="org-string">'</span>)
client_socket.send(mime_header)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send text</span>
text_mime = (<span class="org-string">'--simple boundary\r\n'</span>
             <span class="org-string">'Content-Type: text/plain; charset=utf-8\r\n'</span>
             <span class="org-string">'Content-Transfer-Encoding: quoted-printable\r\n'</span>
             <span class="org-string">'Content-Disposition: inline\r\n\r\n'</span>).encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{text_mime}<span class="org-string">'</span>)
client_socket.send(text_mime)

<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{MSG.encode()}<span class="org-string">'</span>)
client_socket.send(MSG.encode())

<span class="org-comment-delimiter"># </span><span class="org-comment">Send image</span>
img_mime = (<span class="org-string">'--simple boundary\r\n'</span>
            <span class="org-string">'Content-Type: image/jpeg\r\n'</span>
            <span class="org-string">'Content-Transfer-Encoding: BASE64\r\n'</span>
            <span class="org-string">'Content-Disposition: inline\r\n\r\n'</span>).encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{img_mime}<span class="org-string">'</span>)
client_socket.send(img_mime)

<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{img}<span class="org-string">'</span>)
client_socket.send(img)

end_boundary = <span class="org-string">'\r\n--simple boundary--'</span>.encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{end_boundary}<span class="org-string">'</span>)
client_socket.send(end_boundary)

<span class="org-comment-delimiter"># </span><span class="org-comment">Message ends with a single period.</span>
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{END_MSG.encode()}<span class="org-string">'</span>)
client_socket.send(END_MSG.encode())

<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Send QUIT command and get server response.</span>
quit_command = <span class="org-string">'QUIT\r\n'</span>.encode()
<span class="org-builtin">print</span>(f<span class="org-string">'---&gt; </span>{quit_command}<span class="org-string">'</span>)
client_socket.send(quit_command)
<span class="org-builtin">print</span>(f<span class="org-string">'&lt;- </span>{client_socket.recv(BUF_SIZE)}<span class="org-string">'</span>)

client_socket.close()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">% python mail_client.py <span class="org-variable-name">base64_codeEc0ejZzOFY</span>= mrcoinking@gmailcom shichaoxia@outlook.com $<span class="org-string">'Hi,\r\n\r\nHello'</span> a.jpeg
&lt;- b<span class="org-string">'220 smtp.gmail.com ESMTP ls16sm5331505pjb.49 - gsmtp\r\n'</span>
---&gt; b<span class="org-string">'HELO Alice\r\n'</span>
&lt;- b<span class="org-string">'250 smtp.gmail.com at your service\r\n'</span>
---&gt; b<span class="org-string">'AUTH PLAIN base64_codeEc0ejZzOFY= \r\n'</span>
&lt;- b<span class="org-string">'235 2.7.0 Accepted\r\n'</span>
---&gt; b<span class="org-string">'MAIL FROM: <a href="mailto:mrcoinking%40gmailcom">&lt;mrcoinking@gmailcom&gt;</a>\r\n'</span>
&lt;- b<span class="org-string">'250 2.1.0 OK ls16sm5331505pjb.49 - gsmtp\r\n'</span>
---&gt; b<span class="org-string">'RCPT TO: <a href="mailto:shichaoxia%40outlook.com">&lt;shichaoxia@outlook.com&gt;</a>\r\n'</span>
&lt;- b<span class="org-string">'250 2.1.5 OK ls16sm5331505pjb.49 - gsmtp\r\n'</span>
---&gt; b<span class="org-string">'DATA\r\n'</span>
&lt;- b<span class="org-string">'354  Go ahead ls16sm5331505pjb.49 - gsmtp\r\n'</span>
---&gt; b<span class="org-string">'MIME-Version: 1.0\r\nContent-Type: multipart/mixed; boundary="simple boundary\r\n\r\n'</span>
---&gt; b<span class="org-string">'--simple boundary\r\nContent-Type: text/plain; charset=utf-8\r\nContent-Transfer-Encoding: quoted-printable\r\nContent-Disposition: inline\r\n\r\n'</span>
---&gt; b<span class="org-string">'Hi,\r\n\r\nHello\r\n\r\n'</span>
---&gt; b<span class="org-string">'--simple boundary\r\nContent-Type: image/jpeg\r\nContent-Transfer-Encoding: BASE64\r\nContent-Disposition: inline\r\n\r\n'</span>
---&gt; b<span class="org-string">'base64_codeAQAASABIAAD/4QDfJMVKFds/8Am5QJf/wf/9k='</span>
---&gt; b<span class="org-string">'\r\n--simple boundary--'</span>
---&gt; b<span class="org-string">'\r\n.\r\n'</span>
&lt;- b<span class="org-string">'250 2.0.0 OK  1628159614 ls16sm5331505pjb.49 - gsmtp\r\n'</span>
---&gt; b<span class="org-string">'QUIT\r\n'</span>
&lt;- b<span class="org-string">'221 2.0.0 closing connection ls16sm5331505pjb.49 - gsmtp\r\n'</span>
</pre>
</div>

<p>
<b>参考</b><br />
</p>

<ul class="org-ul">
<li><a href="#org3a761ef">使用SMTP通过Gmail发送邮件 p.78</a><br /></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc1521#page-66">A Complex Multipart Example &#x2013;RFC1521</a><br /></li>
<li><p>
在命令行字符串中插入换行的问题（<a href="https://stackoverflow.com/a/26517782/10422197">stackoverflow</a>）<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">% python mail_client.py <span class="org-string">'Subject: DDDXXXX\n\nHello'</span>
b<span class="org-string">'Subject: Title\\n\\nHello'</span>
% python mail_client.py $<span class="org-string">'Subject: Title\n\nHello'</span>
b<span class="org-string">'Subject: Title\n\nHello'</span>
</pre>
</div></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgf2acc39" class="outline-4">
<h4 id="orgf2acc39">作业4：多线程Web代理服务器</h4>
<div class="outline-text-4" id="text-orgf2acc39">
<p>
在这个编程作业中，你将研发一个简单的Web代理服务器。当你的代理服务器从一个浏览器接收到对某对象的HTTP请求，它生成对相同对象的一个新HTTP请求并向初始服务器发送。当该代理从初始服务器接收到具有该对象的HTTP响应时，它生成一个包括该对象的新HTTP响应，并发送给该客户。这个代理将是多线程的，使其在相同时间能够处理多个诮求。<br />
对本作业而言，配套Web网站对该代理服务器提供了框架代码。你的任务是完善该代码，然后测试你的代理，方法是让不同的浏览器经过你的代理来请求Web对象。<br />
</p>

<p>
<a href="code/ch2-proxy-server/socket4-proxyserver.pdf">Socket Programming Assignment 4: HTTP Web Proxy Server</a><br />
</p>
</div>

<ul class="org-ul">
<li><a id="org4aa2b9d"></a>Hand in<br />
<div class="outline-text-5" id="text-org4aa2b9d">
<p>
You can also directly configure your web browser to use your proxy. With this approach, to get a web page using the proxy server, you simply provide the URL of the page you want.<br />
</p>

<p>
For e.g. <a href="http://www.google.com">http://www.google.com</a><br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-doc">"""HTTP Web Proxy Server</span>
<span class="org-doc">"""</span>

<span class="org-keyword">import</span> socket
<span class="org-keyword">import</span> sys
<span class="org-keyword">import</span> argparse

<span class="org-variable-name">parser</span> = argparse.ArgumentParser()
parser.add_argument(<span class="org-string">'server_ip'</span>, <span class="org-builtin">help</span>=<span class="org-string">'IP address of proxy server'</span>)
parser.add_argument(<span class="org-string">'port'</span>, <span class="org-builtin">type</span>=<span class="org-builtin">int</span>, <span class="org-builtin">help</span>=<span class="org-string">'Port of proxy server'</span>)
args = parser.parse_args()

<span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; args: </span>{args}<span class="org-string">'</span>)

HOST = args.server_ip
PORT = args.port
BUFSIZE = 1024

tcp_ser_sock = socket.socket(family=socket.AF_INET, <span class="org-builtin">type</span>=socket.SOCK_STREAM)
tcp_ser_sock.bind((HOST, PORT))
tcp_ser_sock.listen()

<span class="org-keyword">while</span> <span class="org-constant">True</span>:
    <span class="org-builtin">print</span>(<span class="org-string">'&gt;&gt;&gt; Ready to serve...'</span>)
    tcp_cli_sock, addr = tcp_ser_sock.accept()
    <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; Received a connection from: </span>{addr}<span class="org-string">'</span>)

    message = tcp_cli_sock.recv(BUFSIZE).decode()
    <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; Received request message:\n</span>{message}<span class="org-string">'</span>)

    <span class="org-comment-delimiter"># </span><span class="org-comment">GET /www.dianping.com HTTP/1.1</span>
    path = message.split()[1]  <span class="org-comment-delimiter"># </span><span class="org-comment">/www.dianping.com</span>
    <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; path: </span>{path}<span class="org-string">'</span>)
    rel_path = path.partition(<span class="org-string">"/"</span>)[2]  <span class="org-comment-delimiter"># </span><span class="org-comment">www.dianping.com</span>
    <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; rel_path: </span>{rel_path}<span class="org-string">'</span>)

    <span class="org-keyword">try</span>:
        <span class="org-builtin">print</span>(<span class="org-string">'&gt;&gt;&gt; Try to read from cache file'</span>)
        f = <span class="org-builtin">open</span>(rel_path, <span class="org-string">'r'</span>)
        file_content = f.readlines()
        <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; Cache File content:\n</span>{file_content[0:10]}<span class="org-string">...'</span>)

        send_content = <span class="org-builtin">list</span>(<span class="org-builtin">map</span>(<span class="org-keyword">lambda</span> l: l.replace(<span class="org-string">'\n'</span>, <span class="org-string">'\r\n'</span>), file_content))

        <span class="org-keyword">for</span> l <span class="org-keyword">in</span> send_content:
            tcp_cli_sock.send(l.encode())

        <span class="org-builtin">print</span>(<span class="org-string">'Read from cache'</span>)
    <span class="org-keyword">except</span> <span class="org-type">IOError</span>:
        <span class="org-builtin">print</span>(<span class="org-string">'&gt;&gt;&gt; Failed to read cache file'</span>)
        <span class="org-builtin">print</span>(<span class="org-string">'&gt;&gt;&gt; Try to connect origin host'</span>)
        c = socket.socket(family=socket.AF_INET, <span class="org-builtin">type</span>=socket.SOCK_STREAM)
        hostn = rel_path.replace(<span class="org-string">'www.'</span>, <span class="org-string">''</span>, 1)
        <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; hostn: </span>{hostn}<span class="org-string">'</span>)

        c.connect((hostn, 80))

        rqst = (<span class="org-string">'GET / HTTP/1.0\r\n'</span>
                <span class="org-string">'\r\n'</span>).encode()
        <span class="org-builtin">print</span>(f<span class="org-string">'Send request:\n</span>{rqst}<span class="org-string">'</span>)
        c.send(rqst)

        resp = b<span class="org-string">''</span>
        <span class="org-keyword">while</span> <span class="org-constant">True</span>:
            part = c.recv(BUFSIZE)
            resp += part
            <span class="org-keyword">if</span> <span class="org-builtin">len</span>(part) == 0:
                <span class="org-comment-delimiter"># </span><span class="org-comment">end of data</span>
                <span class="org-keyword">break</span>

        <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; resp: </span>{resp[0:10]}<span class="org-string">...'</span>)
        c.close()

        tcp_cli_sock.send(resp)

        cache_path = f<span class="org-string">'./</span>{rel_path}<span class="org-string">'</span>
        <span class="org-builtin">print</span>(f<span class="org-string">'&gt;&gt;&gt; Cache response to </span>{cache_path}<span class="org-string">'</span>)
        <span class="org-keyword">with</span> <span class="org-builtin">open</span>(cache_path, <span class="org-string">'wb'</span>) <span class="org-keyword">as</span> f:
            f.write(resp)

    tcp_cli_sock.close()

tcp_ser_sock.close()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">% python proxy_server.py 127.0.0.1 12008
&gt;&gt;&gt; args: Namespace(<span class="org-variable-name">server_ip</span>=<span class="org-string">'127.0.0.1'</span>, <span class="org-variable-name">port</span>=12008)
&gt;&gt;&gt; Ready to serve...
&gt;&gt;&gt; Received a connection from: (<span class="org-string">'127.0.0.1'</span>, 53325)
&gt;&gt;&gt; Received request message:
GET /www.dianping.com HTTP/1.1
Host: 127.0.0.1:12008
Upgrade-Insecure-Requests: 1
Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,*/*;<span class="org-variable-name">q</span>=0.8
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Connection: keep-alive


&gt;&gt;&gt; path: /www.dianping.com
&gt;&gt;&gt; rel_path: www.dianping.com
&gt;&gt;&gt; Try to read from cache file
&gt;&gt;&gt; Failed to read cache file
&gt;&gt;&gt; Try to connect origin host
&gt;&gt;&gt; hostn: dianping.com
Send request:
b<span class="org-string">'GET / HTTP/1.0\r\n\r\n'</span>
&gt;&gt;&gt; resp: b<span class="org-string">'HTTP/1.1 2'</span>...
&gt;&gt;&gt; Cache response to ./www.dianping.com
&gt;&gt;&gt; Ready to serve...
&gt;&gt;&gt; Received a connection from: (<span class="org-string">'127.0.0.1'</span>, 53327)
&gt;&gt;&gt; Received request message:
GET /www.dianping.com HTTP/1.1
Host: 127.0.0.1:12008
Upgrade-Insecure-Requests: 1
Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,*/*;<span class="org-variable-name">q</span>=0.8
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15
Accept-Language: en-us
Accept-Encoding: gzip, deflate
Connection: keep-alive


&gt;&gt;&gt; path: /www.dianping.com
&gt;&gt;&gt; rel_path: www.dianping.com
&gt;&gt;&gt; Try to read from cache file
&gt;&gt;&gt; Cache File content:
[<span class="org-string">'HTTP/1.1 200 OK\n'</span>, <span class="org-string">'Server: openresty\n'</span>, <span class="org-string">'Date: Thu, 12 Aug 2021 07:44:11 GMT\n'</span>, <span class="org-string">'Content-Type: text/html; charset=utf-8\n'</span>, <span class="org-string">'Content-Length: 6789\n'</span>, <span class="org-string">'Last-Modified: Wed, 31 Jul 2019 07:08:07 GMT\n'</span>, <span class="org-string">'Connection: close\n'</span>, <span class="org-string">'Vary: Accept-Encoding\n'</span>, <span class="org-string">'ETag: "5d413e57-1a85"\n'</span>, <span class="org-string">'Expires: Wed, 12 Aug 2020 07:44:11 GMT\n'</span>]...
Read from cache
&gt;&gt;&gt; Ready to serve...
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org2d22f5f" class="outline-3">
<h3 id="org2d22f5f"><span class="section-number-3">2.5.</span> Wireshark实验：HTTP</h3>
<div class="outline-text-3" id="text-2-5">
<p>
在实验1中，我们已经初步使用了Wireshark分组嗅探器，现在准备使用Wireshark来研究运行中的协议。在本实验中，我们将研究HTTP协议的儿个方面:基本的GET/回答交互，HTTP报文格式，检索大HTML文件，检索具有内嵌URL的HTML文件，持续和非持续连接，HTTP鉴别和安全性。<br />
</p>

<p>
<a href="code/ch2-ws-http/wireshark-http-v7.0.pdf">Wireshark Lab: HTTP v7.0</a><br />
</p>
</div>

<div id="outline-container-orge99a17c" class="outline-4">
<h4 id="orge99a17c">1. The Basic HTTP GET/response interaction</h4>
<div class="outline-text-4" id="text-orge99a17c">
<ol class="org-ol">
<li>Is your browser running HTTP version 1.0 or 1.1? What version of HTTP is the server running?<br /></li>
<li>What languages (if any) does your browser indicate that it can accept to the server?<br /></li>
<li>What is the IP address of your computer? Of the gaia.cs.umass.edu server?<br /></li>
<li>What is the status code returned from the server to your browser?<br /></li>
<li>When was the HTML file that you are retrieving last modified at the server?<br /></li>
<li>How many bytes of content are being returned to your browser?<br /></li>
<li>By inspecting the raw data in the packet content window, do you see any headers within the data that are not displayed in the packet-listing window? If so, name one.<br /></li>
</ol>


<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>    199 8.457561       192.168.1.72          128.119.245.12        HTTP     586    GET /wireshark-labs/HTTP-wireshark-file1.html HTTP/1.1
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 199: 586 bytes on wire (4688 bits), 586 bytes captured (4688 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr"> 7: </span>Transmission Control Protocol, Src Port: 51508, Dst Port: 80, Seq: 1, Ack: 1, Len: 520
<span class="linenr"> 8: </span>Hypertext Transfer Protocol
<span class="linenr"> 9: </span>    GET /wireshark-labs/HTTP-wireshark-file1.html HTTP/1.1\r\n
<span class="linenr">10: </span>    Host: gaia.cs.umass.edu\r\n
<span class="linenr">11: </span>    Connection: keep-alive\r\n
<span class="linenr">12: </span>    Upgrade-Insecure-Requests: 1\r\n
<span class="linenr">13: </span>    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36 Edg/92.0.902.73\r\n
<span class="linenr">14: </span>    Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,image/webp,image/apng,*/*;<span class="org-variable-name">q</span>=0.8,application/signed-exchange;<span class="org-variable-name">v</span>=b3;<span class="org-variable-name">q</span>=0.9\r\n
<span class="linenr">15: </span>    Accept-Encoding: gzip, deflate\r\n
<span class="linenr">16: </span>    Accept-Language: zh-CN,zh;<span class="org-variable-name">q</span>=0.9,en;<span class="org-variable-name">q</span>=0.8,en-GB;<span class="org-variable-name">q</span>=0.7,en-US;<span class="org-variable-name">q</span>=0.6\r\n
<span class="linenr">17: </span>    \r\n
<span class="linenr">18: </span>    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html]
<span class="linenr">19: </span>    [HTTP request 1/2]
<span class="linenr">20: </span>    [Response<span class="org-keyword"> in</span> frame: 261]
<span class="linenr">21: </span>    [Next request<span class="org-keyword"> in</span> frame: 268]
<span class="linenr">22: </span>
<span class="linenr">23: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">24: </span>    261 8.691763       128.119.245.12        192.168.1.72          HTTP     552    HTTP/1.1 200 OK  (text/html)
<span class="linenr">25: </span>
<span class="linenr">26: </span>Frame 261: 552 bytes on wire (4416 bits), 552 bytes captured (4416 bits) on interface en1, id 0
<span class="linenr">27: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">28: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr">29: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 51508, Seq: 1, Ack: 521, Len: 486
<span class="linenr">30: </span>Hypertext Transfer Protocol
<span class="linenr">31: </span>    HTTP/1.1 200 OK\r\n
<span class="linenr">32: </span>    Date: Fri, 13 Aug 2021 02:30:45 GMT\r\n
<span class="linenr">33: </span>    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr">34: </span>    Last-Modified: Thu, 12 Aug 2021 05:59:01 GMT\r\n
<span class="linenr">35: </span>    ETag: <span class="org-string">"80-5c9566e787afe"</span>\r\n
<span class="linenr">36: </span>    Accept-Ranges: bytes\r\n
<span class="linenr">37: </span>    Content-Length: 128\r\n
<span class="linenr">38: </span>    Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=100\r\n
<span class="linenr">39: </span>    Connection: Keep-Alive\r\n
<span class="linenr">40: </span>    Content-Type: text/html; <span class="org-variable-name">charset</span>=UTF-8\r\n
<span class="linenr">41: </span>    \r\n
<span class="linenr">42: </span>    [HTTP response 1/2]
<span class="linenr">43: </span>    [Time since request: 0.234202000 seconds]
<span class="linenr">44: </span>    [Request<span class="org-keyword"> in</span> frame: 199]
<span class="linenr">45: </span>    [Next request<span class="org-keyword"> in</span> frame: 268]
<span class="linenr">46: </span>    [Next response<span class="org-keyword"> in</span> frame: 276]
<span class="linenr">47: </span>    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file1.html]
<span class="linenr">48: </span>    File Data: 128 bytes
<span class="linenr">49: </span>Line-based text data: text/html (4 lines)
</pre>
</div>

<ol class="org-ol">
<li>Line 11, 31. HTTP/1.1<br /></li>
<li>Line 16. Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6<br /></li>
<li>Line 6. Src: 192.168.1.72, Dst: 128.119.245.12<br /></li>
<li>Line 31. 200 OK<br /></li>
<li>Line 34. Last-Modified: Thu, 12 Aug 2021 05:59:01 GMT<br /></li>
<li>Line 37. Content-Length: 128<br /></li>
<li>packet-listing window 只显示了请求行<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org4ce62a2" class="outline-4">
<h4 id="org4ce62a2">2. The HTTP CONDITIONAL GET/response interaction</h4>
<div class="outline-text-4" id="text-org4ce62a2">
<ol class="org-ol">
<li value="8">Inspect the contents of the first HTTP GET request from your browser to the server. Do you see an “IF-MODIFIED-SINCE” line in the HTTP GET?<br /></li>
<li>Inspect the contents of the server response. Did the server explicitly return the contents of the file? How can you tell?<br /></li>
<li>Now inspect the contents of the second HTTP GET request from your browser to the server. Do you see an “IF-MODIFIED-SINCE:” line in the HTTP GET? If so, what information follows the “IF-MODIFIED-SINCE:” header?<br /></li>
<li>What is the HTTP status code and phrase returned from the server in response to this second HTTP GET? Did the server explicitly return the contents of the file? Explain.<br /></li>
</ol>


<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>    259 21.077378      192.168.1.72          128.119.245.12        HTTP     586    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 259: 586 bytes on wire (4688 bits), 586 bytes captured (4688 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr"> 7: </span>Transmission Control Protocol, Src Port: 54686, Dst Port: 80, Seq: 1, Ack: 1, Len: 520
<span class="linenr"> 8: </span>Hypertext Transfer Protocol
<span class="linenr"> 9: </span>    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1\r\n
<span class="linenr">10: </span>    Host: gaia.cs.umass.edu\r\n
<span class="linenr">11: </span>    Connection: keep-alive\r\n
<span class="linenr">12: </span>    Upgrade-Insecure-Requests: 1\r\n
<span class="linenr">13: </span>    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36 Edg/92.0.902.73\r\n
<span class="linenr">14: </span>    Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,image/webp,image/apng,*/*;<span class="org-variable-name">q</span>=0.8,application/signed-exchange;<span class="org-variable-name">v</span>=b3;<span class="org-variable-name">q</span>=0.9\r\n
<span class="linenr">15: </span>    Accept-Encoding: gzip, deflate\r\n
<span class="linenr">16: </span>    Accept-Language: zh-CN,zh;<span class="org-variable-name">q</span>=0.9,en;<span class="org-variable-name">q</span>=0.8,en-GB;<span class="org-variable-name">q</span>=0.7,en-US;<span class="org-variable-name">q</span>=0.6\r\n
<span class="linenr">17: </span>    \r\n
<span class="linenr">18: </span>    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
<span class="linenr">19: </span>    [HTTP request 1/3]
<span class="linenr">20: </span>    [Response<span class="org-keyword"> in</span> frame: 266]
<span class="linenr">21: </span>    [Next request<span class="org-keyword"> in</span> frame: 268]
<span class="linenr">22: </span>
<span class="linenr">23: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">24: </span>    266 21.473567      128.119.245.12        192.168.1.72          HTTP     796    HTTP/1.1 200 OK  (text/html)
<span class="linenr">25: </span>
<span class="linenr">26: </span>Frame 266: 796 bytes on wire (6368 bits), 796 bytes captured (6368 bits) on interface en1, id 0
<span class="linenr">27: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">28: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr">29: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 54686, Seq: 1, Ack: 521, Len: 730
<span class="linenr">30: </span>Hypertext Transfer Protocol
<span class="linenr">31: </span>    HTTP/1.1 200 OK\r\n
<span class="linenr">32: </span>    Date: Fri, 13 Aug 2021 04:03:23 GMT\r\n
<span class="linenr">33: </span>    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr">34: </span>    Last-Modified: Thu, 12 Aug 2021 05:59:01 GMT\r\n
<span class="linenr">35: </span>    ETag: <span class="org-string">"173-5c9566e78732e"</span>\r\n
<span class="linenr">36: </span>    Accept-Ranges: bytes\r\n
<span class="linenr">37: </span>    Content-Length: 371\r\n
<span class="linenr">38: </span>    Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=100\r\n
<span class="linenr">39: </span>    Connection: Keep-Alive\r\n
<span class="linenr">40: </span>    Content-Type: text/html; <span class="org-variable-name">charset</span>=UTF-8\r\n
<span class="linenr">41: </span>    \r\n
<span class="linenr">42: </span>    [HTTP response 1/3]
<span class="linenr">43: </span>    [Time since request: 0.396189000 seconds]
<span class="linenr">44: </span>    [Request<span class="org-keyword"> in</span> frame: 259]
<span class="linenr">45: </span>    [Next request<span class="org-keyword"> in</span> frame: 268]
<span class="linenr">46: </span>    [Next response<span class="org-keyword"> in</span> frame: 271]
<span class="linenr">47: </span>    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
<span class="linenr">48: </span>    File Data: 371 bytes
<span class="linenr">49: </span>Line-based text data: text/html (10 lines)
<span class="linenr">50: </span>    \n
<span class="linenr">51: </span>    &lt;html&gt;\n
<span class="linenr">52: </span>    \n
<span class="linenr">53: </span>    Congratulations again!  Now you<span class="org-string">'ve downloaded the file lab2-2.html. &lt;br&gt;\n</span>
<span class="linenr">54: </span><span class="org-string">    This file'</span>s last modification date will not change.  &lt;p&gt;\n
<span class="linenr">55: </span>    Thus  if you download this multiple times on your browser, a complete copy &lt;br&gt;\n
<span class="linenr">56: </span>    will only be sent once by the server due to the inclusion of the IN-MODIFIED-SINCE&lt;br&gt;\n
<span class="linenr">57: </span>    field<span class="org-keyword"> in</span> your browser<span class="org-string">'s HTTP GET request to the server.\n</span>
<span class="linenr">58: </span><span class="org-string">    \n</span>
<span class="linenr">59: </span><span class="org-string">    &lt;/html&gt;\n</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 60: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 61: </span>    294 25.273673      192.168.1.72          128.119.245.12        HTTP     698    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1
<span class="linenr"> 62: </span>
<span class="linenr"> 63: </span>Frame 294: 698 bytes on wire (5584 bits), 698 bytes captured (5584 bits) on interface en1, id 0
<span class="linenr"> 64: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 65: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr"> 66: </span>Transmission Control Protocol, Src Port: 54686, Dst Port: 80, Seq: 987, Ack: 1215, Len: 632
<span class="linenr"> 67: </span>Hypertext Transfer Protocol
<span class="linenr"> 68: </span>    GET /wireshark-labs/HTTP-wireshark-file2.html HTTP/1.1\r\n
<span class="linenr"> 69: </span>    Host: gaia.cs.umass.edu\r\n
<span class="linenr"> 70: </span>    Connection: keep-alive\r\n
<span class="linenr"> 71: </span>    Cache-Control: max-age=0\r\n
<span class="linenr"> 72: </span>    Upgrade-Insecure-Requests: 1\r\n
<span class="linenr"> 73: </span>    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36 Edg/92.0.902.73\r\n
<span class="linenr"> 74: </span>    Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,image/webp,image/apng,*/*;<span class="org-variable-name">q</span>=0.8,application/signed-exchange;<span class="org-variable-name">v</span>=b3;<span class="org-variable-name">q</span>=0.9\r\n
<span class="linenr"> 75: </span>    Accept-Encoding: gzip, deflate\r\n
<span class="linenr"> 76: </span>    Accept-Language: zh-CN,zh;<span class="org-variable-name">q</span>=0.9,en;<span class="org-variable-name">q</span>=0.8,en-GB;<span class="org-variable-name">q</span>=0.7,en-US;<span class="org-variable-name">q</span>=0.6\r\n
<span class="linenr"> 77: </span>    If-None-Match: <span class="org-string">"173-5c9566e78732e"</span>\r\n
<span class="linenr"> 78: </span>    If-Modified-Since: Thu, 12 Aug 2021 05:59:01 GMT\r\n
<span class="linenr"> 79: </span>    \r\n
<span class="linenr"> 80: </span>    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
<span class="linenr"> 81: </span>    [HTTP request 3/3]
<span class="linenr"> 82: </span>    [Prev request<span class="org-keyword"> in</span> frame: 268]
<span class="linenr"> 83: </span>    [Response<span class="org-keyword"> in</span> frame: 295]
<span class="linenr"> 84: </span>
<span class="linenr"> 85: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 86: </span>    295 25.907813      128.119.245.12        192.168.1.72          HTTP     305    HTTP/1.1 304 Not Modified
<span class="linenr"> 87: </span>
<span class="linenr"> 88: </span>Frame 295: 305 bytes on wire (2440 bits), 305 bytes captured (2440 bits) on interface en1, id 0
<span class="linenr"> 89: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr"> 90: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr"> 91: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 54686, Seq: 1215, Ack: 1619, Len: 239
<span class="linenr"> 92: </span>Hypertext Transfer Protocol
<span class="linenr"> 93: </span>    HTTP/1.1 304 Not Modified\r\n
<span class="linenr"> 94: </span>    Date: Fri, 13 Aug 2021 04:03:27 GMT\r\n
<span class="linenr"> 95: </span>    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr"> 96: </span>    Connection: Keep-Alive\r\n
<span class="linenr"> 97: </span>    Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=98\r\n
<span class="linenr"> 98: </span>    ETag: <span class="org-string">"173-5c9566e78732e"</span>\r\n
<span class="linenr"> 99: </span>    \r\n
<span class="linenr">100: </span>    [HTTP response 3/3]
<span class="linenr">101: </span>    [Time since request: 0.634140000 seconds]
<span class="linenr">102: </span>    [Prev request<span class="org-keyword"> in</span> frame: 268]
<span class="linenr">103: </span>    [Prev response<span class="org-keyword"> in</span> frame: 271]
<span class="linenr">104: </span>    [Request<span class="org-keyword"> in</span> frame: 294]
<span class="linenr">105: </span>    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file2.html]
</pre>
</div>

<ol class="org-ol">
<li value="8">No<br /></li>
<li>Line 37, 40.<br />
Content-Length: 371<br />
Content-Type: text/html; charset=UTF-8<br /></li>
<li>Line 34, 78.<br />
Time follows the “IF-MODIFIED-SINCE:” header is exactly same as previous received file.<br /></li>
<li>Line 93. 304 Not Modified<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org88d3d82" class="outline-4">
<h4 id="org88d3d82">3. Retrieving Long Documents</h4>
<div class="outline-text-4" id="text-org88d3d82">
<ol class="org-ol">
<li value="12">How many HTTP GET request messages did your browser send? Which packet number in the trace contains the GET message for the Bill or Rights?<br /></li>
<li>Which packet number in the trace contains the status code and phrase associated with the response to the HTTP GET request?<br /></li>
<li>What is the status code and phrase in the response?<br /></li>
<li>How many data-containing TCP segments were needed to carry the single HTTP response and the text of the Bill of Rights?<br /></li>
</ol>


<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>     33 9.554387       192.168.1.72          128.119.245.12        HTTP     465    GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 33: 465 bytes on wire (3720 bits), 465 bytes captured (3720 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr"> 7: </span>Transmission Control Protocol, Src Port: 57878, Dst Port: 80, Seq: 1, Ack: 1, Len: 399
<span class="linenr"> 8: </span>Hypertext Transfer Protocol
<span class="linenr"> 9: </span>    GET /wireshark-labs/HTTP-wireshark-file3.html HTTP/1.1\r\n
<span class="linenr">10: </span>    Host: gaia.cs.umass.edu\r\n
<span class="linenr">11: </span>    Upgrade-Insecure-Requests: 1\r\n
<span class="linenr">12: </span>    Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,*/*;<span class="org-variable-name">q</span>=0.8\r\n
<span class="linenr">13: </span>    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15\r\n
<span class="linenr">14: </span>    Accept-Language: zh-cn\r\n
<span class="linenr">15: </span>    Accept-Encoding: gzip, deflate\r\n
<span class="linenr">16: </span>    Connection: keep-alive\r\n
<span class="linenr">17: </span>    \r\n
<span class="linenr">18: </span>    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html]
<span class="linenr">19: </span>    [HTTP request 1/1]
<span class="linenr">20: </span>    [Response<span class="org-keyword"> in</span> frame: 38]
<span class="linenr">21: </span>
<span class="linenr">22: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">23: </span>     38 9.865603       128.119.245.12        192.168.1.72          HTTP     607    HTTP/1.1 200 OK  (text/html)
<span class="linenr">24: </span>
<span class="linenr">25: </span>Frame 38: 607 bytes on wire (4856 bits), 607 bytes captured (4856 bits) on interface en1, id 0
<span class="linenr">26: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">27: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr">28: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 57878, Seq: 4321, Ack: 400, Len: 541
<span class="linenr">29: </span>[4 Reassembled TCP Segments (4861 bytes): <span class="org-comment-delimiter">#</span><span class="org-comment">35(1440), #36(1440), #37(1440), #38(541)]</span>
<span class="linenr">30: </span>    [Frame: 35, payload: 0-1439 (1440 bytes)]
<span class="linenr">31: </span>    [Frame: 36, payload: 1440-2879 (1440 bytes)]
<span class="linenr">32: </span>    [Frame: 37, payload: 2880-4319 (1440 bytes)]
<span class="linenr">33: </span>    [Frame: 38, payload: 4320-4860 (541 bytes)]
<span class="linenr">34: </span>    [Segment count: 4]
<span class="linenr">35: </span>    [Reassembled TCP length: 4861]
<span class="linenr">36: </span>    [Reassembled TCP Data: 485454502f312e3120323030204f4b0d0a446174653a204672692c203133204175672032&#8230;]
<span class="linenr">37: </span>Hypertext Transfer Protocol
<span class="linenr">38: </span>    HTTP/1.1 200 OK\r\n
<span class="linenr">39: </span>    Date: Fri, 13 Aug 2021 06:27:57 GMT\r\n
<span class="linenr">40: </span>    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr">41: </span>    Last-Modified: Fri, 13 Aug 2021 05:59:01 GMT\r\n
<span class="linenr">42: </span>    ETag: <span class="org-string">"1194-5c96a8c545fd2"</span>\r\n
<span class="linenr">43: </span>    Accept-Ranges: bytes\r\n
<span class="linenr">44: </span>    Content-Length: 4500\r\n
<span class="linenr">45: </span>    Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=100\r\n
<span class="linenr">46: </span>    Connection: Keep-Alive\r\n
<span class="linenr">47: </span>    Content-Type: text/html; <span class="org-variable-name">charset</span>=UTF-8\r\n
<span class="linenr">48: </span>    \r\n
<span class="linenr">49: </span>    [HTTP response 1/1]
<span class="linenr">50: </span>    [Time since request: 0.311216000 seconds]
<span class="linenr">51: </span>    [Request<span class="org-keyword"> in</span> frame: 33]
<span class="linenr">52: </span>    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file3.html]
<span class="linenr">53: </span>    File Data: 4500 bytes
<span class="linenr">54: </span>Line-based text data: text/html (98 lines)
</pre>
</div>

<ol class="org-ol">
<li value="12">Line 2. 1 request, number 33.<br /></li>
<li>Line 23. number 38.<br /></li>
<li>Line 38. 200 OK<br /></li>
<li>Line 29-36. 4<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgba528dd" class="outline-4">
<h4 id="orgba528dd">4. HTML Documents with Embedded Objects</h4>
<div class="outline-text-4" id="text-orgba528dd">
<ol class="org-ol">
<li value="16">How many HTTP GET request messages did your browser send? To which Internet addresses were these GET requests sent?<br /></li>
<li>Can you tell whether your browser downloaded the two images serially, or whether they were downloaded from the two web sites in parallel? Explain.<br /></li>
</ol>


<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>1090 5.525870       192.168.1.72          128.119.245.12        HTTP     465    GET /wireshark-labs/HTTP-wireshark-file4.html HTTP/1.1
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 1090: 465 bytes on wire (3720 bits), 465 bytes captured (3720 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr"> 7: </span>Transmission Control Protocol, Src Port: 58171, Dst Port: 80, Seq: 1, Ack: 1, Len: 399
<span class="linenr"> 8: </span>Hypertext Transfer Protocol
<span class="linenr"> 9: </span>GET /wireshark-labs/HTTP-wireshark-file4.html HTTP/1.1\r\n
<span class="linenr">10: </span>Host: gaia.cs.umass.edu\r\n
<span class="linenr">11: </span>Upgrade-Insecure-Requests: 1\r\n
<span class="linenr">12: </span>Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,*/*;<span class="org-variable-name">q</span>=0.8\r\n
<span class="linenr">13: </span>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15\r\n
<span class="linenr">14: </span>Accept-Language: zh-cn\r\n
<span class="linenr">15: </span>Accept-Encoding: gzip, deflate\r\n
<span class="linenr">16: </span>Connection: keep-alive\r\n
<span class="linenr">17: </span>\r\n
<span class="linenr">18: </span>[Full request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file4.html]
<span class="linenr">19: </span>[HTTP request 1/1]
<span class="linenr">20: </span>[Response<span class="org-keyword"> in</span> frame: 1097]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">21: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">22: </span>1097 5.835839       128.119.245.12        192.168.1.72          HTTP     1367   HTTP/1.1 200 OK  (text/html)
<span class="linenr">23: </span>
<span class="linenr">24: </span>Frame 1097: 1367 bytes on wire (10936 bits), 1367 bytes captured (10936 bits) on interface en1, id 0
<span class="linenr">25: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">26: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr">27: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 58171, Seq: 1, Ack: 400, Len: 1301
<span class="linenr">28: </span>Hypertext Transfer Protocol
<span class="linenr">29: </span>HTTP/1.1 200 OK\r\n
<span class="linenr">30: </span>Date: Fri, 13 Aug 2021 06:55:59 GMT\r\n
<span class="linenr">31: </span>Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr">32: </span>Last-Modified: Fri, 13 Aug 2021 05:59:01 GMT\r\n
<span class="linenr">33: </span>ETag: <span class="org-string">"3ae-5c96a8c54b1da"</span>\r\n
<span class="linenr">34: </span>Accept-Ranges: bytes\r\n
<span class="linenr">35: </span>Content-Length: 942\r\n
<span class="linenr">36: </span>Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=100\r\n
<span class="linenr">37: </span>Connection: Keep-Alive\r\n
<span class="linenr">38: </span>Content-Type: text/html; <span class="org-variable-name">charset</span>=UTF-8\r\n
<span class="linenr">39: </span>\r\n
<span class="linenr">40: </span>[HTTP response 1/1]
<span class="linenr">41: </span>[Time since request: 0.309969000 seconds]
<span class="linenr">42: </span>[Request<span class="org-keyword"> in</span> frame: 1090]
<span class="linenr">43: </span>[Request URI: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file4.html]
<span class="linenr">44: </span>File Data: 942 bytes
<span class="linenr">45: </span>Line-based text data: text/html (23 lines)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">46: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">47: </span>1105 6.143539       192.168.1.72          178.79.137.164        HTTP     458    GET /8E_cover_small.jpg HTTP/1.1
<span class="linenr">48: </span>
<span class="linenr">49: </span>Frame 1105: 458 bytes on wire (3664 bits), 458 bytes captured (3664 bits) on interface en1, id 0
<span class="linenr">50: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">51: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 178.79.137.164
<span class="linenr">52: </span>Transmission Control Protocol, Src Port: 58173, Dst Port: 80, Seq: 1, Ack: 1, Len: 392
<span class="linenr">53: </span>Hypertext Transfer Protocol
<span class="linenr">54: </span>GET /8E_cover_small.jpg HTTP/1.1\r\n
<span class="linenr">55: </span>Host: kurose.cslash.net\r\n
<span class="linenr">56: </span>Connection: keep-alive\r\n
<span class="linenr">57: </span>Accept: image/webp,image/png,image/svg+xml,image/*;<span class="org-variable-name">q</span>=0.8,video/*;<span class="org-variable-name">q</span>=0.8,*/*;<span class="org-variable-name">q</span>=0.5\r\n
<span class="linenr">58: </span>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15\r\n
<span class="linenr">59: </span>Accept-Language: zh-cn\r\n
<span class="linenr">60: </span>Referer: http://gaia.cs.umass.edu/\r\n
<span class="linenr">61: </span>Accept-Encoding: gzip, deflate\r\n
<span class="linenr">62: </span>\r\n
<span class="linenr">63: </span>[Full request URI: http://kurose.cslash.net/8E_cover_small.jpg]
<span class="linenr">64: </span>[HTTP request 1/1]
<span class="linenr">65: </span>[Response<span class="org-keyword"> in</span> frame: 1112]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">66: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">67: </span>1106 6.143774       192.168.1.72          128.119.245.12        HTTP     491    GET /pearson.png HTTP/1.1
<span class="linenr">68: </span>
<span class="linenr">69: </span>Frame 1106: 491 bytes on wire (3928 bits), 491 bytes captured (3928 bits) on interface en1, id 0
<span class="linenr">70: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">71: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr">72: </span>Transmission Control Protocol, Src Port: 58172, Dst Port: 80, Seq: 1, Ack: 1, Len: 425
<span class="linenr">73: </span>Hypertext Transfer Protocol
<span class="linenr">74: </span>GET /pearson.png HTTP/1.1\r\n
<span class="linenr">75: </span>Host: gaia.cs.umass.edu\r\n
<span class="linenr">76: </span>Connection: keep-alive\r\n
<span class="linenr">77: </span>Accept: image/webp,image/png,image/svg+xml,image/*;<span class="org-variable-name">q</span>=0.8,video/*;<span class="org-variable-name">q</span>=0.8,*/*;<span class="org-variable-name">q</span>=0.5\r\n
<span class="linenr">78: </span>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15\r\n
<span class="linenr">79: </span>Accept-Language: zh-cn\r\n
<span class="linenr">80: </span>Referer: http://gaia.cs.umass.edu/wireshark-labs/HTTP-wireshark-file4.html\r\n
<span class="linenr">81: </span>Accept-Encoding: gzip, deflate\r\n
<span class="linenr">82: </span>\r\n
<span class="linenr">83: </span>[Full request URI: http://gaia.cs.umass.edu/pearson.png]
<span class="linenr">84: </span>[HTTP request 1/1]
<span class="linenr">85: </span>[Response<span class="org-keyword"> in</span> frame: 1110]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 86: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 87: </span>1110 6.462949       128.119.245.12        192.168.1.72          HTTP     798    HTTP/1.1 200 OK  (PNG)
<span class="linenr"> 88: </span>
<span class="linenr"> 89: </span>Frame 1110: 798 bytes on wire (6384 bits), 798 bytes captured (6384 bits) on interface en1, id 0
<span class="linenr"> 90: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr"> 91: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr"> 92: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 58172, Seq: 2881, Ack: 426, Len: 732
<span class="linenr"> 93: </span>[3 Reassembled TCP Segments (3612 bytes): <span class="org-comment-delimiter">#</span><span class="org-comment">1108(1440), #1109(1440), #1110(732)]</span>
<span class="linenr"> 94: </span> Hypertext Transfer Protocol
<span class="linenr"> 95: </span> HTTP/1.1 200 OK\r\n
<span class="linenr"> 96: </span> Date: Fri, 13 Aug 2021 06:55:59 GMT\r\n
<span class="linenr"> 97: </span> Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr"> 98: </span> Last-Modified: Sat, 06 Aug 2016 10:08:14 GMT\r\n
<span class="linenr"> 99: </span> ETag: <span class="org-string">"cc3-539645c7f1ee7"</span>\r\n
<span class="linenr">100: </span> Accept-Ranges: bytes\r\n
<span class="linenr">101: </span> Content-Length: 3267\r\n
<span class="linenr">102: </span> Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=100\r\n
<span class="linenr">103: </span> Connection: Keep-Alive\r\n
<span class="linenr">104: </span> Content-Type: image/png\r\n
<span class="linenr">105: </span> \r\n
<span class="linenr">106: </span> [HTTP response 1/1]
<span class="linenr">107: </span> [Time since request: 0.319175000 seconds]
<span class="linenr">108: </span> [Request<span class="org-keyword"> in</span> frame: 1106]
<span class="linenr">109: </span> [Request URI: http://gaia.cs.umass.edu/pearson.png]
<span class="linenr">110: </span> File Data: 3267 bytes
<span class="linenr">111: </span> Portable Network Graphics
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">112: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">113: </span>1112 6.462951       178.79.137.164        192.168.1.72          HTTP     237    HTTP/1.1 301 Moved Permanently
<span class="linenr">114: </span>
<span class="linenr">115: </span>Frame 1112: 237 bytes on wire (1896 bits), 237 bytes captured (1896 bits) on interface en1, id 0
<span class="linenr">116: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">117: </span>Internet Protocol Version 4, Src: 178.79.137.164, Dst: 192.168.1.72
<span class="linenr">118: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 58173, Seq: 1, Ack: 393, Len: 171
<span class="linenr">119: </span>Hypertext Transfer Protocol
<span class="linenr">120: </span>HTTP/1.1 301 Moved Permanently\r\n
<span class="linenr">121: </span>Location: https://kurose.cslash.net/8E_cover_small.jpg\r\n
<span class="linenr">122: </span>Content-Length: 0\r\n
<span class="linenr">123: </span>Date: Fri, 13 Aug 2021 06:56:00 GMT\r\n
<span class="linenr">124: </span>Server: lighttpd/1.4.47\r\n
<span class="linenr">125: </span>\r\n
<span class="linenr">126: </span>[HTTP response 1/1]
<span class="linenr">127: </span>[Time since request: 0.319412000 seconds]
<span class="linenr">128: </span>[Request<span class="org-keyword"> in</span> frame: 1105]
<span class="linenr">129: </span>[Request URI: http://kurose.cslash.net/8E_cover_small.jpg]
</pre>
</div>

<ol class="org-ol">
<li value="16"><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">No.</td>
<td class="org-left">addr</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">gaia.cs.umass.edu</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">kurose.cslash.net</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">gaia.cs.umass.edu</td>
</tr>
</tbody>
</table></li>
<li>Parallel. The second image was requested before the first image came back.<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgc475623" class="outline-4">
<h4 id="orgc475623">5. HTTP Authentication</h4>
<div class="outline-text-4" id="text-orgc475623">
<ol class="org-ol">
<li value="18">What is the server’s response (status code and phrase) in response to the initial HTTP GET message from your browser?<br /></li>
<li>When your browser’s sends the HTTP GET message for the second time, what new field is included in the HTTP GET message?<br /></li>
</ol>


<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>    136 5.377209       192.168.1.72          128.119.245.12        HTTP     480    GET /wireshark-labs/protected_pages/HTTP-wiresharkfile5.html HTTP/1.1
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 136: 480 bytes on wire (3840 bits), 480 bytes captured (3840 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr"> 7: </span>Transmission Control Protocol, Src Port: 53753, Dst Port: 80, Seq: 1, Ack: 1, Len: 414
<span class="linenr"> 8: </span>Hypertext Transfer Protocol
<span class="linenr"> 9: </span>    GET /wireshark-labs/protected_pages/HTTP-wiresharkfile5.html HTTP/1.1\r\n
<span class="linenr">10: </span>    Host: gaia.cs.umass.edu\r\n
<span class="linenr">11: </span>    Upgrade-Insecure-Requests: 1\r\n
<span class="linenr">12: </span>    Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,*/*;<span class="org-variable-name">q</span>=0.8\r\n
<span class="linenr">13: </span>    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15\r\n
<span class="linenr">14: </span>    Accept-Language: zh-cn\r\n
<span class="linenr">15: </span>    Accept-Encoding: gzip, deflate\r\n
<span class="linenr">16: </span>    Connection: keep-alive\r\n
<span class="linenr">17: </span>    \r\n
<span class="linenr">18: </span>    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wiresharkfile5.html]
<span class="linenr">19: </span>    [HTTP request 1/1]
<span class="linenr">20: </span>    [Response<span class="org-keyword"> in</span> frame: 138]
<span class="linenr">21: </span>
<span class="linenr">22: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">23: </span>    138 5.732322       128.119.245.12        192.168.1.72          HTTP     783    HTTP/1.1 401 Unauthorized  (text/html)
<span class="linenr">24: </span>
<span class="linenr">25: </span>Frame 138: 783 bytes on wire (6264 bits), 783 bytes captured (6264 bits) on interface en1, id 0
<span class="linenr">26: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">27: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr">28: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 53753, Seq: 1, Ack: 415, Len: 717
<span class="linenr">29: </span>Hypertext Transfer Protocol
<span class="linenr">30: </span>    HTTP/1.1 401 Unauthorized\r\n
<span class="linenr">31: </span>    Date: Fri, 13 Aug 2021 10:49:55 GMT\r\n
<span class="linenr">32: </span>    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr">33: </span>    WWW-Authenticate: Basic <span class="org-variable-name">realm</span>=<span class="org-string">"wireshark-students only"</span>\r\n
<span class="linenr">34: </span>    Content-Length: 381\r\n
<span class="linenr">35: </span>    Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=100\r\n
<span class="linenr">36: </span>    Connection: Keep-Alive\r\n
<span class="linenr">37: </span>    Content-Type: text/html; <span class="org-variable-name">charset</span>=iso-8859-1\r\n
<span class="linenr">38: </span>    \r\n
<span class="linenr">39: </span>    [HTTP response 1/1]
<span class="linenr">40: </span>    [Time since request: 0.355113000 seconds]
<span class="linenr">41: </span>    [Request<span class="org-keyword"> in</span> frame: 136]
<span class="linenr">42: </span>    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wiresharkfile5.html]
<span class="linenr">43: </span>    File Data: 381 bytes
<span class="linenr">44: </span>Line-based text data: text/html (12 lines)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">45: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">46: </span>    234 17.053565      192.168.1.72          128.119.245.12        HTTP     539    GET /wireshark-labs/protected_pages/HTTP-wiresharkfile5.html HTTP/1.1
<span class="linenr">47: </span>
<span class="linenr">48: </span>Frame 234: 539 bytes on wire (4312 bits), 539 bytes captured (4312 bits) on interface en1, id 0
<span class="linenr">49: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">50: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 128.119.245.12
<span class="linenr">51: </span>Transmission Control Protocol, Src Port: 53751, Dst Port: 80, Seq: 1, Ack: 1, Len: 473
<span class="linenr">52: </span>Hypertext Transfer Protocol
<span class="linenr">53: </span>    GET /wireshark-labs/protected_pages/HTTP-wiresharkfile5.html HTTP/1.1\r\n
<span class="linenr">54: </span>    Host: gaia.cs.umass.edu\r\n
<span class="linenr">55: </span>    Connection: keep-alive\r\n
<span class="linenr">56: </span>    Upgrade-Insecure-Requests: 1\r\n
<span class="linenr">57: </span>    Accept: text/html,application/xhtml+xml,application/xml;<span class="org-variable-name">q</span>=0.9,*/*;<span class="org-variable-name">q</span>=0.8\r\n
<span class="linenr">58: </span>    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15\r\n
<span class="linenr">59: </span>    Accept-Language: zh-cn\r\n
<span class="linenr">60: </span>    Accept-Encoding: gzip, deflate\r\n
<span class="linenr">61: </span>    Authorization: Basic <span class="org-variable-name">d2lyZXNoYXJrLXN0dWRlbnRzOm5ldHdvcms</span>=\r\n
<span class="linenr">62: </span>    \r\n
<span class="linenr">63: </span>    [Full request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wiresharkfile5.html]
<span class="linenr">64: </span>    [HTTP request 1/1]
<span class="linenr">65: </span>    [Response<span class="org-keyword"> in</span> frame: 236]
<span class="linenr">66: </span>
<span class="linenr">67: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">68: </span>    236 17.415586      128.119.245.12        192.168.1.72          HTTP     595    HTTP/1.1 404 Not Found  (text/html)
<span class="linenr">69: </span>
<span class="linenr">70: </span>Frame 236: 595 bytes on wire (4760 bits), 595 bytes captured (4760 bits) on interface en1, id 0
<span class="linenr">71: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">72: </span>Internet Protocol Version 4, Src: 128.119.245.12, Dst: 192.168.1.72
<span class="linenr">73: </span>Transmission Control Protocol, Src Port: 80, Dst Port: 53751, Seq: 1, Ack: 474, Len: 529
<span class="linenr">74: </span>Hypertext Transfer Protocol
<span class="linenr">75: </span>    HTTP/1.1 404 Not Found\r\n
<span class="linenr">76: </span>    Date: Fri, 13 Aug 2021 10:50:07 GMT\r\n
<span class="linenr">77: </span>    Server: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/7.4.22 mod_perl/2.0.11 Perl/v5.16.3\r\n
<span class="linenr">78: </span>    Content-Length: 253\r\n
<span class="linenr">79: </span>    Keep-Alive: <span class="org-variable-name">timeout</span>=5, <span class="org-variable-name">max</span>=100\r\n
<span class="linenr">80: </span>    Connection: Keep-Alive\r\n
<span class="linenr">81: </span>    Content-Type: text/html; <span class="org-variable-name">charset</span>=iso-8859-1\r\n
<span class="linenr">82: </span>    \r\n
<span class="linenr">83: </span>    [HTTP response 1/1]
<span class="linenr">84: </span>    [Time since request: 0.362021000 seconds]
<span class="linenr">85: </span>    [Request<span class="org-keyword"> in</span> frame: 234]
<span class="linenr">86: </span>    [Request URI: http://gaia.cs.umass.edu/wireshark-labs/protected_pages/HTTP-wiresharkfile5.html]
<span class="linenr">87: </span>    File Data: 253 bytes
<span class="linenr">88: </span>Line-based text data: text/html (7 lines)
</pre>
</div>

<ol class="org-ol">
<li value="18">Line 30. 401 Unauthorized<br /></li>
<li>Line 61. Authorization: Basic d2lyZXNoYXJrLXN0dWRlbnRzOm5ldHdvcms=<br /></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org60caf9f" class="outline-3">
<h3 id="org60caf9f"><span class="section-number-3">2.6.</span> Wireshark实验：DNS</h3>
<div class="outline-text-3" id="text-2-6">
<p>
在本实验中，我们仔细观察DNS的客户端（DNS是用于将因特网主机名转换为IP地址的协议）。2.4节讲过，在DNS中客户角色是相当简单的：客户向它的本地DNS服务器发送一个请求，并接收返回的响应。在此过程中发生的很多事情均不为DNS客户所见，如等级结构的DNS服务器互相通信递归地或迭代地解析该客户的DNS请求。然而，从DNS客户的角度而言，该协议是相当简单的，即向本地DNS服务器发送一个请求，从该服务器接收一个响应。在本实验中我们观察运转中的DNS。<br />
</p>

<p>
<a href="code/ch2-ws-dns/wireshark-dns-v7.0.pdf">Wireshark Lab: DNS v7.0</a><br />
</p>
</div>

<div id="outline-container-orgdfe0d75" class="outline-4">
<h4 id="orgdfe0d75">1. nslookup</h4>
<div class="outline-text-4" id="text-orgdfe0d75">
<ol class="org-ol">
<li><p>
Run nslookup to obtain the IP address of a Web server in Asia. What is the IP address of that server?<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">&#10095; nslookup www.gov.sg
Server:   240e:3b7:2e91:9310:26f5:a2ff:feb3:b754
Address:  240e:3b7:2e91:9310:26f5:a2ff:feb3:b754#53

Non-authoritative answer:
Name: www.gov.sg
Address: 104.78.26.99
</pre>
</div></li>

<li><p>
Run nslookup to determine the authoritative DNS servers for a university in Europe.<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">&#10095; nslookup -type=NS manchester.ac.uk
Server:   240e:3b7:2e91:9310:26f5:a2ff:feb3:b754
Address:  240e:3b7:2e91:9310:26f5:a2ff:feb3:b754#53

Non-authoritative answer:
manchester.ac.uk  <span class="org-variable-name">nameserver</span> = curlew.cs.man.ac.uk.
manchester.ac.uk  <span class="org-variable-name">nameserver</span> = utserv.mcc.ac.uk.
manchester.ac.uk  <span class="org-variable-name">nameserver</span> = ns4.ja.net.
manchester.ac.uk  <span class="org-variable-name">nameserver</span> = gannet.scg.man.ac.uk.

Authoritative answers can be found from:
utserv.mcc.ac.uk  internet <span class="org-variable-name">address</span> = 130.88.200.6
gannet.scg.man.ac.uk  internet <span class="org-variable-name">address</span> = 130.88.94.110
curlew.cs.man.ac.uk internet <span class="org-variable-name">address</span> = 130.88.13.7
ns4.ja.net  has AAAA address 2001:630:0:47::42
</pre>
</div></li>

<li><p>
Run nslookup so that one of the DNS servers obtained in Question 2 is queried for the mail servers for Yahoo! mail. What is its IP address?<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">&#10095; nslookup -type=mx yahoo.com curlew.cs.man.ac.uk
Server:   curlew.cs.man.ac.uk
Address:  130.88.13.7#53

** server can<span class="org-string">'t find yahoo.com: REFUSED</span>

<span class="org-string">&#10095; nslookup -type=mx yahoo.com</span>
<span class="org-string">Server:   240e:3b7:2e91:9310:26f5:a2ff:feb3:b754</span>
<span class="org-string">Address:  240e:3b7:2e91:9310:26f5:a2ff:feb3:b754#53</span>

<span class="org-string">Non-authoritative answer:</span>
<span class="org-string">yahoo.com mail exchanger = 1 mta5.am0.yahoodns.net.</span>
<span class="org-string">yahoo.com mail exchanger = 1 mta6.am0.yahoodns.net.</span>
<span class="org-string">yahoo.com mail exchanger = 1 mta7.am0.yahoodns.net.</span>

<span class="org-string">Authoritative answers can be found from:</span>
<span class="org-string">yahoo.com nameserver = ns5.yahoo.com.</span>
<span class="org-string">yahoo.com nameserver = ns1.yahoo.com.</span>
<span class="org-string">yahoo.com nameserver = ns3.yahoo.com.</span>
<span class="org-string">yahoo.com nameserver = ns2.yahoo.com.</span>
<span class="org-string">yahoo.com nameserver = ns4.yahoo.com.</span>
<span class="org-string">ns3.yahoo.com internet address = 27.123.42.42</span>
<span class="org-string">ns5.yahoo.com internet address = 202.165.97.53</span>
<span class="org-string">ns4.yahoo.com internet address = 98.138.11.157</span>
<span class="org-string">ns1.yahoo.com internet address = 68.180.131.16</span>
<span class="org-string">ns2.yahoo.com internet address = 68.142.255.16</span>
<span class="org-string">ns3.yahoo.com has AAAA address 2406:8600:f03f:1f8::1003</span>
<span class="org-string">ns5.yahoo.com has AAAA address 2406:2000:1d0::7961:686f:6f21</span>
<span class="org-string">ns1.yahoo.com has AAAA address 2001:4998:130::1001</span>
<span class="org-string">ns2.yahoo.com has AAAA address 2001:4998:140::1002</span>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-orge0e288f" class="outline-4">
<h4 id="orge0e288f">2. ipconfig</h4>
<div class="outline-text-4" id="text-orge0e288f">
<p>
<a href="https://setapp.com/how-to/how-to-flush-dns-cache">Flush DNS cache on your Mac</a><br />
</p>

<div class="org-src-container">
<pre class="src src-sh">&#10095; ifconfig en1
en1: <span class="org-variable-name">flags</span>=8863&lt;UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
  <span class="org-variable-name">options</span>=400&lt;CHANNEL_IO&gt;
  ether b8:09:8a:51:06:4a
  inet6 fe80::1049:ae72:7e7f:3f95%en1 prefixlen 64 secured scopeid 0x5
  inet6 240e:3b7:2e91:9310:1483:c86e:aefc:f5fe prefixlen 64 autoconf secured
  inet6 240e:3b7:2e91:9310:31bd:41e3:6d1e:3522 prefixlen 64 autoconf temporary
  inet 192.168.1.72 netmask 0xffffff00 broadcast 192.168.1.255
  nd6 <span class="org-variable-name">options</span>=201&lt;PERFORMNUD,DAD&gt;
  media: autoselect
  status: active
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">&#10095; scutil --dns
DNS configuration

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">1</span>
nameserver[0] : 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754
nameserver[1] : 192.168.1.1
if_index : 5 (en1)
flags    : Request A records, Request AAAA records
reach    : 0x00020002 (Reachable,Directly Reachable Address)

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">2</span>
domain   : local
options  : mdns
timeout  : 5
flags    : Request A records, Request AAAA records
reach    : 0x00000000 (Not Reachable)
order    : 300000

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">3</span>
domain   : 254.169.in-addr.arpa
options  : mdns
timeout  : 5
flags    : Request A records, Request AAAA records
reach    : 0x00000000 (Not Reachable)
order    : 300200

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">4</span>
domain   : 8.e.f.ip6.arpa
options  : mdns
timeout  : 5
flags    : Request A records, Request AAAA records
reach    : 0x00000000 (Not Reachable)
order    : 300400

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">5</span>
domain   : 9.e.f.ip6.arpa
options  : mdns
timeout  : 5
flags    : Request A records, Request AAAA records
reach    : 0x00000000 (Not Reachable)
order    : 300600

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">6</span>
domain   : a.e.f.ip6.arpa
options  : mdns
timeout  : 5
flags    : Request A records, Request AAAA records
reach    : 0x00000000 (Not Reachable)
order    : 300800

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">7</span>
domain   : b.e.f.ip6.arpa
options  : mdns
timeout  : 5
flags    : Request A records, Request AAAA records
reach    : 0x00000000 (Not Reachable)
order    : 301000

DNS configuration (<span class="org-keyword">for</span> scoped queries)

resolver <span class="org-comment-delimiter">#</span><span class="org-comment">1</span>
nameserver[0] : 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754
nameserver[1] : 192.168.1.1
if_index : 5 (en1)
flags    : Scoped, Request A records, Request AAAA records
reach    : 0x00020002 (Reachable,Directly Reachable Address)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9ececa0" class="outline-4">
<h4 id="org9ececa0">3. Tracing DNS with Wireshark</h4>
<div class="outline-text-4" id="text-org9ececa0">
<ol class="org-ol">
<li value="4"><p>
Locate the DNS query and response messages. Are then sent over UDP or TCP?<br />
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>     84 7.351051       192.168.1.72          192.168.1.1           DNS      72     Standard query 0x55fd HTTPS www.ietf.org
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 84: 72 bytes on wire (576 bits), 72 bytes captured (576 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr"> 7: </span>User Datagram Protocol, Src Port: 62126, Dst Port: 53
<span class="linenr"> 8: </span>Domain Name System (query)
<span class="linenr"> 9: </span>    Transaction ID: 0x55fd
<span class="linenr">10: </span>    Flags: 0x0100 Standard query
<span class="linenr">11: </span>    Questions: 1
<span class="linenr">12: </span>    Answer RRs: 0
<span class="linenr">13: </span>    Authority RRs: 0
<span class="linenr">14: </span>    Additional RRs: 0
<span class="linenr">15: </span>    Queries
<span class="linenr">16: </span>    [Response In: 96]
<span class="linenr">17: </span>
<span class="linenr">18: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">19: </span>     85 7.351648       192.168.1.72          192.168.1.1           DNS      72     Standard query 0x796e AAAA www.ietf.org
<span class="linenr">20: </span>
<span class="linenr">21: </span>Frame 85: 72 bytes on wire (576 bits), 72 bytes captured (576 bits) on interface en1, id 0
<span class="linenr">22: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">23: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr">24: </span>User Datagram Protocol, Src Port: 51085, Dst Port: 53
<span class="linenr">25: </span>Domain Name System (query)
<span class="linenr">26: </span>    Transaction ID: 0x796e
<span class="linenr">27: </span>    Flags: 0x0100 Standard query
<span class="linenr">28: </span>    Questions: 1
<span class="linenr">29: </span>    Answer RRs: 0
<span class="linenr">30: </span>    Authority RRs: 0
<span class="linenr">31: </span>    Additional RRs: 0
<span class="linenr">32: </span>    Queries
<span class="linenr">33: </span>    [Response In: 91]
<span class="linenr">34: </span>
<span class="linenr">35: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">36: </span>     86 7.351648       192.168.1.72          192.168.1.1           DNS      72     Standard query 0x6b64 A www.ietf.org
<span class="linenr">37: </span>
<span class="linenr">38: </span>Frame 86: 72 bytes on wire (576 bits), 72 bytes captured (576 bits) on interface en1, id 0
<span class="linenr">39: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">40: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr">41: </span>User Datagram Protocol, Src Port: 62644, Dst Port: 53
<span class="linenr">42: </span>Domain Name System (query)
<span class="linenr">43: </span>    Transaction ID: 0x6b64
<span class="linenr">44: </span>    Flags: 0x0100 Standard query
<span class="linenr">45: </span>    Questions: 1
<span class="linenr">46: </span>    Answer RRs: 0
<span class="linenr">47: </span>    Authority RRs: 0
<span class="linenr">48: </span>    Additional RRs: 0
<span class="linenr">49: </span>    Queries
<span class="linenr">50: </span>    [Response In: 97]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">51: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">52: </span>     91 7.359142       192.168.1.1           192.168.1.72          DNS      483    Standard query response 0x796e AAAA www.ietf.org CNAME www.ietf.org.cdn.cloudflare.net AAAA 2606:4700::6810:2c63 AAAA 2606:4700::6810:2d63 NS ns2.cloudflare.net NS ns3.cloudflare.net NS ns4.cloudflare.net NS ns1.cloudflare.net NS ns5.cloudflare.net A 173.245.59.31 A 198.41.222.131 A 198.41.222.31 A 198.41.223.131 A 198.41.223.31 AAAA 2400:cb00:2049:1::adf5:3b1f AAAA 2400:cb00:2049:1::c629:de83 AAAA 2400:cb00:2049:1::c629:de1f AAAA 2400:cb00:2049:1::c629:df83 AAAA 2400:cb00:2049:1::c629:df1f
<span class="linenr">53: </span>
<span class="linenr">54: </span>Frame 91: 483 bytes on wire (3864 bits), 483 bytes captured (3864 bits) on interface en1, id 0
<span class="linenr">55: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">56: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">57: </span>User Datagram Protocol, Src Port: 53, Dst Port: 51085
<span class="linenr">58: </span>Domain Name System (response)
<span class="linenr">59: </span>    Transaction ID: 0x796e
<span class="linenr">60: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">61: </span>    Questions: 1
<span class="linenr">62: </span>    Answer RRs: 3
<span class="linenr">63: </span>    Authority RRs: 5
<span class="linenr">64: </span>    Additional RRs: 10
<span class="linenr">65: </span>    Queries
<span class="linenr">66: </span>    Answers
<span class="linenr">67: </span>        www.ietf.org: type CNAME, class IN, cname www.ietf.org.cdn.cloudflare.net
<span class="linenr">68: </span>        www.ietf.org.cdn.cloudflare.net: type AAAA, class IN, addr 2606:4700::6810:2c63
<span class="linenr">69: </span>        www.ietf.org.cdn.cloudflare.net: type AAAA, class IN, addr 2606:4700::6810:2d63
<span class="linenr">70: </span>    Authoritative nameservers
<span class="linenr">71: </span>        cloudflare.net: type NS, class IN, ns ns2.cloudflare.net
<span class="linenr">72: </span>        cloudflare.net: type NS, class IN, ns ns3.cloudflare.net
<span class="linenr">73: </span>        cloudflare.net: type NS, class IN, ns ns4.cloudflare.net
<span class="linenr">74: </span>        cloudflare.net: type NS, class IN, ns ns1.cloudflare.net
<span class="linenr">75: </span>        cloudflare.net: type NS, class IN, ns ns5.cloudflare.net
<span class="linenr">76: </span>    Additional records
<span class="linenr">77: </span>        ns1.cloudflare.net: type A, class IN, addr 173.245.59.31
<span class="linenr">78: </span>        ns2.cloudflare.net: type A, class IN, addr 198.41.222.131
<span class="linenr">79: </span>        ns3.cloudflare.net: type A, class IN, addr 198.41.222.31
<span class="linenr">80: </span>        ns4.cloudflare.net: type A, class IN, addr 198.41.223.131
<span class="linenr">81: </span>        ns5.cloudflare.net: type A, class IN, addr 198.41.223.31
<span class="linenr">82: </span>        ns1.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::adf5:3b1f
<span class="linenr">83: </span>        ns2.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de83
<span class="linenr">84: </span>        ns3.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de1f
<span class="linenr">85: </span>        ns4.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df83
<span class="linenr">86: </span>        ns5.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df1f
<span class="linenr">87: </span>    [Request In: 85]
<span class="linenr">88: </span>    [Time: 0.007494000 seconds]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 89: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 90: </span>     92 7.359670       192.168.1.72          192.168.1.1           DNS      91     Standard query 0xf84c HTTPS www.ietf.org.cdn.cloudflare.net
<span class="linenr"> 91: </span>
<span class="linenr"> 92: </span>Frame 92: 91 bytes on wire (728 bits), 91 bytes captured (728 bits) on interface en1, id 0
<span class="linenr"> 93: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 94: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr"> 95: </span>User Datagram Protocol, Src Port: 53578, Dst Port: 53
<span class="linenr"> 96: </span>Domain Name System (query)
<span class="linenr"> 97: </span>    Transaction ID: 0xf84c
<span class="linenr"> 98: </span>    Flags: 0x0100 Standard query
<span class="linenr"> 99: </span>    Questions: 1
<span class="linenr">100: </span>    Answer RRs: 0
<span class="linenr">101: </span>    Authority RRs: 0
<span class="linenr">102: </span>    Additional RRs: 0
<span class="linenr">103: </span>    Queries
<span class="linenr">104: </span>    [Response In: 99]
<span class="linenr">105: </span>
<span class="linenr">106: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">107: </span>     93 7.359746       192.168.1.72          192.168.1.1           DNS      91     Standard query 0x8e7d A www.ietf.org.cdn.cloudflare.net
<span class="linenr">108: </span>
<span class="linenr">109: </span>Frame 93: 91 bytes on wire (728 bits), 91 bytes captured (728 bits) on interface en1, id 0
<span class="linenr">110: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">111: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr">112: </span>User Datagram Protocol, Src Port: 55742, Dst Port: 53
<span class="linenr">113: </span>Domain Name System (query)
<span class="linenr">114: </span>    Transaction ID: 0x8e7d
<span class="linenr">115: </span>    Flags: 0x0100 Standard query
<span class="linenr">116: </span>    Questions: 1
<span class="linenr">117: </span>    Answer RRs: 0
<span class="linenr">118: </span>    Authority RRs: 0
<span class="linenr">119: </span>    Additional RRs: 0
<span class="linenr">120: </span>    Queries
<span class="linenr">121: </span>    [Response In: 98]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">122: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">123: </span>     96 7.519505       192.168.1.1           192.168.1.72          DNS      497    Standard query response 0x55fd HTTPS www.ietf.org CNAME www.ietf.org.cdn.cloudflare.net HTTPS NS ns5.cloudflare.net NS ns2.cloudflare.net NS ns1.cloudflare.net NS ns4.cloudflare.net NS ns3.cloudflare.net A 173.245.59.31 A 198.41.222.131 A 198.41.222.31 A 198.41.223.131 A 198.41.223.31 AAAA 2400:cb00:2049:1::adf5:3b1f AAAA 2400:cb00:2049:1::c629:de83 AAAA 2400:cb00:2049:1::c629:de1f AAAA 2400:cb00:2049:1::c629:df83 AAAA 2400:cb00:2049:1::c629:df1f
<span class="linenr">124: </span>
<span class="linenr">125: </span>Frame 96: 497 bytes on wire (3976 bits), 497 bytes captured (3976 bits) on interface en1, id 0
<span class="linenr">126: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">127: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">128: </span>User Datagram Protocol, Src Port: 53, Dst Port: 62126
<span class="linenr">129: </span>Domain Name System (response)
<span class="linenr">130: </span>    Transaction ID: 0x55fd
<span class="linenr">131: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">132: </span>    Questions: 1
<span class="linenr">133: </span>    Answer RRs: 2
<span class="linenr">134: </span>    Authority RRs: 5
<span class="linenr">135: </span>    Additional RRs: 10
<span class="linenr">136: </span>    Queries
<span class="linenr">137: </span>    Answers
<span class="linenr">138: </span>        www.ietf.org: type CNAME, class IN, cname www.ietf.org.cdn.cloudflare.net
<span class="linenr">139: </span>        www.ietf.org.cdn.cloudflare.net: type HTTPS, class IN
<span class="linenr">140: </span>    Authoritative nameservers
<span class="linenr">141: </span>        cloudflare.net: type NS, class IN, ns ns5.cloudflare.net
<span class="linenr">142: </span>        cloudflare.net: type NS, class IN, ns ns2.cloudflare.net
<span class="linenr">143: </span>        cloudflare.net: type NS, class IN, ns ns1.cloudflare.net
<span class="linenr">144: </span>        cloudflare.net: type NS, class IN, ns ns4.cloudflare.net
<span class="linenr">145: </span>        cloudflare.net: type NS, class IN, ns ns3.cloudflare.net
<span class="linenr">146: </span>    Additional records
<span class="linenr">147: </span>        ns1.cloudflare.net: type A, class IN, addr 173.245.59.31
<span class="linenr">148: </span>        ns2.cloudflare.net: type A, class IN, addr 198.41.222.131
<span class="linenr">149: </span>        ns3.cloudflare.net: type A, class IN, addr 198.41.222.31
<span class="linenr">150: </span>        ns4.cloudflare.net: type A, class IN, addr 198.41.223.131
<span class="linenr">151: </span>        ns5.cloudflare.net: type A, class IN, addr 198.41.223.31
<span class="linenr">152: </span>        ns1.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::adf5:3b1f
<span class="linenr">153: </span>        ns2.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de83
<span class="linenr">154: </span>        ns3.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de1f
<span class="linenr">155: </span>        ns4.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df83
<span class="linenr">156: </span>        ns5.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df1f
<span class="linenr">157: </span>    [Request In: 84]
<span class="linenr">158: </span>    [Time: 0.168454000 seconds]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">159: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">160: </span>     97 7.525307       192.168.1.1           192.168.1.72          DNS      459    Standard query response 0x6b64 A www.ietf.org CNAME www.ietf.org.cdn.cloudflare.net A 104.16.45.99 A 104.16.44.99 NS ns2.cloudflare.net NS ns1.cloudflare.net NS ns5.cloudflare.net NS ns4.cloudflare.net NS ns3.cloudflare.net A 173.245.59.31 A 198.41.222.131 A 198.41.222.31 A 198.41.223.131 A 198.41.223.31 AAAA 2400:cb00:2049:1::adf5:3b1f AAAA 2400:cb00:2049:1::c629:de83 AAAA 2400:cb00:2049:1::c629:de1f AAAA 2400:cb00:2049:1::c629:df83 AAAA 2400:cb00:2049:1::c629:df1f
<span class="linenr">161: </span>
<span class="linenr">162: </span>Frame 97: 459 bytes on wire (3672 bits), 459 bytes captured (3672 bits) on interface en1, id 0
<span class="linenr">163: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">164: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">165: </span>User Datagram Protocol, Src Port: 53, Dst Port: 62644
<span class="linenr">166: </span>Domain Name System (response)
<span class="linenr">167: </span>    Transaction ID: 0x6b64
<span class="linenr">168: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">169: </span>    Questions: 1
<span class="linenr">170: </span>    Answer RRs: 3
<span class="linenr">171: </span>    Authority RRs: 5
<span class="linenr">172: </span>    Additional RRs: 10
<span class="linenr">173: </span>    Queries
<span class="linenr">174: </span>    Answers
<span class="linenr">175: </span>        www.ietf.org: type CNAME, class IN, cname www.ietf.org.cdn.cloudflare.net
<span class="linenr">176: </span>        www.ietf.org.cdn.cloudflare.net: type A, class IN, addr 104.16.45.99
<span class="linenr">177: </span>        www.ietf.org.cdn.cloudflare.net: type A, class IN, addr 104.16.44.99
<span class="linenr">178: </span>    Authoritative nameservers
<span class="linenr">179: </span>        cloudflare.net: type NS, class IN, ns ns2.cloudflare.net
<span class="linenr">180: </span>        cloudflare.net: type NS, class IN, ns ns1.cloudflare.net
<span class="linenr">181: </span>        cloudflare.net: type NS, class IN, ns ns5.cloudflare.net
<span class="linenr">182: </span>        cloudflare.net: type NS, class IN, ns ns4.cloudflare.net
<span class="linenr">183: </span>        cloudflare.net: type NS, class IN, ns ns3.cloudflare.net
<span class="linenr">184: </span>    Additional records
<span class="linenr">185: </span>        ns1.cloudflare.net: type A, class IN, addr 173.245.59.31
<span class="linenr">186: </span>        ns2.cloudflare.net: type A, class IN, addr 198.41.222.131
<span class="linenr">187: </span>        ns3.cloudflare.net: type A, class IN, addr 198.41.222.31
<span class="linenr">188: </span>        ns4.cloudflare.net: type A, class IN, addr 198.41.223.131
<span class="linenr">189: </span>        ns5.cloudflare.net: type A, class IN, addr 198.41.223.31
<span class="linenr">190: </span>        ns1.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::adf5:3b1f
<span class="linenr">191: </span>        ns2.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de83
<span class="linenr">192: </span>        ns3.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de1f
<span class="linenr">193: </span>        ns4.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df83
<span class="linenr">194: </span>        ns5.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df1f
<span class="linenr">195: </span>    [Request In: 86]
<span class="linenr">196: </span>    [Time: 0.173659000 seconds]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">197: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">198: </span>     98 7.525317       192.168.1.1           192.168.1.72          DNS      433    Standard query response 0x8e7d A www.ietf.org.cdn.cloudflare.net A 104.16.44.99 A 104.16.45.99 NS ns2.cloudflare.net NS ns1.cloudflare.net NS ns4.cloudflare.net NS ns5.cloudflare.net NS ns3.cloudflare.net A 173.245.59.31 A 198.41.222.131 A 198.41.222.31 A 198.41.223.131 A 198.41.223.31 AAAA 2400:cb00:2049:1::adf5:3b1f AAAA 2400:cb00:2049:1::c629:de83 AAAA 2400:cb00:2049:1::c629:de1f AAAA 2400:cb00:2049:1::c629:df83 AAAA 2400:cb00:2049:1::c629:df1f
<span class="linenr">199: </span>
<span class="linenr">200: </span>Frame 98: 433 bytes on wire (3464 bits), 433 bytes captured (3464 bits) on interface en1, id 0
<span class="linenr">201: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">202: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">203: </span>User Datagram Protocol, Src Port: 53, Dst Port: 55742
<span class="linenr">204: </span>Domain Name System (response)
<span class="linenr">205: </span>    Transaction ID: 0x8e7d
<span class="linenr">206: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">207: </span>    Questions: 1
<span class="linenr">208: </span>    Answer RRs: 2
<span class="linenr">209: </span>    Authority RRs: 5
<span class="linenr">210: </span>    Additional RRs: 10
<span class="linenr">211: </span>    Queries
<span class="linenr">212: </span>    Answers
<span class="linenr">213: </span>        www.ietf.org.cdn.cloudflare.net: type A, class IN, addr 104.16.44.99
<span class="linenr">214: </span>        www.ietf.org.cdn.cloudflare.net: type A, class IN, addr 104.16.45.99
<span class="linenr">215: </span>    Authoritative nameservers
<span class="linenr">216: </span>        cloudflare.net: type NS, class IN, ns ns2.cloudflare.net
<span class="linenr">217: </span>        cloudflare.net: type NS, class IN, ns ns1.cloudflare.net
<span class="linenr">218: </span>        cloudflare.net: type NS, class IN, ns ns4.cloudflare.net
<span class="linenr">219: </span>        cloudflare.net: type NS, class IN, ns ns5.cloudflare.net
<span class="linenr">220: </span>        cloudflare.net: type NS, class IN, ns ns3.cloudflare.net
<span class="linenr">221: </span>    Additional records
<span class="linenr">222: </span>        ns1.cloudflare.net: type A, class IN, addr 173.245.59.31
<span class="linenr">223: </span>        ns2.cloudflare.net: type A, class IN, addr 198.41.222.131
<span class="linenr">224: </span>        ns3.cloudflare.net: type A, class IN, addr 198.41.222.31
<span class="linenr">225: </span>        ns4.cloudflare.net: type A, class IN, addr 198.41.223.131
<span class="linenr">226: </span>        ns5.cloudflare.net: type A, class IN, addr 198.41.223.31
<span class="linenr">227: </span>        ns1.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::adf5:3b1f
<span class="linenr">228: </span>        ns2.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de83
<span class="linenr">229: </span>        ns3.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de1f
<span class="linenr">230: </span>        ns4.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df83
<span class="linenr">231: </span>        ns5.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df1f
<span class="linenr">232: </span>    [Request In: 93]
<span class="linenr">233: </span>    [Time: 0.165571000 seconds]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">234: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">235: </span>     99 7.530981       192.168.1.1           192.168.1.72          DNS      471    Standard query response 0xf84c HTTPS www.ietf.org.cdn.cloudflare.net HTTPS NS ns4.cloudflare.net NS ns3.cloudflare.net NS ns1.cloudflare.net NS ns2.cloudflare.net NS ns5.cloudflare.net A 173.245.59.31 A 198.41.222.131 A 198.41.222.31 A 198.41.223.131 A 198.41.223.31 AAAA 2400:cb00:2049:1::adf5:3b1f AAAA 2400:cb00:2049:1::c629:de83 AAAA 2400:cb00:2049:1::c629:de1f AAAA 2400:cb00:2049:1::c629:df83 AAAA 2400:cb00:2049:1::c629:df1f
<span class="linenr">236: </span>
<span class="linenr">237: </span>Frame 99: 471 bytes on wire (3768 bits), 471 bytes captured (3768 bits) on interface en1, id 0
<span class="linenr">238: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">239: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">240: </span>User Datagram Protocol, Src Port: 53, Dst Port: 53578
<span class="linenr">241: </span>Domain Name System (response)
<span class="linenr">242: </span>    Transaction ID: 0xf84c
<span class="linenr">243: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">244: </span>    Questions: 1
<span class="linenr">245: </span>    Answer RRs: 1
<span class="linenr">246: </span>    Authority RRs: 5
<span class="linenr">247: </span>    Additional RRs: 10
<span class="linenr">248: </span>    Queries
<span class="linenr">249: </span>    Answers
<span class="linenr">250: </span>        www.ietf.org.cdn.cloudflare.net: type HTTPS, class IN
<span class="linenr">251: </span>    Authoritative nameservers
<span class="linenr">252: </span>        cloudflare.net: type NS, class IN, ns ns4.cloudflare.net
<span class="linenr">253: </span>        cloudflare.net: type NS, class IN, ns ns3.cloudflare.net
<span class="linenr">254: </span>        cloudflare.net: type NS, class IN, ns ns1.cloudflare.net
<span class="linenr">255: </span>        cloudflare.net: type NS, class IN, ns ns2.cloudflare.net
<span class="linenr">256: </span>        cloudflare.net: type NS, class IN, ns ns5.cloudflare.net
<span class="linenr">257: </span>    Additional records
<span class="linenr">258: </span>        ns1.cloudflare.net: type A, class IN, addr 173.245.59.31
<span class="linenr">259: </span>        ns2.cloudflare.net: type A, class IN, addr 198.41.222.131
<span class="linenr">260: </span>        ns3.cloudflare.net: type A, class IN, addr 198.41.222.31
<span class="linenr">261: </span>        ns4.cloudflare.net: type A, class IN, addr 198.41.223.131
<span class="linenr">262: </span>        ns5.cloudflare.net: type A, class IN, addr 198.41.223.31
<span class="linenr">263: </span>        ns1.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::adf5:3b1f
<span class="linenr">264: </span>        ns2.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de83
<span class="linenr">265: </span>        ns3.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:de1f
<span class="linenr">266: </span>        ns4.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df83
<span class="linenr">267: </span>        ns5.cloudflare.net: type AAAA, class IN, addr 2400:cb00:2049:1::c629:df1f
<span class="linenr">268: </span>    [Request In: 92]
<span class="linenr">269: </span>    [Time: 0.171311000 seconds]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">270: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">271: </span>    332 8.698384       192.168.1.72          192.168.1.1           DNS      78     Standard query 0x7e16 HTTPS analytics.ietf.org
<span class="linenr">272: </span>
<span class="linenr">273: </span>Frame 332: 78 bytes on wire (624 bits), 78 bytes captured (624 bits) on interface en1, id 0
<span class="linenr">274: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">275: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr">276: </span>User Datagram Protocol, Src Port: 64413, Dst Port: 53
<span class="linenr">277: </span>Domain Name System (query)
<span class="linenr">278: </span>    Transaction ID: 0x7e16
<span class="linenr">279: </span>    Flags: 0x0100 Standard query
<span class="linenr">280: </span>    Questions: 1
<span class="linenr">281: </span>    Answer RRs: 0
<span class="linenr">282: </span>    Authority RRs: 0
<span class="linenr">283: </span>    Additional RRs: 0
<span class="linenr">284: </span>    Queries
<span class="linenr">285: </span>    [Response In: 533]
<span class="linenr">286: </span>
<span class="linenr">287: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">288: </span>    333 8.698456       192.168.1.72          192.168.1.1           DNS      78     Standard query 0x5e8e AAAA analytics.ietf.org
<span class="linenr">289: </span>
<span class="linenr">290: </span>Frame 333: 78 bytes on wire (624 bits), 78 bytes captured (624 bits) on interface en1, id 0
<span class="linenr">291: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">292: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr">293: </span>User Datagram Protocol, Src Port: 63705, Dst Port: 53
<span class="linenr">294: </span>Domain Name System (query)
<span class="linenr">295: </span>    Transaction ID: 0x5e8e
<span class="linenr">296: </span>    Flags: 0x0100 Standard query
<span class="linenr">297: </span>    Questions: 1
<span class="linenr">298: </span>    Answer RRs: 0
<span class="linenr">299: </span>    Authority RRs: 0
<span class="linenr">300: </span>    Additional RRs: 0
<span class="linenr">301: </span>    Queries
<span class="linenr">302: </span>    [Response In: 606]
<span class="linenr">303: </span>
<span class="linenr">304: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">305: </span>    334 8.698510       192.168.1.72          192.168.1.1           DNS      78     Standard query 0xf20a A analytics.ietf.org
<span class="linenr">306: </span>
<span class="linenr">307: </span>Frame 334: 78 bytes on wire (624 bits), 78 bytes captured (624 bits) on interface en1, id 0
<span class="linenr">308: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr">309: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 192.168.1.1
<span class="linenr">310: </span>User Datagram Protocol, Src Port: 51303, Dst Port: 53
<span class="linenr">311: </span>Domain Name System (query)
<span class="linenr">312: </span>    Transaction ID: 0xf20a
<span class="linenr">313: </span>    Flags: 0x0100 Standard query
<span class="linenr">314: </span>    Questions: 1
<span class="linenr">315: </span>    Answer RRs: 0
<span class="linenr">316: </span>    Authority RRs: 0
<span class="linenr">317: </span>    Additional RRs: 0
<span class="linenr">318: </span>    Queries
<span class="linenr">319: </span>    [Response In: 660]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">320: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">321: </span>    533 8.891728       192.168.1.1           192.168.1.72          DNS      131    Standard query response 0x7e16 HTTPS analytics.ietf.org SOA ns0.amsl.com
<span class="linenr">322: </span>
<span class="linenr">323: </span>Frame 533: 131 bytes on wire (1048 bits), 131 bytes captured (1048 bits) on interface en1, id 0
<span class="linenr">324: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">325: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">326: </span>User Datagram Protocol, Src Port: 53, Dst Port: 64413
<span class="linenr">327: </span>Domain Name System (response)
<span class="linenr">328: </span>    Transaction ID: 0x7e16
<span class="linenr">329: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">330: </span>    Questions: 1
<span class="linenr">331: </span>    Answer RRs: 0
<span class="linenr">332: </span>    Authority RRs: 1
<span class="linenr">333: </span>    Additional RRs: 0
<span class="linenr">334: </span>    Queries
<span class="linenr">335: </span>    Authoritative nameservers
<span class="linenr">336: </span>        ietf.org: type SOA, class IN, mname ns0.amsl.com
<span class="linenr">337: </span>    [Request In: 332]
<span class="linenr">338: </span>    [Time: 0.193344000 seconds]
<span class="linenr">339: </span>
<span class="linenr">340: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">341: </span>    606 8.955778       192.168.1.1           192.168.1.72          DNS      411    Standard query response 0x5e8e AAAA analytics.ietf.org AAAA 2001:1900:3001:11::2d NS ns1.yyz1.afilias-nst.info NS ns0.amsl.com NS ns1.mia1.afilias-nst.info NS ns1.ams1.afilias-nst.info NS ns1.sea1.afilias-nst.info NS ns1.hkg1.afilias-nst.info A 65.22.9.1 A 65.22.6.79 A 4.31.198.39 A 65.22.8.1 AAAA 2a01:8840:9::1 AAAA 2001:1900:3001:11::27 AAAA 2a01:8840:8::1
<span class="linenr">342: </span>
<span class="linenr">343: </span>Frame 606: 411 bytes on wire (3288 bits), 411 bytes captured (3288 bits) on interface en1, id 0
<span class="linenr">344: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">345: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">346: </span>User Datagram Protocol, Src Port: 53, Dst Port: 63705
<span class="linenr">347: </span>Domain Name System (response)
<span class="linenr">348: </span>    Transaction ID: 0x5e8e
<span class="linenr">349: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">350: </span>    Questions: 1
<span class="linenr">351: </span>    Answer RRs: 1
<span class="linenr">352: </span>    Authority RRs: 6
<span class="linenr">353: </span>    Additional RRs: 7
<span class="linenr">354: </span>    Queries
<span class="linenr">355: </span>    Answers
<span class="linenr">356: </span>        analytics.ietf.org: type AAAA, class IN, addr 2001:1900:3001:11::2d
<span class="linenr">357: </span>    Authoritative nameservers
<span class="linenr">358: </span>        ietf.org: type NS, class IN, ns ns1.yyz1.afilias-nst.info
<span class="linenr">359: </span>        ietf.org: type NS, class IN, ns ns0.amsl.com
<span class="linenr">360: </span>        ietf.org: type NS, class IN, ns ns1.mia1.afilias-nst.info
<span class="linenr">361: </span>        ietf.org: type NS, class IN, ns ns1.ams1.afilias-nst.info
<span class="linenr">362: </span>        ietf.org: type NS, class IN, ns ns1.sea1.afilias-nst.info
<span class="linenr">363: </span>        ietf.org: type NS, class IN, ns ns1.hkg1.afilias-nst.info
<span class="linenr">364: </span>    Additional records
<span class="linenr">365: </span>        ns1.yyz1.afilias-nst.info: type A, class IN, addr 65.22.9.1
<span class="linenr">366: </span>        ns1.ams1.afilias-nst.info: type A, class IN, addr 65.22.6.79
<span class="linenr">367: </span>        ns0.amsl.com: type A, class IN, addr 4.31.198.39
<span class="linenr">368: </span>        ns1.sea1.afilias-nst.info: type A, class IN, addr 65.22.8.1
<span class="linenr">369: </span>        ns1.yyz1.afilias-nst.info: type AAAA, class IN, addr 2a01:8840:9::1
<span class="linenr">370: </span>        ns0.amsl.com: type AAAA, class IN, addr 2001:1900:3001:11::27
<span class="linenr">371: </span>        ns1.sea1.afilias-nst.info: type AAAA, class IN, addr 2a01:8840:8::1
<span class="linenr">372: </span>    [Request In: 333]
<span class="linenr">373: </span>    [Time: 0.257322000 seconds]
</pre>
</div>
<div class="org-src-container">
<pre class="src src-sh"><span class="linenr">374: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">375: </span>    660 8.979479       192.168.1.1           192.168.1.72          DNS      455    Standard query response 0xf20a A analytics.ietf.org A 4.31.198.45 NS ns1.hkg1.afilias-nst.info NS ns0.amsl.com NS ns1.yyz1.afilias-nst.info NS ns1.ams1.afilias-nst.info NS ns1.sea1.afilias-nst.info NS ns1.mia1.afilias-nst.info A 65.22.7.1 A 65.22.6.79 A 65.22.9.1 A 65.22.6.1 AAAA 2a01:8840:7::1 AAAA 2001:500:6::79 AAAA 2a01:8840:9::1 AAAA 2a01:8840:6::1 AAAA 2a01:8840:8::1
<span class="linenr">376: </span>
<span class="linenr">377: </span>Frame 660: 455 bytes on wire (3640 bits), 455 bytes captured (3640 bits) on interface en1, id 0
<span class="linenr">378: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">379: </span>Internet Protocol Version 4, Src: 192.168.1.1, Dst: 192.168.1.72
<span class="linenr">380: </span>User Datagram Protocol, Src Port: 53, Dst Port: 51303
<span class="linenr">381: </span>Domain Name System (response)
<span class="linenr">382: </span>    Transaction ID: 0xf20a
<span class="linenr">383: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">384: </span>    Questions: 1
<span class="linenr">385: </span>    Answer RRs: 1
<span class="linenr">386: </span>    Authority RRs: 6
<span class="linenr">387: </span>    Additional RRs: 9
<span class="linenr">388: </span>    Queries
<span class="linenr">389: </span>    Answers
<span class="linenr">390: </span>        analytics.ietf.org: type A, class IN, addr 4.31.198.45
<span class="linenr">391: </span>    Authoritative nameservers
<span class="linenr">392: </span>        ietf.org: type NS, class IN, ns ns1.hkg1.afilias-nst.info
<span class="linenr">393: </span>        ietf.org: type NS, class IN, ns ns0.amsl.com
<span class="linenr">394: </span>        ietf.org: type NS, class IN, ns ns1.yyz1.afilias-nst.info
<span class="linenr">395: </span>        ietf.org: type NS, class IN, ns ns1.ams1.afilias-nst.info
<span class="linenr">396: </span>        ietf.org: type NS, class IN, ns ns1.sea1.afilias-nst.info
<span class="linenr">397: </span>        ietf.org: type NS, class IN, ns ns1.mia1.afilias-nst.info
<span class="linenr">398: </span>    Additional records
<span class="linenr">399: </span>        ns1.mia1.afilias-nst.info: type A, class IN, addr 65.22.7.1
<span class="linenr">400: </span>        ns1.ams1.afilias-nst.info: type A, class IN, addr 65.22.6.79
<span class="linenr">401: </span>        ns1.yyz1.afilias-nst.info: type A, class IN, addr 65.22.9.1
<span class="linenr">402: </span>        ns1.hkg1.afilias-nst.info: type A, class IN, addr 65.22.6.1
<span class="linenr">403: </span>        ns1.mia1.afilias-nst.info: type AAAA, class IN, addr 2a01:8840:7::1
<span class="linenr">404: </span>        ns1.ams1.afilias-nst.info: type AAAA, class IN, addr 2001:500:6::79
<span class="linenr">405: </span>        ns1.yyz1.afilias-nst.info: type AAAA, class IN, addr 2a01:8840:9::1
<span class="linenr">406: </span>        ns1.hkg1.afilias-nst.info: type AAAA, class IN, addr 2a01:8840:6::1
<span class="linenr">407: </span>        ns1.sea1.afilias-nst.info: type AAAA, class IN, addr 2a01:8840:8::1
<span class="linenr">408: </span>    [Request In: 334]
<span class="linenr">409: </span>    [Time: 0.280969000 seconds]
</pre>
</div>

<p>
Line 7. DNS query and response messages are then sent over UDP.<br />
</p></li>

<li><p>
What is the destination port for the DNS query message? What is the source port of DNS response message?<br />
</p>

<p>
Line 7. The destination port for the DNS query message is 53.<br />
Line 128. The source port of DNS response message is 53.<br />
</p></li>

<li><p>
To what IP address is the DNS query message sent? Use ipconfig to determine the IP address of your local DNS server. Are these two IP addresses the same?<br />
</p>

<p>
Line 6. The DNS query message is sent to 192.168.1.1. These two IP addresses are same.<br />
</p></li>

<li><p>
Examine the DNS query message. What “Type” of DNS query is it? Does the query message contain any “answers”?<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Line No.</td>
<td class="org-left">DNS Type</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">HTTPS</td>
</tr>

<tr>
<td class="org-right">19</td>
<td class="org-left">AAAA</td>
</tr>

<tr>
<td class="org-right">36</td>
<td class="org-left">A</td>
</tr>
</tbody>
</table></li>

<li><p>
Examine the DNS response message. How many “answers” are provided? What do each of these answers contain?<br />
</p>

<p>
以序号97的A记录DNS请求的响应为例，响应里一共包含了3小节信息：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Answers</td>
<td class="org-left">CNAME和A记录</td>
</tr>

<tr>
<td class="org-left">Authoritative nameservers</td>
<td class="org-left">权威服务器的NS记录</td>
</tr>

<tr>
<td class="org-left">Additional records</td>
<td class="org-left">权威服务器NS记录对应的A和AAAA记录</td>
</tr>
</tbody>
</table></li>

<li><p>
Consider the subsequent TCP SYN packet sent by your host. Does the destination IP address of the SYN packet correspond to any of the IP addresses provided in the DNS response message?<br />
</p>

<p>
YES.<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">No.     Time           Source                Destination           Protocol Length Info
1233 10.442433      192.168.1.72          4.31.198.45           TCP      78     59962 &#8594; 443 [SYN] <span class="org-variable-name">Seq</span>=0 <span class="org-variable-name">Win</span>=65535 <span class="org-variable-name">Len</span>=0 <span class="org-variable-name">MSS</span>=1460 <span class="org-variable-name">WS</span>=64 <span class="org-variable-name">TSval</span>=551439144 <span class="org-variable-name">TSecr</span>=0 <span class="org-variable-name">SACK_PERM</span>=1

Frame 1233: 78 bytes on wire (624 bits), 78 bytes captured (624 bits) on interface en1, id 0
Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
Internet Protocol Version 4, Src: 192.168.1.72, Dst: 4.31.198.45
Transmission Control Protocol, Src Port: 59962, Dst Port: 443, Seq: 0, Len: 0
</pre>
</div></li>

<li><p>
This web page contains images. Before retrieving each image, does your host issue new DNS queries?<br />
</p>

<p>
NO.<br />
</p></li>

<li value="11"><p>
What is the destination port for the DNS query message? What is the source port of DNS response message?<br />
</p>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>      8 3.494274       240e:3b7:2e91:9310:31bd:41e3:6d1e:3522 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754 DNS      91     Standard query 0x8c48 A www.mit.edu
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 8: 91 bytes on wire (728 bits), 91 bytes captured (728 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 6, Src: 240e:3b7:2e91:9310:31bd:41e3:6d1e:3522, Dst: 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754
<span class="linenr"> 7: </span>User Datagram Protocol, Src Port: 50538, Dst Port: 53
<span class="linenr"> 8: </span>Domain Name System (query)
<span class="linenr"> 9: </span>    Transaction ID: 0x8c48
<span class="linenr">10: </span>    Flags: 0x0100 Standard query
<span class="linenr">11: </span>    Questions: 1
<span class="linenr">12: </span>    Answer RRs: 0
<span class="linenr">13: </span>    Authority RRs: 0
<span class="linenr">14: </span>    Additional RRs: 0
<span class="linenr">15: </span>    Queries
<span class="linenr">16: </span>    [Response In: 9]
<span class="linenr">17: </span>
<span class="linenr">18: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">19: </span>      9 3.496780       240e:3b7:2e91:9310:26f5:a2ff:feb3:b754 240e:3b7:2e91:9310:31bd:41e3:6d1e:3522 DNS      183    Standard query response 0x8c48 A www.mit.edu CNAME www.mit.edu.edgekey.net CNAME e9566.dscb.akamaiedge.net A 104.106.56.136
<span class="linenr">20: </span>
<span class="linenr">21: </span>Frame 9: 183 bytes on wire (1464 bits), 183 bytes captured (1464 bits) on interface en1, id 0
<span class="linenr">22: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">23: </span>Internet Protocol Version 6, Src: 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754, Dst: 240e:3b7:2e91:9310:31bd:41e3:6d1e:3522
<span class="linenr">24: </span>User Datagram Protocol, Src Port: 53, Dst Port: 50538
<span class="linenr">25: </span>Domain Name System (response)
<span class="linenr">26: </span>    Transaction ID: 0x8c48
<span class="linenr">27: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">28: </span>    Questions: 1
<span class="linenr">29: </span>    Answer RRs: 3
<span class="linenr">30: </span>    Authority RRs: 0
<span class="linenr">31: </span>    Additional RRs: 0
<span class="linenr">32: </span>    Queries
<span class="linenr">33: </span>    Answers
<span class="linenr">34: </span>        www.mit.edu: type CNAME, class IN, cname www.mit.edu.edgekey.net
<span class="linenr">35: </span>        www.mit.edu.edgekey.net: type CNAME, class IN, cname e9566.dscb.akamaiedge.net
<span class="linenr">36: </span>        e9566.dscb.akamaiedge.net: type A, class IN, addr 104.106.56.136
<span class="linenr">37: </span>    [Request In: 8]
<span class="linenr">38: </span>    [Time: 0.002506000 seconds]
</pre>
</div>

<p>
Line 7. The destination port for the DNS query message is 53.<br />
Line 24. The source port of DNS response message is 53.<br />
</p></li>

<li><p>
To what IP address is the DNS query message sent? Is this the IP address of your default local DNS server?<br />
</p>

<p>
240e:3b7:2e91:9310:26f5:a2ff:feb3:b754. Yes.<br />
</p></li>

<li>Examine the DNS query message. What “Type” of DNS query is it? Does the query message contain any “answers”?<br />

<ol class="org-ol">
<li>Yes.<br /></li>
</ol></li>

<li><p>
Examine the DNS response message. How many “answers” are provided? What do each of these answers contain?<br />
</p>

<p>
两条CNAME记录，一条A记录。<br />
</p></li>

<li>Provide a screenshot.<br /></li>

<li value="16"><p>
To what IP address is the DNS query message sent? Is this the IP address of your default local DNS server?<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">&#10095; dig mit.edu ns

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; mit.edu ns
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 33485
<span class="org-sh-heredoc">;; flags: qr rd ra; QUERY: 1, ANSWER: 8, AUTHORITY: 0, ADDITIONAL: 8</span>

<span class="org-sh-heredoc">;; QUESTION SECTION:</span>
<span class="org-sh-heredoc">;mit.edu.     IN  NS</span>

<span class="org-sh-heredoc">;; ANSWER SECTION:</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  eur5.akam.net.</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  asia2.akam.net.</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  usw2.akam.net.</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  asia1.akam.net.</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  ns1-173.akam.net.</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  use2.akam.net.</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  ns1-37.akam.net.</span>
<span class="org-sh-heredoc">mit.edu.    1080  IN  NS  use5.akam.net.</span>

<span class="org-sh-heredoc">;; ADDITIONAL SECTION:</span>
<span class="org-sh-heredoc">ns1-37.akam.net.  89298 IN  A 193.108.91.37</span>
<span class="org-sh-heredoc">eur5.akam.net.    13993 IN  A 23.74.25.64</span>
<span class="org-sh-heredoc">asia2.akam.net.   78322 IN  A 95.101.36.64</span>
<span class="org-sh-heredoc">ns1-173.akam.net. 85792 IN  A 193.108.91.173</span>
<span class="org-sh-heredoc">usw2.akam.net.    146712  IN  A 184.26.161.64</span>
<span class="org-sh-heredoc">use2.akam.net.    89089 IN  A 96.7.49.64</span>
<span class="org-sh-heredoc">ns1-37.akam.net.  89298 IN  AAAA  2600:1401:2::25</span>
<span class="org-sh-heredoc">ns1-173.akam.net. 87583 IN  AAAA  2600:1401:2::ad</span>

<span class="org-sh-heredoc">;; Query time: 10 msec</span>
<span class="org-sh-heredoc">;; SERVER: 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754#53(240e:3b7:2e91:9310:26f5:a2ff:feb3:b754)</span>
<span class="org-sh-heredoc">;; WHEN: Sat Aug 14 18:07:25 CST 2021</span>
<span class="org-sh-heredoc">;; MSG SIZE  rcvd: 344</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>      1 0.000000       240e:3b7:2e91:9310:31bd:41e3:6d1e:3522 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754 DNS      98     Standard query 0x611d NS mit.edu OPT
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 1: 98 bytes on wire (784 bits), 98 bytes captured (784 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 6, Src: 240e:3b7:2e91:9310:31bd:41e3:6d1e:3522, Dst: 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754
<span class="linenr"> 7: </span>User Datagram Protocol, Src Port: 51259, Dst Port: 53
<span class="linenr"> 8: </span>Domain Name System (query)
<span class="linenr"> 9: </span>    Transaction ID: 0x611d
<span class="linenr">10: </span>    Flags: 0x0120 Standard query
<span class="linenr">11: </span>    Questions: 1
<span class="linenr">12: </span>    Answer RRs: 0
<span class="linenr">13: </span>    Authority RRs: 0
<span class="linenr">14: </span>    Additional RRs: 1
<span class="linenr">15: </span>    Queries
<span class="linenr">16: </span>        mit.edu: type NS, class IN
<span class="linenr">17: </span>    Additional records
<span class="linenr">18: </span>        &lt;Root&gt;: type OPT
<span class="linenr">19: </span>    [Response In: 2]
<span class="linenr">20: </span>
<span class="linenr">21: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">22: </span>      2 0.008975       240e:3b7:2e91:9310:26f5:a2ff:feb3:b754 240e:3b7:2e91:9310:31bd:41e3:6d1e:3522 DNS      466    Standard query response 0x611d NS mit.edu NS eur5.akam.net NS asia1.akam.net NS use2.akam.net NS asia2.akam.net NS ns1-37.akam.net NS usw2.akam.net NS ns1-173.akam.net NS use5.akam.net A 193.108.91.37 A 95.100.175.64 A 96.7.49.64 A 95.101.36.64 A 23.74.25.64 A 2.16.40.64 A 184.26.161.64 A 193.108.91.173 AAAA 2600:1401:2::25 AAAA 2600:1403:a::40 AAAA 2600:1401:2::ad
<span class="linenr">23: </span>
<span class="linenr">24: </span>Frame 2: 466 bytes on wire (3728 bits), 466 bytes captured (3728 bits) on interface en1, id 0
<span class="linenr">25: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">26: </span>Internet Protocol Version 6, Src: 240e:3b7:2e91:9310:26f5:a2ff:feb3:b754, Dst: 240e:3b7:2e91:9310:31bd:41e3:6d1e:3522
<span class="linenr">27: </span>User Datagram Protocol, Src Port: 53, Dst Port: 51259
<span class="linenr">28: </span>Domain Name System (response)
<span class="linenr">29: </span>    Transaction ID: 0x611d
<span class="linenr">30: </span>    Flags: 0x8180 Standard query response, No error
<span class="linenr">31: </span>    Questions: 1
<span class="linenr">32: </span>    Answer RRs: 8
<span class="linenr">33: </span>    Authority RRs: 0
<span class="linenr">34: </span>    Additional RRs: 11
<span class="linenr">35: </span>    Queries
<span class="linenr">36: </span>        mit.edu: type NS, class IN
<span class="linenr">37: </span>    Answers
<span class="linenr">38: </span>        mit.edu: type NS, class IN, ns eur5.akam.net
<span class="linenr">39: </span>        mit.edu: type NS, class IN, ns asia1.akam.net
<span class="linenr">40: </span>        mit.edu: type NS, class IN, ns use2.akam.net
<span class="linenr">41: </span>        mit.edu: type NS, class IN, ns asia2.akam.net
<span class="linenr">42: </span>        mit.edu: type NS, class IN, ns ns1-37.akam.net
<span class="linenr">43: </span>        mit.edu: type NS, class IN, ns usw2.akam.net
<span class="linenr">44: </span>        mit.edu: type NS, class IN, ns ns1-173.akam.net
<span class="linenr">45: </span>        mit.edu: type NS, class IN, ns use5.akam.net
<span class="linenr">46: </span>    Additional records
<span class="linenr">47: </span>        ns1-37.akam.net: type A, class IN, addr 193.108.91.37
<span class="linenr">48: </span>        asia1.akam.net: type A, class IN, addr 95.100.175.64
<span class="linenr">49: </span>        use2.akam.net: type A, class IN, addr 96.7.49.64
<span class="linenr">50: </span>        asia2.akam.net: type A, class IN, addr 95.101.36.64
<span class="linenr">51: </span>        eur5.akam.net: type A, class IN, addr 23.74.25.64
<span class="linenr">52: </span>        use5.akam.net: type A, class IN, addr 2.16.40.64
<span class="linenr">53: </span>        usw2.akam.net: type A, class IN, addr 184.26.161.64
<span class="linenr">54: </span>        ns1-173.akam.net: type A, class IN, addr 193.108.91.173
<span class="linenr">55: </span>        ns1-37.akam.net: type AAAA, class IN, addr 2600:1401:2::25
<span class="linenr">56: </span>        use5.akam.net: type AAAA, class IN, addr 2600:1403:a::40
<span class="linenr">57: </span>        ns1-173.akam.net: type AAAA, class IN, addr 2600:1401:2::ad
<span class="linenr">58: </span>    [Request In: 1]
<span class="linenr">59: </span>    [Time: 0.008975000 seconds]
</pre>
</div>
<p>
240e:3b7:2e91:9310:26f5:a2ff:feb3:b754. Yes.<br />
</p></li>

<li><p>
Examine the DNS query message. What “Type” of DNS query is it? Does the query message contain any “answers”?<br />
</p>

<p>
NS.<br />
</p></li>

<li><p>
Examine the DNS response message. What MIT nameservers does the response message provide? Does this response message also provide the IP addresses of the MIT namesers?<br />
</p>

<p>
mit.edu: type NS, class IN, ns eur5.akam.net<br />
mit.edu: type NS, class IN, ns asia1.akam.net<br />
mit.edu: type NS, class IN, ns use2.akam.net<br />
mit.edu: type NS, class IN, ns asia2.akam.net<br />
mit.edu: type NS, class IN, ns ns1-37.akam.net<br />
mit.edu: type NS, class IN, ns usw2.akam.net<br />
mit.edu: type NS, class IN, ns ns1-173.akam.net<br />
mit.edu: type NS, class IN, ns use5.akam.net<br />
</p>

<p>
Yes.<br />
</p></li>

<li>Provide a screenshot.<br /></li>

<li value="20"><p>
To what IP address is the DNS query message sent? Is this the IP address of your default local DNS server? If not, what does the IP address correspond to?<br />
</p>

<div class="org-src-container">
<pre class="src src-sh">&#10095; dig www.aiit.or.kr @ns71.dnszi.com

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; www.aiit.or.kr @ns71.dnszi.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 14836
<span class="org-sh-heredoc">;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 5, ADDITIONAL: 1</span>
<span class="org-sh-heredoc">;; WARNING: recursion requested but not available</span>

<span class="org-sh-heredoc">;; OPT PSEUDOSECTION:</span>
<span class="org-sh-heredoc">; EDNS: version: 0, flags:; udp: 4096</span>
<span class="org-sh-heredoc">;; QUESTION SECTION:</span>
<span class="org-sh-heredoc">;www.aiit.or.kr.      IN  A</span>

<span class="org-sh-heredoc">;; ANSWER SECTION:</span>
<span class="org-sh-heredoc">www.aiit.or.kr.   3600  IN  A 58.229.6.225</span>

<span class="org-sh-heredoc">;; AUTHORITY SECTION:</span>
<span class="org-sh-heredoc">aiit.or.kr.   3600  IN  NS  ns88.dnszi.com.</span>
<span class="org-sh-heredoc">aiit.or.kr.   3600  IN  NS  ns25.dnszi.com.</span>
<span class="org-sh-heredoc">aiit.or.kr.   3600  IN  NS  ns9.dnszi.com.</span>
<span class="org-sh-heredoc">aiit.or.kr.   3600  IN  NS  ns71.dnszi.com.</span>
<span class="org-sh-heredoc">aiit.or.kr.   3600  IN  NS  ns66.dnszi.com.</span>

<span class="org-sh-heredoc">;; Query time: 392 msec</span>
<span class="org-sh-heredoc">;; SERVER: 121.78.72.41#53(121.78.72.41)</span>
<span class="org-sh-heredoc">;; WHEN: Sat Aug 14 18:41:03 CST 2021</span>
<span class="org-sh-heredoc">;; MSG SIZE  rcvd: 162</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span class="linenr"> 1: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr"> 2: </span>      1 0.000000       192.168.1.72          121.78.72.41          DNS      85     Standard query 0x39f4 A www.aiit.or.kr OPT
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>Frame 1: 85 bytes on wire (680 bits), 85 bytes captured (680 bits) on interface en1, id 0
<span class="linenr"> 5: </span>Ethernet II, Src: Apple_51:06:4a (b8:09:8a:51:06:4a), Dst: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54)
<span class="linenr"> 6: </span>Internet Protocol Version 4, Src: 192.168.1.72, Dst: 121.78.72.41
<span class="linenr"> 7: </span>User Datagram Protocol, Src Port: 49902, Dst Port: 53
<span class="linenr"> 8: </span>Domain Name System (query)
<span class="linenr"> 9: </span>    Transaction ID: 0x39f4
<span class="linenr">10: </span>    Flags: 0x0120 Standard query
<span class="linenr">11: </span>    Questions: 1
<span class="linenr">12: </span>    Answer RRs: 0
<span class="linenr">13: </span>    Authority RRs: 0
<span class="linenr">14: </span>    Additional RRs: 1
<span class="linenr">15: </span>    Queries
<span class="linenr">16: </span>        www.aiit.or.kr: type A, class IN
<span class="linenr">17: </span>    Additional records
<span class="linenr">18: </span>        &lt;Root&gt;: type OPT
<span class="linenr">19: </span>    [Response In: 3]
<span class="linenr">20: </span>
<span class="linenr">21: </span>No.     Time           Source                Destination           Protocol Length Info
<span class="linenr">22: </span>      3 0.392447       121.78.72.41          192.168.1.72          DNS      204    Standard query response 0x39f4 A www.aiit.or.kr A 58.229.6.225 NS ns88.dnszi.com NS ns25.dnszi.com NS ns9.dnszi.com NS ns71.dnszi.com NS ns66.dnszi.com OPT
<span class="linenr">23: </span>
<span class="linenr">24: </span>Frame 3: 204 bytes on wire (1632 bits), 204 bytes captured (1632 bits) on interface en1, id 0
<span class="linenr">25: </span>Ethernet II, Src: BelkinIn_b3:b7:54 (24:f5:a2:b3:b7:54), Dst: Apple_51:06:4a (b8:09:8a:51:06:4a)
<span class="linenr">26: </span>Internet Protocol Version 4, Src: 121.78.72.41, Dst: 192.168.1.72
<span class="linenr">27: </span>User Datagram Protocol, Src Port: 53, Dst Port: 49902
<span class="linenr">28: </span>Domain Name System (response)
<span class="linenr">29: </span>    Transaction ID: 0x39f4
<span class="linenr">30: </span>    Flags: 0x8500 Standard query response, No error
<span class="linenr">31: </span>    Questions: 1
<span class="linenr">32: </span>    Answer RRs: 1
<span class="linenr">33: </span>    Authority RRs: 5
<span class="linenr">34: </span>    Additional RRs: 1
<span class="linenr">35: </span>    Queries
<span class="linenr">36: </span>        www.aiit.or.kr: type A, class IN
<span class="linenr">37: </span>    Answers
<span class="linenr">38: </span>        www.aiit.or.kr: type A, class IN, addr 58.229.6.225
<span class="linenr">39: </span>    Authoritative nameservers
<span class="linenr">40: </span>        aiit.or.kr: type NS, class IN, ns ns88.dnszi.com
<span class="linenr">41: </span>        aiit.or.kr: type NS, class IN, ns ns25.dnszi.com
<span class="linenr">42: </span>        aiit.or.kr: type NS, class IN, ns ns9.dnszi.com
<span class="linenr">43: </span>        aiit.or.kr: type NS, class IN, ns ns71.dnszi.com
<span class="linenr">44: </span>        aiit.or.kr: type NS, class IN, ns ns66.dnszi.com
<span class="linenr">45: </span>    Additional records
<span class="linenr">46: </span>        &lt;Root&gt;: type OPT
<span class="linenr">47: </span>    [Request In: 1]
<span class="linenr">48: </span>    [Time: 0.392447000 seconds]
</pre>
</div>

<p>
121.78.72.41.<br />
No.<br />
DNS server ns71.dnszi.com.<br />
</p></li>

<li><p>
Examine the DNS query message. What “Type” of DNS query is it? Does the query message contain any “answers”?<br />
</p>

<ol class="org-ol">
<li></li>
</ol>
<p>
Yes.<br />
</p></li>

<li><p>
Examine the DNS response message. How many “answers” are provided? What does each of these answers contain?<br />
</p>

<p>
Answers<br />
    www.aiit.or.kr: type A, class IN, addr 58.229.6.225<br />
Authoritative nameservers<br />
    aiit.or.kr: type NS, class IN, ns ns88.dnszi.com<br />
    aiit.or.kr: type NS, class IN, ns ns25.dnszi.com<br />
    aiit.or.kr: type NS, class IN, ns ns9.dnszi.com<br />
    aiit.or.kr: type NS, class IN, ns ns71.dnszi.com<br />
    aiit.or.kr: type NS, class IN, ns ns66.dnszi.com<br />
</p></li>

<li>Provide a screenshot.<br /></li>
</ol>
</div>
</div>
</div>
</div>

<div id="outline-container-org8736638" class="outline-2">
<h2 id="org8736638"><span class="section-number-2">3.</span> 运输层</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org25db268" class="outline-3">
<h3 id="org25db268"><span class="section-number-3">3.1.</span> 笔记</h3>
<div class="outline-text-3" id="text-3-1">
<table id="orga97ea99" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 3:</span> 构造可靠数据传输协议</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">问题</td>
<td class="org-left">解决方案</td>
</tr>

<tr>
<td class="org-left">1 比特差错</td>
<td class="org-left">差错检验,发送方反馈,重传</td>
</tr>

<tr>
<td class="org-left">1.1 ACK受损</td>
<td class="org-left">收到受损的ACK执行重传</td>
</tr>

<tr>
<td class="org-left">1.2 收到受损的ACK执行重传引入冗余分组</td>
<td class="org-left">分组编号</td>
</tr>

<tr>
<td class="org-left">2 丢包</td>
<td class="org-left">超时重传</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org69ee336" class="outline-3">
<h3 id="org69ee336"><span class="section-number-3">3.2.</span> 复习题</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org61ed0c2" class="outline-4">
<h4 id="org61ed0c2">R1 UDP提供的服务模型、运输层协议工作的位置</h4>
<div class="outline-text-4" id="text-org61ed0c2">
<p>
假定网络层提供了下列服务。在源主机中的网络层接受最大长度1200字节和来自运输层的目的主机地址的报文段。网络层则保证将该报文段交付给位于目的主机的运输层。假定在目的主机上能够运行许多网络应用进程。<br />
</p>

<ol class="org-ol">
<li>设计可能最简单的运输层协议，该协议将使应用程序数据到达位于目的主机的所希望的进程。假设在目的主机中的操作系统已经为每个运行的应用进程分配了一个4字节的端口号。<br /></li>
<li>修改这个协议，使它向目的进程提供一个的“返回地址”。<br /></li>
<li>在你的协议中，该运输层在计算机网络的核心中“必须做任何事”吗？<br /></li>
</ol>


<ol class="org-ol">
<li>简单运输协议（Simple Transport Protocol，STP）。<br />
在发送方，STP接受来自发送进程的一个不超过1196字节的数据块、一个目的主机地址和一个目的端口号。STP为每个数据块添加一个四字节的头部，这个头部的内容是目的进程的端口号。然后，STP将目的主机地址和产生的报文段交给网络层。网络层将报文段交付给目的主机的STP。然后，STP检查段中的端口号，从段中提取数据，并将数据传递给由端口号确定的进程。<br /></li>
<li>STP的头部增加一个4字节的源端口字段。<br /></li>
<li>运输层协议是在端系统中而不是在路由器中实现。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org7e96da4" class="outline-4">
<h4 id="org7e96da4">R2 信件邮政服务类比传输层协议</h4>
<div class="outline-text-4" id="text-org7e96da4">
<p>
考虑有一个星球，每个人都属于某个六口之家，每个家庭都住在自己的房子里，每个房子都一个唯一的地址，并且某给定家庭中的每个人有一个独特的名字。假定该星球有一个从源家庭到目的家庭交付信件的邮政服务。该邮件服务要求：①在一个信封中有一封信；②在信封上清楚地写上目的家庭的地址（并且没有别的东西）。假设每个家庭有一名家庭成员代表为家庭中的其他成员收集和分发信件。这些信没有必要提供任何有关信的接收者的指示。<br />
</p>

<ol class="org-ol">
<li>使用对上面复习题R1的解决方案作为启发，描述家庭成员代表能够使用的协议，以从发送家庭成员向接收家庭成员交付信件。<br /></li>
<li>在你的协议中，该邮政服务必须打开信封并检查信件内容才能提供它的服务吗？<br /></li>
</ol>


<ol class="org-ol">
<li>寄信时，家庭成员要把信的本身、目的地房屋的地址和收信人的姓名交给委托人。委托人在信的上面清楚地写上收件人的名字。然后，代表将信装入信封，并在信封上写上目的地房屋的地址。然后，代表将信交给地球上的邮递员。在收信方，代表从邮件服务处收到信，把信从信封里拿出来，并记下写在信上面的收件人姓名。然后，代表将信交给有这个名字的家庭成员。<br /></li>
<li>邮件服务不需要打开信封；它只检查信封上的地址。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org6aa9f36" class="outline-4">
<h4 id="org6aa9f36">R3 发送方和接受方的源端口号和目的端口号的关系</h4>
<div class="outline-text-4" id="text-org6aa9f36">
<p>
考虑在主机A和主机B之间有一条TCP连接。假设从主机A传送到主机B的TCP报文段具有源端口号x和目的端口号y。对于从主机B传送到主机A的报文段，源端口号和目的端口号分别是多少？<br />
</p>

<p>
源端口号y，目的端口号x。<br />
</p>
</div>
</div>

<div id="outline-container-org7bb44da" class="outline-4">
<h4 id="org7bb44da">R4 UDP相较于TCP的优势 p.131</h4>
<div class="outline-text-4" id="text-org7bb44da">
<p>
描述应用程序开发者为什么可能选择在UDP上运行应用程序而不是在TCP上运行的原因。<br />
</p>

<ul class="org-ul">
<li>关于发送什么数据以及何时发送的应用层控制更为精细。<br /></li>
<li>无须连接建立。<br /></li>
<li>无连接状态。<br /></li>
<li>分组首部开销小。<br /></li>
</ul>
</div>
</div>

<div id="outline-container-org72ecdd1" class="outline-4">
<h4 id="org72ecdd1">R5 流媒体应用在UDP更具有优势的前提下选择TCP的原因 p.131</h4>
<div class="outline-text-4" id="text-org72ecdd1">
<p>
在今天的因特网中，为什么语音和图像流量常常是经过TCP而不是经UDP发送。（提示：我们寻找的答案与TCP的拥塞控制机制没有关系。）<br />
</p>

<p>
当分组丢包率低时，并且为了安全原因，某些机构阻塞UDP流扯，对于流式媒体传输来说，TCP变得越来越有吸引力了。<br />
</p>
</div>
</div>

<div id="outline-container-orgef46da5" class="outline-4">
<h4 id="orgef46da5">R6 在UDP之上的应用层协议中实现可靠性传输 p.132</h4>
<div class="outline-text-4" id="text-orgef46da5">
<p>
当某应用程序运行在UDP上时，该应用程序可能得到可靠数据传输吗？如果能，如何实现？<br />
</p>

<p>
可能。可以通过在应用程序自身中建立可靠性机制来完成。<br />
</p>
</div>
</div>

<div id="outline-container-org0ff6d1e" class="outline-4">
<h4 id="org0ff6d1e">R7 UDP套接字由二元组（目的IP地址、目的端口号）标识 p.127</h4>
<div class="outline-text-4" id="text-org0ff6d1e">
<p>
假定在主机C上的一个进程有一个具有端口号6789的UDP套接字。假定主机A和主机B都用目的端口号6789向主机C发送一个UDP报文段。这两台主机的这些报文段在主机C都被描述为相同的套接字吗？如果是这样的话，在主机C的该进程将怎样知道源于两台不同主机的这两个报文段？<br />
</p>

<p>
这两个报文段将被定向到同一个套接字。进程可以从套接字接口获取报文段的源IP地址从而确定其来源。<br />
</p>
</div>
</div>

<div id="outline-container-org7a5a8e0" class="outline-4">
<h4 id="org7a5a8e0">R8 TCP套接字由一个四元组标识 p.128</h4>
<div class="outline-text-4" id="text-org7a5a8e0">
<p>
假定在主机C端口80上运行的一个Web服务器。假定这个Web服务器使用持续连接，并且正在接收来自两台不同主机A和B的请求。被发送的所有请求都通过位于主机C的相同套接字吗？如果它们通过不同的套接字传递，这两个套接字都具有端口80吗？讨论和解释之。<br />
</p>

<p>
对于每个持久性连接，Web服务器创建一个单独的 "连接套接字"。每个连接套接字都有一个四元组标识：（源IP地址、源端口号、目标IP地址、目标端口号）。当主机C收到IP数据报时，它检查数据报/报文段中的这四个字段，以确定它应该将TCP报文段的有效载荷传递给哪个套接字。因此，来自A和B的请求通过不同的套接字。这两个套接字的标识符的目的端口都是80；但是，这些套接字的标识符的源IP地址的值不同。与UDP不同，当传输层将TCP段的有效载荷传递给应用进程时，它不指定源IP地址，因为这是由套接字标识符隐含地指定的。<br />
</p>
</div>
</div>

<div id="outline-container-orgfd51073" class="outline-4">
<h4 id="orgfd51073">R9 为什么引入序号 p.138</h4>
<div class="outline-text-4" id="text-orgfd51073">
<p>
在我们的rdt协议中，为什么需要引入序号？<br />
</p>

<p>
在rdt2.0中引入了确认和重传解决了分组可能受损或丢失的问题；但同时引入了冗余分组。接收方在收到冗余分组时不知道这是一个新的分组还是重传。于是给分组加上序号，这样接收方就能确定收到的分组是否是一次重传。<br />
</p>
</div>
</div>

<div id="outline-container-org652f4a9" class="outline-4">
<h4 id="org652f4a9">R10 为什么引入定时器 p.141</h4>
<div class="outline-text-4" id="text-org652f4a9">
<p>
在我们的rdt协议中，为什么需要引入定时器？<br />
</p>

<p>
在rdt3.0中引入定时器是为了检测丢包，即数据分组丢失、ACK丢失或者该分组或ACK过度延时。<br />
</p>
</div>
</div>

<div id="outline-container-org17c1237" class="outline-4">
<h4 id="org17c1237">R11</h4>
<div class="outline-text-4" id="text-org17c1237">
<p>
假定发送方和接收方之间的往返时延是固定的并且为发送方所知。假设分组能够丢失的话，在协议rdt3.0中，一个定时器仍是必需的吗？试解释之。<br />
</p>

<p>
仍然是必需的。定时器的作用是在一个确定的时间后如果没收到ACK就判定丢包，这个确定的时间至少是RTT加接收方处理分组的时间。至于这个RTT是不是固定且已知的只会影响判定的准确性。<br />
</p>
</div>
</div>

<div id="outline-container-org9040b42" class="outline-4">
<h4 id="org9040b42">R12 Go-Back-N动画演示</h4>
<div class="outline-text-4" id="text-org9040b42">
<p>
在配套网站上使用Go-Back-N（回退N步）Java小程序。<br />
</p>
<ol class="org-ol">
<li>让源发送5个分组，在这5个分组的任何一个到达目的地之前暂停该动画。然后毁掉第一个分组并继续该动画。试描述发生的情况。<br /></li>
<li>重复该实验，只是现在让第一个分组到达目的地并毁掉第一个确认。再次描述发生的情况。<br /></li>
<li>最后，尝试发送6个分组。发生了什么情况？<br /></li>
</ol>


<p>
<a href="https://media.pearsoncmg.com/aw/ecs_kurose_compnetwork_7/cw/content/interactiveanimations/go-back-n-protocol/index.html">Go-Back-N Protocol.</a><br />
</p>

<ol class="org-ol">
<li>接收方收到1、2、3、4分组，但是由于失序而丢弃。经过一段时间后定时器超时，接收方重传0～4分组。接收方收到分组后发送ACK0～4。发送方收到ACK0～4后窗口移动至5～9。<br /></li>
<li>接收方在收到1分组后发出ACK1。发送方收到ACK1后移动了发送窗口。<br /></li>
<li>在1毁掉第一个分组后，发送方继续发送完1～5分组后发送窗口已满，无法发送6分组。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org029bc9c" class="outline-4">
<h4 id="org029bc9c">R13 Selective Repeat动画演示</h4>
<div class="outline-text-4" id="text-org029bc9c">
<p>
重复复习题R12，但是现在使用Selective Repeat（选择重传）Java小程序。选择重传和回退N步有什么不同？<br />
</p>

<p>
<a href="https://media.pearsoncmg.com/aw/ecs_kurose_compnetwork_7/cw/content/interactiveanimations/selective-repeat-protocol/index.html">Selective Repeat Protocol.</a><br />
</p>

<ol class="org-ol">
<li>&#x00ad;<br />
<ul class="org-ul">
<li>接收方确认了1-4分组，并发送ACK1-4<br /></li>
<li>发送方收到ACK1-4后，经过一段时间定时器超时，重发0分组<br /></li>
<li>接收方确认0分组，发送ACK0，发送窗口移动（rcv_base指向5）<br /></li>
<li>接收方收到ACK0，接收窗口移动（send_base指向5）<br /></li>
</ul></li>
<li>发送方在定时器超时后重传1分组<br /></li>
<li>发送窗口已满，无法发送6分组。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org9500538" class="outline-4">
<h4 id="org9500538">R14</h4>
<div class="outline-text-4" id="text-org9500538">
<p>
是非判断题：<br />
</p>
<ol class="org-ol">
<li>主机A经过一条TCP连接向主机B发送一个大文件。假设主机B没有数据发往主机A。因为主机B不能随数据捎带确认，所以主机B将不向主机A发送确认。<br /></li>
<li>在连接的整个过程中，TCP的rwnd的长度决不会变化。<br /></li>
<li>假设主机A通过一条TCP连接向主机B发送一个大文件。主机A发送但未被确认的字节数不会超过接收缓存的大小。<br /></li>
<li>假设主机A通过一条TCP连接向主机B发送一个大文件。如果对于这条连接的一个报文段的序号为m，则对于后继报文段的序号将必然是m+1。<br /></li>
<li>TCP报文段在它的首部中有一个rwnd字段。<br /></li>
<li>假定在一条TCP连接中最后的SampleRTT等于1秒，那么对于该连接的TimeoutInterval的当前值必定大于等于1秒。<br /></li>
<li>假设主机A通过一条TCP连接向主机B发送一个序号为38的4个字节的报文段。在这个相同的报文段中，确认号必定是42。<br /></li>
</ol>


<ol class="org-ol">
<li>主机B需要发送确认。<br /></li>
<li>rwnd会随着发送方的空闲换粗大小改变。<br /></li>
<li>正确。<br /></li>
<li>报文段的序号是该报文段首字节的字节流编号。<br /></li>
<li>正确。<br /></li>
<li>TimeoutInterval=EstimatedRTT+4DevRTT<br /></li>
<li>确认号是对主机B序号对确认，而不是对主机A自己。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org6fba991" class="outline-4">
<h4 id="org6fba991">R15 TCP报文段的序号和确认号</h4>
<div class="outline-text-4" id="text-org6fba991">
<p>
假设主机A通过一条TCP连接向主机B发送两个紧接着的TCP报文段。第一个报文段的序号为90，第二个报文段序号为110。<br />
</p>
<ol class="org-ol">
<li>第一个报文段中有多少数据？<br /></li>
<li>假设第一个报文段丢失而第二个报文段到达主机B。那么在主机B发往主机A的确认报文中，确认号应该是多少？<br /></li>
</ol>


<ol class="org-ol">
<li>20字节<br /></li>
<li>ACK=90<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org9606ceb" class="outline-4">
<h4 id="org9606ceb">R16 Telnet中的TCP序号和确认号</h4>
<div class="outline-text-4" id="text-org9606ceb">
<p>
考虑在3.5节中讨论的Telnet的例子。在用户键入字符C数秒之后，用户又键入字符R。那么在用户键入字符R之后，总共发送了多少个报文段，这些报文段中的序号和确认字段应该填入什么？<br />
</p>


<div id="orga37a0be" class="figure">
<p><img src="img/ch3-r16.svg" alt="ch3-r16.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgcbe1341" class="outline-4">
<h4 id="orgcbe1341">R17 公平性</h4>
<div class="outline-text-4" id="text-orgcbe1341">
<p>
假设两条TCP连接存在于一个带宽为Rbps的瓶颈链路上。它们都要发送一个很大的文件（以相同方向经过瓶颈链路），并且两者是同时开始发送文件。那么TCP将为每条连接分配什么样的传输速率？<br />
</p>

<p>
R/2<br />
</p>
</div>
</div>

<div id="outline-container-orgf6ac426" class="outline-4">
<h4 id="orgf6ac426">R18</h4>
<div class="outline-text-4" id="text-orgf6ac426">
<p>
是非判断题。考虑TCP的拥塞控制。当发送方定时器超时时，其ssthresh的值将被设置为原来值的一半。<br />
</p>

<p>
错误，设为拥塞窗口的一半。<br />
</p>
</div>
</div>

<div id="outline-container-org472f1d8" class="outline-4">
<h4 id="org472f1d8">R19 TCP分叉 p.179</h4>
<div class="outline-text-4" id="text-org472f1d8">
<p>
在3.7节的“TCP分岔”讨论中，对于TCP分岔的响应时间，断言大约是\( 4\times RTT_{FE}+RTT_{BE}+\text{处理时间} \)。评价该断言。<br />
</p>


<div id="org5ffcb44" class="figure">
<p><img src="img/ch3-r18a.svg" alt="ch3-r18a.svg" class="org-svg" style="width:100%; max-width:200px;" /><br />
</p>
</div>


<div id="org51ff229" class="figure">
<p><img src="img/ch3-r18b.svg" alt="ch3-r18b.svg" class="org-svg" style="width:100%; max-width:350px;" /><br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org3480b4f" class="outline-3">
<h3 id="org3480b4f"><span class="section-number-3">3.3.</span> 习题</h3>
<div class="outline-text-3" id="text-3-3">
</div>
<div id="outline-container-orge6921d6" class="outline-4">
<h4 id="orge6921d6">P1 源端口号和目的端口号</h4>
<div class="outline-text-4" id="text-orge6921d6">
<p>
假设客户A向服务器S发起一个Telnet会话。与此同时，客户B也向服务器S发起一个Telnet会话。给出下面报文段的源端口号和目的端口号：<br />
</p>
<ol class="org-ol">
<li>从A向S发送的报文段。<br /></li>
<li>从B向S发送的报文段。<br /></li>
<li>从S向A发送的报文段。<br /></li>
<li>从S向B发送的报文段。<br /></li>
<li>如果A和B是不同的主机，那么从A向S发送的报文段的源端口号是否可能与从B向S发送的报文段的源端口号相同？<br /></li>
<li>如果它们是同一台主机，情况会怎么样？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">序号</td>
<td class="org-left">源端口号</td>
<td class="org-left">目的端口号</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">A</td>
<td class="org-left">S</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">B</td>
<td class="org-left">S</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">S</td>
<td class="org-left">A</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">S</td>
<td class="org-left">B</td>
</tr>
</tbody>
</table></li>

<li value="5">Yes<br /></li>
<li>No<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org444879d" class="outline-4">
<h4 id="org444879d">P2</h4>
<div class="outline-text-4" id="text-org444879d">
<p>
考虑图3-5。从服务器返回客户进程的报文流中的源端口号和目的端口号是多少？在承载运输层报文段的网络层数据报中，IP地址是多少？<br />
</p>


<div id="orgd271f56" class="figure">
<p><img src="./img/fig3-5.png" alt="fig3-5.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>

<p>
报文段中的源端口和目的端口对调，数据包中的源IP和目的IP对调。<br />
</p>
</div>
</div>

<div id="outline-container-org7e080d5" class="outline-4">
<h4 id="org7e080d5">P3 UDP检验和 p.133</h4>
<div class="outline-text-4" id="text-org7e080d5">
<p>
UDP和TCP使用反码来计算它们的检验和。假设你有下面3个8比特字节：01010011，01100110，01110100。<br />
</p>
<ol class="org-ol">
<li>这些8比特字节和的反码是多少？（注意到尽管UDP和TCP使用16比特的字来计算检验和，但对于这个问题，你应该考虑8比特和。）写出所有工作过程。<br /></li>
<li>UDP为什么要用该和的反码，即为什么不直接使用该和呢？<br /></li>
<li>使用该反码方案，接收方如何检测出差错？<br /></li>
<li>1比特的差错将可能检测不出来吗？<br /></li>
<li>2比特的差错呢？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<pre class="example" id="orgb20fbc9">
  0101 0011
+ 0110 0110
= 1011 1001

  1011 1001    0010 1101
+ 0111 0100  +         1
=10010 1101    0010 1110

  0010 1110
c 1101 0001
</pre></li>

<li>接收方将校验和在内的比特字加在一起，如果结果比特中没有0则认为没有引入差错。如果校验和直接用和，那么接收方要用减法，猜测是因为减法用硬件处理更慢。<br /></li>
<li>见2<br /></li>
<li>1比特的差错都可以被检测出<br /></li>
<li>2比特差错可能检测不出。如果2个不同比特字节的对应位置出现差错，求和的结果不变，所以检测不出。<br /></li>
</ol>


<p>
UDP求和时遇到溢出采用的是回卷处理（<a href="https://qr.ae/pGWXNX">wrap around</a>）。实际上采用截断也是可以的。例如，原始报文段 0110 1110，采用截断求和得到 0100，求反得到校验和1011，一样能够校验。<br />
</p>
</div>
</div>

<div id="outline-container-orgf19c59f" class="outline-4">
<h4 id="orgf19c59f">P4 和的反码</h4>
<div class="outline-text-4" id="text-orgf19c59f">
<ol class="org-ol">
<li>假定你有下列2个字节：01011100和01100101。这2个字节之和的反码是什么？<br /></li>
<li>假定你有下列2个字节：11011010和01100101。这2个字节之和的反码是什么？<br /></li>
<li>对于（1）中的字节，给出一个例子，使得这2个字节中的每一个都在一个比特反转时，其反码不会改变。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<pre class="example" id="org4f3ebea">
  0101 1100
+ 0110 0101
= 1100 0001
c 0011 1110
</pre></li>
<li><p>
&#x00ad;<br />
</p>
<pre class="example" id="org1cc8d2e">
  1101 1010
+ 0110 0101
=10011 1111

  0011 1111
+         1
= 0100 0000
c 1011 1111
</pre></li>
<li><p>
&#x00ad;<br />
</p>
<pre class="example" id="orgb07e8ac">
  0101 1101
+ 0110 0100
= 1100 0001
c 0011 1110
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org30abd9b" class="outline-4">
<h4 id="org30abd9b">P5 UDP差错检测</h4>
<div class="outline-text-4" id="text-org30abd9b">
<p>
假定某UDP接收方对接收到的UDP报文段计算因特网检验和，并发现它与承载在检验和字段中的值相匹配。该接收方能够绝对确信没有出现过比特差错吗？试解释之。<br />
</p>

<p>
不能，解释见P3.5、P4。<br />
</p>
</div>
</div>

<div id="outline-container-org9bea6e4" class="outline-4">
<h4 id="org9bea6e4">P6 rdt2.1进入死锁的改动</h4>
<div class="outline-text-4" id="text-org9bea6e4">
<p>
考虑我们改正协议rdt2.1的动机。试说明如图3-57所示的接收方与如图3-11所示的发送方运行时，接收方可能会引起发送方和接收方进入死锁状态，即双方都在等待不可能发生的事件。<br />
</p>


<div id="org6b72998" class="figure">
<p><img src="./img/fig3-11.png" alt="fig3-11.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>


<div id="org1dba7c7" class="figure">
<p><img src="./img/fig3-57.png" alt="fig3-57.png" style="width:100%; max-width:800px;" /><br />
</p>
</div>

<p>
在“等待来自下层的0”状态中，蓝色的事件动作是原来的，对corrupt和seq1响应是不同的；而修改后这两个事件合并到一起了，都返回NAK。“等待来自下层的1”也作了类似的修改。<br />
</p>

<p>
现在假设发送处于“等待来自上层的调用0”状态，发送了分组0，状态变为“等待ACK或NAK 0”。接收方收到分组0，返回ACK，状态变为“等待来自下层的1”。但是这个ACK在传送的过程中损坏了，于是发送方重传分组0。接收方收到分组0后发送NAK。发送方收到NAK后继续重传分组0，双方进入死锁状态，如下图。<br />
</p>


<div id="org3423210" class="figure">
<p><img src="img/ch3-p6.svg" alt="ch3-p6.svg" class="org-svg" style="width:100%; max-width:700px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb1cae2a" class="outline-4">
<h4 id="orgb1cae2a">P7 序号的作用</h4>
<div class="outline-text-4" id="text-orgb1cae2a">
<p>
在rdt3.0协议中，从接收方向发送方流动的ACK分组没有序号（尽管它们具有ACK字段，该字段包括了它们正在确认的分组的序号）。为什么这些ACK分组不需要序号呢？<br />
</p>

<p>
rdt3.0是一个比特交替协议，同时也是一个停等协议。例如，当发送方处于等待ACK0的状态时，发送方被阻塞，只有收到了ACK0才会解除阻塞状态。此时不论接收方发送ACK0还是ACK1都有对应的合理行为，不会有什么误解，所以ACK分组不需要需要序号。<br />
序号是用于解决接受方不能区分分组是新的还是重传的这个问题的。<br />
</p>
</div>
</div>

<div id="outline-container-orga00ffca" class="outline-4">
<h4 id="orga00ffca">P8 rdt3.0</h4>
<div class="outline-text-4" id="text-orga00ffca">
<p>
画出协议rdt3.0中接收方的FSM。<br />
</p>

<p>
rdt3.0的发送方相较于rdt2.2增加了timeout重传，rdt2.2的接收方仍然能够处理这种情况。<br />
</p>


<div id="org7c11a20" class="figure">
<p><img src="./img/ch3-p8.png" alt="ch3-p8.png" style="width:100%; max-width:1000px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgdbd3af3" class="outline-4">
<h4 id="orgdbd3af3">P9 rdt3.0分组发生篡改的时序图</h4>
<div class="outline-text-4" id="text-orgdbd3af3">
<p>
当数据分组和确认分组发生篡改时，给出rdt3.0协议运行的轨迹。你画的轨迹应当类似于图3-16中所用的图。<br />
</p>


<div id="org1887522" class="figure">
<p><img src="img/ch3-p9a.svg" alt="ch3-p9a.svg" class="org-svg" style="width:100%; max-width:300px;" /><br />
</p>
<p><span class="figure-number">Figure 2: </span>数据分组发生篡改</p>
</div>


<div id="orgabd3663" class="figure">
<p><img src="img/ch3-p9b.svg" alt="ch3-p9b.svg" class="org-svg" style="width:100%; max-width:300px;" /><br />
</p>
<p><span class="figure-number">Figure 3: </span>确认分组发生篡改</p>
</div>
</div>
</div>

<div id="outline-container-orgbda17d7" class="outline-4">
<h4 id="orgbda17d7">P10 为rdt2.1增加超时重传</h4>
<div class="outline-text-4" id="text-orgbda17d7">
<p>
考虑一个能够丢失分组但其最大时延已知的信道。修改协议rdt2.1，以包括发送方超时和重传机制。非正式地论证：为什么你的协议能够通过该信道正确通信？<br />
</p>

<p>
rdt3.0由rdt2.2改进，无NAK。本题由rdt2.1改进，使用ACK和NAK，接收方与rdt2.1相同。<br />
</p>


<div id="org9212d4d" class="figure">
<p><img src="./img/ch3-p10.png" alt="ch3-p10.png" style="width:100%; max-width:1000px;" /><br />
</p>
<p><span class="figure-number">Figure 4: </span>rdt3.1发送方</p>
</div>
</div>
</div>

<div id="outline-container-org1dd30e9" class="outline-4">
<h4 id="org1dd30e9">P11 rdt2.2进入死锁的改动</h4>
<div class="outline-text-4" id="text-org1dd30e9">
<p>
考虑在图3-14中的rdt2.2接收方，在状态"等待来自下层的0"和状态"等待来自下层的1"中的自转换（即从某状态转换回自身）中生成一个新分组： <code>sndpkt=make_pkt(ACK, 1, checksum)</code> 和 <code>sndpkt=make_pkt(ACK, 0, checksum)</code> 。如果这个动作从状态"等待来自下层的1"中的自转换中删除，该协议将正确工作吗？评估你的答案。在状态"等待来自下层的0"中的自转换中删除这个事件将会怎样？【提示：在后一种情况下，考虑如果第一个发送方到接收方的分组损坏的话，将会发生什么情况？】<br />
</p>


<div id="org6b6979e" class="figure">
<p><img src="./img/fig3-14.png" alt="fig3-14.png" style="width:100%; max-width:800px;" /><br />
</p>
</div>

<p>
会发生类似于P6的死锁情况。<br />
</p>
</div>
</div>

<div id="outline-container-org03b0744" class="outline-4">
<h4 id="org03b0744">P12 rdt3.0</h4>
<div class="outline-text-4" id="text-org03b0744">
<p>
rdt3.0协议的发送方直接忽略（即不采取任何动作）接收到的所有出现差错和确认分组的确认号（acknum）字段中的值有差错的分组。假设在这种情况下，rdt3.0只是重传当前的数据分组，该协议是否还能正常运行？（提示：考虑在下列情况下会发生什么悄况：仅有一个比特差错时；报文没有丢失但能出现定时器过早超时。考虑到当n趋于无穷时，第n个分组将被发送多少次。）<br />
</p>

<p>
The sender side of rdt3.0 simply ignores (that is, takes no action on) all received packets that are either in error or have the wrong value in the acknum field of an acknowledgment packet. Suppose that in such circumstances, rdt3.0 were simply to retransmit the current data packet. Would the protocol still work? (Hint: Consider what would happen if there were only bit errors; there are no packet losses but premature timeouts can occur. Consider how many times the nth packet is sent, in the limit as n approaches infinity.)<br />
</p>


<div id="org8bf81a1" class="figure">
<p><img src="./img/ch3-p12.png" alt="ch3-p12.png" style="width:100%; max-width:355px;" /><br />
</p>
</div>

<p>
可以正常工作。由上图可以看出，第一次过早超时所引起的重传会导致发送方对接下来的每个分组都重传一次。后面的第二次、第三次到第n次过早超时都会有这样的影响。所以第n个分组会被发送n+2次，n趋于无穷时，被发送的次数也趋近无穷。<br />
</p>
</div>
</div>

<div id="outline-container-orgbafa936" class="outline-4">
<h4 id="orgbafa936">P13 rdt3.0</h4>
<div class="outline-text-4" id="text-orgbafa936">
<p>
考虑rdt3.0协议。如果发送方和接收方的网络连接能够对报文重排序（即在发送方和接收方之间的媒体上传播的两个报文段能重新排序），那么比特交替协议将不能正确工作（确信你清楚地理解这时它不能正确工作的原因），试画图说明之。画图时把发送方放在左边，接收方放在右边，使时间轴朝下，标出交换的数据报文（D）和确认报文（A）。要标明与任何数据和确认报文段相关的序号。<br />
</p>


<div id="orgde2e099" class="figure">
<p><img src="./img/ch3-p13.png" alt="ch3-p13.png" style="width:100%; max-width:274px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org46a4551" class="outline-4">
<h4 id="org46a4551">P14 只是用NAK的协议</h4>
<div class="outline-text-4" id="text-org46a4551">
<p>
考虑一种仅使用否定确认的可靠数据传输协议。假定发送方只是偶尔发送数据。只用NAK的协议是否会比使用ACK的协议更好？为什么？现在我们假设发送方要发送大量的数据，并且该端到端连接很少丢包。在第二种情况下，只用NAK的协议是否会比使用ACK的协议更好？为什么？<br />
</p>

<blockquote>
<p>
在仅使用NAK的协议中，接收方只有在收到x+1数据包时，才能发现数据包x的丢失。如果x的传输和x+1的传输之间有很大的延迟，将需要很长的时间才能恢复x。<br />
</p>

<p>
另一方面，如果数据经常被发送，那么恢复可能很快发生。此外，如果错误不经常发生，那么NAK只是在需要的时候偶尔发送，反馈比只发送ACK的情况下大大减少。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org8ce93c8" class="outline-4">
<h4 id="org8ce93c8">P15 信道利用率</h4>
<div class="outline-text-4" id="text-org8ce93c8">
<p>
考虑显示在图3-17中的网络跨越国家的例子。窗口长度设览成多少时，才能使该信道的利用率超过90%？假设分组的长度为1500字节（包括首部字段和数据）。<br />
</p>


<div id="org31f9561" class="figure">
<p><img src="./img/fig3-17.png" alt="fig3-17.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>

<p>
发送一个分组所需要的时间：<br />
</p>

<p>
\[ t_{\rm{trans}} = \frac{L}{R} = \frac{1500\rm{Byte/pkt}}{10^{9}\rm{bit/s}} = 12\rm{μs/pkt} \]<br />
</p>

<p>
设窗口长度为n，令利用率为90%：<br />
</p>

\begin{align*}
  U_{\rm{sender}} &= \frac{n\times t_{\rm{trans}}}{RTT+t_{\rm{trans}}} = \frac{0.012n}{30.012} > 0.9 \\
  n &> 2250.9
\end{align*}
</div>
</div>

<div id="outline-container-org8d1c01a" class="outline-4">
<h4 id="org8d1c01a">P16 流水线</h4>
<div class="outline-text-4" id="text-org8d1c01a">
<p>
假设某应用使用rdt3.0作为其运输层协议。因为停等协议具有非常低的信道利用率（显示在网络跨越国家的例子中），该应用程序的设计者让接收方持续回送许多（大于2）交替的ACK0和ACKI，即使对应的数据未到达接收方。这个应用程序设计将能增加信道利用率吗？为什么？该方法存在某种潜在的问题吗？试解释之。<br />
</p>


<div id="org844da2a" class="figure">
<p><img src="./img/ch3-p16.png" alt="ch3-p16.png" style="width:100%; max-width:200px;" /><br />
</p>
</div>

<p>
可以触发一定程度的流水线，但是发送方将无法重传丢失的分组。<br />
</p>
</div>
</div>

<div id="outline-container-orgbf4bf60" class="outline-4">
<h4 id="orgbf4bf60">P17 严格交替发送的状态机</h4>
<div class="outline-text-4" id="text-orgbf4bf60">
<p>
考虑两个网络实体A和B，它们由一条完善的双向信道所连接（即任何发送的报文将正确地收到；信道将不会损坏、丢失或重排序分组）。A和B将以交互的方式彼此交付报文：首先，A必须向B交付一个报文，B然后必须向A交付一个报文，接下来A必须向B交付一个报文，等等。如果一个实体处于它不试图向另一侧交付报文的状态，将存在一个来自上层的类似于rdt_send(data)调用的事件，它试图向下传送数据以向另一侧传输，来自上层的该调用能够直接忽略对于rdt_unable_to_send(data)调用，这通知较高层当前不能够发送数据。［注意：做出这种简化的假设，使你不必担心缓存数据。］<br />
</p>

<p>
对该协议画出FSM说明（一个FSM用于A，一个FSM用千B）。注意你不必担心这里的可靠性机制，该问题的要点在于创建反映这两个实体的同步行为的FSM说明。应当使用与图3-9中协议rdt1.0有相同含义的下列事件和动作：rdt_send(data)，packet = make_pkt(data) ，udt_send(packet)，rdt_rcv(packet) ，extract (packet, data)，deliver_data(data)。保证你的协议反映了A和B之间发送的严格交替。还要保证在你的FSM描述中指出A和B的初始状态。<br />
</p>


<div id="org99fbbce" class="figure">
<p><img src="./img/ch3-p17.png" alt="ch3-p17.png" style="width:100%; max-width:800px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org773a877" class="outline-4">
<h4 id="org773a877">P18 选择重传</h4>
<div class="outline-text-4" id="text-org773a877">
<p>
在3.4.4节我们学习的一般性SR协议中，只要报文可用（如果报文在窗口中），发送方就会不等待确认而传输报文。假设现在我们要求一个SR协议，一次发出一对报文，而且只有在知道第一对报文中的两个报文都正确到达后才发送第二对报文。<br />
</p>

<p>
假设该信道中可能会丢失报文，但报文不会发生损坏和失序。试为报文的单向可靠传输而设计一个差错控制协议。画出发送方和接收方的FSM描述。描述在发送方和接收方之间两个方向发送的报文格式。如果你使用了不同于3.4节（例如udt_send()、start_timer()、rdt_rcv()等）中的任何其他过程调用，详细地阐述这些动作。举例说明（用发送方和接收方的时序踪迹图）你的协议是如何恢复报文丢失的。<br />
</p>

<p>
SR的状态机图：<br />
</p>


<div id="orgbc6a567" class="figure">
<p><img src="./img/ch3-p18a.png" alt="ch3-p18a.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>

<p>
用一个窗口长度N=2的SR协议，且仅当send_base、send_base+1都被确认了才移动send_base。<br />
</p>


<div id="org641619d" class="figure">
<p><img src="./img/ch3-p18b.png" alt="ch3-p18b.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb94cb3a" class="outline-4">
<h4 id="orgb94cb3a">P19 由rdt3.0衍生的发送给多个接收方的停等模型</h4>
<div class="outline-text-4" id="text-orgb94cb3a">
<p>
考虑一种情况，主机A想同时向主机B和主机C发送分组。A与B和C是经过广播信道连接的，即由A发送的分组通过该信道传送到B和C。假设连接A、B和C的这个广播信道具有独立的报文丢失和损坏特性（例如，从A发出的报文可能被B正确接收，但没有被C正确接收）。设计一个类似于停等协议的差错控制协议，用于从A可靠地传输分组到B和C。该协议使得A直到得知B和C已经正确接收到当前报文，才获取上层交付的新数据。给出A和C的FSM描述。（提示：B的FSM大体上应当与C的相同。）同时，给出所使用的报文格式的描述。<br />
</p>

<p>
因为信道可能丢失报文，所以分组需要序号。在rdt3.0的基础上修改即可，发送方的FSM如下，接收方的FSM同rdt3.0。<br />
</p>


<div id="org6e2b9f4" class="figure">
<p><img src="./img/ch3-p19.png" alt="ch3-p19.png" style="width:100%; max-width:1100px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgc91f35a" class="outline-4">
<h4 id="orgc91f35a">P20 由rdt3.0衍生的多个发送方的停等模型</h4>
<div class="outline-text-4" id="text-orgc91f35a">
<p>
考虑一种主机A和主机B要向主机C发送报文的情况。主机A和C通过一条报文能够丢失和损坏（但不重排序）的信道相连接。主机B和C由另一条（与连接A和C的信道独立）具有相同性质的信道连接。在主机C上的运输层，在向上层交付来自主机A和B的报文时应当交替进行（即它应当首先交付来自A的分组中的数据，然后是来自B的分组中的数据，等等）。设计一个类似于停等协议的差错控制协议，以可靠地向C传输来自A和B的分组，同时以前面描述的方式在C处交替地交付。给出A和C的FSM描述。（提示：B的FSM大体上应当与A的相同。）同时，给出所使用的报文格式的描述。<br />
</p>

<p>
接收方：<br />
</p>


<div id="orgf93b1fe" class="figure">
<p><img src="./img/ch3-p20.png" alt="ch3-p20.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>

<p>
发送方与rdt3.0相同。<br />
</p>
</div>
</div>

<div id="outline-container-orgef6e034" class="outline-4">
<h4 id="orgef6e034">P21 停等协议中超时重传和序号的作用</h4>
<div class="outline-text-4" id="text-orgef6e034">
<p>
假定我们有两个网络实体A和B。B有一些数据报文要通过下列规则传给A。当A从其上层得到一个请求，就从B获取下一个数据（D）报文。A必须通过A-8信道向B发送一个请求（R）报文。仅当B收到一个R报文后，它才会通过B—A信道向A发送一个数据（D）报文。A应当准确地将每份D报文的副本交付给上层。R报文可能会在A—B信道中丢失（但不会损坏）；D报文一旦发出总是能够正确交付。两个信道的时延未知且是变化的。设计一个协议（给出FSM描述），它能够综合适当的机制，以补偿会丢包的A—B信道，并且实现在A实体中向上层传递报文。只采用绝对必要的机制。<br />
</p>

<p>
因为A-B信道可能会丢失请求信息，A将需要超时并重发其请求信息（以便能够从丢失中恢复）。因为信道的延迟是可变的和未知的，所以A有可能会发送重复的请求（即重新发送已经被B收到的请求信息）。为了能够检测重复的请求信息，该协议将使用序列号。一个1位的序列号对于一个停止和等待类型的请求/响应协议来说就足够了。<br />
</p>


<div id="orgbfce85d" class="figure">
<p><img src="./img/ch3-p21.png" alt="ch3-p21.png" style="width:100%; max-width:500px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org5ba60ba" class="outline-4">
<h4 id="org5ba60ba">P22 GBN协议中发送方窗口长度和接收方期待序号间的关系</h4>
<div class="outline-text-4" id="text-org5ba60ba">
<p>
考虑一个GBN协议，其发送方窗口为4，序号范围为1024。假设在时刻t，接收方期待的下一个有序分组的序号是k。假设媒体不会对报文重新排序。回答以下问题：<br />
</p>
<ol class="org-ol">
<li>在t时刻，发送方窗口内的报文序号可能是多少？论证你的回答。<br /></li>
<li>在t时刻，在当前传播回发送方的所有可能报文中，ACK字段的所有可能值是多少？论证你的回答。<br /></li>
</ol>


<ol class="org-ol">
<li>发送方期待的下一个分组的序号是k，说明了发送已经发送了k之前分组的确认。最坏的情况是这些确认消息发送方都还没有收到，那么此时发送方的窗口是k-4，k-3，k-2，k-1。最好的情况是这些确认消息都送达了发送方，那么此时发送方的窗口是k，k+1，k+2，k+3.<br /></li>
<li>k-4，k-3，k-2，k-1。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org974f870" class="outline-4">
<h4 id="org974f870">P23 序号空间和窗口长度的关系</h4>
<div class="outline-text-4" id="text-org974f870">
<p>
考虑GBN协议和SR协议。假设序号空间的长度为k，那么为了避免出现图3-27中的问题，对于这两种协议中的每一种，允许的发送方窗口最大为多少？<br />
</p>

<p>
设窗口的大小为N，由P22可知，当接收方期待的序号是p时，发送方的窗口可能范围是[p-N, p+N-1]。序号空间至少要容纳下这个范围窗口才不会出现重叠，即k⩾length([p-N, p+N-1])=2N。<br />
</p>
</div>
</div>

<div id="outline-container-orge2d1741" class="outline-4">
<h4 id="orge2d1741">P24 SR和SBN的窗口长度</h4>
<div class="outline-text-4" id="text-orge2d1741">
<p>
对下面的问题判断是非，并简要地证实你的回答：<br />
</p>
<ol class="org-ol">
<li>对于SR协议，发送方可能会收到落在其当前窗口之外的分组的ACK。<br /></li>
<li>对于GBN协议，发送方可能会收到落在其当前窗口之外的分组的ACK。<br /></li>
<li>当发送方和接收方窗口长度都为1时，比特交替协议与SR协议相同。<br /></li>
<li>当发送方和接收方窗口长度都为1时，比特交替协议与GBN协议相同。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
正确。<br />
</p>

<div id="org80f5014" class="figure">
<p><img src="./img/ch3-p24.png" alt="ch3-p24.png" style="width:100%; max-width:250px;" /><br />
</p>
</div></li>
<li>正确，理由同上。<br /></li>
<li>正确。<br /></li>
<li>正确。当窗口大小为1时，SR、GBN和交替位协议在功能上是等同的。窗口大小为1时，排除了（在窗口内）出现失序包的可能性。在这种情况下，累积ACK只是一个普通的ACK，因为它只能指窗口内的单个数据包。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org877d9ef" class="outline-4">
<h4 id="org877d9ef">P25 UDP提供了更好的应用层控制</h4>
<div class="outline-text-4" id="text-org877d9ef">
<p>
我们曾经说过，应用程序可能选择UDP作为运输协议，因为UDP提供了（比TCP）更好的应用层控制，以决定在报文段中发送什么数据和发送时机。<br />
</p>
<ol class="org-ol">
<li>应用程序为什么对在报文段中发送什么数据有更多的控制？<br /></li>
<li>应用程序为什么对何时发送报文段有更多的控制？<br /></li>
</ol>


<ol class="org-ol">
<li><a href="https://stackoverflow.com/a/17446839/10422197">TCP stream vs UDP message</a><br /></li>
<li>在TCP中，由于流量控制和拥塞控制，从应用程序将数据写入其发送缓冲区到数据被交给网络层，可能会有很大的延迟。UDP没有由于流量控制和拥塞控制而产生的延迟。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org0d9a2bf" class="outline-4">
<h4 id="org0d9a2bf">P26 TCP报文段的序号</h4>
<div class="outline-text-4" id="text-org0d9a2bf">
<p>
考虑从主机A向主机B传输L字节的大文件，假设MSS为536字节。<br />
</p>
<ol class="org-ol">
<li>为了使得TCP序号不至于用完，L的最大值是多少？前面讲过TCP的序号字段为4字节。<br /></li>
<li>对于你在（a）中得到的L，求出传输此文件要用多长时间？假定运输层、网络层和数据链路层首部总共为66字节，并加在每个报文段上，然后经155Mbps链路发送得到的分组。忽略流量控制和拥塞控制，使主机A能够一个接一个和连续不断地发送这些报文段。<br /></li>
</ol>


<ol class="org-ol">
<li>4字节的序号字段能提供2^32=4294967296个序号，由于序号是字节流编号，所以跟MSS无关，能传输的最大文件就是2^32字节。<br /></li>
<li>⌈2^32/536⌉*(536+66)byte/155Mbps≈249s<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org662d03a" class="outline-4">
<h4 id="org662d03a">P27 TCP报文段的序号、重传和确认</h4>
<div class="outline-text-4" id="text-org662d03a">
<p>
主机A和B经一条TCP连接通信，并且主机B已经收到了来自A的最长为126字节的所有字节。假定主机A随后向主机B发送两个紧接着的报文段。第一个和第二个报文段分别包含了80字节和40字节的数据。在第一个报文段中，序号是127，源端口号是302，目的地端口号是80。无论何时主机B接收到来自主机A的报文段，它都会发送确认。<br />
</p>
<ol class="org-ol">
<li>在从主机A发往B的第二个报文段中，序号、源端口号和目的端口号各是什么？<br /></li>
<li>如果第一个报文段在第二个报文段之前到达，在第一个到达报文段的确认中，确认号、源端口号和目的端口号各是什么？<br /></li>
<li>如果第二个报文段在第一个报文段之前到达，在第一个到达报文段的确认中，确认号是什么？<br /></li>
<li>假定由A发送的两个报文段按序到达B。第一个确认丢失了而第二个确认在第一个超时间隔之后到达。画出时序图，显示这些报文段和发送的所有其他报文段和确认。（假设没有其他分组丢失。）对于图上每个报文段，标出序号和数据的字节数量；对于你增加的每个应答，标出确认号。<br /></li>
</ol>


<p>
从A发给B的报文段：<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">报文段</td>
<td class="org-right">序号</td>
<td class="org-right">长度</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">127</td>
<td class="org-right">80</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">207</td>
<td class="org-right">40</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">247</td>
<td class="org-right">&#xa0;</td>
</tr>
</tbody>
</table>

<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">序号</td>
<td class="org-right">源端口号</td>
<td class="org-right">目的端口号</td>
</tr>

<tr>
<td class="org-right">207</td>
<td class="org-right">302</td>
<td class="org-right">80</td>
</tr>
</tbody>
</table></li>

<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">确认号</td>
<td class="org-right">源端口号</td>
<td class="org-right">目的端口号</td>
</tr>

<tr>
<td class="org-right">207</td>
<td class="org-right">80</td>
<td class="org-right">302</td>
</tr>
</tbody>
</table></li>

<li>第二个报文段和第一个报文段的确认号都是207<br /></li>

<li><p>
&#x00ad;<br />
</p>

<div id="org0b51629" class="figure">
<p><img src="./img/ch3-p27.png" alt="ch3-p27.png" style="width:100%; max-width:300px;" /><br />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org496f9b7" class="outline-4">
<h4 id="org496f9b7">P28 流量控制</h4>
<div class="outline-text-4" id="text-org496f9b7">
<p>
主机A和B直接经一条1OOMbps链路连接。在这两台主机之间有一条TCP连接。主机A经这条连接向主机B发送一个大文件。主机A能够向它的TCP套接字以高达120Mbps的速率发送应用数据，而主机B能够以最大50Mbps的速率从它的TCP接收缓存中读出数据。描述TCP流量控制的影响。<br />
</p>

<p>
由于链路的传输速率是100Mbps，所以主机A的发送速率最高是100Mbps。主机B通过在TCP报文段中的RcvWindow告知主机A可用的缓存空间。当主机B的接收缓存存满时这个值是0，此时主机A停止发送数据，直到接收到RcvWindow&gt;0的报文段主机A开始重新发送数据。<br />
</p>
</div>
</div>

<div id="outline-container-org3ae4285" class="outline-4">
<h4 id="org3ae4285">P29 SYN cookie</h4>
<div class="outline-text-4" id="text-org3ae4285">
<p>
在3.5.6节中讨论了SYN cookie。<br />
</p>
<ol class="org-ol">
<li>服务器在SYNACK中使用一个特殊的初始序号，这为什么是必要的？<br /></li>
<li>假定某攻击者得知了一台目标主机使用了SYN cookie。该攻击者能够通过直接向目标发送一个ACK分组创建半开或全开连接吗？为什么？<br /></li>
<li>假设某攻击者收集了由服务器发送的大量初始序号。该攻击者通过发送具有初始序号的ACK，能够引起服务器产生许多全开连接吗？为什么？<br /></li>
</ol>


<ol class="org-ol">
<li>使用这个特殊的初始序号可以抵御SYN泛洪攻击。<br /></li>
<li>攻击者不能通过简单地向目标发送ACK分组来创建半开或全开的连接。因为使用SYN cookie的服务器在建立完全连接之前不会为任何连接保持连接变量和缓冲区，所以创建半开放连接是不可能的。为了建立全开的连接，攻击者应该知道与攻击者的（欺骗的）源IP地址相对应的特殊初始序列号。这个序列号的产生需要知道服务器使用的秘密数。由于攻击者不知道这个秘密数，所以无法猜到初始序列号。<br /></li>
<li>服务器可以简单地在计算这些初始序列号时加入一个时间戳，并为这些序列号选择一个存活时间，即使攻击者重播这些序列号，服务器也会丢弃过期的初始序列号。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgc52d30b" class="outline-4">
<h4 id="orgc52d30b">P30 有限缓存的路由器对拥塞的影响</h4>
<div class="outline-text-4" id="text-orgc52d30b">
<p>
考虑在3.6.1节中显示在第二种情况下的网络。假设发送主机A和B具有某些固定的超时值。<br />
</p>
<ol class="org-ol">
<li>证明增加路由器有限缓存的长度可能减小吞吐量（λ<sub>out</sub>）。<br /></li>
<li>现在假设两台主机基于路由器的缓存时延，动态地调整它们的超时值（像TCP所做的那样）。增加缓存长度将有助于增加吞吐量吗？为什么？<br /></li>
</ol>


<ol class="org-ol">
<li>缓存长度增加会导致发送发提前超时并重传在队列中已被推迟但还未丢失的分组的情况更加频繁地发生。这就导致了供给载荷中重传分组的占比增加，因此会降低吞吐量。<br /></li>
<li>如果超时值能基于路由器的缓存时延动态调整，那么增加缓存长度将有助于增加吞吐量。因为增加缓存长度导致的缓存时延的增加，将不再引起重传分组的增加。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org04e0bf2" class="outline-4">
<h4 id="org04e0bf2">P31 往返时间的估计与超时</h4>
<div class="outline-text-4" id="text-org04e0bf2">
<p>
假设测量的5个SampleRTT值（参见3.5.3节）是106ms、120ms、140ms、90ms和115ms。在获得了每个SampleRTT值后计算EstimatedRTT，使用α=0.125并且假设在刚获得前5个样本之后EstimatedRTT的值为1OOms。在获得每个样本之后，也计算DevRTT，假设β=0.25，并且假设在刚获得前5个样本之后DevRTT的值为5ms。最后，在获得这些样本之后计算TCP TimeoutInterval。<br />
</p>

<p>
EstimatedRTT = (1-α)·EstimatedRTT + α·SampleRTT<br />
DevRTT = (1-β)⋅DevRTT + β⋅SampleDevRTT<br />
TimeoutInterval = EstimatedRTT + 4⋅DevRTT<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">SampleRTT</td>
<td class="org-right">106</td>
<td class="org-right">120</td>
<td class="org-right">140</td>
<td class="org-right">90</td>
<td class="org-right">115</td>
</tr>

<tr>
<td class="org-left">EstimatedRTT 100</td>
<td class="org-right">101</td>
<td class="org-right">103</td>
<td class="org-right">108</td>
<td class="org-right">106</td>
<td class="org-right">107</td>
</tr>

<tr>
<td class="org-left">DevRTT 5</td>
<td class="org-right">5</td>
<td class="org-right">9</td>
<td class="org-right">16</td>
<td class="org-right">17</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">TimeoutInterval</td>
<td class="org-right">121</td>
<td class="org-right">139</td>
<td class="org-right">172</td>
<td class="org-right">174</td>
<td class="org-right">167</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgcbccebc" class="outline-4">
<h4 id="orgcbccebc">P32 指数移动平均</h4>
<div class="outline-text-4" id="text-orgcbccebc">
<p>
考虑TCP估计RTT的过程。假设α=0.1，令SampleRT<sub>T1</sub>设置为最新样本RTT，令SampleRT<sub>T2</sub>设置为下一个最新样本RTT，等等。<br />
</p>
<ol class="org-ol">
<li>对于一个给定的TCP连接，假定4个确认报文相继到达，带有4个对应的RTT值：SampleRT<sub>T4</sub>、SampleRT<sub>T3</sub>、SampleRT<sub>T2</sub>和SampleRT<sub>T1</sub>。根据这4个样本RTT表示EstimatedRTT。<br /></li>
<li>将你得到的公式一般化到n个RTT样本的情况。<br /></li>
<li>对于在（b）中得到的公式，令n趋于无穷。试说明为什么这个平均过程被称为指数移动平均。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">SampleRTT</td>
<td class="org-left">EstimatedRTT</td>
<td class="org-left">simplified EstimatedRTT</td>
</tr>

<tr>
<td class="org-left">T1</td>
<td class="org-left">T1</td>
<td class="org-left">T1</td>
</tr>

<tr>
<td class="org-left">T2</td>
<td class="org-left">(1-α)ERTT1+αT2</td>
<td class="org-left">(1-α)T1+αT2</td>
</tr>

<tr>
<td class="org-left">T3</td>
<td class="org-left">(1-α)ERTT2+αT3</td>
<td class="org-left">(1-α)<sup>2</sup>T1+(1-α)αT2+αT3</td>
</tr>

<tr>
<td class="org-left">T4</td>
<td class="org-left">(1-α)ERTT2+αT3</td>
<td class="org-left">(1-α)<sup>3</sup>T1+(1-α)<sup>2</sup>αT2+(1-α)αT3+αT4</td>
</tr>
</tbody>
</table></li>

<li><p>
&#x00ad;<br />
</p>
\begin{equation*}
  EstimatedRTT_{n} =\begin{cases}
  T_{1} &\text{if } n=1, \\
  (1-α)^{n-1}T_{1}+\sum_{k=2}^{n}(1-α)^{n-k}αT_{k} &\text{if } n⩾2.
  \end{cases}
\end{equation*}</li>

<li>过去样本的权重呈指数级衰减。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org00e5eee" class="outline-4">
<h4 id="org00e5eee">P33 避免测量重传报文段的SampleRTT</h4>
<div class="outline-text-4" id="text-org00e5eee">
<p>
在3.5.3节中，我们讨论了TCP的往返时间的估计。TCP避免测量重传报文段的SampleRTT，对此你有何看法？<br />
</p>


<div id="org39c12f6" class="figure">
<p><img src="./img/ch3-p33.png" alt="ch3-p33.png" style="width:100%; max-width:300px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgb254f4e" class="outline-4">
<h4 id="orgb254f4e">P34 SendBase和LastByteRcvd</h4>
<div class="outline-text-4" id="text-orgb254f4e">
<p>
3.5.4节中的变量SendBase和3.5.5节中的变量LastByteRcvd之间有什么关系？<br />
</p>

<p>
TCP状态变量SendBase是最早未被确认的字节的序号。（因此SendBase-1是指接收方已正确按序接收到的数据的最后一个字节的序号。）<br />
</p>

<p>
LastByteRcvd：从网络中到达的并且已放入主机B接收缓存中的数据流的最后一个字节的编号。<br />
</p>

<p>
到达接收方的分组的确认可能还没到达发送方，所以SendBase–1⩽LastByteRcvd。<br />
</p>
</div>
</div>

<div id="outline-container-org333c1ea" class="outline-4">
<h4 id="org333c1ea">P35 确认序号y和LastByteRcvd</h4>
<div class="outline-text-4" id="text-org333c1ea">
<p>
3.5.5节中的变量LastByteRcvd和3.5.4节中的变量y之间有什么关系？<br />
</p>

<p>
y：ACK的值<br />
</p>

<p>
y-1⩽LastByteRvcd<br />
</p>
</div>
</div>

<div id="outline-container-org3500411" class="outline-4">
<h4 id="org3500411">P36 快速重传的时机</h4>
<div class="outline-text-4" id="text-org3500411">
<p>
在3.5.4节中，我们看到TCP直到收到3个冗余ACK才执行快速重传。你对TCP设计者没有选择在收到对报文段的第一个冗余ACK后就快速重传有何看法？<br />
</p>

<p>
考虑相邻的两个分组重排的情况：<br />
</p>


<div id="org6173c6e" class="figure">
<p><img src="./img/ch3-p36.png" alt="ch3-p36.png" style="width:100%; max-width:400px;" /><br />
</p>
</div>

<p>
等待3个冗余ACK的方案权衡了触发快速重传的时机，即只有收到2个失序分组是才会触发。<br />
</p>
</div>
</div>

<div id="outline-container-org6d2b41e" class="outline-4">
<h4 id="org6d2b41e">P37 相较于GBN、SR，TCP的快速重传的优点</h4>
<div class="outline-text-4" id="text-org6d2b41e">
<p>
比较GBN、SR和TCP（无延时的ACK）。假设对所有3个协议的超时值足够长，使得5个连续的数据报文段及其对应的ACK能够分别由接收主机（主机B）和发送主机（主机A）收到（如果在信道中无丢失）。假设主机A向主机B发送5个数据报文段，并且第二个报文段（从A发送）丢失。最后，所有5个数据报文段已经被主机B正确接收。<br />
</p>
<ol class="org-ol">
<li>主机A总共发送了多少报文段和主机B总共发送了多少ACK？它们的序号是什么？对所有3个协议回答这个问题。<br /></li>
<li>如果对所有3个协议超时值比5RTT长得多，则哪个协议在最短的时间间隔中成功地交付所有5个数据报文段？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<div id="org78522dd" class="figure">
<p><img src="./img/ch3-p37.png" alt="ch3-p37.png" style="width:100%; max-width:610px;" /><br />
</p>
</div></li>

<li>TCP的发送方通常可在超时事件发生之前通过注意所谓冗余ACK来较好地检测到丢包情况。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgdfcddb5" class="outline-4">
<h4 id="orgdfcddb5">P38 发送速率与cwnd</h4>
<div class="outline-text-4" id="text-orgdfcddb5">
<p>
在图3-52中的TCP描述中，阈值ssthresh的值在几个地方被设置为ssthresh=cwnd/2，其中包括出现一个丢包事件时，ssthresh的值被设置为窗口长度的一半。当出现丢包事件时，发送方发送的速率，每个RTT必须大约等于cwnd报文段吗？（Must the rate at which the sender is sending when the loss event occurred be approximately equal to cwnd segments per RTT?）解释你的答案。如果你的回答是没有，你能建议一种不同的方式，进行ssthresh设置吗？<br />
</p>


<div id="orgdbe5e68" class="figure">
<p><img src="./img/fig3-52.png" alt="fig3-52.png" style="width:100%; max-width:400px;" /><br />
</p>
</div>

<p>
发送方的发送速率就是cwnd/RTT。<br />
</p>
</div>
</div>

<div id="outline-container-org7ef0e43" class="outline-4">
<h4 id="org7ef0e43">P39 有限缓存路由器的丢包分析</h4>
<div class="outline-text-4" id="text-org7ef0e43">
<p>
考虑图3-46b。如果 \(λ_{in}^{\prime}\) 增加超过了R/2，λ<sub>out</sub>能够增加超过R/3吗？试解释之。现在考虑图3-46c。假定一个分组从路由器到接收方平均转发两次的话，如果 \(λ_{in}^{\prime}\) 增加超过R/2，λ<sub>out</sub>能够增加超过R/4吗？试解释之。<br />
</p>


<div id="org0ade2d1" class="figure">
<p><img src="./img/fig3-46.png" alt="fig3-46.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>

<p>
当 \(λ_{in}^{\prime}\) 等于R/2时，λ<sub>out</sub>等于R/3，那么供给载荷中有R/6是重传的分组。随着 \(λ_{in}^{\prime}\) 的继续增加，路由器的总到达速率会超过R，丢包率也会逐渐增加，重传分组的占比会提高，因此λ<sub>out</sub>会小于R/3。同理在图3-46c中 λ<sub>in</sub><sup>&prime;</sup>\) 增加超过了R/2，λ<sub>out</sub>也会小于R/4。<br />
</p>
</div>
</div>

<div id="outline-container-orga260798" class="outline-4">
<h4 id="orga260798">P40 TCP拥塞控制的过程</h4>
<div class="outline-text-4" id="text-orga260798">
<p>
考虑图3-58。假设TCP Reno是一个经历如上所示行为的协议，回答下列问题。在各种情况中，简要地论证你的回答。<br />
</p>
<ol class="org-ol">
<li>指出TCP慢启动运行时的时间间隔。<br /></li>
<li>指出TCP拥塞避免运行时的时间间隔。<br /></li>
<li>在第16个传输轮回之后，报文段的丢失是根据3个冗余ACK还是根据超时检测出 来的？<br /></li>
<li>在第22个传输轮回之后、报文段的丢失是根据3个冗余ACK还是根据超时检测出来的？<br /></li>
<li>在第1个传输轮回里，ssthresh的初始值设置为多少？<br /></li>
<li>在第18个传输轮回里，ssthresh的值设置为多少？<br /></li>
<li>在第24个传输轮回里，ssthresh的值设置为多少？<br /></li>
<li>在哪个传输轮回内发送第70个报文段？<br /></li>
<li>假定在第26个传输轮回后，通过收到3个冗余ACK检测出有分组丢失，拥塞的窗口长度和ssthresh的值应当是多少？<br /></li>
<li>假定使用TCP Tahoe（而不是TCP Reno），并假定在第16个传输轮回收到3个冗余ACK。在第19个传输轮回，ssthresh和拥塞窗口长度是什么？<br /></li>
<li>再次假设使用TCP Tahoe，在第22个传输轮回有一个超时事件。从第17个传输轮回到第22个传输轮回（包括这两个传输轮回），一共发送了多少分组？<br /></li>
</ol>



<div id="org633ea45" class="figure">
<p><img src="./img/fig3-58.png" alt="fig3-58.png" style="width:100%; max-width:400px;" /><br />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">传输轮回</td>
<td class="org-left">阶段</td>
<td class="org-right">ssthresh</td>
</tr>

<tr>
<td class="org-right">1-6</td>
<td class="org-left">慢启动</td>
<td class="org-right">32</td>
</tr>

<tr>
<td class="org-right">6-16</td>
<td class="org-left">拥塞避免</td>
<td class="org-right">32</td>
</tr>

<tr>
<td class="org-right">17-22</td>
<td class="org-left">快速恢复</td>
<td class="org-right">21</td>
</tr>

<tr>
<td class="org-right">23-26</td>
<td class="org-left">慢启动</td>
<td class="org-right">14</td>
</tr>
</tbody>
</table>

<ol class="org-ol">
<li>[1-6]、[23-26]<br /></li>
<li>[6-16]<br /></li>
<li>3个冗余ACK<br /></li>
<li>超时<br /></li>
<li>32MSS<br /></li>
<li>21MSS<br /></li>
<li>14MSS<br /></li>
<li>7<br /></li>
<li>ssthresh=4，cwnd=7<br /></li>
<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">传输轮回</th>
<th scope="col" class="org-right">ssthresh</th>
<th scope="col" class="org-right">cwnd</th>
<th scope="col" class="org-left">阶段</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">32</td>
<td class="org-right">1</td>
<td class="org-left">慢启动</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">32</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">32</td>
<td class="org-right">4</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">32</td>
<td class="org-right">8</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">32</td>
<td class="org-right">16</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">32</td>
<td class="org-right">32</td>
<td class="org-left">cwnd⩾ssthresh,拥塞避免</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">32</td>
<td class="org-right">33</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">32</td>
<td class="org-right">34</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">32</td>
<td class="org-right">35</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">32</td>
<td class="org-right">36</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">32</td>
<td class="org-right">37</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-right">32</td>
<td class="org-right">38</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">13</td>
<td class="org-right">32</td>
<td class="org-right">39</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-right">32</td>
<td class="org-right">40</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-right">32</td>
<td class="org-right">41</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">16</td>
<td class="org-right">32</td>
<td class="org-right">42</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">17</td>
<td class="org-right">21</td>
<td class="org-right">1</td>
<td class="org-left">3个冗余ACK,慢启动</td>
</tr>

<tr>
<td class="org-right">18</td>
<td class="org-right">21</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">19</td>
<td class="org-right">21</td>
<td class="org-right">4</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-right">21</td>
<td class="org-right">8</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">21</td>
<td class="org-right">21</td>
<td class="org-right">16</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">22</td>
<td class="org-right">21</td>
<td class="org-right">32</td>
<td class="org-left">cwnd⩾ssthresh,拥塞避免</td>
</tr>

<tr>
<td class="org-right">23</td>
<td class="org-right">21</td>
<td class="org-right">33</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">24</td>
<td class="org-right">21</td>
<td class="org-right">34</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">25</td>
<td class="org-right">21</td>
<td class="org-right">35</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">26</td>
<td class="org-right">21</td>
<td class="org-right">36</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>


<div id="org2e42c46" class="figure">
<p><img src="./img/ch3-p40j.svg" alt="ch3-p40j.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>
<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">传输轮回</th>
<th scope="col" class="org-right">ssthresh</th>
<th scope="col" class="org-right">cwnd</th>
<th scope="col" class="org-left">阶段</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">32</td>
<td class="org-right">1</td>
<td class="org-left">慢启动</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">32</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">32</td>
<td class="org-right">4</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">32</td>
<td class="org-right">8</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">32</td>
<td class="org-right">16</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">32</td>
<td class="org-right">32</td>
<td class="org-left">cwnd⩾ssthresh,拥塞避免</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">32</td>
<td class="org-right">33</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">32</td>
<td class="org-right">34</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">32</td>
<td class="org-right">35</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">32</td>
<td class="org-right">36</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">32</td>
<td class="org-right">37</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-right">32</td>
<td class="org-right">38</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">13</td>
<td class="org-right">32</td>
<td class="org-right">39</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-right">32</td>
<td class="org-right">40</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-right">32</td>
<td class="org-right">41</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">16</td>
<td class="org-right">32</td>
<td class="org-right">42</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">17</td>
<td class="org-right">21</td>
<td class="org-right">1</td>
<td class="org-left">慢启动</td>
</tr>

<tr>
<td class="org-right">18</td>
<td class="org-right">21</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">19</td>
<td class="org-right">21</td>
<td class="org-right">4</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-right">21</td>
<td class="org-right">8</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">21</td>
<td class="org-right">21</td>
<td class="org-right">16</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">22</td>
<td class="org-right">8</td>
<td class="org-right">1</td>
<td class="org-left">超时,慢启动</td>
</tr>

<tr>
<td class="org-right">23</td>
<td class="org-right">8</td>
<td class="org-right">2</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">24</td>
<td class="org-right">8</td>
<td class="org-right">4</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">25</td>
<td class="org-right">8</td>
<td class="org-right">8</td>
<td class="org-left">cwnd⩾ssthresh,拥塞避免</td>
</tr>

<tr>
<td class="org-right">26</td>
<td class="org-right">8</td>
<td class="org-right">9</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>


<div id="orga5ab507" class="figure">
<p><img src="./img/ch3-p40k.svg" alt="ch3-p40k.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org3153fee" class="outline-4">
<h4 id="org3153fee">P41 TCP拥塞控制的公平性</h4>
<div class="outline-text-4" id="text-org3153fee">
<p>
参考图3-55，该图描述了TCP的AIMD算法的收敛特性。假设TCP不采用乘性减，而是采用按某一常量减小窗口。所得的AIAD算法将收敛于一种平等共享算法吗？使用类似于图3-55中的图来证实你的结论。<br />
</p>


<div id="org25fe87e" class="figure">
<p><img src="./img/fig3-55.png" alt="fig3-55.png" style="width:100%; max-width:400px;" /><br />
</p>
</div>

<p>
假设两条有相同MSS和RTT的TCP连接1、2共享一段传输速率为10MSS的链路。在传输轮回1，连接1的速率为1MSS，连接2的速率为8MSS，下表展示了两条连接最终收敛到平等带宽共享曲线附近的过程：<br />
</p>

<table id="orga9cf3d2" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">传输轮回</th>
<th scope="col" class="org-right">连接1</th>
<th scope="col" class="org-right">连接2</th>
<th scope="col" class="org-right">sum</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">8</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">9</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">1</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">3</td>
<td class="org-right">6</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">4</td>
<td class="org-right">7</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
<td class="org-right">11</td>
</tr>
</tbody>
</table>


<div id="orgbf829ae" class="figure">
<p><img src="img/ch3-p41a.svg" alt="ch3-p41a.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div>

<p>
现在假设按照常量2减小窗口：<br />
</p>

<table id="org91dfd1a" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">传输轮回</th>
<th scope="col" class="org-right">A</th>
<th scope="col" class="org-right">B</th>
<th scope="col" class="org-right">sum</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">8</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">9</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">7</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">1</td>
<td class="org-right">8</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">9</td>
<td class="org-right">11</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">0</td>
<td class="org-right">7</td>
<td class="org-right">7</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">1</td>
<td class="org-right">8</td>
<td class="org-right">9</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">2</td>
<td class="org-right">9</td>
<td class="org-right">11</td>
</tr>
</tbody>
</table>


<div id="org956826a" class="figure">
<p><img src="img/ch3-p41b.svg" alt="ch3-p41b.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org54f1bb2" class="outline-4">
<h4 id="org54f1bb2">P42 加倍超时间隔与拥塞控制</h4>
<div class="outline-text-4" id="text-org54f1bb2">
<p>
在3.5.4节中，我们讨论了在发生超时事件后将超时间隔加倍（p.162）。为什么除了这种加倍超时间隔机制外，TCP还需要基于窗口的拥塞控制机制（如在3.7节中学习的那种机制）呢？<br />
</p>

<p>
发送流量 = 发送频率 * 发送流量/每次<br />
</p>

<p>
这两种方式都起到了限制发送流量的作用。加倍超时间隔降低了发送的频率，基于窗口的拥塞控制减少了每次发送的流量。<br />
</p>

<blockquote>
<p>
If TCP were a stop-and-wait protocol, then the doubling of the time out interval would suffice as a congestion control mechanism. However, TCP uses pipelining (and is therefore not a stop-and-wait protocol), which allows the sender to have multiple outstanding unacknowledged segments. The doubling of the timeout interval does not prevent a TCP sender from sending a large number of first-time-transmitted packets into the network, even when the end-to-end path is highly congested. Therefore a congestioncontrol mechanism is needed to stem the flow of “data received from the application above” when there are signs of network congestion.<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org628236f" class="outline-4">
<h4 id="org628236f">P43 流量控制和拥塞控制工作的前提</h4>
<div class="outline-text-4" id="text-org628236f">
<p>
主机A通过一条TCP连接向主机B发送一个很大的文件。在这条连接上，不会出现任何分组丢失和定时器超时。主机A与因特网连接链路的传输速率表示为Rbps。假设主机A上的进程能够以Sbps的速率向TCP套接字发送数据，其中S=10×R。进一步假设TCP的接收缓存足够大，能够容纳整个文件，并且发送缓存只能容纳这个文件的百分之一。如何防止主机A上的进程连续地向TCP套接字以速率Sbps传送数据呢？还是用TCP流量控制呢？还是用TCP拥塞控制？或者用其他措施？阐述其理由。<br />
</p>

<p>
由于接收方的接收缓冲区可以容纳整个文件，所以不存在溢出的危险。另外，由于不会出现分组丢失和定时器超时，TCP拥塞控制起作用。然而，由于主机A的发送缓冲区很快会被填满，进程不会连续地向套接字传送数据。一旦发送缓冲区被填满，该进程将以平均速率R向套接字传送数据。<br />
</p>
</div>
</div>

<div id="outline-container-orgc2509a5" class="outline-4">
<h4 id="orgc2509a5">P44 cwnd与平均吞吐量</h4>
<div class="outline-text-4" id="text-orgc2509a5">
<p>
考虑从一台主机经一条没有丢包的TCP连接向另一台主机发送一个大文件。<br />
</p>
<ol class="org-ol">
<li>假定TCP使用不具有慢启动的AIMD进行拥塞控制。假设每当收到一批ACK时，cwnd增加1个MSS，并且假设往返时间大约恒定，cwnd从6MSS增加到12MSS要花费多长时间（假设没有丢包事件）？<br /></li>
<li>对于该连接，到时间＝6RTT，其平均吞吐址是多少（根据MSS和RTT）？<br /></li>
</ol>


<ol class="org-ol">
<li>6RTT<br /></li>
<li>(6+7+8+9+10+11MSS)/6RTT = 8.5 MSS/RTT<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org04f1299" class="outline-4">
<h4 id="org04f1299">P45 对TCP吞吐量的宏观描述</h4>
<div class="outline-text-4" id="text-org04f1299">
<p>
回想TCP吞吐量的宏观描述。在连接速率从W/(2xRTT)变化到W/RTT的周期内，只丢失了一个分组（在该周期的结束）。<br />
</p>
<ol class="org-ol">
<li>证明其丢包率（分组丢失的比率）等于：<br />
\[ L=\text{丢包率}=\frac{1}{\frac38W^2+\frac34W} \]<br /></li>
<li>如果一条连接的丢包率为L，使用上面的结果，则它的平均速率近似由下式给出：<br />
\[ \text{平均速率}\approx \frac{1.22*MSS}{RTT\sqrt{L}} \]<br /></li>
</ol>


<ol class="org-ol">
<li><p>
在该周期内总共传输的分组数量为<br />
</p>

\begin{align*}
  \text{P} &= \frac{W}{2}+(\frac{W}{2}+1)+\cdots + W \\
  &= \sum_{n=0}^{W/2}(\frac{W}{2}+n) \\
  &= (\frac{w}{2}+1)\frac{W}{2}+\sum_{n=0}^{W/2}n \\
  &= \frac38W^2 + \frac34W
\end{align*}

<p>
由于丢失了一个分组，所以丢包率为<br />
</p>

<p>
\[ L=\frac{1\cdot MSS}{P\cdot MSS}=\frac{1}{\frac38W^2+\frac34W} \]<br />
</p></li>

<li><p>
对于较大的W，\( \frac38W^2 >> \frac34W \)。所以 \( L \approx \frac{8}{3W^2} \)，即 \( W \approx \sqrt{\frac{8}{3L}} \)。<br />
</p>

<p>
所以<br />
</p>

\begin{align*}
  \text{一条连接的平均吞吐量} &= \frac{0.75\cdot W\cdot MSS}{RTT} \\
  &\approx  \frac{0.75\cdot \sqrt{\frac83}\cdot MSS}{\sqrt{L}\cdot RTT} \\
  &= \frac{1.22MSS}{RTT\sqrt{L}}
\end{align*}</li>
</ol>
</div>
</div>

<div id="outline-container-org425e1b9" class="outline-4">
<h4 id="org425e1b9">P46 计算TCP吞吐量与窗口长度</h4>
<div class="outline-text-4" id="text-org425e1b9">
<p>
考虑仅有一条单一的TCP（Reno）连接使用一条1OMbps链路，且该链路没有缓存任何数据。假设这条链路是发送主机和接收主机之间的唯一拥塞链路。假定某TCP发送方向接收方有一个大文件要发送，而接收方的接收缓存比拥塞窗口要大得多。我们也做下列假设：每个TCP报文段长度为1500字节；该连接的双向传播时延是150ms；并且该TCP连接总是处于拥塞避免阶段，即忽略了慢启动。<br />
</p>
<ol class="org-ol">
<li>这条TCP连接能够取得的最大窗口长度（以报文段计）是多少？<br /></li>
<li>这条TCP连接的平均窗口长度（以报文段计）和平均吞吐量（以bps计）是多少？<br /></li>
<li>这条TCP连接在从丢包恢复后，再次到达其最大窗口要经历多长时间？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
该连接取得最大窗口长度W时的吞吐量等于链路的容量，即Throughput<sub>max</sub>=10Mbps，由于<br />
</p>

\begin{align*}
  T_{max} = \frac{W⋅MSS}{RTT}
\end{align*}

<p>
所以<br />
</p>

\begin{align*}
  W &= \frac{T_{max}\cdot RTT}{MSS}\\
  &= \frac{10\text{Mbps}⋅150\text{ms}}{1500\text{B}} \\
  &= 125
\end{align*}</li>

<li>平均窗口长度等于0.75W≈94，平均吞吐量约等于0.75*10Mpbs=7.5Mbps。<br /></li>

<li>125/2*150ms=9.375s<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org0891683" class="outline-4">
<h4 id="org0891683">P47 TCP吞吐量与链路缓存</h4>
<div class="outline-text-4" id="text-org0891683">
<p>
考虑在前面习题中所描述的场景。假设1OMbps链路能够缓存有限个报文段。试论证为了使该链路总是忙于发送数据，我们将要选择缓存长度，使得其至少为发送方和接收方之间链路速率C与双向传播时延之积。<br />
</p>

<p>
发送方窗口最小时，即减小到W/2时，链路最有可能不能维持一直发送数据的状态。此时分别考虑发送方发送分组和等待确实两种情况。<br />
</p>

<p>
当发送方正在发送分组且缓存为空时，要想链路一直发送数据，必须满足发送速率大于（等于）链路速率，即 \( \frac{W/2}{RTT} ⩾ C \)，由此有 \( \frac{W}{2} ⩾ C\cdot RTT \)。<br />
</p>

<p>
假设缓存的大小是S，链路要发送完全部缓存的分组需要的时间是S/C。发送方发送了W/2个分组后开始等待ACK，经过W/2C时间后，ACK全部到达发送方，然后发送方开始扩大窗口并发送新的分组。在发送方等待ACK的时间里链路需要一直忙于发送数据，因此清空完缓存的时间必须大于（等于）等待ACK的时间，即 \( \frac{S}{C}⩾\frac{W/2}{C} \)，由此有 \( S⩾\frac{W}{2} \)。<br />
</p>

<p>
综合上述两种情况得到 \( S⩾C\cdot RTT \)。<br />
</p>
</div>
</div>

<div id="outline-container-org1eca47f" class="outline-4">
<h4 id="org1eca47f">P48 高带宽链路的窗口扩大速度</h4>
<div class="outline-text-4" id="text-org1eca47f">
<p>
重复习题46，但用一条1OGbps链路代替1OMbps链路。注意到在对c部分的答案中，应当认识到在从丢包恢复后，拥塞窗口长度到达最大窗口长度将需要很长时间。给出解决该问题的基本思路。<br />
</p>

<ol class="org-ol">
<li>\( W = 125×10^3 = 125000 \)<br /></li>
<li>\( 0.75W= 93750 \)<br />
\( 0.75×10Gbps = 7.5Gbps \)<br /></li>
<li>\( 125000÷2×150\text{ms}= 156.25min \)<br />
可以增加窗口扩大的速度，比如慢启动阶段的指数增加。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org80ffeb1" class="outline-4">
<h4 id="org80ffeb1">P49 拥塞窗口增加的时间与平均吞吐量</h4>
<div class="outline-text-4" id="text-org80ffeb1">
<p>
令T（用RTT度量）表示一条TCP连接将拥塞窗口从W/2增加到W所需的时间间隔，其中W是最大的拥塞窗口长度。论证T是TCP平均吞吐量的函数。<br />
</p>

<p>
拥塞窗口从W/2增加到W所需的时间间隔等于两次丢包出现的时间间隔。而两次丢包的出现间隔可以由丢包率L得到，即在第一次丢包出现后再发送1/L个分组出现第二次丢包，发送这些分组所需要的时间就等于窗口增加的时间：<br />
</p>

<p>
\[ T=\frac{1/L\cdot MSS}{B}. \]<br />
</p>

<p>
又由于TCP平均速率为<br />
</p>

<p>
\[ B=\frac{1.22\cdot MSS}{RTT\cdot \sqrt{L}}, \]<br />
由此可得<br />
</p>

<p>
\[ L=(\frac{1.22\cdot MSS}{B\cdot RTT})^2. \]<br />
</p>

<p>
综合可得<br />
</p>

<p>
\[ T=\frac{RTT^2}{1.22^2\cdot MSS}\cdot B. \]<br />
</p>

<p>
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD<br />
</p>
</div>
</div>
<div id="outline-container-orgc356f0f" class="outline-4">
<h4 id="orgc356f0f">P50 具有较小RTT的连接享有更高的吞吐量</h4>
<div class="outline-text-4" id="text-orgc356f0f">
<p>
考虑一种简化的TCP的AIMD算法，其中拥塞窗口长度用报文段的数量来度量，而不是用字节度量。在加性增中，每个RTT拥塞窗口长度增加一个报文段。在乘性减中，拥塞窗口长度减小一半（如果结果不是一个整数，向下取整到最近的整数）。假设两条TCP连接C1和C2，它们共享一条速率为每秒30个报文段的单一拥塞链路。假设C1和C2均处于拥塞避免阶段。连接C1的RTT是50ms，连接C2的RTT是100ms。假设当链路中的数据速率超过了链路的速率时，所有TCP连接经受数据报文段丢失。<br />
</p>
<ol class="org-ol">
<li>如果在时刻t<sub>0</sub>，C1和C2具有10个报文段的拥塞窗口，在1000ms后它们的拥塞窗口为多长？<br /></li>
<li>经长时间运行，这两条连接将取得共享该拥塞链路的相同的带宽吗？<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<table id="org09630e5" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">时刻 ms</th>
<th scope="col" class="org-right">C1 pkt</th>
<th scope="col" class="org-right">C1 pkt/s</th>
<th scope="col" class="org-right">C2 pkt</th>
<th scope="col" class="org-right">C2 pkt/s</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">10</td>
<td class="org-right">200</td>
<td class="org-right">10</td>
<td class="org-right">100</td>
</tr>

<tr>
<td class="org-right">50</td>
<td class="org-right">5</td>
<td class="org-right">100</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">100</td>
</tr>

<tr>
<td class="org-right">100</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">5</td>
<td class="org-right">50</td>
</tr>

<tr>
<td class="org-right">150</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">50</td>
</tr>

<tr>
<td class="org-right">200</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">250</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">300</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">350</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">400</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">450</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">500</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">550</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">600</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">650</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">700</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">750</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">800</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">850</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">900</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">950</td>
<td class="org-right">2</td>
<td class="org-right">40</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">1000</td>
<td class="org-right">1</td>
<td class="org-right">20</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>
</tbody>
</table>

<p>
在时刻50：对于C1，由于在上一个50ms内的C1、C2的总平均速率是300pkt/s，超过链路容量，发生丢包，所以C1窗口减半。<br />
</p>

<p>
在时刻100：对于C2，在上一个100ms内的C1、C2的总平均速率是250pkt/s（(200+100)/2+(100+100)/2），所以C2窗口减半。C1窗口减半，理由同上一条。<br />
</p></li>

<li><p>
具有较小RTT的连接能够在链路空闲时更快地打开其拥塞窗口，因而将比那些具有较大RTT的连接享有更高的吞吐量。<br />
</p>


<div id="orgd777861" class="figure">
<p><img src="img/ch3-p50.svg" alt="ch3-p50.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org45879dc" class="outline-4">
<h4 id="org45879dc">P51 TCP拥塞控制的公平性</h4>
<div class="outline-text-4" id="text-org45879dc">
<p>
考虑在前面习题中描述的网络。现在假设两条TCP连接C1和C2，它们具有相同的100ms RTT。假设在时刻t<sub>0</sub>，C1的拥塞窗口长度为15个报文段，而C2的拥塞窗口长度是10个报文段。<br />
</p>
<ol class="org-ol">
<li>在2200ms后，它们的拥塞窗口长度为多长？<br /></li>
<li>经长时间运行，这两条连接将取得共享该拥塞链路的相同的带宽吗？<br /></li>
<li>如果这两条连接在相同时间达到它们的最大窗口长度，并在相同时间达到它们的最小窗口长度，我们说这两条连接是同步的。经长时间运行，这两条连接将最终变得同步吗？如果是，它们的最大窗口长度是多少？<br /></li>
<li>这种同步将有助于改善共享链路的利用率吗？为什么？给出打破这种同步的某种思路。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<table id="org7fcaf4c" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">时刻 ms</th>
<th scope="col" class="org-right">C1 pkt</th>
<th scope="col" class="org-right">C1 pkt/s</th>
<th scope="col" class="org-right">C2 pkt</th>
<th scope="col" class="org-right">C2 pkt/s</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">15</td>
<td class="org-right">150</td>
<td class="org-right">10</td>
<td class="org-right">100</td>
</tr>

<tr>
<td class="org-right">100</td>
<td class="org-right">7</td>
<td class="org-right">70</td>
<td class="org-right">5</td>
<td class="org-right">50</td>
</tr>

<tr>
<td class="org-right">200</td>
<td class="org-right">3</td>
<td class="org-right">30</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">300</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">400</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">500</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">600</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">700</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">800</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">900</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">1000</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">1100</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">1200</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">1300</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">1400</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">1500</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">1600</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">1700</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">1800</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">1900</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">2000</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>

<tr>
<td class="org-right">2100</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">2200</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
<td class="org-right">2</td>
<td class="org-right">20</td>
</tr>
</tbody>
</table>


<div id="org311382e" class="figure">
<p><img src="img/ch3-p51a.svg" alt="ch3-p51a.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>

<li>是，这是TCP的加性增乘性减算法和两条连接具有相同RTT共同作用的结果。<br /></li>

<li>是，最大窗口长度是2。<br /></li>

<li>这种同步不利于改善共享链路的利用率。这种同步使得两条连接表现得像一条在窗口的最小值和最大值之间振荡的连接。可以在链路中加入一个有限缓存。在缓存溢出之前随机的丢弃分组，这样可以使得不同的连接错开减小窗口的时间。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org25de95f" class="outline-4">
<h4 id="org25de95f">P52 修改为乘性增的吞吐量</h4>
<div class="outline-text-4" id="text-org25de95f">
<p>
考虑修改TCP的拥塞控制算法。不使用加性增，使用乘性增。无论何时某TCP收到一个合法的ACK，就将其窗口长度增加一个小正数a（O&lt;a&lt;1）（A TCP sender increases its window size by a small positive constant a(0&lt;a&lt;1) whenever it receives a valid ACK.）。求出丢包率L和最大拥塞窗口W之间的函数关系。论证：对于这种修正的TCP，无论TCP的平均吞吐量如何，一条TCP连接将其拥塞窗口长度从W/2增加到W，总是需要相同的时间。<br />
</p>

<p>
在拥塞窗口从W/2增长到W的过程中总共发送的分组数量是：<br />
</p>

<p>
\[ S = W/2+(1+a)W/2+(1+a)^2W/2+\cdots + (1+a)^kW/2, \]<br />
</p>

<p>
其中 \(k=\log_{a+1}2\)，带入可得 \(S=\frac{2a+1}{2a}W.\)<br />
</p>

<p>
丢包率是：<br />
</p>

\begin{align*}
  L = \frac1S = \frac{2a}{(2a+1)W}.
\end{align*}

<p>
从W/2增长到W所需要的时间是：<br />
</p>

<p>
\[ k⋅RTT=(\log_{1+a}2)⋅RTT, \]<br />
</p>

<p>
这个时间与链路的吞吐量无关。<br />
</p>

<p>
平均吞吐量是（发送W还需要1个RTT，因此是增长时间加1）：<br />
</p>

<p>
\[ B = \frac{S⋅MSS}{(k+1)⋅RTT} = \frac{MSS}{L⋅(k+1)⋅RTT}. \]<br />
</p>
</div>
</div>

<div id="outline-container-org71b6f84" class="outline-4">
<h4 id="org71b6f84">P53 经高带宽路径的TCP</h4>
<div class="outline-text-4" id="text-org71b6f84">
<p>
在3.7节对TCP未来的讨论中，我们注意到为了取得10Gbps的吞吐量，TCP仅能容忍2×10<sup>-10</sup>的报文段丢失率（或等价为每5 000 000 000个报文段有一个丢包事件）。给出针对3.7节中给定的RTT和MSS值的对2×10<sup>-10</sup>值的推导。如果TCP需要支持一条100Gbps的连接，所能容忍的丢包率是多少？<br />
</p>

<p>
丢包率和吞吐量之间的关系：<br />
</p>

<p>
\[ L = (\frac{1.22⋅MSS}{RTT⋅B})^2. \]<br />
</p>

<p>
对于10Gbps的吞吐量，\(L=(\frac{1.22⋅1500B}{100ms⋅10Gbps})^2≈2⋅10^{-10}.\)<br />
</p>

<p>
对于100Gbps，\(L≈2⋅10^{-12}.\)<br />
</p>
</div>
</div>

<div id="outline-container-org5efa19e" class="outline-4">
<h4 id="org5efa19e">P54 拥塞控制的实效性</h4>
<div class="outline-text-4" id="text-org5efa19e">
<p>
在3.7节中对TCP拥塞控制的讨论中，我们隐含地假定TCP发送方总是有数据要发送。现在考虑下列情况，某TCP发送方发送大量数据，然后在t<sub>1</sub>时刻变得空闲（因为它没有更多的数据要发送）。TCP在相对长的时间内保持空闲，然后在t<sub>2</sub>时刻要发送更多的数据。当TCP在t<sub>2</sub>开始发送数据时，让它使用在t<sub>1</sub>时刻的cwnd和ssthresh值，将有什么样的优点和缺点？你建议使用什么样的方法？为什么？<br />
</p>

<blockquote>
<p>
在t<sub>2</sub>使用早期的cwnd和ssthresh值的好处是，TCP不必通过慢启动和拥塞避免来提升到t<sub>1</sub>获得的吞吐量值。使用这些值的缺点是，它们可能不再准确了。特别是，如果路径在t<sub>1</sub>和t<sub>2</sub>之间变得更加拥挤，发送方将向已经拥挤的路径发送一个大窗口的段。<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org07d2a31" class="outline-4">
<h4 id="org07d2a31">P55 SYN cookie与地址欺骗</h4>
<div class="outline-text-4" id="text-org07d2a31">
<p>
在这个习题中我们研究是否UDP或TCP提供了某种程度的端点鉴别。<br />
</p>
<ol class="org-ol">
<li>考虑一台服务器接收到在一个UDP分组中的请求并对该请求进行响应（例如，如由DNS服务器所做的那样）。如果一个具有IP地址X的客户用地址Y进行哄骗的话，服务器将向何处发送它的响应？<br /></li>
<li>假定一台服务器接收到具有IP源地址Y的一个SYN，在用SYNACK响应之后，接收一个具有IP源地址Y和正确确认号的ACK。假设该服务器选择了一个随机初始序号并且没有“中间人”，该服务器能够确定该客户的确位于Y吗？（并且不在某个其他哄骗为Y的地址X。）<br /></li>
</ol>


<ol class="org-ol">
<li>服务器将向Y发送它的响应。<br /></li>
<li>服务器可以确定该客户端的确位于Y。如果它是在其他地址用地址Y进行哄骗，SYNACK就会被发送到地址Y，而该主机中的TCP不会发送TCP ACK回来。即使攻击者能在适当的时间发送一个TCP ACK，它也无法知道正确的随机初始序号。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org47835a7" class="outline-4">
<h4 id="org47835a7">P56 TCP慢启动引入的时延</h4>
<div class="outline-text-4" id="text-org47835a7">
<p>
在这个习题中，我们考虑由TCP慢启动阶段引入的时延。考虑一个客户和一个Web服务器直接连接到速率R的一条链路。假定该客户要取回一个对象，其长度正好等于15S，其中S是最大段长度（MSS）。客户和服务器之间的往返时间表示为RTT（假设为常数）。忽略协议首部，确定在下列情况下取回该对象的时间（包括TCP连接创建）：<br />
</p>
<ol class="org-ol">
<li>4S/R&gt;S/R+RTT&gt;2S/R<br /></li>
<li>S/R+RTT&gt;4S/R<br /></li>
<li>S/R&gt;RTT<br /></li>
</ol>



<div id="orgc06658d" class="figure">
<p><img src="./img/ch3-p56.png" alt="ch3-p56.png" style="width:100%; max-width:450px;" /><br />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orge900be6" class="outline-3">
<h3 id="orge900be6"><span class="section-number-3">3.4.</span> 编程作业 实现一个可靠运输协议</h3>
<div class="outline-text-3" id="text-3-4">
<p>
在这个编程作业实验中，你将要编写发送和接收运输层的代码，以实现一个简单的可靠数据运输协议。这个实验有两个版本，即比特交替协议版本和GBN版本。这个实验应当是有趣的，因为你的实现将与实际情况下所要求的差异很小。<br />
</p>

<p>
因为可能没有你能够修改其操作系统的独立机器，你的代码将不得不在模拟的硬件/软件环境中执行。然而，为你提供例程的编程接口（即从上层和下层调用你的实体的代码），非常类似于在实际UNIX环境中做那些事情的接口。（实际上，在本编程作业中描述的软件接口比起许多教科书中描述的无限循环的发送方和接收方要真实得多。）停止和启动定时器也是模拟的，定时器中断将激活你的定时器处理例程。<br />
</p>

<p>
<a href="https://media.pearsoncmg.com/aw/aw_kurose_network_2/labs/lab3.html">Programming Assignment 3: Implementing a Reliable Transport Protocol</a><br />
</p>
</div>

<div id="outline-container-orgb0d80aa" class="outline-4">
<h4 id="orgb0d80aa">比特交替协议</h4>
<div class="outline-text-4" id="text-orgb0d80aa">
<p>
比特交替协议版本直接实现rdt3.0即可。<br />
</p>


<div id="orge2e4d06" class="figure">
<p><img src="./img/fig3-14.png" alt="fig3-14.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>


<div id="org982e635" class="figure">
<p><img src="./img/fig3-15.png" alt="fig3-15.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 2: </span>abp.c</label><pre class="src src-c"><span class="org-preprocessor">#include</span> <span class="org-string">"rdt.h"</span>
<span class="org-preprocessor">#include</span> <span class="org-string">&lt;stdlib.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string">&lt;stdio.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string">&lt;string.h&gt;</span>

<span class="org-preprocessor">#define</span> <span class="org-variable-name">PUBLIC</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">empty</span><span class="org-comment-delimiter"> */</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">PRIVATE</span> <span class="org-keyword">static</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">TIMEOUT</span> 25

<span class="org-keyword">enum</span> <span class="org-type">stat</span> {<span class="org-variable-name">WAIT_0</span>, <span class="org-variable-name">WAIT_ACK_0</span>, <span class="org-variable-name">WAIT_1</span>, <span class="org-variable-name">WAIT_ACK_1</span>};
<span class="org-keyword">enum</span> <span class="org-type">stat</span> <span class="org-variable-name">A_state</span>;
<span class="org-keyword">enum</span> <span class="org-type">stat</span> <span class="org-variable-name">B_state</span>;

PRIVATE <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">unacked_packet</span> = {0};
PRIVATE <span class="org-type">int</span> <span class="org-variable-name">received</span> = 0;

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_output</span>(<span class="org-keyword">struct</span> <span class="org-type">msg</span> <span class="org-variable-name">message</span>) {
  printf(<span class="org-string">"\n&gt;&gt;&gt; layer5 &#8595; A, "</span>);
  print_msg(message);
  <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">sndpkt</span> = {0};

  memcpy(sndpkt.payload, message.data, <span class="org-keyword">sizeof</span>(sndpkt.payload));
  <span class="org-keyword">switch</span> (A_state) {
  <span class="org-keyword">case</span> WAIT_0:
    sndpkt.seqnum = 0;
    sndpkt.checksum = calc_checksum(sndpkt);
    tolayer3(0, sndpkt);
    starttimer(0, TIMEOUT);
    unacked_packet = sndpkt;
    A_state = WAIT_ACK_0;
    printf(<span class="org-string">"    A state: WAIT_0\n"</span>);
    printf(<span class="org-string">"    A &#8595; layer3, "</span>);
    print_pkt(sndpkt);
    printf(<span class="org-string">"    A new state: WAIT_ACK_0\n"</span>);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_ACK_0:
    printf(<span class="org-string">"    A state: WAIT_ACK_0, ignore\n"</span>);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_1:
    sndpkt.seqnum = 1;
    sndpkt.checksum = calc_checksum(sndpkt);
    tolayer3(0, sndpkt);
    starttimer(0, TIMEOUT);
    unacked_packet = sndpkt;
    A_state = WAIT_ACK_1;
    printf(<span class="org-string">"    A state: WAIT_1\n"</span>);
    printf(<span class="org-string">"    A &#8595; layer3, "</span>);
    print_pkt(sndpkt);
    printf(<span class="org-string">"    A new state: WAIT_ACK_1\n"</span>);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_ACK_1:
    printf(<span class="org-string">"    A state: WAIT_ACK_1, ignore\n"</span>);
    <span class="org-keyword">break</span>;
  }
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_input</span>(<span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">packet</span>) {
  printf(<span class="org-string">"\n&gt;&gt;&gt; layer3 &#8593; A, "</span>);
  print_pkt(packet);
  <span class="org-keyword">switch</span> (A_state) {
  <span class="org-keyword">case</span> WAIT_0:
    printf(<span class="org-string">"    A state: WAIT_0, ignore\n"</span>);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_ACK_0:
    printf(<span class="org-string">"    A state: WAIT_ACK_0\n"</span>);
    <span class="org-keyword">if</span> (packet.checksum != calc_checksum(packet) ||
        packet.acknum != 0) {
      printf(<span class="org-string">"    corrupt or ack1, ignore\n"</span>);
      <span class="org-keyword">return</span>;
    }
    stoptimer(0);
    A_state = WAIT_1;
    printf(<span class="org-string">"    acked\n"</span>);
    printf(<span class="org-string">"    A new state: WAIT_1\n"</span>);
    received += 1;
    printf(<span class="org-string">"    A&#25910;&#21040;B&#23545;&#31532;%d&#20010;&#20998;&#32452;&#30340;&#30830;&#35748;\n"</span>, received);
    <span class="org-keyword">if</span> (received &gt;= 10) exit(0);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_1:
    printf(<span class="org-string">"    A state: WAIT_1, ignore\n"</span>);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_ACK_1:
    printf(<span class="org-string">"    A state: WAIT_ACK_1\n"</span>);
    <span class="org-keyword">if</span> (packet.checksum != calc_checksum(packet) ||
        packet.acknum != 1) {
      printf(<span class="org-string">"    corrupt or ack0, ignore\n"</span>);
      <span class="org-keyword">return</span>;
    }
    stoptimer(0);
    A_state = WAIT_0;
    printf(<span class="org-string">"    acked\n"</span>);
    printf(<span class="org-string">"    A new state: WAIT_0\n"</span>);
    received += 1;
    printf(<span class="org-string">"    A&#25910;&#21040;B&#23545;&#31532;%d&#20010;&#20998;&#32452;&#30340;&#30830;&#35748;\n"</span>, received);
    <span class="org-keyword">if</span> (received &gt;= 10) exit(0);
    <span class="org-keyword">break</span>;
  }
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_timerinterrupt</span>() {
  printf(<span class="org-string">"\n&gt;&gt;&gt; A timeout\n"</span>);
  <span class="org-keyword">switch</span> (A_state) {
  <span class="org-keyword">case</span> WAIT_0:
    printf(<span class="org-string">"    A state: WAIT_0, ignore\n"</span>);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_ACK_0:
    printf(<span class="org-string">"    A state: WAIT_ACK_0\n"</span>);
    printf(<span class="org-string">"    A &#8595; layer3, "</span>);
    print_pkt(unacked_packet);
    tolayer3(0, unacked_packet);
    starttimer(0, TIMEOUT);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_1:
    printf(<span class="org-string">"    A state: WAIT_1, ignore\n"</span>);
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_ACK_1:
    printf(<span class="org-string">"    A state: WAIT_ACK_1\n"</span>);
    printf(<span class="org-string">"    A &#8595; layer3, "</span>);
    print_pkt(unacked_packet);
    tolayer3(0, unacked_packet);
    starttimer(0, TIMEOUT);
    <span class="org-keyword">break</span>;
  }
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_init</span>() {
  A_state = WAIT_0;
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_output</span>(<span class="org-keyword">struct</span> <span class="org-type">msg</span> <span class="org-variable-name">message</span>) {
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_input</span>(<span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">packet</span>) {
  printf(<span class="org-string">"\n&gt;&gt;&gt; layer3 &#8593; B, "</span>);
  print_pkt(packet);
  <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">sndpkt</span> = {0};
  <span class="org-keyword">switch</span> (B_state) {
  <span class="org-keyword">case</span> WAIT_0:
    printf(<span class="org-string">"    B state: WAIT_0\n"</span>);
    <span class="org-keyword">if</span> ((packet.checksum != calc_checksum(packet)) ||
        (packet.seqnum == 1)) {
      sndpkt.acknum = 1;
      sndpkt.checksum = calc_checksum(sndpkt);
      tolayer3(1, sndpkt);
      printf(<span class="org-string">"    corrupt or seq1, send ACK1\n"</span>);
      printf(<span class="org-string">"    B &#8595; layer3, "</span>);
      print_pkt(sndpkt);
    } <span class="org-keyword">else</span> <span class="org-keyword">if</span> ((packet.checksum == calc_checksum(packet)) &amp;&amp;
               (packet.seqnum == 0)) {
      tolayer5(1, packet.payload);
      sndpkt.acknum = 0;
      sndpkt.checksum = calc_checksum(sndpkt);
      tolayer3(1, sndpkt);
      B_state = WAIT_1;
      printf(<span class="org-string">"    B &#8593; layer5, send ACK0\n"</span>);
      printf(<span class="org-string">"    B &#8595; layer3, "</span>);
      print_pkt(sndpkt);
    }
    <span class="org-keyword">break</span>;
  <span class="org-keyword">case</span> WAIT_1:
    printf(<span class="org-string">"    B state: WAIT_1\n"</span>);
    <span class="org-keyword">if</span> ((packet.checksum != calc_checksum(packet)) ||
        (packet.seqnum == 0)) {
      sndpkt.acknum = 0;
      sndpkt.checksum = calc_checksum(sndpkt);
      tolayer3(1, sndpkt);
      printf(<span class="org-string">"    corrupt or seq0, send ACK0\n"</span>);
      printf(<span class="org-string">"    B &#8595; layer3, "</span>);
      print_pkt(sndpkt);
    } <span class="org-keyword">else</span> <span class="org-keyword">if</span> ((packet.checksum == calc_checksum(packet)) &amp;&amp;
               (packet.seqnum == 1)) {
      tolayer5(1, packet.payload);
      sndpkt.acknum = 1;
      sndpkt.checksum = calc_checksum(sndpkt);
      tolayer3(1, sndpkt);
      B_state = WAIT_0;
      printf(<span class="org-string">"    B &#8593; layer5, send ACK1\n"</span>);
      printf(<span class="org-string">"    B &#8595; layer3, "</span>);
      print_pkt(sndpkt);
    }
    <span class="org-keyword">break</span>;
  <span class="org-keyword">default</span>:
    <span class="org-keyword">break</span>;
  }
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_timerinterrupt</span>() {
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_init</span>() {
  B_state = WAIT_0;
}
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 3: </span>test_abp.txt部分结果</label><pre class="src src-c">-----  Stop and Wait Network Simulator Version 1.1 --------

Enter the number of messages to simulate: Enter  packet loss probability [enter 0.0 <span class="org-keyword">for</span> no loss]:Enter packet corruption probability [0.0 <span class="org-keyword">for</span> no corruption]:Enter average time between messages from sender<span class="org-warning">'</span>s layer5 [ &gt; 0.0]:Enter TRACE:
&gt;&gt;&gt; layer5 &#8595; A, message: {<span class="org-constant">data</span>: aaaaaaaaaaaaaaaaaaaa}
    <span class="org-type">A</span> <span class="org-variable-name">state</span>: WAIT_0
    A &#8595; layer3, <span class="org-variable-name">packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 0, checksum: 1940, payload: aaaaaaaaaaaaaaaaaaaa}
    <span class="org-type">A</span> <span class="org-type">new</span> <span class="org-variable-name">state</span>: WAIT_ACK_0

&gt;&gt;&gt; layer3 &#8593; B, <span class="org-variable-name">packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 0, checksum: 1940, payload: aaaaaaaaaaaaaaaaaaaa}
    <span class="org-type">B</span> <span class="org-variable-name">state</span>: WAIT_0
          TOLAYER3: packet being corrupted
    B &#8593; layer5, <span class="org-variable-name">send</span> ACK0
    B &#8595; layer3, <span class="org-variable-name">packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 0, checksum: 0, payload: }

&gt;&gt;&gt; layer3 &#8593; A, packet: {<span class="org-constant">seqnum</span>: 0, acknum: 0, checksum: 0, payload: Z}
    <span class="org-type">A</span> <span class="org-variable-name">state</span>: WAIT_ACK_0
    corrupt or ack1, <span class="org-variable-name">ignore</span>

&gt;&gt;&gt; layer5 &#8595; A, <span class="org-variable-name">message</span>: {<span class="org-constant">data</span>: bbbbbbbbbbbbbbbbbbbb}
    <span class="org-type">A</span> <span class="org-variable-name">state</span>: WAIT_ACK_0, <span class="org-variable-name">ignore</span>

&gt;&gt;&gt; A timeout
    A state: WAIT_ACK_0
    A &#8595; layer3, <span class="org-variable-name">packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 0, checksum: 1940, payload: aaaaaaaaaaaaaaaaaaaa}
          <span class="org-constant">TOLAYER3</span>: packet <span class="org-type">being</span> <span class="org-variable-name">corrupted</span>

&gt;&gt;&gt; layer5 &#8595; A, <span class="org-variable-name">message</span>: {<span class="org-constant">data</span>: cccccccccccccccccccc}
    <span class="org-type">A</span> <span class="org-variable-name">state</span>: WAIT_ACK_0, <span class="org-variable-name">ignore</span>

&gt;&gt;&gt; layer3 &#8593; B, <span class="org-variable-name">packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 999999, checksum: 1940, payload: aaaaaaaaaaaaaaaaaaaa}
    <span class="org-type">B</span> <span class="org-variable-name">state</span>: WAIT_1
    corrupt or seq0, <span class="org-variable-name">send</span> ACK0
    B &#8595; layer3, <span class="org-variable-name">packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 0, checksum: 0, payload: }

&gt;&gt;&gt; layer3 &#8593; A, packet: {<span class="org-constant">seqnum</span>: 0, acknum: 0, checksum: 0, payload: }
    <span class="org-type">A</span> <span class="org-variable-name">state</span>: WAIT_ACK_0
    acked
    A new state: WAIT_1
    A&#25910;&#21040;B&#23545;&#31532;1&#20010;&#20998;&#32452;&#30340;&#30830;&#35748;
</pre>
</div>
</div>
</div>

<div id="outline-container-org9d73e83" class="outline-4">
<h4 id="org9d73e83">GBN</h4>
<div class="outline-text-4" id="text-org9d73e83">

<div id="orgbb0ff7c" class="figure">
<p><img src="./img/fig3-20.png" alt="fig3-20.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>


<div id="org6f8f130" class="figure">
<p><img src="./img/fig3-21.png" alt="fig3-21.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 4: </span>gbn.c</label><pre class="src src-c"><span class="org-preprocessor">#include</span> <span class="org-string">&lt;stdio.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string">&lt;stdlib.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string">&lt;string.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string">&lt;stdbool.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string">&lt;sys/queue.h&gt;</span>
<span class="org-preprocessor">#include</span> <span class="org-string">"rdt.h"</span>

<span class="org-preprocessor">#define</span> <span class="org-variable-name">PUBLIC</span>  <span class="org-comment-delimiter">/* </span><span class="org-comment">empty</span><span class="org-comment-delimiter"> */</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">PRIVATE</span> <span class="org-keyword">static</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">TIMEOUT</span> 25
<span class="org-preprocessor">#define</span> <span class="org-variable-name">N</span> 8  <span class="org-comment-delimiter">/* </span><span class="org-comment">window size</span><span class="org-comment-delimiter"> */</span>

<span class="org-keyword">struct</span> <span class="org-type">entry</span> {
  <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">packet</span>;
  <span class="org-function-name">STAILQ_ENTRY</span>(<span class="org-type">entry</span>) entries;
};

<span class="org-type">PRIVATE</span> <span class="org-function-name">STAILQ_HEAD</span>(tailhead, <span class="org-type">entry</span>) head = STAILQ_HEAD_INITIALIZER(head);

<span class="org-type">PRIVATE</span> <span class="org-type">int</span> <span class="org-variable-name">base</span>;
<span class="org-type">PRIVATE</span> <span class="org-type">int</span> <span class="org-variable-name">nextseqnum</span>;
<span class="org-type">PRIVATE</span> <span class="org-type">int</span> <span class="org-variable-name">expectedseqnum</span>;

<span class="org-type">PRIVATE</span> <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">B_sndpkt</span>;

<span class="org-type">PRIVATE</span> <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-function-name">make_pkt</span>(<span class="org-type">int</span> <span class="org-variable-name">seq</span>, <span class="org-type">int</span> <span class="org-variable-name">ack</span>, <span class="org-type">char</span> <span class="org-variable-name">payload</span>[]) {
  <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">p</span> = {seq, ack, 0, {0}};
  <span class="org-keyword">if</span> (payload) memcpy(p.payload, payload, <span class="org-keyword">sizeof</span>(p.payload));
  p.checksum = calc_checksum(p);
  <span class="org-keyword">return</span> p;
}

<span class="org-type">PRIVATE</span> <span class="org-type">bool</span> <span class="org-function-name">corrupt</span>(<span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">p</span>) {
  <span class="org-keyword">return</span> p.checksum != calc_checksum(p);
}

<span class="org-type">PRIVATE</span> <span class="org-type">bool</span> <span class="org-function-name">hasseqnum</span>(<span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">p</span>, <span class="org-type">int</span> <span class="org-variable-name">expt</span>) {
  <span class="org-keyword">return</span> p.seqnum == expt;
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_output</span>(<span class="org-keyword">struct</span> <span class="org-type">msg</span> <span class="org-variable-name">message</span>) {
  printf(<span class="org-string">"\n&gt;&gt;&gt; Layer5 &#8595; A, "</span>);
  print_msg(message);
  <span class="org-keyword">if</span> (nextseqnum &lt; base + N) {
    <span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">sndpkt</span> = make_pkt(nextseqnum, 0, message.data);
    printf(<span class="org-string">"    Send "</span>);
    print_pkt(sndpkt);
    <span class="org-keyword">struct</span> <span class="org-type">entry</span> *<span class="org-variable-name">elem</span> = malloc(<span class="org-keyword">sizeof</span>(<span class="org-keyword">struct</span> <span class="org-type">entry</span>));
    elem-&gt;packet = sndpkt;
    STAILQ_INSERT_TAIL(&amp;head, elem, entries);
    tolayer3(0, sndpkt);
    <span class="org-keyword">if</span> (base == nextseqnum) starttimer(0, TIMEOUT);
    nextseqnum += 1;
  } <span class="org-keyword">else</span> {
    printf(<span class="org-string">"    Refuse data\n"</span>);
  }
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_input</span>(<span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">packet</span>) {
  printf(<span class="org-string">"\n&gt;&gt;&gt; Layer3 &#8593; A, "</span>);
  print_pkt(packet);
  <span class="org-keyword">if</span> (corrupt(packet)) {
    printf(<span class="org-string">"    Ignore corrupt packet\n"</span>);
    <span class="org-keyword">return</span>;
  }
  <span class="org-type">int</span> <span class="org-variable-name">acknum</span> = packet.acknum;
  printf(<span class="org-string">"*** Ack packet: %d\n"</span>, acknum);
  <span class="org-keyword">if</span> (acknum &gt;= 20) {
    printf(<span class="org-string">"&gt;&gt;&gt; 20 messages were successfully transfered from sender to receiver\n"</span>);
    exit(0);
  }
  <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">i</span>=acknum-base+1; i&gt;0; --i) {
    <span class="org-keyword">struct</span> <span class="org-type">entry</span> *<span class="org-variable-name">elem</span>  = STAILQ_FIRST(&amp;head);
    STAILQ_REMOVE_HEAD(&amp;head, entries);
    free(elem);
  }
  base = acknum + 1;

  <span class="org-keyword">if</span> (base == nextseqnum) {
    stoptimer(0);
  } <span class="org-keyword">else</span> {
    stoptimer(0);
    starttimer(0, TIMEOUT);
  }

}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_timerinterrupt</span>() {
  printf(<span class="org-string">"\n&gt;&gt;&gt; A timeout\n"</span>);
  starttimer(0, TIMEOUT);
  <span class="org-keyword">struct</span> <span class="org-type">entry</span> *<span class="org-variable-name">elem</span>;
  STAILQ_FOREACH(elem, &amp;head, entries) {
    tolayer3(0, elem-&gt;packet);
    printf(<span class="org-string">"    Resend "</span>);
    print_pkt(elem-&gt;packet);
  }
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">A_init</span>() {
  base = 1;
  nextseqnum = 1;
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_output</span>(<span class="org-keyword">struct</span> <span class="org-type">msg</span> <span class="org-variable-name">message</span>) {
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_input</span>(<span class="org-keyword">struct</span> <span class="org-type">pkt</span> <span class="org-variable-name">packet</span>) {
  printf(<span class="org-string">"\n&gt;&gt;&gt; Layer3 &#8593; B, "</span>);
  print_pkt(packet);
  <span class="org-keyword">if</span> (corrupt(packet)) {
    printf(<span class="org-string">"    Ignore corrupt packet\n"</span>);
    <span class="org-keyword">return</span>;
  }
  <span class="org-keyword">if</span> (<span class="org-negation-char">!</span>hasseqnum(packet, expectedseqnum)) {
    printf(<span class="org-string">"    Unexpected packet, resend last ACK, "</span>);
    print_pkt(B_sndpkt);
    tolayer3(1, B_sndpkt);
    <span class="org-keyword">return</span>;
  }
  tolayer5(1, packet.payload);
  B_sndpkt = make_pkt(0, expectedseqnum, <span class="org-constant">NULL</span>);
  tolayer3(1, B_sndpkt);
  printf(<span class="org-string">"    B send ACK "</span>);
  print_pkt(B_sndpkt);
  expectedseqnum += 1;
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_timerinterrupt</span>() {
}

PUBLIC <span class="org-type">void</span> <span class="org-function-name">B_init</span>() {
  expectedseqnum = 1;
  B_sndpkt = make_pkt(0, 0, <span class="org-constant">NULL</span>);
}
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>test_gbn.txt部分结果</label><pre class="src src-c">-----  Stop and Wait Network Simulator Version 1.1 --------

Enter the number of messages to simulate: Enter  packet loss probability [enter 0.0 <span class="org-keyword">for</span> no loss]:Enter packet corruption probability [0.0 <span class="org-keyword">for</span> no corruption]:Enter average time between messages from sender<span class="org-warning">'</span>s layer5 [ &gt; 0.0]:Enter TRACE:
&gt;&gt;&gt; Layer5 &#8595; A, Message: {<span class="org-constant">data</span>: aaaaaaaaaaaaaaaaaaaa}
    <span class="org-type">Send</span> <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 1, acknum: 0, checksum: 1941, payload: aaaaaaaaaaaaaaaaaaaa}

&gt;&gt;&gt; Layer3 &#8593; B, Packet: {<span class="org-constant">seqnum</span>: 1, acknum: 0, checksum: 1941, payload: aaaaaaaaaaaaaaaaaaaa}
          <span class="org-constant">TOLAYER3</span>: packet being corrupted
    B send <span class="org-type">ACK</span> <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 1, checksum: 1, payload: }

&gt;&gt;&gt; Layer3 &#8593; A, Packet: {<span class="org-constant">seqnum</span>: 0, acknum: 1, checksum: 1, payload: Z}
    Ignore <span class="org-type">corrupt</span> <span class="org-variable-name">packet</span>

&gt;&gt;&gt; Layer5 &#8595; A, <span class="org-variable-name">Message</span>: {<span class="org-constant">data</span>: bbbbbbbbbbbbbbbbbbbb}
    <span class="org-type">Send</span> <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 2, acknum: 0, checksum: 1962, payload: bbbbbbbbbbbbbbbbbbbb}
          <span class="org-constant">TOLAYER3</span>: packet <span class="org-type">being</span> <span class="org-variable-name">corrupted</span>

&gt;&gt;&gt; Layer3 &#8593; B, <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 2, acknum: 999999, checksum: 1962, payload: bbbbbbbbbbbbbbbbbbbb}
    Ignore <span class="org-type">corrupt</span> <span class="org-variable-name">packet</span>

&gt;&gt;&gt; A timeout
    Resend Packet: {<span class="org-constant">seqnum</span>: 1, acknum: 0, checksum: 1941, payload: aaaaaaaaaaaaaaaaaaaa}
          <span class="org-constant">TOLAYER3</span>: packet <span class="org-type">being</span> corrupted
    <span class="org-type">Resend</span> <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 2, acknum: 0, checksum: 1962, payload: bbbbbbbbbbbbbbbbbbbb}

&gt;&gt;&gt; Layer5 &#8595; A, Message: {<span class="org-constant">data</span>: cccccccccccccccccccc}
    <span class="org-type">Send</span> <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 3, acknum: 0, checksum: 1983, payload: cccccccccccccccccccc}
          <span class="org-constant">TOLAYER3</span>: packet <span class="org-type">being</span> <span class="org-variable-name">corrupted</span>

&gt;&gt;&gt; Layer3 &#8593; B, <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 1, acknum: 0, checksum: 1941, payload: aaaaaaaaaaaaaaaaaaaa}
    <span class="org-type">Unexpected</span> <span class="org-variable-name">packet</span>, <span class="org-variable-name">resend</span> last ACK, <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 0, acknum: 1, checksum: 1, payload: }

&gt;&gt;&gt; Layer3 &#8593; A, Packet: {<span class="org-constant">seqnum</span>: 0, acknum: 1, checksum: 1, payload: }
*** Ack packet: 1

&gt;&gt;&gt; Layer5 &#8595; A, Message: {<span class="org-constant">data</span>: dddddddddddddddddddd}
    <span class="org-type">Send</span> <span class="org-variable-name">Packet</span>: {<span class="org-constant">seqnum</span>: 4, acknum: 0, checksum: 2004, payload: dddddddddddddddddddd}

&gt;&gt;&gt; Layer3 &#8593; B, Packet: {<span class="org-constant">seqnum</span>: 2, acknum: 999999, checksum: 1962, payload: bbbbbbbbbbbbbbbbbbbb}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgebd3a02" class="outline-3">
<h3 id="orgebd3a02"><span class="section-number-3">3.5.</span> Wireshark实验：探究TCP</h3>
<div class="outline-text-3" id="text-3-5">
<p>
在这个实验中，你将使用Web浏览器访问来自某Web服务器的一个文件。如同在前面的Wireshark实验中一样，你将使用Wireshark来俘获到达你计算机的分组。与前面实验不同的是，你也能够从该Web服务器下载一个Wireshark可读的分组踪迹，记载你从服务器下载文件的过程。在这个服务器踪迹文件里，你将发现自己访问该Web服务器所产生的分组。你将分析客户端和服务器端踪迹文件，以探究TCP的方方面面。特别是你将评估在你的计算机与该Web服务器之间TCP连接的性能。你将跟踪TCP窗口行为、推断分组丢失、重传、流控和拥塞控制行为并估计往返时间。<br />
</p>

<p>
<a href="code/ch3-ws-tcp/wireshark-tcp-v7.0.pdf">Wireshark Lab: TCP v7.0</a><br />
</p>

<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-c">No.     Time               Source                Destination           Protocol Length Info
199 21:44:25.867722    192.168.1.102         128.119.245.12        HTTP     104    POST /ethereal-labs/lab3-1-reply.htm HTTP/1.1  (text/plain)

Frame 199: 104 bytes on wire (832 bits), 104 bytes captured (832 bits)
  <span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
  Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.119.245.12
  Transmission Control Protocol, <span class="org-variable-name">Src</span> Port: 1161, <span class="org-variable-name">Dst</span> Port: 80, <span class="org-variable-name">Seq</span>: 164041, <span class="org-variable-name">Ack</span>: 1, <span class="org-variable-name">Len</span>: 50
  [122 Reassembled TCP Segments (164090 bytes): #4(565), #5(1460), #7(1460), #8(1460), #10(1460), #11(1460), #13(1147), #18(1460), #19(1460), #20(1460), #21(1460), #22(1460), #23(892), #30(1460), #31(1460), #32(1460), #33(1460), #34(1460), #3]
  Hypertext Transfer Protocol
  MIME Multipart Media Encapsulation, <span class="org-variable-name">Type</span>: multipart/form-data, <span class="org-variable-name">Boundary</span>: <span class="org-string">"---------------------------265001916915724"</span>
</pre>
</div>

<ul class="org-ul">
<li><p>
What is the IP address and TCP port number used by the client computer (source) that is transferring the file to gaia.cs.umass.edu?<br />
</p>

<p>
192.168.1.102, 1161.<br />
</p></li>
</ul></li>

<li>&#x00ad;<br />
<ul class="org-ul">
<li><p>
What is the IP address of gaia.cs.umass.edu?<br />
</p>

<p>
128.119.245.12.<br />
</p></li>

<li>On what port number is it sending and receiving TCP segments for this connection?<br />
80<br /></li>
</ul></li>

<li><p>
&#x00ad;<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time               Source                Destination           Protocol Length Info
153 14:14:42.972534    192.168.8.100         128.119.245.12        HTTP     402    POST /wireshark-labs/lab3-1-reply.htm HTTP/1.1  (text/plain)

Frame 153: 402 bytes on wire (3216 bits), 402 bytes captured (3216 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
  Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
  Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-variable-name">Dst</span>: 128.119.245.12
  Transmission Control Protocol, <span class="org-variable-name">Src</span> Port: 49753, <span class="org-variable-name">Dst</span> Port: 80, <span class="org-variable-name">Seq</span>: 152592, <span class="org-variable-name">Ack</span>: 1, <span class="org-variable-name">Len</span>: 336
  [114 Reassembled TCP Segments (152927 bytes): #4(606), #5(137), #6(1368), #7(1368), #8(1368), #9(1368), #10(1368), #11(1368), #12(1368), #13(1368), #14(1368), #18(1368), #19(1368), #20(1368), #21(1368), #22(1368), #23(1368), #24(1368), #25(]
   Hypertext Transfer Protocol
   MIME Multipart Media Encapsulation, Type: multipart/form-data, Boundary: <span class="org-string">"----WebKitFormBoundaryhIxTN5lI8AmIgWDB"</span>
</pre>
</div>

<ul class="org-ul">
<li>What is the IP address and TCP port number used by your client computer (source) to transfer the file to gaia.cs.umass.edu?<br />
192.168.8.100, 49753.<br /></li>
</ul></li>

<li><p>
&#x00ad;<br />
</p>
<div class="org-src-container">
<pre class="src src-c">No.     Time               Source                Destination           Protocol Length Info
1 14:14:41.756084    192.168.8.100         128.119.245.12        TCP      78     49753 &#8594; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=64 TSval=2472490822 TSecr=0 SACK_PERM=1

  Frame 1: 78 bytes on wire (624 bits), 78 bytes captured (624 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
  Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
  Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-variable-name">Dst</span>: 128.119.245.12
  Transmission Control Protocol, <span class="org-variable-name">Src</span> Port: 49753, <span class="org-variable-name">Dst</span> Port: 80, <span class="org-variable-name">Seq</span>: 0, <span class="org-variable-name">Len</span>: 0
  Source Port: 49753
  Destination Port: 80
  [Stream index: 0]
  [TCP Segment Len: 0]
  Sequence Number: 0    (relative <span class="org-type">sequence</span> <span class="org-variable-name">number</span>)
  <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (raw): 736682434
  [Next Sequence Number: 1    (relative <span class="org-type">sequence</span> <span class="org-variable-name">number</span>)]
  Acknowledgment Number: 0
  Acknowledgment number (raw): 0
  1011 .... = Header Length: 44 bytes (11)
  Flags: 0x002 (SYN)
  Window: 65535
  [Calculated window size: 65535]
  Checksum: 0x5d71 [unverified]
  [Checksum Status: Unverified]
  Urgent Pointer: 0
  Options: (24 bytes), <span class="org-variable-name">Maximum</span> segment size, <span class="org-function-name">No</span>-Operation (NOP), <span class="org-variable-name">Window</span> scale, <span class="org-function-name">No</span>-Operation (NOP), <span class="org-function-name">No</span>-Operation (NOP), <span class="org-variable-name">Timestamps</span>, <span class="org-variable-name">SACK</span> permitted, <span class="org-function-name">End</span> of Option List (EOL)
  [Timestamps]
</pre>
</div>

<ul class="org-ul">
<li>What is the sequence number of the TCP SYN segment that is used to initiate the TCP connection between the client computer and gaia.cs.umass.edu?<br />

<ol class="org-ol">
<li></li>
</ol></li>

<li><p>
What is it in the segment that identifies the segment as a SYN segment?<br />
</p>

<p>
Flags: 0x002 (SYN).<br />
</p></li>
</ul></li>

<li><p>
&#x00ad;<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time               Source                Destination           Protocol Length Info
2 14:14:42.063101    128.119.245.12        192.168.8.100         TCP      74     80 &#8594; 49753 [SYN, ACK] Seq=0 Ack=1 Win=28960 Len=0 MSS=1380 SACK_PERM=1 TSval=2475192272 TSecr=2472490822 WS=128

  Frame 2: 74 bytes on wire (592 bits), 74 bytes captured (592 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
  Ethernet II, <span class="org-function-name">Src</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), <span class="org-function-name">Dst</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
  Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 128.119.245.12, <span class="org-variable-name">Dst</span>: 192.168.8.100
  Transmission Control Protocol, <span class="org-variable-name">Src</span> Port: 80, <span class="org-variable-name">Dst</span> Port: 49753, <span class="org-variable-name">Seq</span>: 0, <span class="org-variable-name">Ack</span>: 1, <span class="org-variable-name">Len</span>: 0
  Source Port: 80
  Destination Port: 49753
  [Stream index: 0]
  [TCP Segment Len: 0]
  Sequence Number: 0    (relative <span class="org-type">sequence</span> <span class="org-variable-name">number</span>)
  <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (raw): 447646307
  [Next Sequence Number: 1    (relative <span class="org-type">sequence</span> <span class="org-variable-name">number</span>)]
  Acknowledgment Number: 1    (relative <span class="org-type">ack</span> <span class="org-variable-name">number</span>)
  <span class="org-type">Acknowledgment</span> <span class="org-function-name">number</span> (raw): 736682435
  1010 .... = Header Length: 40 bytes (10)
  Flags: 0x012 (SYN, ACK)
  Window: 28960
  [Calculated window size: 28960]
  Checksum: 0x5529 [unverified]
  [Checksum Status: Unverified]
  Urgent Pointer: 0
  Options: (20 bytes), <span class="org-variable-name">Maximum</span> segment size, <span class="org-variable-name">SACK</span> permitted, <span class="org-variable-name">Timestamps</span>, <span class="org-function-name">No</span>-Operation (NOP), <span class="org-variable-name">Window</span> scale
  [SEQ/ACK analysis]
  [Timestamps]
</pre>
</div>

<ul class="org-ul">
<li>What is the sequence number of the SYNACK segment sent by gaia.cs.umass.edu to the client computer in reply to the SYN?<br />

<ol class="org-ol">
<li></li>
</ol></li>

<li>What is the value of the Acknowledgement field in the SYNACK segment?<br />

<ol class="org-ol">
<li></li>
</ol></li>

<li><p>
How did gaia.cs.umass.edu determine that value?<br />
</p>

<p>
确认号是主机期望收到的下一字节的序号。<br />
</p></li>

<li><p>
What is it in the segment that identifies the segment as a SYNACK segment?<br />
</p>

<p>
Flags: 0x012 (SYN, ACK).<br />
</p></li>
</ul></li>

<li><p>
使用示例提供的trace文件。<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
4 0.026477       192.168.1.102         128.119.245.12        TCP      619    1161 &#8594; 80 [PSH, ACK] Seq=1 Ack=1 Win=17520 Len=565 [TCP segment of a reassembled PDU]

  0000  00 06 25 da af 73 00 20 e0 8a 70 1a 08 00 45 00   ..%..s. ..p...E.
  0010  02 5d 1e 21 40 00 80 06 a2 e7 c0 a8 01 66 80 77   .].<span class="org-negation-char">!</span>@........f.w
  0020  f5 0c 04 89 00 50 0d d6 01 f5 34 a2 74 1a 50 18   .....P....4.t.P.
  0030  44 70 1f bd 00 00 50 4f 53 54 20 2f 65 74 68 65   Dp....POST /ethe
  0040  72 65 61 6c 2d 6c 61 62 73 2f 6c 61 62 33 2d 31   real-labs/lab3-1
  0050  2d 72 65 70 6c 79 2e 68 74 6d 20 48 54 54 50 2f   -reply.htm HTTP/
  0060  31 2e 31 0d 0a 48 6f 73 74 3a 20 67 61 69 61 2e   1.1..Host: gaia.
  0070  63 73 2e 75 6d 61 73 73 2e 65 64 75 0d 0a 55 73   cs.umass.edu..Us
  0080  65 72 2d 41 67 65 6e 74 3a 20 4d 6f 7a 69 6c 6c   er-Agent: Mozill
  0090  61 2f 35 2e 30 20 28 57 69 6e 64 6f 77 73 3b 20   a/5.0 (Windows;
                                                                 00a0  55 3b 20 57 69 6e 64 6f 77 73 20 4e 54 20 35 2e   U; <span class="org-type">Windows</span> <span class="org-variable-name">NT</span> 5.
                                                                 00b0  31 3b 20 65 6e 2d 55 53 3b 20 72 76 3a 31 2e 30   1; en-US; <span class="org-constant">rv</span>:1.0
                                                                 00c0  2e 32 29 20 47 65 63 6b 6f 2f 32 30 30 33 30 32   .2) Gecko/200302
  00d0  30 38 20 4e 65 74 73 63 61 70 65 2f 37 2e 30 32   08 Netscape/7.02
  00e0  0d 0a 41 63 63 65 70 74 3a 20 74 65 78 74 2f 78   ..Accept: text/x
  00f0  6d 6c 2c 61 70 70 6c 69 63 61 74 69 6f 6e 2f 78   ml,application/x
                                                              0100  6d 6c 2c 61 70 70 6c 69 63 61 74 69 6f 6e 2f 78   ml,application/x
                                                              0110  68 74 6d 6c 2b 78 6d 6c 2c 74 65 78 74 2f 68 74   html+xml,text/ht
                                                              0120  6d 6c 3b 71 3d 30 2e 39 2c 74 65 78 74 2f 70 6c   ml;q=0.9,text/pl
                                                                                                                           0130  61 69 6e 3b 71 3d 30 2e 38 2c 76 69 64 65 6f 2f   ain;q=0.8,video/
                                                                                                                                                                                         0140  78 2d 6d 6e 67 2c 69 6d 61 67 65 2f 70 6e 67 2c   x-mng,image/png,
                                                                                                                                                                                         0150  69 6d 61 67 65 2f 6a 70 65 67 2c 69 6d 61 67 65   image/jpeg,image
                                                                                                                                                                                         0160  2f 67 69 66 3b 71 3d 30 2e 32 2c 74 65 78 74 2f   /gif;q=0.2,text/
                                                                                                                                                                                                                                                        0170  63 73 73 2c 2a 2f 2a 3b 71 3d 30 2e 31 0d 0a 41   css,*<span class="org-comment-delimiter">/*</span><span class="org-comment">;q=0.1..A</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0180  63 63 65 70 74 2d 4c 61 6e 67 75 61 67 65 3a 20   ccept-Language:</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0190  65 6e 2d 75 73 2c 20 65 6e 3b 71 3d 30 2e 35 30   en-us, en;q=0.50</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       01a0  0d 0a 41 63 63 65 70 74 2d 45 6e 63 6f 64 69 6e   ..Accept-Encodin</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       01b0  67 3a 20 67 7a 69 70 2c 20 64 65 66 6c 61 74 65   g: gzip, deflate</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       01c0  2c 20 63 6f 6d 70 72 65 73 73 3b 71 3d 30 2e 39   , compress;q=0.9</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       01d0  0d 0a 41 63 63 65 70 74 2d 43 68 61 72 73 65 74   ..Accept-Charset</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       01e0  3a 20 49 53 4f 2d 38 38 35 39 2d 31 2c 20 75 74   : ISO-8859-1, ut</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       01f0  66 2d 38 3b 71 3d 30 2e 36 36 2c 20 2a 3b 71 3d   f-8;q=0.66, *;q=</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0200  30 2e 36 36 0d 0a 4b 65 65 70 2d 41 6c 69 76 65   0.66..Keep-Alive</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0210  3a 20 33 30 30 0d 0a 43 6f 6e 6e 65 63 74 69 6f   : 300..Connectio</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0220  6e 3a 20 6b 65 65 70 2d 61 6c 69 76 65 0d 0a 52   n: keep-alive..R</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0230  65 66 65 72 65 72 3a 20 68 74 74 70 3a 2f 2f 67   eferer: http://g</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0240  61 69 61 2e 63 73 2e 75 6d 61 73 73 2e 65 64 75   aia.cs.umass.edu</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0250  2f 65 74 68 65 72 65 61 6c 2d 6c 61 62 73 2f 6c   /ethereal-labs/l</span>
<span class="org-comment">                                                                                                                                                                                                                                                                                                                       0260  61 62 33 2d 31 2e 68 74 6d 0d 0a                  ab3-1.htm..</span>
</pre>
</div>

<p>
What is the sequence number of the TCP segment containing the HTTP POST command?<br />
</p>

<ol class="org-ol">
<li></li>
</ol></li>

<li><p>
&#x00ad;<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
4 0.026477       192.168.1.102         128.119.245.12        TCP      619    1161 &#8594; 80 [PSH, ACK] Seq=1 Ack=1 Win=17520 Len=565 [TCP segment of a reassembled PDU]
  5 0.041737       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [PSH, ACK] Seq=566 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
  7 0.054026       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [ACK] Seq=2026 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
  8 0.054690       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [ACK] Seq=3486 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
  10 0.077405       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [ACK] Seq=4946 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
  11 0.078157       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [ACK] Seq=6406 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
6 0.053937       128.119.245.12        192.168.1.102         TCP      60     80 &#8594; 1161 [ACK] Seq=1 Ack=566 Win=6780 Len=0
  9 0.077294       128.119.245.12        192.168.1.102         TCP      60     80 &#8594; 1161 [ACK] Seq=1 Ack=2026 Win=8760 Len=0
  12 0.124085       128.119.245.12        192.168.1.102         TCP      60     80 &#8594; 1161 [ACK] Seq=1 Ack=3486 Win=11680 Len=0
  14 0.169118       128.119.245.12        192.168.1.102         TCP      60     80 &#8594; 1161 [ACK] Seq=1 Ack=4946 Win=14600 Len=0
  15 0.217299       128.119.245.12        192.168.1.102         TCP      60     80 &#8594; 1161 [ACK] Seq=1 Ack=6406 Win=17520 Len=0
  16 0.267802       128.119.245.12        192.168.1.102         TCP      60     80 &#8594; 1161 [ACK] Seq=1 Ack=7866 Win=20440 Len=0
</pre>
</div>

<ul class="org-ul">
<li>What are the sequence numbers of the first six segments in the TCP connection (including the segment containing the HTTP POST)?<br /></li>
<li>At what time was each segment sent?<br /></li>
<li>When was the ACK for each segment received?<br /></li>
<li>what is the RTT value for each of the six segments?<br /></li>
<li><p>
What is the EstimatedRTT value after the receipt of each ACK?<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">seq</th>
<th scope="col" class="org-right">send time</th>
<th scope="col" class="org-right">ack time</th>
<th scope="col" class="org-right">RTT</th>
<th scope="col" class="org-right">EstimatedRTT</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0.026477</td>
<td class="org-right">0.053937</td>
<td class="org-right">0.02746</td>
<td class="org-right">0.02746</td>
</tr>

<tr>
<td class="org-right">566</td>
<td class="org-right">0.041737</td>
<td class="org-right">0.077294</td>
<td class="org-right">0.035557</td>
<td class="org-right">0.028472125</td>
</tr>

<tr>
<td class="org-right">2026</td>
<td class="org-right">0.054026</td>
<td class="org-right">0.124085</td>
<td class="org-right">0.070059</td>
<td class="org-right">0.033670484</td>
</tr>

<tr>
<td class="org-right">3486</td>
<td class="org-right">0.054690</td>
<td class="org-right">0.169118</td>
<td class="org-right">0.114428</td>
<td class="org-right">0.043765174</td>
</tr>

<tr>
<td class="org-right">4946</td>
<td class="org-right">0.077405</td>
<td class="org-right">0.217299</td>
<td class="org-right">0.139894</td>
<td class="org-right">0.055781277</td>
</tr>

<tr>
<td class="org-right">6406</td>
<td class="org-right">0.078157</td>
<td class="org-right">0.267802</td>
<td class="org-right">0.189645</td>
<td class="org-right">0.072514242</td>
</tr>
</tbody>
</table></li>
</ul></li>

<li><p>
What is the length of each of the first six TCP segments?<br />
</p>

<p>
565, 1460, 1460, 1460, 1460, 1460.<br />
</p></li>

<li><p>
&#x00ad;<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
1 0.000000       192.168.1.102         128.119.245.12        TCP      62     1161 &#8594; 80 [SYN] Seq=0 Win=16384 Len=0 MSS=1460 SACK_PERM=1
  2 0.023172       128.119.245.12        192.168.1.102         TCP      62     80 &#8594; 1161 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1460 SACK_PERM=1
  3 0.023265       192.168.1.102         128.119.245.12        TCP      54     1161 &#8594; 80 [ACK] Seq=1 Ack=1 Win=17520 Len=0
  4 0.026477       192.168.1.102         128.119.245.12        TCP      619    1161 &#8594; 80 [PSH, ACK] Seq=1 Ack=1 Win=17520 Len=565 [TCP segment of a reassembled PDU]
  5 0.041737       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [PSH, ACK] Seq=566 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
  6 0.053937       128.119.245.12        192.168.1.102         TCP      60     80 &#8594; 1161 [ACK] Seq=1 Ack=566 Win=6780 Len=0
  7 0.054026       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [ACK] Seq=2026 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
  8 0.054690       192.168.1.102         128.119.245.12        TCP      1514   1161 &#8594; 80 [ACK] Seq=3486 Ack=1 Win=17520 Len=1460 [TCP segment of a reassembled PDU]
</pre>
</div>

<ul class="org-ul">
<li>What is the minimum amount of available buffer space advertised at the received for the entire trace?<br />

<ol class="org-ol">
<li></li>
</ol></li>

<li><p>
Does the lack of receiver buffer space ever throttle the sender?<br />
</p>

<p>
No.<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">No.</th>
<th scope="col" class="org-right">发送方累积未确认分组</th>
<th scope="col" class="org-right">接收方窗口</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">5840</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">565</td>
<td class="org-right">5840</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">2025</td>
<td class="org-right">5840</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">1460</td>
<td class="org-right">6780</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">2920</td>
<td class="org-right">6780</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">4380</td>
<td class="org-right">6780</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">2920</td>
<td class="org-right">8760</td>
</tr>
</tbody>
</table>


<div id="orgfb120b9" class="figure">
<p><img src="code/ch3-ws-tcp/9-buf.svg" alt="9-buf.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>
</ul></li>

<li><p>
Are there any retransmitted segments in the trace file? What did you check for (in the trace) in order to answer this question?<br />
</p>

<p>
没有重传的分组。通过观察发送方的分组序号：如果有重传的分组，那么序号序列里会出现小于或等于前一序号的分组。<br />
</p>


<div id="orgf35dcc2" class="figure">
<p><img src="code/ch3-ws-tcp/10-seqnum.svg" alt="10-seqnum.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>

<li>&#x00ad;<br />

<ul class="org-ul">
<li><p>
How much data does the receiver typically acknowledge in an ACK?<br />
</p>

<p>
1460, 2352, 2920.<br />
</p>


<div id="org66d1259" class="figure">
<p><img src="code/ch3-ws-tcp/11-ackdata.svg" alt="11-ackdata.svg" class="org-svg" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>

<li><p>
Can you identify cases where the receiver is ACKing every other received segment (见160页表3.2).<br />
</p>

<p>
观察接收方的确认号可以发现没有失序的报文。因此立即发送确认信号的情况只剩一种：具有所期望序号的按序报文段到达，另一个按序报文段等待ACK传输。<br />
</p></li>
</ul></li>

<li><p>
&#x00ad;<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
    199 5.297341       192.168.1.102         128.119.245.12        HTTP     104    POST /ethereal-labs/lab3-1-reply.htm HTTP/1.1  (text/plain)

Frame 199: 104 bytes on wire (832 bits), 104 bytes captured (832 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.119.245.12
Transmission Control Protocol, <span class="org-variable-name">Src</span> Port: 1161, <span class="org-variable-name">Dst</span> Port: 80, <span class="org-variable-name">Seq</span>: 164041, <span class="org-variable-name">Ack</span>: 1, <span class="org-variable-name">Len</span>: 50
[122 Reassembled TCP Segments (164090 bytes): #4(565), #5(1460), #7(1460), #8(1460), #10(1460), #11(1460), #13(1147), #18(1460), #19(1460), #20(1460), #21(1460), #22(1460), #23(892), #30(1460), #31(1460), #32(1460), #33(1460), #34(1460), #3]
Hypertext Transfer Protocol
MIME Multipart Media Encapsulation, <span class="org-variable-name">Type</span>: multipart/form-data, <span class="org-variable-name">Boundary</span>: <span class="org-string">"---------------------------265001916915724"</span>
</pre>
</div>

<p>
What is the throughput (bytes transferred per unit time) for the TCP connection? Explain how you calculated this value.<br />
</p>

<p>
164090byte / 5.297341s ≈ 247Kbps.<br />
</p></li>

<li><p>
Can you identify where TCP’s slowstart phase begins and ends, and where congestion avoidance takes over? Comment on ways in which the measured data differs from the idealized behavior of TCP that we’ve studied in the text.<br />
</p>

<p>
0~0.25s之间是慢启动阶段。0.25~0.5s进入拥塞避免阶段。<br />
</p>

<p>
拥塞避免阶段并没有像书中描述的那样在每个RTT将拥塞窗口扩大一个MSS，而是一直保持发送6个分组。<br />
</p>


<div id="orga7ef01f" class="figure">
<p><img src="code/ch3-ws-tcp/13-ts.png" alt="13-ts.png" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>

<li><p>
Answer each of two questions above for the trace that you have gathered when you transferred a file from your computer to gaia.cs.umass.edu<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">单位时间</th>
<th scope="col" class="org-right">发送的分组数量</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">10</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">22</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">47</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">65</td>
</tr>
</tbody>
</table>

<p>
可以看出一直到文件传输结束都一直处于慢启动阶段。<br />
</p>


<div id="orgcf639d1" class="figure">
<p><img src="code/ch3-ws-tcp/14-ts.png" alt="14-ts.png" style="width:100%; max-width:600px;" /><br />
</p>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org413b264" class="outline-3">
<h3 id="org413b264"><span class="section-number-3">3.6.</span> Wireshark实验：探究UDP</h3>
<div class="outline-text-3" id="text-3-6">
<p>
在这个简短实验中，你将进行分组俘获并分析那些使用UDP的你喜爱的应用程序（例如，DNS或如Skype这样的多媒体应用）。如我们在3.3节中所学的那样，UDP是一种简单的、不提供不必要服务的运输协议。在这个实验中，你将研究在UDP报文段中的各首部字段以及检验和计算。<br />
</p>

<p>
<a href="code/ch3-udp/wireshark-udp-v7.0.pdf">Wireshark Lab: UDP v7.0</a><br />
</p>

<ol class="org-ol">
<li><p>
Select one UDP packet from your trace. From this packet, determine how many fields there are in the UDP header. (You shouldn’t look in the textbook! Answer these questions directly from what you observe in the packet trace.) Name these fields.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     15 8.628758       fe80::cab:21fb:bf60:9847 fe80::96e9:eeff:fe68:6c29 DNS      100    Standard query 0xf831 A bag.itunes.apple.com

Frame 15: 100 bytes on wire (800 bits), 100 bytes captured (800 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 6, <span class="org-variable-name">Src</span>: fe80::cab:21fb:bf60:9847, <span class="org-variable-name">Dst</span>: fe80::96e9:eeff:fe68:6c29
User Datagram Protocol, <span class="org-variable-name">Src</span> Port: 57194, <span class="org-variable-name">Dst</span> Port: 53
    Source Port: 57194
    Destination Port: 53
    Length: 46
    Checksum: 0xea8e [unverified]
    [Checksum Status: Unverified]
    [Stream index: 2]
    [Timestamps]
    UDP payload (38 bytes)
Domain <span class="org-type">Name</span> <span class="org-function-name">System</span> (query)

0000  94 e9 ee 68 6c 29 00 1e 10 1f 00 00 86 dd 60 0f   ...hl)........`.
0010  0d 00 00 2e 11 40 fe 80 00 00 00 00 00 00 0c ab   .....@..........
0020  21 fb bf 60 98 47 fe 80 00 00 00 00 00 00 96 e9   <span class="org-negation-char">!</span>..`.G..........
0030  ee ff fe 68 6c 29 df 6a 00 35 00 2e ea 8e f8 31   ...hl).j.5.....1
0040  01 00 00 01 00 00 00 00 00 00 03 62 61 67 06 69   ...........bag.i
0050  74 75 6e 65 73 05 61 70 70 6c 65 03 63 6f 6d 00   tunes.apple.com.
0060  00 01 00 01                                       ....
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">首部字段</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Source Port</td>
</tr>

<tr>
<td class="org-left">Destination Port</td>
</tr>

<tr>
<td class="org-left">Length</td>
</tr>

<tr>
<td class="org-left">Checksum</td>
</tr>
</tbody>
</table></li>

<li><p>
By consulting the displayed information in Wireshark’s packet content field for this packet, determine the length (in bytes) of each of the UDP header fields.<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">头部字段</th>
<th scope="col" class="org-left">内容</th>
<th scope="col" class="org-right">长度 Byte</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Source Port</td>
<td class="org-left">df6a</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">Destination Port</td>
<td class="org-left">0035</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">Length</td>
<td class="org-left">002e</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">Checksum</td>
<td class="org-left">ea8e</td>
<td class="org-right">2</td>
</tr>
</tbody>
</table></li>

<li><p>
The value in the Length field is the length of what? (You can consult the text for this answer). Verify your claim with your captured UDP packet.<br />
</p>

<p>
从第一个首部字段Source Port开始（df6a ）到payload结束（0001）的整个UDP报文段的长度。<br />
</p></li>

<li><p>
What is the maximum number of bytes that can be included in a UDP payload?<br />
</p>

<p>
38 bytes.<br />
</p></li>

<li><p>
What is the largest possible source port number?<br />
</p>

<p>
2字节的source port首部可表示的范围是0~65535。<br />
</p></li>

<li><p>
What is the protocol number for UDP? Give your answer in both hexadecimal and decimal notation. To answer this question, you’ll need to look into the Protocol field of the IP datagram containing this UDP segment (see Figure 4.13 in the text, and the discussion of IP header fields).<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     15 8.628758       fe80::cab:21fb:bf60:9847 fe80::96e9:eeff:fe68:6c29 DNS      100    Standard query 0xf831 A bag.itunes.apple.com

Frame 15: 100 bytes on wire (800 bits), 100 bytes captured (800 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 6, <span class="org-variable-name">Src</span>: fe80::cab:21fb:bf60:9847, <span class="org-variable-name">Dst</span>: fe80::96e9:eeff:fe68:6c29
    0110 .... = Version: 6
    .... 0000 0000 .... .... .... .... .... = Traffic Class: 0x00 (DSCP: CS0, ECN: Not-ECT)
    .... .... .... 1111 0000 1101 0000 0000 = Flow Label: 0xf0d00
    Payload Length: 46
    Next Header: UDP (17)
    <span class="org-type">Hop</span> <span class="org-variable-name">Limit</span>: 64
    Source Address: fe80::cab:21fb:bf60:9847
    Destination Address: fe80::96e9:eeff:fe68:6c29
    [Destination SA MAC: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)]
User Datagram Protocol, <span class="org-variable-name">Src</span> Port: 57194, <span class="org-function-name">Dst</span> Port: 53
Domain Name System (query)

0000  94 e9 ee 68 6c 29 00 1e 10 1f 00 00 86 dd 60 0f   ...hl)........`.
0010  0d 00 00 2e 11 40 fe 80 00 00 00 00 00 00 0c ab   .....@..........
0020  21 fb bf 60 98 47 fe 80 00 00 00 00 00 00 96 e9   <span class="org-negation-char">!</span>..`.G..........
0030  ee ff fe 68 6c 29 df 6a 00 35 00 2e ea 8e f8 31   ...hl).j.5.....1
0040  01 00 00 01 00 00 00 00 00 00 03 62 61 67 06 69   ...........bag.i
0050  74 75 6e 65 73 05 61 70 70 6c 65 03 63 6f 6d 00   tunes.apple.com.
0060  00 01 00 01                                       ....
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">首部</td>
<td class="org-right">十进制</td>
<td class="org-right">十六进制</td>
</tr>

<tr>
<td class="org-left">Next Header: UDP (17)</td>
<td class="org-right">17</td>
<td class="org-right">11</td>
</tr>
</tbody>
</table></li>

<li><p>
Examine a pair of UDP packets in which your host sends the first UDP packet and the second UDP packet is a reply to this first UDP packet. (Hint: for a second packet to be sent in response to a first packet, the sender of the first packet should be the destination of the second packet). Describe the relationship between the port numbers in the two packets.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     15 8.628758       fe80::cab:21fb:bf60:9847 fe80::96e9:eeff:fe68:6c29 DNS      100    Standard query 0xf831 A bag.itunes.apple.com

Frame 15: 100 bytes on wire (800 bits), 100 bytes captured (800 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 6, <span class="org-variable-name">Src</span>: fe80::cab:21fb:bf60:9847, <span class="org-variable-name">Dst</span>: fe80::96e9:eeff:fe68:6c29
User Datagram Protocol, <span class="org-variable-name">Src</span> Port: 57194, <span class="org-function-name">Dst</span> Port: 53
Domain Name System (query)

No.     Time           Source                Destination           Protocol Length Info
     18 8.689860       fe80::96e9:eeff:fe68:6c29 fe80::cab:21fb:bf60:9847 DNS      521    Standard query response 0xf831 A bag.itunes.apple.com CNAME init-cdn.itunes-apple.com.akadns.net CNAME init-china.itunes-apple.com.akadns.net CNAME init.itunes.apple.com.mwcname.com A 125.77.130.19 A 113.96.147.50 A 116.211.251.31 A 113.96.140.109 A 183.6.248.180 NS dns5.cdn30.org NS dns3.wscloudcdn.org NS dns1.wscloudcdn.org NS dns2.mwcloudcdn.info NS dns4.mwcloudcdn.info A 101.227.98.160 A 61.136.167.99 A 183.131.124.31 A 121.12.91.34 AAAA 240e:e1:9600:20c::33

Frame 18: 521 bytes on wire (4168 bits), 521 bytes captured (4168 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), <span class="org-function-name">Dst</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 6, <span class="org-variable-name">Src</span>: fe80::96e9:eeff:fe68:6c29, <span class="org-variable-name">Dst</span>: fe80::cab:21fb:bf60:9847
User Datagram Protocol, <span class="org-variable-name">Src</span> Port: 53, <span class="org-function-name">Dst</span> Port: 57194
Domain Name System (response)
</pre>
</div>

<p>
源端口和目的端口对调。<br />
</p></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org8344628" class="outline-2">
<h2 id="org8344628"><span class="section-number-2">4.</span> 网络层：数据平面</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org4a9a75f" class="outline-3">
<h3 id="org4a9a75f"><span class="section-number-3">4.1.</span> 复习题</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-org7e54060" class="outline-4">
<h4 id="org7e54060">R1 路由器和链路层交换机的区别</h4>
<div class="outline-text-4" id="text-org7e54060">
<p>
我们回顾在本书中使用的某些术语。前面讲过运输层的分组名字是报文段，数据链路层的分组名字是帧。网络层的分组名字是什么？前面讲过路由器和链路层交换机都被称为分组交换机。路由器与链路层交换机间的根本区别是什么？<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 4:</span> p.34</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">协议栈层次</th>
<th scope="col" class="org-left">分组名称</th>
<th scope="col" class="org-left">英文</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">应用层</td>
<td class="org-left">报文</td>
<td class="org-left">message</td>
</tr>

<tr>
<td class="org-left">运输层</td>
<td class="org-left">报文段</td>
<td class="org-left">segment</td>
</tr>

<tr>
<td class="org-left">网络层</td>
<td class="org-left">数据报</td>
<td class="org-left">datagram</td>
</tr>

<tr>
<td class="org-left">链路层</td>
<td class="org-left">帧</td>
<td class="org-left">frame</td>
</tr>
</tbody>
</table>

<p>
首先，路由器与链路层交换机都是分组交换机，它们根据分组首部字段中的值，从输入链路接口到输出链路接口转移分组。<br />
</p>

<p>
区别在于，链路层交换机基于链路层帧中的字段值做出转发决定，是链路层（第2层）设备。路由器基于网络层数据报中的首部字段值做出转发决定。是网络层（第3层）设备。（p.203）<br />
</p>
</div>
</div>

<div id="outline-container-orgea5ab61" class="outline-4">
<h4 id="orgea5ab61">R2 数据平面和控制平面的功能</h4>
<div class="outline-text-4" id="text-orgea5ab61">
<p>
我们注意到网络层功能可被大体分成数据平面功能和控制平面功能。数据平面的主要功能是什么？控制平面的主要功能呢？<br />
</p>

<p>
数据平面功能决定到达路由器输入链路之一的数据报如何转发到该路由器的输出链路之一。控制平面功能控制数据报沿着从源主机到目的主机的端到端路径中路由器之间的路由方式。（p.198）<br />
</p>
</div>
</div>

<div id="outline-container-org81a6772" class="outline-4">
<h4 id="org81a6772">R3 路由选择和转发的区别</h4>
<div class="outline-text-4" id="text-org81a6772">
<p>
我们对网络层执行的转发功能和路由选择功能进行区别。路由选择和转发的主要区别是什么？<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 5:</span> 路由选择和转发的区别（p.200）</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">功能</th>
<th scope="col" class="org-left">目的</th>
<th scope="col" class="org-left">性质</th>
<th scope="col" class="org-left">时间尺度</th>
<th scope="col" class="org-left">实现方式</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">转发</td>
<td class="org-left">将分组从一个输入链路接口转移到适当的输出链路接</td>
<td class="org-left">路由器本地动作</td>
<td class="org-left">几纳秒</td>
<td class="org-left">硬件</td>
</tr>

<tr>
<td class="org-left">路由选择</td>
<td class="org-left">确定分组从源到目的地所采取的端到端路径</td>
<td class="org-left">网络范围处理过层</td>
<td class="org-left">几秒</td>
<td class="org-left">软件</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgd0f8eca" class="outline-4">
<h4 id="orgd0f8eca">R4 转发表的作用</h4>
<div class="outline-text-4" id="text-orgd0f8eca">
<p>
路由器中转发表的主要作用是什么？<br />
</p>

<p>
路由器检查到达分组首部的一个或多个字段值，进而使用这些首部值在其转发表中索引，通过这种方法来转发分组。这些值对应存储在转发表项中的值，指出了该分组将被转发的路由器的输出链路接口。（p.200）<br />
</p>
</div>
</div>

<div id="outline-container-org73f0d5e" class="outline-4">
<h4 id="org73f0d5e">R5 网络层的服务模型</h4>
<div class="outline-text-4" id="text-org73f0d5e">
<p>
我们说过网络层的服务模型”定义发送主机和接收主机之间端到端分组的传送特性”。因特网的网络层的服务模型是什么？就主机到主机数据报的传递而论，因特网的服务模型能够保证什么？<br />
</p>

<p>
使用尽力而为服务，传送的分组既不能保证以它们发送的顺序被接收，也不能保证它们最终交付；既不能保证端到端时延，也不能保证有最小的带宽。（p.202）<br />
</p>
</div>
</div>

<div id="outline-container-org1607da7" class="outline-4">
<h4 id="org1607da7">R6 数据平面和控制平面的软硬件实现</h4>
<div class="outline-text-4" id="text-org1607da7">
<p>
在4.2节中，我们看到路由器通常由输入端口、输出端口、交换结构和路由选择处理器组成。其中哪些是用硬件实现的，哪些是用软件实现的？为什么？转到网络层的数据平面和控制平面的概念，哪些是用硬件实现的，哪些是用软件实现的？为什么？<br />
</p>

<p>
构成数据平面的输入端口、输出端口和交换结构用硬件实现，因为它们以纳秒尺度运行，远远快过软件实现的速率。<br />
</p>

<p>
路由器的控制功能以毫秒或秒时间尺度运行，这些控制功能包括执行路由选择协议、对上线或下线的连接链路进行响应、与远程控制器通信和执行管理功能。因而这些控制平面的功能通常用软件实现并在路由选择处理器上执行。（p.204）<br />
</p>
</div>
</div>

<div id="outline-container-org1cc568d" class="outline-4">
<h4 id="org1cc568d">R7 转发表的影子副本</h4>
<div class="outline-text-4" id="text-org1cc568d">
<p>
讨论为什么在高速路由器的每个输入端口都存储转发表的影子副本。<br />
</p>

<p>
使用在每个输入端口的影子副本，转发决策能在每个输入端口本地做出，无须基于每个分组调用集中式路由选择处理器，因此避免了集中式处理的瓶颈。<br />
</p>
</div>
</div>

<div id="outline-container-orgc9aaca7" class="outline-4">
<h4 id="orgc9aaca7">R8 基于目的转发和通用转发</h4>
<div class="outline-text-4" id="text-orgc9aaca7">
<p>
基于目的地转发意味着什么？这与通用转发有什么不同（假定你已经阅读4.4节，两种方法中哪种是软件定义网络所采用的）？<br />
</p>

<p>
基于目的地转发意味着转发基于数据报的目的地址进行；通用转发和其他功能可以使用数据报首部中的几个不同的字段值来进行。软件定义网络采用通用转发。（p.231）<br />
</p>
</div>
</div>

<div id="outline-container-orgdbd3bae" class="outline-4">
<h4 id="orgdbd3bae">R9 最长前缀匹配</h4>
<div class="outline-text-4" id="text-orgdbd3bae">
<p>
假设一个到达分组匹配了路由器转发表中的两个或更多表项。采用传统的基于目的地转发，路由器用什么原则来确定这条规则可以用于确定输出端口，使得到达的分组能交换到输出端口？<br />
</p>

<p>
最长前缀匹配规则。<br />
</p>
</div>
</div>

<div id="outline-container-orgac9b028" class="outline-4">
<h4 id="orgac9b028">R10 三种交换结构</h4>
<div class="outline-text-4" id="text-orgac9b028">
<p>
在4.2节中讨论了三种交换结构。列出并简要讨论每一种交换结构。哪一种（如果有的话）能够跨越交换结构并行发送多个分组？<br />
</p>

<ol class="org-ol">
<li>经内存交换<br />
<ul class="org-ul">
<li>过程：①一个分组到达一个输人端口时，该端口会先通过中断方式向路由选择处理器发出信号。②该分组从输入端口处被复制到处理器内存中。③路由选择处理器则从其首部中提取目的地址，在转发表中找出适当的输出端口，并将该分组复制到输出端口的缓存中。<br /></li>
<li>带宽：小于内存带宽的一半。<br /></li>
<li>是否阻塞：阻塞的，经共享系统总线一次仅能执行一个内存读写。<br /></li>
</ul></li>
<li>经总线交换<br />
<ul class="org-ul">
<li>过程：①让输入端口为分组预先计划一个交换机内部标签（首部），指示本地输出端口，使分组在总线上传送和传输到输出端口。②该分组能由所有输出端口收到，但只有与该标签匹配的端口才能保存该分组。③然后标签在输出端口被去除，因为其仅用于交换机内部来跨越总线。<br /></li>
<li>带宽：受总线速率限制。<br /></li>
<li>是否阻塞：阻塞的，一次只有一个分组能够跨越总线。<br /></li>
</ul></li>
<li>经互联网络交换<br />
<ul class="org-ul">
<li>过程：每条垂直的总线在交叉点与每条水平的总线交叉，交叉点通过交换结构控制器（其逻辑是交换结构自身的一部分）能够在任何时候开启和闭合。<br /></li>
<li>是否阻塞：如果来自两个不同输入端口的两个分组其目的地为相同的输出端口，则阻塞；否则不阻塞。<br /></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org2ffbbe7" class="outline-4">
<h4 id="org2ffbbe7">R11 输入端口分组丢失</h4>
<div class="outline-text-4" id="text-org2ffbbe7">
<p>
描述在输入端口会出现分组丢失的原因。描述在输入端口如何消除分组丢失（不使用无限大缓存区）。<br />
</p>

<p>
交换结构的速度小于总的输入线路速度。提高交换结构的速度。<br />
</p>
</div>
</div>

<div id="outline-container-orga7ce6cf" class="outline-4">
<h4 id="orga7ce6cf">R12 输出端口分组丢失</h4>
<div class="outline-text-4" id="text-orga7ce6cf">
<p>
描述在输出端口会出现分组丢失的原因。通过提高交换结构速率，能够防止这种丢失吗？<br />
</p>

<p>
分组到达输出端口的速度大于输出端口的传输速度。不能。<br />
</p>
</div>
</div>

<div id="outline-container-orgbbf7a64" class="outline-4">
<h4 id="orgbbf7a64">R13 HOL阻塞</h4>
<div class="outline-text-4" id="text-orgbbf7a64">
<p>
什么是HOL阻塞？它出现在输入端口还是输出端口？<br />
</p>

<p>
在一个输入队列中排队的分组必须等待通过交换结构发送，因为它被位于线路前部的另一个分组所阻塞。<br />
</p>
</div>
</div>

<div id="outline-container-org9073c88" class="outline-4">
<h4 id="org9073c88">R14 分组调度规则</h4>
<div class="outline-text-4" id="text-org9073c88">
<p>
在4.2节我们学习了FIFO、优先权、循环（RR）和加权公平排队（WFQ）分组调度规则。这些排队规则中，哪个规则确保所有分组是以到达的次序离开的？<br />
</p>

<p>
FIFO。<br />
</p>
</div>
</div>

<div id="outline-container-org1e2ce27" class="outline-4">
<h4 id="org1e2ce27">R15 分组的优先权</h4>
<div class="outline-text-4" id="text-org1e2ce27">
<p>
举例说明为什么网络操作员要让一类分组的优先权超过另一类分组的。<br />
</p>

<p>
基于IP的实时话音分组可能获得超过非实时流量（如SMTP或IMAP电子邮件分组）的优先权。<br />
</p>
</div>
</div>

<div id="outline-container-orgb40de8c" class="outline-4">
<h4 id="orgb40de8c">R16 循环和加权公平排队</h4>
<div class="outline-text-4" id="text-orgb40de8c">
<p>
RR和WFQ分组调度之间的基本差异是什么？存在RR和WFQ将表现得完全相同的场合吗？（提示：考虑WFQ权重。）<br />
</p>

<p>
对于RR，循环调度器在每个类之间轮流提供服务。对于WFQ，每个类得到的服务数量取决于其权重。<br />
</p>

<p>
如果每个类的权重相同，那么WFQ将表现得与RR一样。<br />
</p>
</div>
</div>

<div id="outline-container-org075cc2d" class="outline-4">
<h4 id="org075cc2d">R17 IP数据报格式</h4>
<div class="outline-text-4" id="text-org075cc2d">
<p>
假定主机A向主机B发送封装在一个IP数据报中的TCP报文段。当主机B接收到该数据报时，主机B中的网络层怎样知道它应当将该报文段（即数据报的有效载荷）交给TCP而不是UDP或某个其他东西呢？<br />
</p>

<p>
IPv4的上层协议，IPv6的下一个首部。<br />
</p>
</div>
</div>

<div id="outline-container-orgf4fdc8b" class="outline-4">
<h4 id="orgf4fdc8b">R18</h4>
<div class="outline-text-4" id="text-orgf4fdc8b">
<p>
在IP首部中，哪个字段能用来确保一个分组的转发不超过N台路由器？<br />
</p>

<p>
TTL。<br />
</p>
</div>
</div>

<div id="outline-container-org74e002b" class="outline-4">
<h4 id="org74e002b">R19 与运输层检验和的区别</h4>
<div class="outline-text-4" id="text-org74e002b">
<p>
前面讲过因特网检验和被用于运输层报文段（分别在图3-7和图3-29的UDP和TCP首部中）以及网络层数据报（图4-16的IP首部中）。现在考虑一个运输层报文段封装在一个IP数据报中。在报文段首部和数据报首部中的检验和要遍及IP数据报中的任何共同字节进行计算吗？<br />
</p>

<p>
IP数据报的检验和仅检验IP数据报的首部，运输层报文段的检验和检验TCP或UDP报文段，位于IP数据报的载荷部分，所以这两种检验和没有计算共同的字节。<br />
</p>
</div>
</div>

<div id="outline-container-org234a681" class="outline-4">
<h4 id="org234a681">R20 分片</h4>
<div class="outline-text-4" id="text-org234a681">
<p>
什么时候一个大数据报分割成多个较小的数据报？较小的数据报在什么地方装配成一个较大的数据报？<br />
</p>

<p>
数据报从一条链路传输到另一条具有更小MTU的链路层协议的链路。端系统。<br />
</p>
</div>
</div>

<div id="outline-container-orgbecb13d" class="outline-4">
<h4 id="orgbecb13d">R21 接口与IP地址</h4>
<div class="outline-text-4" id="text-orgbecb13d">
<p>
路由器有IP地址吗？如果有，有多少个？<br />
</p>

<p>
路由器的每一个接口有一个IP地址。<br />
</p>
</div>
</div>

<div id="outline-container-orgac62090" class="outline-4">
<h4 id="orgac62090">R22</h4>
<div class="outline-text-4" id="text-orgac62090">
<p>
IP地址223.1.3.27的32比特二进制等价形式是什么？<br />
</p>

<p>
1101 1111 0000 0001 0000 0011 0001 1011<br />
</p>
</div>
</div>

<div id="outline-container-orge1afbcd" class="outline-4">
<h4 id="orge1afbcd">R23</h4>
<div class="outline-text-4" id="text-orge1afbcd">
<p>
考察使用DHCP的主机，获取它的IP地址、网络掩码、默认路由器及其本地DNS服务器的IP地址。列出这些值。<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">IP地址</td>
<td class="org-right">192.168.8.100</td>
</tr>

<tr>
<td class="org-left">子网掩码</td>
<td class="org-right">255.255.255.0</td>
</tr>

<tr>
<td class="org-left">路由器</td>
<td class="org-right">192.168.8.1</td>
</tr>

<tr>
<td class="org-left">DNS服务器</td>
<td class="org-right">198.18.0.2</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org9c64c5c" class="outline-4">
<h4 id="org9c64c5c">R24</h4>
<div class="outline-text-4" id="text-org9c64c5c">
<p>
假设在一个源主机和一个目的主机之间有3台路由器。不考虑分片，一个从源主机发送给目的主机的IP数据报将通过多少个接口？为了将数据报从源移动到目的地需要检索多少个转发表？<br />
</p>

<p>
(每个路由器2个)*3+端系统1个*2 = 8个接口<br />
</p>

<p>
3个转发表<br />
</p>
</div>
</div>

<div id="outline-container-org0e2e6a6" class="outline-4">
<h4 id="org0e2e6a6">R25</h4>
<div class="outline-text-4" id="text-org0e2e6a6">
<p>
假设某应用每20ms生成一个40字节的数据块，每块封装在一个TCP报文段中，TCP报文段再封装在一个IP数据报中。每个数据报的开销有多大？应用数据所占百分比是多少？<br />
</p>

<p>
40字节数据+20字节TCP首部+20字节IP首部 = 80字节<br />
</p>

<p>
应用数据占比40/80=50%<br />
</p>
</div>
</div>

<div id="outline-container-org3e32423" class="outline-4">
<h4 id="org3e32423">R26</h4>
<div class="outline-text-4" id="text-org3e32423">
<p>
假定你购买了一个无线路由器并将其与电缆调制解调器相连。同时假定ISP动态地为你连接的设备（即你的无线路由器）分配一个IP地址。还假定你家有5台PC，均使用802.11以无线方式与该无线路由器相连。怎样为这5台PC分配IP地址？该无线路由器使用NAT吗？为什么？<br />
</p>

<p>
通常，无线路由器包括一个DHCP服务器。DHCP被用来给5台PC和路由器接口分配IP地址。是的，无线路由器也使用NAT，因为它只从ISP那里获得一个IP地址。<br />
</p>
</div>
</div>

<div id="outline-container-orgad4c893" class="outline-4">
<h4 id="orgad4c893">R27 路由聚合</h4>
<div class="outline-text-4" id="text-orgad4c893">
<p>
“路由聚合”一词意味着什么？路由器执行路由聚合为什么是有用的？<br />
</p>

<p>
路由聚合指使用单个网络前缀通告多个网络的能力。<br />
当地址按块分给ISP，然后又由ISP分给客户组织时，地址聚合工作极为有效。<br />
</p>
</div>
</div>

<div id="outline-container-org0c434c0" class="outline-4">
<h4 id="org0c434c0">R28</h4>
<div class="outline-text-4" id="text-org0c434c0">
<p>
“即插即用”或“零配置”协议意味着什么？<br />
</p>

<p>
将主机连接进一个网络的网络相关方面的自动能力。<br />
</p>
</div>
</div>

<div id="outline-container-org17ca912" class="outline-4">
<h4 id="org17ca912">R29 专用网络地址</h4>
<div class="outline-text-4" id="text-org17ca912">
<p>
什么是专用网络地址？具有专用网络地址的数据报会出现在大型公共因特网中吗？解释理由。<br />
</p>

<p>
专用网络地址是指一个只对该网络中的设备有意义的网络地址。带有专用网络地址的数据报不应该出现在公共互联网上，因为专用网络地址有可能被许多网络设备在自己的专用网络中使用。<br />
</p>
</div>
</div>

<div id="outline-container-org7633559" class="outline-4">
<h4 id="org7633559">R30 IP首部</h4>
<div class="outline-text-4" id="text-org7633559">
<p>
比较并对照IPv4和IPv6首部字段。它们有相同的字段吗？<br />
</p>

<p>
IPv6有一个固定长度的首部，它不包括IPv4首部可以包括的可选选项。尽管IPv6首部含两个128位的地址（源和目的IP地址），但整个头只有40字节的固定长度。其中有几个字段的作用是相似的。IPv6中的流量类型、有效载荷长度、下一个首部和跳限制分别与IPv4中的服务类型、数据报长度、上层协议和寿命相似。<br />
</p>
</div>
</div>

<div id="outline-container-orgab9451a" class="outline-4">
<h4 id="orgab9451a">R31 隧道</h4>
<div class="outline-text-4" id="text-orgab9451a">
<p>
有人说当IPv6以隧道形式通过IPv4路由器时，IPv6将IPv4隧道作为链路层协议。你同意这种说法吗？为什么？<br />
</p>

<p>
同意。借助于隧道，在隧道发送端的IPv6节点可将整个IPv6数据报放到一个1Pv4数据报的数据字段中。（p.230）<br />
</p>
</div>
</div>

<div id="outline-container-org512477d" class="outline-4">
<h4 id="org512477d">R32 通用转发与基于目的地转发的区别</h4>
<div class="outline-text-4" id="text-org512477d">
<p>
通用转发与基于目的地转发有何不同？<br />
</p>

<p>
通用转发能够对协议栈的多个首部字段进行匹配，而基于目的转发仅仅基于分组的目的地址。（p.231）<br />
</p>
</div>
</div>

<div id="outline-container-org1a24cd8" class="outline-4">
<h4 id="org1a24cd8">R33</h4>
<div class="outline-text-4" id="text-org1a24cd8">
<p>
我们在4.1节遇到的基于目的地转发与在4.4节遇到的OpenFlow流表之间有什么差异？<br />
</p>


<div id="org9c72381" class="figure">
<p><img src="img/fig4-3.png" alt="fig4-3.png" style="width:100%; max-width:650px;" /><br />
</p>
</div>


<div id="org3081032" class="figure">
<p><img src="img/fig4-28.png" alt="fig4-28.png" style="width:100%; max-width:650px;" /><br />
</p>
</div>

<p>
转发有两个主要操作：匹配和动作。使用基于目的地的转发，路由器的匹配操作只查找待转发数据报的目的IP地址，路由器的动包括将数据报通过交换结构发送到指定输出端口。<br />
</p>

<p>
使用通用转发，能够对协议栈的多个首部字段进行匹配，这些首部字段是与不同层次的不同协议相关联的。动作能够包括：将分组转发到一个或多个输出端口（就像在基于目的地转发中一样），跨越多个通向服务的离开接口进行负载均衡分组（就像在负载均衡中一样），重写首部值（就像在NAT中一样），有意识地阻挡／丢弃某个分组（就像在防火墙中一样），为进一步处理和动作而向某个特定的服务器发送一个分组（就像在DPI一样），等等。<br />
</p>
</div>
</div>

<div id="outline-container-org79a1e9e" class="outline-4">
<h4 id="org79a1e9e">R34</h4>
<div class="outline-text-4" id="text-org79a1e9e">
<p>
路由器或交换机的“匹配加动作”意味着什么？在基于目的地转发的分组交换机场合中，要匹配什么并采取什么动作？在SDN的场合中，举出3个能够被匹配的字段和3个能被采取的动作。<br />
</p>

<p>
“匹配加行动”是指路由器或交换机试图找到数据报的一些首部与流表中的一些条目之间的匹配，然后根据这种匹配，路由器决定将数据包转发到哪个（些）接口，甚至对数据包进行一些其他操作。在基于目的地转发的数据报交换中，路由器只试图找到转发表条目与到达的数据报的目的IP地址之间的匹配，而行动是决定将数据包转发到哪个接口。在SDN的情况下，有许多字段可以匹配，例如，IP源地址、TCP源端口和源MAC地址；也有许多行动可以采取，例如，转发、丢弃和修改一个字段值。<br />
</p>
</div>
</div>

<div id="outline-container-org6832673" class="outline-4">
<h4 id="org6832673">R35</h4>
<div class="outline-text-4" id="text-org6832673">
<p>
在IP数据报中举出能够在OpenFlow 1.0通用转发中“匹配”的3个首部字段。不能在OpenFlow中“匹配”的3个IP数据报首部字段是什么？<br />
</p>

<p>
IP源地址、TCP源端口和源MAC地址。<br />
TTL字段、数据报长度字段、首部校验和（取决于TTL字段）。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org9a90aaf" class="outline-3">
<h3 id="org9a90aaf"><span class="section-number-3">4.2.</span> 习题</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org44bc230" class="outline-4">
<h4 id="org44bc230">P1 基于目的地转发的限制</h4>
<div class="outline-text-4" id="text-org44bc230">
<p>
考虑下面的网络。<br />
</p>
<ol class="org-ol">
<li>显示路由器A中的转发表，使得目的地为主机H3的所有流量都通过接口3转发。<br /></li>
<li>写出路由器A中的转发表，使得从H1发往主机H3的所有流量都通过接口3转发，从H2发往主机H3的所有流量都通过接口4转发。（提示：这是一个技巧性的问题。）<br /></li>
</ol>



<div id="orge8cf84c" class="figure">
<p><img src="img/ch4-p1.png" alt="ch4-p1.png" style="width:100%; max-width:400px;" /><br />
</p>
</div>

<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">目的地址</th>
<th scope="col" class="org-right">输出</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">H3</td>
<td class="org-right">3</td>
</tr>
</tbody>
</table></li>

<li>路由器使用基于目的地转发时只能根据目的地转发数据报，因此不能根据不同源主机将数据报转发到不同接口。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org7ecaaab" class="outline-4">
<h4 id="org7ecaaab">P2</h4>
<div class="outline-text-4" id="text-org7ecaaab">
<p>
假设两个分组在完全相同的时刻到达一台路由器的两个不同输入端口。同时假设在该路由器中没有其他分组。<br />
</p>
<ol class="org-ol">
<li>假设这两个分组朝着两个不同的输出端口转发。当交换结构使用一条共享总线时，这两个分组可能在相同时刻通过该交换结构转发吗？<br /></li>
<li>假设这两个分组朝着两个不同的输出端口转发。当交换结构使用经内存交换时，这两个分组可能在相同时刻通过该交换结构转发吗？<br /></li>
<li>假设这两个分组朝着相同的输出端口转发。当交换结构使用纵横式时，这两个分组可能在相同时刻通过该交换结构转发吗？<br /></li>
</ol>


<ol class="org-ol">
<li>不能，因为一次只有一个分组能够跨越总线。<br /></li>
<li>不能，因为经过共享系统总线一次仅能执行一个内存读写。<br /></li>
<li>不能，输出端口相同时，相当于共享了一部分总线。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org498f24e" class="outline-4">
<h4 id="org498f24e">P3 交换结构时延</h4>
<div class="outline-text-4" id="text-org498f24e">
<p>
在4.2节中，我们注意到如果交换结构速率是输入线路速率的n倍，其最大的排队时延为(n-1)D。假设所有分组有相同长度，在相同时刻n个分组到达n个输出端口，同时所有n个分组要转发到不同的输出端口。对于内存、总线和纵横式交换结构，一个分组的最大时延是多少？<br />
</p>

<p>
(n-1)D<br />
(n-1)D<br />
0<br />
</p>
</div>
</div>

<div id="outline-container-org5fa36e2" class="outline-4">
<h4 id="org5fa36e2">P4 交换结构调度</h4>
<div class="outline-text-4" id="text-org5fa36e2">
<p>
考虑下列交换机。假设所有数据报具有相同长度，交换机以一种分时隙、同步的方式运行，在一个时隙中一个数据报能够从某输入端口传送到某输出端口。其交换结构是纵横式的，因此在一个时隙中至多一个数据报能够传送到一个给定输出端口，但在一个时隙中不同的输出端口能够接收到来自不同输入端口的数据报，从输入端口到它们的输出端口传送所示的分组，所需的时隙数量最小是多少？此时假定使用你所需要的任何输入排队调度方法（即此时没有HOL阻塞）。假定采用你能够设计的最差情况下的调度方案，且非空输入队列不会空闲，所需的时隙数量最大是多少？<br />
</p>


<div id="org3fba0d9" class="figure">
<p><img src="img/ch4-p4.png" alt="ch4-p4.png" style="width:100%; max-width:420px;" /><br />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">时隙1</th>
<th scope="col" class="org-left">时隙2</th>
<th scope="col" class="org-left">时隙3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><del>X</del></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">X <del>Y</del></td>
<td class="org-left"><del>X</del></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Z Y</td>
<td class="org-left">Z <del>Y</del></td>
<td class="org-left"><del>Z</del></td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">时隙1</th>
<th scope="col" class="org-left">时隙2</th>
<th scope="col" class="org-left">时隙3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><del>X</del></td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">X Y</td>
<td class="org-left">X <del>Y</del></td>
<td class="org-left"><del>X</del></td>
</tr>

<tr>
<td class="org-left">Z <del>Y</del></td>
<td class="org-left"><del>Z</del></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
两种情况都是3个时隙。<br />
</p>
</div>
</div>

<div id="outline-container-org259aade" class="outline-4">
<h4 id="org259aade">P5 地址范围转换为最长前缀匹配</h4>
<div class="outline-text-4" id="text-org259aade">
<p>
考虑使用32比特主机地址的某数据报网络。假定一台路由器具有4条链路，编号为0~3，分组能被转发到如下的各链路接口：<br />
</p>


<div id="orgc176152" class="figure">
<p><img src="img/ch4-p5.png" alt="ch4-p5.png" style="width:100%; max-width:450px;" /><br />
</p>
</div>

<ol class="org-ol">
<li>提供一个具有5个表项的转发表，使用最长前缀匹配，转发分组到正确的链路接口。<br /></li>
<li><p>
描述你的转发表是如何为具有下列目的地址的数据报决定适当的链路接口的。<br />
</p>

<pre class="example" id="org107d896">
11001000 10010001 01010001 01010101
11100001 01000000 11000011 00111100
11100001 10000000 00010001 01110111
</pre></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">目的地址</th>
<th scope="col" class="org-right">链路接口</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">11100000 00</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-left">11100000 01000000</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">1110000</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">11100001 1</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">其他</td>
<td class="org-right">3</td>
</tr>
</tbody>
</table></li>

<li>3<br />
2<br />
3<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org90ebb5f" class="outline-4">
<h4 id="org90ebb5f">P6 最长前缀匹配与地址范围</h4>
<div class="outline-text-4" id="text-org90ebb5f">
<p>
考虑使用8比特主机地址的某数据报网络。假定一台路由器使用最长前缀匹配并具有下列转发表：<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">前缀匹配</th>
<th scope="col" class="org-right">接口</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">00</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">010</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">011</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">3</td>
</tr>
</tbody>
</table>

<p>
对这4个接口中的每个，给出相应的目的主机地址的范围和在该范围中的地址数量。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">前缀匹配</th>
<th scope="col" class="org-left">目的地址范围</th>
<th scope="col" class="org-right">地址数量</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">00</td>
<td class="org-left">0000 0000 ~ 0011 1111</td>
<td class="org-right">2^6</td>
</tr>

<tr>
<td class="org-right">010</td>
<td class="org-left">0100 0000 ~ 0101 1111</td>
<td class="org-right">2^5</td>
</tr>

<tr>
<td class="org-right">011</td>
<td class="org-left">0110 0000 ~ 0111 1111</td>
<td class="org-right">2^5</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-left">1000 0000 ~ 1011 1111</td>
<td class="org-right">2^6</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-left">1100 0000 ~ 1111 1111</td>
<td class="org-right">2^6</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org0be2924" class="outline-4">
<h4 id="org0be2924">P7</h4>
<div class="outline-text-4" id="text-org0be2924">
<p>
考虑使用8比特主机地址的数据报网络。假定一台路由器使用最长前缀匹配并具有下列转发表：<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">前缀匹配</th>
<th scope="col" class="org-right">接口</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">111</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">其他</td>
<td class="org-right">3</td>
</tr>
</tbody>
</table>

<p>
对这4个接口中的每个，给出相应的目的主机地址的范围和在该范围中的地址数量。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">前缀匹配</th>
<th scope="col" class="org-right">前三位</th>
<th scope="col" class="org-left">地址范围</th>
<th scope="col" class="org-right">地址数量</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">110</td>
<td class="org-left">1100 0000 ~ 1101 1111</td>
<td class="org-right">2^5</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">100 101</td>
<td class="org-left">1000 0000 ~ 1011 1111</td>
<td class="org-right">2^6</td>
</tr>

<tr>
<td class="org-right">111</td>
<td class="org-right">111</td>
<td class="org-left">1110 0000 ~ 1111 1111</td>
<td class="org-right">2^5</td>
</tr>

<tr>
<td class="org-right">其他</td>
<td class="org-right">&#xa0;</td>
<td class="org-left">0000 0000 ~ 0111 1111</td>
<td class="org-right">2^7</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org419e25b" class="outline-4">
<h4 id="org419e25b">P8 子网与接口数量</h4>
<div class="outline-text-4" id="text-org419e25b">
<p>
考虑互联3个子网（子网1、子网2和子网3）的一台路由器。假定这3个子网的所有接口要求具有前缀223.1.17/24。还假定子网1要求支持多达60个接口，子网2要求支持多达90个接口，子网3要求支持多达12个接口。提供3个满足这些限制的网络地址（形式为a.b.c.d/x）。<br />
</p>

<p>
223.1.17.0/26<br />
223.1.17.128/25<br />
223.1.17.192/28<br />
</p>
</div>
</div>

<div id="outline-container-org7573491" class="outline-4">
<h4 id="org7573491">P9 子网掩码记法</h4>
<div class="outline-text-4" id="text-org7573491">
<p>
在4.2.1节中给出了一个转发表（使用最长前缀匹配）的例子。使用a.b.c.d/x记法代替二进制字符串记法，重写该转发表。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">二进制记法</th>
<th scope="col" class="org-left">子网掩码记法</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">11001000 00010111 00010</td>
<td class="org-left">200.23.16/21</td>
</tr>

<tr>
<td class="org-left">11001000 00010111 00011000</td>
<td class="org-left">200.23.24/24</td>
</tr>

<tr>
<td class="org-left">11001000 00010111 00011</td>
<td class="org-left">200.23.24/21</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgbc9a548" class="outline-4">
<h4 id="orgbc9a548">P10</h4>
<div class="outline-text-4" id="text-orgbc9a548">
<p>
在习题P5中要求你给出转发表（使用最长前缀匹配）。使用a.b.c.d/x记法代替二进制字符串记法，重写该转发表。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">二进制记法</th>
<th scope="col" class="org-left">子网掩码记法</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">11100000 00</td>
<td class="org-left">224.0/10</td>
</tr>

<tr>
<td class="org-left">11100000 01000000</td>
<td class="org-left">224.64/16</td>
</tr>

<tr>
<td class="org-left">1110000</td>
<td class="org-left">224/7</td>
</tr>

<tr>
<td class="org-left">11100001 1</td>
<td class="org-left">225.128/9</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orge5fe8c6" class="outline-4">
<h4 id="orge5fe8c6">P11</h4>
<div class="outline-text-4" id="text-orge5fe8c6">
<p>
考虑一个具有前缀128.119.40.128/26的子网。给出能被分配给该网络的一个IP地址（形式为XXX.XXX.XXX.XXX）的例子。假定一个ISP拥有形式为128.119.40.64/26的地址块。假定它要从该地址块生成4个子网，每块具有相同数量的IP地址。这4个子网（形式为a.b.c.d/x）的前缀是什么？<br />
</p>

<ol class="org-ol">
<li>128.119.40.128<br /></li>
<li><p>
128.119.40.64/26最后8位是0100 0000，均分给4个子网需要用掉2位：<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">0100 0000</td>
<td class="org-left">128.119.40.64/28</td>
</tr>

<tr>
<td class="org-left">0101 0000</td>
<td class="org-left">128.119.40.80/28</td>
</tr>

<tr>
<td class="org-left">0110 0000</td>
<td class="org-left">128.119.40.96/28</td>
</tr>

<tr>
<td class="org-left">0111 0000</td>
<td class="org-left">128.119.40.112/28</td>
</tr>
</tbody>
</table></li>
</ol>
</div>
</div>

<div id="outline-container-org596b1c5" class="outline-4">
<h4 id="org596b1c5">P12 子网划分</h4>
<div class="outline-text-4" id="text-org596b1c5">
<p>
考虑图4-20中显示的拓扑。（在12:00以顺时针开始）标记具有主机的3个子网为网络A、B和C，标记没有主机的子网为网络D、E和F。<br />
</p>
<ol class="org-ol">
<li>为这6个子网分配网络地址，要满足下列限制：所有地址必须从214.97.254/23起分配；子网A应当具有足够地址以支持250个接口；子网B应当具有足够地址以支持120个接口；子网C应当具有足够地址以支待120个接口。当然，子网D、E和F应当支持两个接口。对于每个子网，分配采用的形式是a.b.c.d/x或a.b.c.d/x~e.f.g.h/y。<br /></li>
<li>使用你对（a）部分的答案，为这3台路由器提供转发表（使用最长前缀匹配）。<br /></li>
</ol>



<div id="org4e609a9" class="figure">
<p><img src="img/fig4-20.png" alt="fig4-20.png" style="width:100%; max-width:450px;" /><br />
</p>
</div>


<div id="org8762a29" class="figure">
<p><img src="img/ch4-p12.png" alt="ch4-p12.png" style="width:100%; max-width:700px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgf88ce71" class="outline-4">
<h4 id="orgf88ce71">P13 大学IP地址块和服务器位置</h4>
<div class="outline-text-4" id="text-orgf88ce71">
<p>
使用美国因特网编码注册机构 (<a href="http://www.arin.net/whois">http://www.arin.net/whois</a>) 的whois服务来确定三所大学所用的IP地址块。whois服务能被用于确定某个特定的IP地址的确定地理位置吗？使用 www.maxmind.com 来确定位于这三所大学的Web服务器的位置。<br />
</p>

<pre class="example" id="orgf92a9da">
❯ dig nyu.edu

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; nyu.edu
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 49081
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 3, ADDITIONAL: 6

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;nyu.edu.			IN	A

;; ANSWER SECTION:
nyu.edu.		550	IN	A	216.165.47.10

;; AUTHORITY SECTION:
nyu.edu.		34436	IN	NS	ns1.nyu.net.
nyu.edu.		34436	IN	NS	ns4.nyu.edu.
nyu.edu.		34436	IN	NS	ns2.nyu.org.

;; ADDITIONAL SECTION:
ns1.nyu.net.		27920	IN	A	128.122.0.8
ns2.nyu.org.		27918	IN	A	128.122.0.76
ns4.nyu.edu.		3707	IN	A	3.226.48.68
ns1.nyu.net.		27920	IN	AAAA	2607:f600:1001:6100::8
ns2.nyu.org.		27918	IN	AAAA	2607:f600:1001:6000::76

;; Query time: 23 msec
;; SERVER: 192.168.8.1#53(192.168.8.1)
;; WHEN: Thu Oct 28 11:24:45 CST 2021
;; MSG SIZE  rcvd: 224

❯ whois 216.165.47.10
% IANA WHOIS server
% for more information on IANA, visit http://www.iana.org
% This query returned 1 object

refer:        whois.arin.net

inetnum:      216.0.0.0 - 216.255.255.255
organisation: ARIN
status:       ALLOCATED

whois:        whois.arin.net

changed:      1998-04
source:       IANA

# whois.arin.net

NetRange:       216.165.0.0 - 216.165.127.255
CIDR:           216.165.0.0/17
NetName:        NYU-NET2
NetHandle:      NET-216-165-0-0-1
Parent:         NET216 (NET-216-0-0-0-0)
NetType:        Direct Assignment
OriginAS:
Organization:   New York University (NYU)
RegDate:        1999-08-11
Updated:        2017-11-27
Comment:        Please query Merit's RADb for up to date information on allocations, routing policy, and contacts.
Comment:
Comment:        whois -h whois.radb.net
Comment:
Comment:        www.ra.net
Ref:            https://rdap.arin.net/registry/ip/216.165.0.0
</pre>


<div id="orgd17778e" class="figure">
<p><img src="img/ch4-p13.png" alt="ch4-p13.png" style="width:100%; max-width:1000px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd8e3ea4" class="outline-4">
<h4 id="orgd8e3ea4">P14 分片</h4>
<div class="outline-text-4" id="text-orgd8e3ea4">
<p>
考虑向具有700字节MTU的一条链路发送一个2400字节的数据报。假定初始数据报标有标识号422。将会生成多少个分片？在生成相关分片的数据报中各个字段的值是多少？<br />
</p>

<p>
根据<a href="https://datatracker.ietf.org/doc/html/rfc791#section-3.1">RFC791</a>，片偏移以64bit为单位。<br />
</p>


<div id="orgdd03213" class="figure">
<p><img src="img/ch4-p14.png" alt="ch4-p14.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd4357ba" class="outline-4">
<h4 id="orgd4357ba">P15</h4>
<div class="outline-text-4" id="text-orgd4357ba">
<p>
假定在源主机A和目的主机B之间的数据报被限制为1500字节（包括首部）。假设IP首部为20字节，要发送一个5MB的MP3文件需要多少个数据报？解释你的答案是如何计算的。<br />
</p>

<p>
⌈5e6/(1500-20TCP-20IP)⌉ = 3425<br />
</p>
</div>
</div>

<div id="outline-container-orgeda16a7" class="outline-4">
<h4 id="orgeda16a7">P16 NAT</h4>
<div class="outline-text-4" id="text-orgeda16a7">
<p>
考虑在图4-25中建立的网络。假定ISP现在为路由器分配地址24.34.112.235，家庭网络的网络地址是192.168.1/24。<br />
</p>
<ol class="org-ol">
<li>在家庭网络中为所有接口分配地址。<br /></li>
<li>假定每台主机具有两个进行中的TCP连接，所有都是针对主机128.119.40.86的80端口的。在NAT转换表中提供6个对应表项。<br /></li>
</ol>



<div id="org17dc837" class="figure">
<p><img src="img/fig4-25.png" alt="fig4-25.png" style="width:100%; max-width:680px;" /><br />
</p>
</div>


<div id="orgb48cb59" class="figure">
<p><img src="img/ch4-p16.png" alt="ch4-p16.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org21fc295" class="outline-4">
<h4 id="org21fc295">P17</h4>
<div class="outline-text-4" id="text-org21fc295">
<p>
假设你有兴趣检测NAT后面的主机数量。你观察到在每个IP分组上IP层顺序地标出一个标识号。由一台主机生成的第一个IP分组的标识号是一个随机数，后继IP分组的标识号是顺序分配的。假设由NAT后面主机产生的所有IP分组都发往外部。<br />
</p>
<ol class="org-ol">
<li>基于这个观察，假定你能够俘获由NAT向外部发送的所有分组，你能概要给出一种简单的技术来检测NAT后面不同主机的数量吗？评估你的答案。<br /></li>
<li>如果标识号不是顺序分配而是随机分配的，这种技术还能正常工作吗？评估你的答案。<br /></li>
</ol>


<ol class="org-ol">
<li>连续的标识号指示一台主机。<br /></li>
<li>不能。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org5d32d71" class="outline-4">
<h4 id="org5d32d71">P18 NAT与TCP连接</h4>
<div class="outline-text-4" id="text-org5d32d71">
<p>
在这个习题中，我们将探讨NAT对P2P应用程序的影响。假定用户名为Arnold的对等方通过查询发现，用户名为Bernard的对等方有一个要下载的文件。同时假定Bernard和Arnold都位于NAT后面。尝试设计一种技术，使得Arnold与Bernard创建一条TCP连接，而不对NAT做应用特定的配置。如果难以设计这样的技术，试讨论其原因。<br />
</p>

<p>
为了在Arnold和Bernard之间创建一条TCP连接，Arnold或Bernard必须向对方发起连接。但是，Arnold和Bernard的外层的NAT会丢弃从WAN端到达的SYN数据包。因此，如果Arnold和Bernard都在NAT后面，他们都不能发起建立与对方的TCP连接。<br />
</p>
</div>
</div>

<div id="outline-container-org41e6a2c" class="outline-4">
<h4 id="org41e6a2c">P19 通用转发与流表</h4>
<div class="outline-text-4" id="text-org41e6a2c">
<p>
考虑显示在图4-30中的SDN OpenFlow网络。假定对于到达s2的数据报的期望转发行为如下：<br />
</p>

<ul class="org-ul">
<li>any datagrams arriving on input port 1 from hosts h5 or h6 that are destined to hosts h1 or h2 should be forwarded over output port 2;<br /></li>
<li>any datagrams arriving on input port 2 from hosts h1 or h2 that are destined to hosts h5 or h6 should be forwarded over output port 1;<br /></li>
<li>any arriving datagrams on input ports 1 or 2 and destined to hosts h3 or h4 should be delivered to the host specified;<br /></li>
<li>hosts h3 and h4 should be able to send datagrams to each other.<br /></li>
</ul>


<p>
详述实现这种转发行为的s2中的流表项。<br />
</p>


<div id="org6fb8110" class="figure">
<p><img src="img/fig4-30.png" alt="fig4-30.png" style="width:100%; max-width:660px;" /><br />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">匹配</th>
<th scope="col" class="org-left">动作</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Ingress Port = 1; IP Src = 10.3.*.*; IP Dst = 10.1.*.*</td>
<td class="org-left">Forward(2)</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 2; IP Src = 10.1.*.*; IP Dst = 10.3.*.*</td>
<td class="org-left">Forward(1)</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 1; IP Dst = 10.2.0.3;</td>
<td class="org-left">Forward(3)</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 2; IP Dst = 10.2.0.3;</td>
<td class="org-left">Forward(3)</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 1; IP Dst = 10.2.0.4;</td>
<td class="org-left">Forward(4)</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 2; IP Dst = 10.2.0.4;</td>
<td class="org-left">Forward(4)</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 3;</td>
<td class="org-left">Forward(4)</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 4;</td>
<td class="org-left">Forward(3)</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org97c526b" class="outline-4">
<h4 id="org97c526b">P20</h4>
<div class="outline-text-4" id="text-org97c526b">
<p>
再次考虑显示在图4-30中的SDN OpenFlow网络。假定在s2对于来自主机h3或h4的数据报的期望转发行为如下：<br />
</p>

<ul class="org-ul">
<li>任何来自主机h3并且发往主机h1、h2、h5或h6的数据报应当在网络中以顺时针方向转发。<br /></li>
<li>任何来自主机h4并且发往主机h1、h2、h5或h6的数据报应当在网络中以逆时针方向转发。<br /></li>
</ul>


<p>
详述实现这种转发行为的s2中的流表项。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">匹配</th>
<th scope="col" class="org-left">动作</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Ingress Port = 3; IP Dst = 10.1.*.*</td>
<td class="org-left">Forward(2)</td>
<td class="org-left">h3-&gt;h1,h2</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 3; IP Dst = 10.3.*.*</td>
<td class="org-left">Forward(2)</td>
<td class="org-left">h3-&gt;h5,h6</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 4; IP Dst = 10.1.*.*</td>
<td class="org-left">Forward(1)</td>
<td class="org-left">h4-&gt;h1,h2</td>
</tr>

<tr>
<td class="org-left">Ingress Port = 4; IP Dst = 10.3.*.*</td>
<td class="org-left">Forward(1)</td>
<td class="org-left">h4-&gt;h5,h5</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgadb7412" class="outline-4">
<h4 id="orgadb7412">P21</h4>
<div class="outline-text-4" id="text-orgadb7412">
<p>
再次考虑上面P19的场景。给出分组交换机s1和s3的流表项，使得具有h3或h4源地址的任何到达数据报被路由到在IP数据报的目的地址字段中定义的目的主机。（提示：你的转发表规则应当包括如下情况，即到达的数据报被发往直接连接的主机，或应当转发到相邻路由器以便传递到最终主机。）<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 6:</span> s1的流表</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">匹配</th>
<th scope="col" class="org-left">动作</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">IP Src = 10.2.*.*; IP Dst = 10.1.0.1</td>
<td class="org-left">Forward(2)</td>
<td class="org-left">h3,h4-&gt;h1</td>
</tr>

<tr>
<td class="org-left">IP Src = 10.2.*.*; IP Dst = 10.1.0.2</td>
<td class="org-left">Forward(3)</td>
<td class="org-left">h3,h4-&gt;h2</td>
</tr>

<tr>
<td class="org-left">IP Src = 10.2.*.*; IP Dst = 10.3.*.*</td>
<td class="org-left">Forward(1)</td>
<td class="org-left">h3,h4-&gt;h5,h6</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 7:</span> s3的流表</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">匹配</th>
<th scope="col" class="org-left">动作</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">IP Src = 10.2.*.*; IP Dst = 10.1.0.5</td>
<td class="org-left">Forward(2)</td>
<td class="org-left">h3,h4-&gt;h5</td>
</tr>

<tr>
<td class="org-left">IP Src = 10.2.*.*; IP Dst = 10.1.0.6</td>
<td class="org-left">Forward(1)</td>
<td class="org-left">h3,h4-&gt;h6</td>
</tr>

<tr>
<td class="org-left">IP Src = 10.2.*.*; IP Dst = 10.1.*.*</td>
<td class="org-left">Forward(3)</td>
<td class="org-left">h3,h4-&gt;h1,h2</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org0c59482" class="outline-4">
<h4 id="org0c59482">P22</h4>
<div class="outline-text-4" id="text-org0c59482">
<p>
再次考虑显示在图4-30中的SDN OpenFlow网络。假定我们希望交换机s2的功能像防火墙一样。在s2中定义实现下列防火墙行为的流表，以传递目的地为h3和h4的数据报（对下列四种防火墙行为，每种定义一张不同的流表）。不需要在s2中定义将流量转发到其他路由器的转发行为。<br />
</p>
<ul class="org-ul">
<li>仅有从主机h1和h6到达的流量应当传递到主机h3或h4（即从主机h2和h5到达的流量被阻塞）。<br /></li>
<li>仅有TCP流量被允许传递给主机h3或h4（即UDP流扯被阻塞）。<br /></li>
<li>仅有发往h3的流量被传递（即所有到h4的流量被阻塞）。<br /></li>
<li>仅有来自h1并且发往h3的UDP流量被传递。所有其他流量被阻塞。<br /></li>
</ul>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">匹配</th>
<th scope="col" class="org-left">动作</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">IP Src = 10.1.0.1; IP Dst = 10.2.0.3</td>
<td class="org-left">Forward(3)</td>
<td class="org-left">h1-&gt;h3</td>
</tr>

<tr>
<td class="org-left">IP Src = 10.1.0.1; IP Dst = 10.2.0.4</td>
<td class="org-left">Forward(4)</td>
<td class="org-left">h1-&gt;h4</td>
</tr>

<tr>
<td class="org-left">IP Src = 10.3.0.6; IP Dst = 10.2.0.3</td>
<td class="org-left">Forward(3)</td>
<td class="org-left">h6-&gt;h3</td>
</tr>

<tr>
<td class="org-left">IP Src = 10.3.0.6; IP Dst = 10.2.0.4</td>
<td class="org-left">Forward(4)</td>
<td class="org-left">h6-&gt;h4</td>
</tr>
</tbody>
</table></li>
<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">匹配</th>
<th scope="col" class="org-left">动作</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">IP Scr = *.*.*.*; IP Dst = 10.2.0.3; TCP</td>
<td class="org-left">Forward(3)</td>
<td class="org-left">*-TCP-&gt;h3</td>
</tr>

<tr>
<td class="org-left">IP Scr = *.*.*.*; IP Dst = 10.2.0.4; TCP</td>
<td class="org-left">Forward(4)</td>
<td class="org-left">*-TCP-&gt;h4</td>
</tr>
</tbody>
</table></li>
<li><p>
&#x00ad;<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">匹配</th>
<th scope="col" class="org-left">动作</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">IP Src = 10.1.0.1; IP Dst = 10.2.0.3; UDP</td>
<td class="org-left">Forward(3)</td>
<td class="org-left">h1-UDP-&gt;h3</td>
</tr>
</tbody>
</table></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org0fa9698" class="outline-3">
<h3 id="org0fa9698"><span class="section-number-3">4.3.</span> Wireshark实验</h3>
<div class="outline-text-3" id="text-4-3">
<p>
<a href="code/ch4-ws-ip/wireshark-ip-v7.0.pdf">Wireshark Lab: IP v7.0</a><br />
</p>

<p>
下面的traceroute<a href="code/ch4-ws-ip/my-trace.pcapng">结果</a>不理想，采用实验附带的数据。<br />
</p>

<pre class="example" id="org1054410">
❯ traceroute -I -w 1 gaia.cs.umass.edu
traceroute to gaia.cs.umass.edu (128.119.245.12), 64 hops max, 72 byte packets
 1  www.huaweimobilewifi.com (192.168.8.1)  19.915 ms  26.711 ms  29.840 ms
 2  * * *
 3  192.168.208.65 (192.168.208.65)  38.351 ms  39.267 ms  40.085 ms
 4  192.168.191.77 (192.168.191.77)  39.732 ms  39.413 ms  39.948 ms
 5  * * *
 6  * * *
 7  * * *
 8  * * *
 9  * * *
10  * * *
11  * * *
12  * * *
13  * * *
14  * * *
15  * * *
16  * * *
17  * * *
18  * * *
19  * * *
20  * * *
21  * * *
22  * * *
23  * * *
24  * * *
25  * * *
26  * * *
27  * * *
28  gaia.cs.umass.edu (128.119.245.12)  280.594 ms  279.113 ms  299.696 ms
</pre>

<ol class="org-ol">
<li><p>
Select the first ICMP Echo Request message sent by your computer, and expand the Internet Protocol part of the packet in the packet details window.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
      8 6.163045       192.168.1.102         128.59.23.100         ICMP     98     Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=20483/848, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 8: 98 bytes on wire (784 bits), 98 bytes captured (784 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 84
    Identification: 0x32d0 (13008)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2d2c [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
Internet Control Message Protocol
</pre>
</div>

<p>
What is the IP address of your computer?<br />
</p>

<p>
Source Address: 192.168.1.102<br />
</p></li>

<li><p>
Within the IP packet header, what is the value in the upper layer protocol field?<br />
</p>

<p>
Protocol: ICMP (1)<br />
</p></li>

<li>&#x00ad;<br />

<ul class="org-ul">
<li><p>
How many bytes are in the IP header?<br />
</p>

<p>
Header Length: 20 bytes<br />
</p></li>

<li><p>
How many bytes are in the payload of the IP datagram? Explain how you determined the number of payload bytes.<br />
</p>

<p>
Total Length: 84<br />
</p>

<p>
payload length = 84 - 20 = 64 bytes<br />
</p></li>
</ul></li>

<li><p>
Has this IP datagram been fragmented? Explain how you determined whether or not the datagram has been fragmented.<br />
</p>

<p>
没有被分片，More fragments: Not set<br />
</p></li>

<li><p>
Which fields in the IP datagram always change from one datagram to the next within this series of ICMP messages sent by your computer?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
    355 53.678468      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49155/960, <span class="org-variable-name">ttl</span>=9 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 355: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3346 (13126)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 9
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2160 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #353(1480), #354(1480), #355(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    358 53.714979      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49411/961, <span class="org-variable-name">ttl</span>=10 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 358: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3347 (13127)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 10
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x205f [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #356(1480), #357(1480), #358(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    361 53.728518      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49667/962, <span class="org-variable-name">ttl</span>=11 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 361: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3348 (13128)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 11
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1f5e [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #359(1480), #360(1480), #361(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    365 53.758584      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=49923/963, <span class="org-variable-name">ttl</span>=12 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 365: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3349 (13129)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 12
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1e5d [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #363(1480), #364(1480), #365(548)]
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
    368 53.778721      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=50179/964, <span class="org-variable-name">ttl</span>=13 (<span class="org-type">reply</span> <span class="org-variable-name">in</span> 380)

Frame 368: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x334a (13130)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 13
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1d5c [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #366(1480), #367(1480), #368(548)]
Internet Control Message Protocol
</pre>
</div>

<p>
Identification<br />
Time to Live<br />
Header Checksum<br />
</p></li>

<li>Which fields stay constant? Which of the fields must stay constant? Which fields must change? Why?<br />

<ul class="org-ul">
<li>Stay constant:<br />
Version<br />
Header Length<br />
Protocol<br />
Source Address<br />
Destination Address<br /></li>

<li>Must stay constant:<br />
Source Address<br />
Destination Address<br />
Protocol<br /></li>

<li>Must change:<br />
Identification<br />
Time to Live<br /></li>
</ul></li>

<li><p>
Describe the pattern you see in the values in the Identification field of the IP datagram<br />
</p>

<p>
从13008开始，逐个IP数据报加一。<br />
</p></li>

<li><p>
What is the value in the Identification field and the TTL field?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
      9 6.176826       10.216.228.1          192.168.1.102         ICMP     70     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 9: 70 bytes on wire (560 bits), 70 bytes captured (560 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: LinksysG_da:af:73 (00:06:25:da:af:73), <span class="org-function-name">Dst</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 10.216.228.1, <span class="org-variable-name">Dst</span>: 192.168.1.102
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 56
    Identification: 0x9d7c (40316)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 255
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x6ca0 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 10.216.228.1
    Destination Address: 192.168.1.102
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
     40 11.174495      10.216.228.1          192.168.1.102         ICMP     70     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 40: 70 bytes on wire (560 bits), 70 bytes captured (560 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: LinksysG_da:af:73 (00:06:25:da:af:73), <span class="org-function-name">Dst</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 10.216.228.1, <span class="org-variable-name">Dst</span>: 192.168.1.102
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 56
    Identification: 0x9d98 (40344)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 255
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x6c84 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 10.216.228.1
    Destination Address: 192.168.1.102
Internet Control Message Protocol

No.     Time           Source                Destination           Protocol Length Info
     65 16.179649      10.216.228.1          192.168.1.102         ICMP     70     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 65: 70 bytes on wire (560 bits), 70 bytes captured (560 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: LinksysG_da:af:73 (00:06:25:da:af:73), <span class="org-function-name">Dst</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 10.216.228.1, <span class="org-variable-name">Dst</span>: 192.168.1.102
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 56
    Identification: 0x9db8 (40376)
    Flags: 0x00
    Fragment Offset: 0
    Time to Live: 255
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x6c64 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 10.216.228.1
    Destination Address: 192.168.1.102
Internet Control Message Protocol
</pre>
</div>

<p>
Identification: 0x9d7c (40316)<br />
Time to Live: 255<br />
</p></li>

<li><p>
Do these values remain unchanged for all of the ICMP TTL-exceeded replies sent to your computer by the nearest (first hop) router? Why?<br />
</p>

<p>
Identification会变化，TTL不变。<br />
</p></li>

<li><p>
Find the first ICMP Echo Request message that was sent by your computer after you changed the Packet Size in pingplotter to be 2000. Has that message been fragmented across more than one IP datagram?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     93 28.442185      192.168.1.102         128.59.23.100         ICMP     562    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=30467/887, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 93: 562 bytes on wire (4496 bits), 562 bytes captured (4496 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 548
    Identification: 0x32f9 (13049)
    Flags: 0x00
        0... .... = Reserved bit: Not set
        .0.. .... = Don<span class="org-warning">'</span>t fragment: Not set
        ..0. .... = More fragments: Not set
    Fragment Offset: 1480
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2a7a [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [2 IPv4 Fragments (2008 bytes): #92(1480), #93(528)]
        [Frame: 92, payload: 0-1479 (1480 bytes)]
        [Frame: 93, payload: 1480-2007 (528 bytes)]
        [Fragment count: 2]
        [Reassembled IPv4 length: 2008]
        [Reassembled IPv4 data: 0800d0c603007703373620aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#8230;]
Internet Control Message Protocol
</pre>
</div></li>

<li>&#x00ad;<br />

<ul class="org-ul">
<li><p>
Print out the first fragment of the fragmented IP datagram.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     92 28.441511      192.168.1.102         128.59.23.100         IPv4     1514   Fragmented IP protocol (proto=ICMP 1, off=0, ID=32f9) [Reassembled in #93]

Frame 92: 1514 bytes on wire (12112 bits), 1514 bytes captured (12112 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 1500
    Identification: 0x32f9 (13049)
    Flags: 0x20, <span class="org-variable-name">More</span> fragments
        0... .... = Reserved bit: Not set
        .0.. .... = Don<span class="org-warning">'</span>t fragment: Not set
        ..1. .... = More fragments: Set
    Fragment Offset: 0
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x077b [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [Reassembled IPv4 in frame: 93]
Data (1480 bytes)
</pre>
</div></li>

<li><p>
What information in the IP header indicates that the datagram been fragmented?<br />
</p>

<p>
Flags: 0x20, More fragments<br />
</p></li>

<li><p>
What information in the IP header indicates whether this is the first fragment versus a latter fragment?<br />
</p>

<p>
Flags: 0x20, More fragments<br />
Fragment Offset: 0<br />
</p></li>

<li><p>
How long is this IP datagram?<br />
</p>

<p>
Total Length: 1500<br />
</p></li>
</ul></li>

<li>&#x00ad;<br />
<ul class="org-ul">
<li><p>
Print out the second fragment of the fragmented IP datagram.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     93 28.442185      192.168.1.102         128.59.23.100         ICMP     562    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=30467/887, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 93: 562 bytes on wire (4496 bits), 562 bytes captured (4496 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 548
    Identification: 0x32f9 (13049)
    Flags: 0x00
    Fragment Offset: 1480
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2a7a [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [2 IPv4 Fragments (2008 bytes): #92(1480), #93(528)]
Internet Control Message Protocol
</pre>
</div></li>

<li>What information in the IP header indicates that this is not the first datagram fragment?<br />
Fragment Offset: 1480<br /></li>

<li><p>
Are the more fragments?<br />
</p>

<p>
No.<br />
</p></li>

<li><p>
How can you tell?<br />
</p>

<p>
Flags: 0x00<br />
</p></li>
</ul></li>

<li><p>
What fields change in the IP header between the first and second fragment?<br />
</p>

<p>
Total Length<br />
Flags<br />
Header Checksum<br />
</p></li>

<li><p>
How many fragments were created from the original datagram?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
    218 43.467629      192.168.1.102         128.59.23.100         ICMP     582    Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x0300, <span class="org-variable-name">seq</span>=40451/926, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 218: 582 bytes on wire (4656 bits), 582 bytes captured (4656 bits)
<span class="org-type">Ethernet</span> <span class="org-variable-name">II</span>, <span class="org-function-name">Src</span>: Actionte_8a:70:1a (00:20:e0:8a:70:1a), <span class="org-function-name">Dst</span>: LinksysG_da:af:73 (00:06:25:da:af:73)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.1.102, <span class="org-variable-name">Dst</span>: 128.59.23.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 568
    Identification: 0x3323 (13091)
    Flags: 0x01
    Fragment Offset: 2960
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x2983 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.1.102
    Destination Address: 128.59.23.100
    [3 IPv4 Fragments (3508 bytes): #216(1480), #217(1480), #218(548)]
Internet Control Message Protocol
</pre>
</div>

<p>
3<br />
</p></li>

<li><p>
What fields change in the IP header among the fragments?<br />
</p>

<p>
Fragment Offset<br />
</p></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org4c84186" class="outline-2">
<h2 id="org4c84186"><span class="section-number-2">5.</span> 网络层：控制平面</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org843811b" class="outline-3">
<h3 id="org843811b"><span class="section-number-3">5.1.</span> 笔记</h3>
<div class="outline-text-3" id="text-5-1">

<div id="org0645187" class="figure">
<p><img src="img/fig5-3.png" alt="fig5-3.png" style="width:100%; max-width:300px;" /><br />
</p>
</div>


<div id="org6940d87" class="figure">
<p><img src="img/fig5-6.png" alt="fig5-6.png" style="width:100%; max-width:470px;" /><br />
</p>
</div>


<div id="org40980d0" class="figure">
<p><img src="img/fig5-7.png" alt="fig5-7.png" style="width:100%; max-width:360px;" /><br />
</p>
</div>


<div id="org11d1830" class="figure">
<p><img src="img/fig5-10.png" alt="fig5-10.png" style="width:100%; max-width:480px;" /><br />
</p>
</div>


<div id="org822d924" class="figure">
<p><img src="img/fig5-12.png" alt="fig5-12.png" style="width:100%; max-width:460px;" /><br />
</p>
</div>


<div id="org629018a" class="figure">
<p><img src="img/fig5-13.png" alt="fig5-13.png" style="width:100%; max-width:370px;" /><br />
</p>
</div>


<div id="orgfa5d881" class="figure">
<p><img src="img/fig5-14.png" alt="fig5-14.png" style="width:100%; max-width:370px;" /><br />
</p>
</div>


<div id="org4a73ac2" class="figure">
<p><img src="img/fig5-15.png" alt="fig5-15.png" style="width:100%; max-width:380px;" /><br />
</p>
</div>


<div id="orga6780f1" class="figure">
<p><img src="img/fig5-16.png" alt="fig5-16.png" style="width:100%; max-width:390px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orgd0ca986" class="outline-3">
<h3 id="orgd0ca986"><span class="section-number-3">5.2.</span> 复习题</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-orgdd27b9e" class="outline-4">
<h4 id="orgdd27b9e">R1 每路由器控制</h4>
<div class="outline-text-4" id="text-orgdd27b9e">
<ul class="org-ul">
<li><p>
基于每路由器控制的控制平面意味着什么？<br />
</p>

<p>
意味着在每台路由器中运行一种路由选择算法，每台路由器中都包含转发和路由选择功能。每台路由器有一个路由选择组件，用于与其他路由器中的路由选择组件通信，以计算其转发表的值。<br />
</p></li>

<li><p>
在这种情况下，当我们说网络控制平面和数据平面是“整体地”实现时，是什么意思？<br />
</p>

<p>
控制平面路由选择功能与数据平面转发功能位于同一台物理路由器中。<br />
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgcff195f" class="outline-4">
<h4 id="orgcff195f">R2 逻辑集中式控制</h4>
<div class="outline-text-4" id="text-orgcff195f">
<ul class="org-ul">
<li><p>
基于逻辑上集中控制的控制平面意味着什么？<br />
</p>

<p>
逻辑集中式控制器计算并分发转发表以供每台路由 器使用。<br />
</p></li>

<li><p>
在这种情况下，数据平面和控制平面是在相同的设备或在分离的设备中实现的吗？请解释。<br />
</p>

<p>
数据平面和控制平面在不同的设备中实现。控制平面在一台或多台服务器中实现，而数据平面在每台路由器中实现。<br />
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org11520d3" class="outline-4">
<h4 id="org11520d3">R3 集中式和分散式路由选择算法</h4>
<div class="outline-text-4" id="text-org11520d3">
<p>
比较和对照集中式和分布式路由选择算法的性质。给出一个路由选择协议的例子，该路由选择协议采用分布式方法和集中式方法。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">集中式</th>
<th scope="col" class="org-left">分散式</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">计算节点拥有的信息</td>
<td class="org-left">完整的,全局的网络知识</td>
<td class="org-left">与其直接相连链路的开销知识</td>
</tr>

<tr>
<td class="org-left">计算过程</td>
<td class="org-left">直接计算出从源到目的地之间的最低开销路径</td>
<td class="org-left">通过迭代计算过程以及与相邻节点的信息交换，一个节点逐渐计算出到达某目的节点或一组目的节点的最低开销路径</td>
</tr>

<tr>
<td class="org-left">例子</td>
<td class="org-left">OSPF</td>
<td class="org-left">BGP</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5e1f375" class="outline-4">
<h4 id="org5e1f375">R4 链路状态和距离矢量路由选择选法</h4>
<div class="outline-text-4" id="text-org5e1f375">
<p>
比较和对照链路状态和距离矢量这两种路由选择算法。<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">链路状态</th>
<th scope="col" class="org-left">矢量</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">通信对象</td>
<td class="org-left">所有其他节点</td>
<td class="org-left">直接相连的邻居</td>
</tr>

<tr>
<td class="org-left">通信内容</td>
<td class="org-left">与自己直接相连链路的开销</td>
<td class="org-left">从自己到网络中所有其他节点的最低开销估计</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orga69bced" class="outline-4">
<h4 id="orga69bced">R5 距离矢量路由选择中的无穷计数</h4>
<div class="outline-text-4" id="text-orga69bced">
<p>
在距离矢量路由选择中的“无穷计数”是什么意思？<br />
</p>

<p>
t<sub>0</sub>,         D<sub>y</sub>(x) = 6<br />
t<sub>1</sub>, y通知z, D<sub>z</sub>(x) = c(z,y) + D<sub>y</sub>(x) = 7<br />
t<sub>2</sub>, z通知y, D<sub>y</sub>(x) = 8<br />
t<sub>3</sub>, y通知z, D<sub>z</sub>(x) = 9<br />
&#x2026;<br />
t<sub>43</sub>, y通知z, D<sub>z</sub>(x) = 49<br />
t<sub>44</sub>, z通知y, D<sub>y</sub>(x) = 50<br />
t<sub>45</sub>, y通知z, D<sub>z</sub>(x) = min{c(z,x)+D<sub>x</sub>(x), c(z,y)+D<sub>y</sub>(x)} = min{50+0, 1+50} = 50<br />
</p>


<div id="org3892225" class="figure">
<p><img src="img/ch5-r5.png" alt="ch5-r5.png" style="width:100%; max-width:480px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org5a010d2" class="outline-4">
<h4 id="org5a010d2">R6</h4>
<div class="outline-text-4" id="text-org5a010d2">
<p>
每个自治系统使用相同的AS内部路由选择算法是必要的吗？说明其原因。<br />
</p>

<p>
不需要，每个AS对其内部的路由享有自治权。<br />
</p>
</div>
</div>

<div id="outline-container-orga233e86" class="outline-4">
<h4 id="orga233e86">R7 AS内部协议的必要性</h4>
<div class="outline-text-4" id="text-orga233e86">
<p>
为什么在因特网中用到了不同的AS间与AS内部协议？<br />
</p>

<p>
所有路由器执行相同的路由选择算法以计算穿越整个网络的路由选择路径会遇到两个问题：<br />
</p>
<ol class="org-ol">
<li>随着路由器数目变得很大，涉及路由选择信息的通信、计算和存储的开销将高得不可实现。<br /></li>
<li>一个组织应当能够按自己的愿望运行和管理其网络，还要能将其网络与其他外部网络连接起来。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org9be127c" class="outline-4">
<h4 id="org9be127c">R8</h4>
<div class="outline-text-4" id="text-org9be127c">
<p>
是非判断题：当一台OSPF路由器发送它的链路状态信息时，它仅向那些直接相邻的节点发送。解释理由。<br />
</p>

<p>
错误，它向自制系统内所有其他路由器广播链路状态信息。<br />
</p>
</div>
</div>

<div id="outline-container-orge8b7a4b" class="outline-4">
<h4 id="orge8b7a4b">R9 OSPF AS中的区域</h4>
<div class="outline-text-4" id="text-orge8b7a4b">
<ul class="org-ul">
<li><p>
在OSPF自治系统中区域表示什么？<br />
</p>

<p>
每个区域都运行自己的OSPF链路状态路由选择算法，在每个区域内，一台或多台区域边界路由器负责为流向该区域以外的分组提供路由选择。<br />
</p></li>
</ul>


<ul class="org-ul">
<li><p>
为什么引入区域的概念？<br />
</p>

<p>
区域的概念是出于可扩展性的考虑而引入的，也就是说，我们希望为一个大规模的OSPF AS建立一个具有层次结构的路由，而区域是构成层次结构路由的一个重要构件。<br />
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgef80b4a" class="outline-4">
<h4 id="orgef80b4a">R10 子网、前缀和BGP路由</h4>
<div class="outline-text-4" id="text-orgef80b4a">
<p>
定义和对比下列术语：子网、前缀和BGP路由。<br />
</p>

<p>
将每个接口从其主机或路由器分离出来，形成孤立的网络岛，接口是孤立网络的终点。这些孤立的网络中的每一个都被称为子网。<br />
</p>

<p>
形式为a.b.c.d/x的地址的x最高比特构成了IP地址的网络部分，并且经常被称为该地址的前缀。<br />
</p>

<p>
当路由器通过BGP连接通告前缀时，它在前缀中包括一些BGP属性。用BGP术语来说，前缀及其属性称为路由。<br />
</p>
</div>
</div>

<div id="outline-container-org6a01f07" class="outline-4">
<h4 id="org6a01f07">R11 AS-PATH NEXT-HOP</h4>
<div class="outline-text-4" id="text-org6a01f07">
<p>
BGP是怎样使用NEXT-HOP展性的？它是怎样使用AS-PATH属性的？<br />
</p>

<p>
BGP路由器使用AS-PATH属性<br />
</p>
<ol class="org-ol">
<li>检测和防止通告环路；<br /></li>
<li>在通往同一前缀的多个路径中进行选择。<br /></li>
</ol>


<p>
NEXT-HOP属性表示沿着通告路径（在收到通告的AS之外）到一个给定前缀的第一个路由器的IP地址。当配置其转发表时，路由器使用NEXT-HOP属性。<br />
</p>
</div>
</div>

<div id="outline-container-orgc0d57af" class="outline-4">
<h4 id="orgc0d57af">R12 BGP策略</h4>
<div class="outline-text-4" id="text-orgc0d57af">
<p>
描述一个较高层ISP的网络管理员在配置BGP时是如何实现策略的。<br />
</p>

<p>
一个一级ISP B可能不会在另外两个一级ISP（例如A和C）之间传输流量。为了执行这一政策，ISP B不会向A通告经过C的路线；也不会向C通过经过A的路线。<br />
</p>
</div>
</div>

<div id="outline-container-org9ba86b8" class="outline-4">
<h4 id="org9ba86b8">R13</h4>
<div class="outline-text-4" id="text-org9ba86b8">
<p>
是非判断题：当BGP路由器从它的邻居接收到一条通告的路径时，它必须对接收路径增加上它自己的标识，然后向其所有邻居发送该新路径。解释理由。<br />
</p>

<p>
错误。AS将其ASN加入AS-PATH中的现有列表并发送给邻居意味着该AS向外宣告有一条经过自己的路径。是否这么做取决于AS想实现怎样的BGP策略。<br />
</p>
</div>
</div>

<div id="outline-container-orgf8665de" class="outline-4">
<h4 id="orgf8665de">R14</h4>
<div class="outline-text-4" id="text-orgf8665de">
<p>
描述在SDN控制器中的通信层、网络范围状态管理层和网络控制应用程序层的主要任务。<br />
</p>

<ol class="org-ol">
<li>传送控制器与交换机、主机或其他设备之间的信息。<br /></li>
<li>维护网络范围状态信息。<br /></li>
<li>使用由SDN控制器提供的API来定义和控制网络设备中的数据平面。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org457c0da" class="outline-4">
<h4 id="org457c0da">R15</h4>
<div class="outline-text-4" id="text-org457c0da">
<p>
假定你要在SDN控制平面中实现一个新型路由选择协议。你将在哪个层次中实现该协议？解释理由。<br />
</p>

<p>
SDN网络控制应用程序层，因为这一层里的路由选择网络控制应用程序可以决定源和目的地之间的端到端路径。<br />
</p>
</div>
</div>

<div id="outline-container-org5c21383" class="outline-4">
<h4 id="org5c21383">R16</h4>
<div class="outline-text-4" id="text-org5c21383">
<p>
什么类型的报文流跨越SDN控制器的北向和南向API？谁是从控制器跨越南向接口发送的这些报文的接收者？谁是跨越北向接口从控制器发送的这些报文的接收者？<br />
</p>

<ul class="org-ul">
<li><p>
What types of messages flow across an SDN controller’s northbound and southbound APIs?<br />
</p>

<p>
网络控制应用程序与控制器交互的报文通过北向API；受控交换机与控制器交互的报文通过南向API。<br />
</p></li>

<li><p>
Who is the recipient of these messages sent from the controller across the southbound interface, and who sends messages to the controller across the northbound interface?<br />
</p>

<p>
受控交换机；网络控制应用程序。<br />
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org088ff41" class="outline-4">
<h4 id="org088ff41">R17</h4>
<div class="outline-text-4" id="text-org088ff41">
<p>
描述两种从受控设备到控制器发送的OpenFlow报文类型的目的。描述两种从控制器到受控设备发送的OpenFlow报文类型的目的。<br />
</p>

<p>
p.268<br />
</p>
</div>
</div>

<div id="outline-container-org136e381" class="outline-4">
<h4 id="org136e381">R18</h4>
<div class="outline-text-4" id="text-org136e381">
<p>
在OpenDaylight SDN控制器中服务抽象层的目的是什么？<br />
</p>


<div id="org31e3489" class="figure">
<p><img src="img/fig5-17.png" alt="fig5-17.png" style="width:100%; max-width:570px;" /><br />
</p>
</div>

<p>
服务抽象层允许内部网络服务应用程序相互通信。它允许控制器组件和应用程序互相调用对方的服务，并订阅它们产生的事件。该层还为通信层的具体底层通信协议提供统一的抽象接口，包括OpenFlow和SNMP。<br />
</p>
</div>
</div>

<div id="outline-container-org2806042" class="outline-4">
<h4 id="org2806042">R19</h4>
<div class="outline-text-4" id="text-org2806042">
<p>
列举4种不同类型的ICMP报文。<br />
</p>


<div id="org04d7efc" class="figure">
<p><img src="img/fig5-19.png" alt="fig5-19.png" style="width:100%; max-width:476px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org05700bc" class="outline-4">
<h4 id="org05700bc">R20</h4>
<div class="outline-text-4" id="text-org05700bc">
<p>
在发送主机执行Traceroute程序，收到哪两种类型的ICMP报文？<br />
</p>

<p>
目的地之前的路由器发送的TTL过期（11,0）和目的主机发送的目的端口不可达（3,3）。<br />
</p>
</div>
</div>

<div id="outline-container-orgff3349f" class="outline-4">
<h4 id="orgff3349f">R21</h4>
<div class="outline-text-4" id="text-orgff3349f">
<p>
在SNMP环境中定义下列术语：管理服务器、被管设备、网络管理代理和MIB。<br />
</p>


<div id="org59cdd63" class="figure">
<p><img src="img/fig5-20.png" alt="fig5-20.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>

<p>
管理服务器是一个应用程序，它运行在网络运营中心的集中式网络管理工作站上。管理服务器是执行网络管理活动的地方，它控制网络管理信息的收集、处理、分析和显示。<br />
</p>

<p>
被管设备是网络装备的一部分（包括它的软件），位于被管理的网络中。<br />
</p>

<p>
网络管理代理是运行在被管设备中的一个进程，该进程与管理服务器通信，在管理服务器的命令和控制下在被管设备中采取本地动作。<br />
</p>

<p>
管理信息库 (Management Information Base, MIB) 收集被管设备中的每个被管对象的关联信<br />
</p>
</div>
</div>

<div id="outline-container-orgb565dc0" class="outline-4">
<h4 id="orgb565dc0">R22 SNMP报文</h4>
<div class="outline-text-4" id="text-orgb565dc0">
<p>
SNMP GetRequest和SetRequest报文的目的是什么？<br />
</p>

<p>
请求或设置位于被管设备中的一个或多个MIB对象的值。<br />
</p>
</div>
</div>

<div id="outline-container-org59db029" class="outline-4">
<h4 id="org59db029">R23</h4>
<div class="outline-text-4" id="text-org59db029">
<p>
SNMP陷阱报文的目的是什么？<br />
</p>

<p>
通知管理服务器，一个异常情况已经导致了MIB对象值的改变。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org3059d56" class="outline-3">
<h3 id="org3059d56"><span class="section-number-3">5.3.</span> 习题</h3>
<div class="outline-text-3" id="text-5-3">
</div>
<div id="outline-container-orgc7f3e86" class="outline-4">
<h4 id="orgc7f3e86">P1 图中的路径</h4>
<div class="outline-text-4" id="text-orgc7f3e86">
<p>
观察图5-3，列举从y到u不包含任何环路的路径。<br />
</p>


<div id="orga66deb9" class="figure">
<p><img src="img/fig5-3.png" alt="fig5-3.png" style="width:100%; max-width:300px;" /><br />
</p>
</div>


<div id="org7b0a9d0" class="figure">
<p><img src="img/ch5-p1.svg" alt="ch5-p1.svg" class="org-svg" style="width:100%; max-width:350px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orge660157" class="outline-4">
<h4 id="orge660157">P2</h4>
<div class="outline-text-4" id="text-orge660157">
<p>
重复习题P1，列举从x到z、z到u以及z到w的不包含任何环路的路径。<br />
</p>

<p>
x到z:<br />
</p>


<div id="org26124d7" class="figure">
<p><img src="img/ch5-p2.png" alt="ch5-p2.png" style="width:100%; max-width:600px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orga51342d" class="outline-4">
<h4 id="orga51342d">P3 Dijkstra最短路算法</h4>
<div class="outline-text-4" id="text-orga51342d">
<p>
考虑下面的网络。对于标明的链路开销，用Dijkstra的最短路算法计算出从x到所有网络节点的最短路径。通过计算一个类似于表5-1的表，说明该算法是如何工作的。<br />
</p>


<div id="org1c45547" class="figure">
<p><img src="img/ch5-p3.png" alt="ch5-p3.png" style="width:100%; max-width:280px;" /><br />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">N'</th>
<th scope="col" class="org-left">D(y),p(y)</th>
<th scope="col" class="org-left">D(z),p(z)</th>
<th scope="col" class="org-left">D(u),p(u)</th>
<th scope="col" class="org-left">D(v),p(v)</th>
<th scope="col" class="org-left">D(w),p(w)</th>
<th scope="col" class="org-left">D(t),p(t)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">x</td>
<td class="org-left">6,x</td>
<td class="org-left">8,x</td>
<td class="org-left">∞</td>
<td class="org-left">3,x</td>
<td class="org-left">6,x</td>
<td class="org-left">∞</td>
</tr>

<tr>
<td class="org-left">x,v</td>
<td class="org-left">6,x</td>
<td class="org-left">8,x</td>
<td class="org-left">6,v</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">6,x</td>
<td class="org-left">7,v</td>
</tr>

<tr>
<td class="org-left">x,v,w</td>
<td class="org-left">6,x</td>
<td class="org-left">8,x</td>
<td class="org-left">6,v</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">7,v</td>
</tr>

<tr>
<td class="org-left">x,v,w,u</td>
<td class="org-left">6,x</td>
<td class="org-left">8,x</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">7,v</td>
</tr>

<tr>
<td class="org-left">x,v,w,u,y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">8,x</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">7,v</td>
</tr>

<tr>
<td class="org-left">x,v,w,u,y,t</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">8,x</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">x,v,w,u,y,t,z</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgf195fc3" class="outline-4">
<h4 id="orgf195fc3">P4</h4>
<div class="outline-text-4" id="text-orgf195fc3">
<p>
考虑习题P3中所示的网络。使用Dijkstra算法和一个类似于表5-1的表来说明你做的工作：<br />
</p>

<ol class="org-ol">
<li>计算出从t到所有网络节点的最短路径。<br /></li>
<li>计算出从u到所有网络节点的最短路径。<br /></li>
<li>计算出从v到所有网络节点的最短路径。<br /></li>
<li>计算出从w到所有网络节点的最短路径。<br /></li>
<li>计算出从y到所有网络节点的最短路径。<br /></li>
<li>计算出从z到所有网络节点的最短路径。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">N'</th>
<th scope="col" class="org-left">D(x),p(x)</th>
<th scope="col" class="org-left">D(y),p(y)</th>
<th scope="col" class="org-left">D(z),p(z)</th>
<th scope="col" class="org-left">D(u),p(u)</th>
<th scope="col" class="org-left">D(v),p(v)</th>
<th scope="col" class="org-left">D(w),p(w)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">t</td>
<td class="org-left">∞</td>
<td class="org-left">7,t</td>
<td class="org-left">∞</td>
<td class="org-left">2,t</td>
<td class="org-left">4,t</td>
<td class="org-left">∞</td>
</tr>

<tr>
<td class="org-left">t,u</td>
<td class="org-left">∞</td>
<td class="org-left">7,t</td>
<td class="org-left">∞</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">4,t</td>
<td class="org-left">5,u</td>
</tr>

<tr>
<td class="org-left">t,u,v</td>
<td class="org-left">7,v</td>
<td class="org-left">7,t</td>
<td class="org-left">∞</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">5,u</td>
</tr>

<tr>
<td class="org-left">t,u,v,w</td>
<td class="org-left">7,v</td>
<td class="org-left">7,t</td>
<td class="org-left">∞</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">t,u,v,w,y</td>
<td class="org-left">7,v</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">19,y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">t,u,v,w,y,v</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">19,y</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">t,u,v,w,y,v,z</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table></li>
</ol>
</div>
</div>

<div id="outline-container-orgb68e8fc" class="outline-4">
<h4 id="orgb68e8fc">P5 距离向量算法</h4>
<div class="outline-text-4" id="text-orgb68e8fc">
<p>
考虑下图所示的网络，假设每个节点初始时知道到它的每个邻居的开销。考虑距离向量算法，并显示在节点z中的距离表表项。<br />
</p>


<div id="orgbc19ea9" class="figure">
<p><img src="img/ch5-p5.png" alt="ch5-p5.png" style="width:100%; max-width:240px;" /><br />
</p>
</div>

<p>
单元中如果有两项，前一项表示节点收到的距离向量，后一项是计算后更新的距离。<br />
</p>

<p>
迭代1：计算初始距离向量，然后交换接收<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">x</td>
<td class="org-right">y</td>
<td class="org-right">z</td>
<td class="org-right">u</td>
<td class="org-right">v</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">z</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">0</td>
<td class="org-right">7</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">4</td>
<td class="org-right">2</td>
<td class="org-right">7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">5</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>

<p>
迭代2：<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">x</td>
<td class="org-right">y</td>
<td class="org-left">z</td>
<td class="org-right">u</td>
<td class="org-right">v</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-left">2</td>
<td class="org-right">∞,4</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-left">∞,5</td>
<td class="org-right">2</td>
<td class="org-right">∞,3</td>
</tr>

<tr>
<td class="org-left">z</td>
<td class="org-right">2</td>
<td class="org-right">∞,5</td>
<td class="org-left">0</td>
<td class="org-right">∞,7</td>
<td class="org-right">6,5</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">∞,4</td>
<td class="org-right">2</td>
<td class="org-left">∞,7</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-right">3</td>
<td class="org-right">∞,3</td>
<td class="org-left">6,5</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>

<p>
迭代3：<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">x</td>
<td class="org-right">y</td>
<td class="org-right">z</td>
<td class="org-right">u</td>
<td class="org-right">v</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">z</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">0</td>
<td class="org-right">7,6</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">4</td>
<td class="org-right">2</td>
<td class="org-right">7,6</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">v</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">5</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgc2eb5c6" class="outline-4">
<h4 id="orgc2eb5c6">P6 距离向量算法收敛所需的迭代次数</h4>
<div class="outline-text-4" id="text-orgc2eb5c6">
<p>
考虑一个一般性拓扑（即不是以上所显示的特定网络）和一个同步版本的距离向量算法。假设每次迭代时，一个节点与其邻居交换其距离向量并接收它们的距离向量。假定算法开始时，每个节点只知道到其直接邻居的开销，在该分布式算法收敛前所需的最大迭代次数是多少？评估你的答案。<br />
</p>

<p>
在每一次迭代中，一个节点与它的邻居交换距离表。因此，如果你是节点A，而你的邻居是B，B的所有邻居在一次迭代后将知道到你的一跳或两跳的最低开销路径。<br />
</p>

<p>
设d为网络的直径——网络中任何两个节点之间无循环的最长路径的长度。利用上述推理，经过d-1次迭代，所有节点都将知道到所有其他节点的最短路径开销为d或更少的跳数。由于任何大于d跳的路径都会有环路，该算法将在最多d-1次迭代后收敛。<br />
</p>
</div>
</div>

<div id="outline-container-org4ec2929" class="outline-4">
<h4 id="org4ec2929">P7</h4>
<div class="outline-text-4" id="text-org4ec2929">
<p>
考虑下图所示的网络段。x只有两个相连邻居w与y。w有一条通向目的地u（没有显示）的最低开销路径，其值为5，y有一条通向目的地u的最低开销路径，其值为6。从w与y到u（以及w与y之间）的完整路径未显示出来。网络中所有链路开销皆为正整数值。<br />
</p>


<div id="orge849b05" class="figure">
<p><img src="img/ch5-p7.png" alt="ch5-p7.png" style="width:100%; max-width:230px;" /><br />
</p>
</div>

<ol class="org-ol">
<li>给出x对目的地w、y和u的距离向量。<br /></li>
<li>给出对于c(x,w)或c(x,y)的链路开销的变化，使得执行了距离向量算法后，x将通知其邻居有一条通向u的新最低开销路径。<br /></li>
<li>给出对c(x,w)或c(x,y)的链路开销的变化，使得执行了距离向拭算法后，x将不通知其邻居有一条通向x的新最低开销路径。<br /></li>
</ol>


<ol class="org-ol">
<li><p>
&#x00ad;<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">x</td>
<td class="org-right">w</td>
<td class="org-right">y</td>
<td class="org-right">u</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">∞</td>
</tr>

<tr>
<td class="org-left">w</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">∞</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">x</td>
<td class="org-right">w</td>
<td class="org-right">y</td>
<td class="org-right">u</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
<td class="org-right">∞,7</td>
</tr>

<tr>
<td class="org-left">w</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">5</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">5</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">u</td>
<td class="org-right">∞,7</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table></li>

<li><p>
Dx(U) = min{Dy(U)+c(x,y), Dw(U)+c(x,w)}<br />
</p>

<p>
c(x,w)或c(x,y)的链路开销变化以后如果影响上式就会使得x计算出新的到u的最低开销路径。<br />
</p></li>

<li>同上。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orged83f89" class="outline-4">
<h4 id="orged83f89">P8</h4>
<div class="outline-text-4" id="text-orged83f89">
<p>
考虑如图5-6中所示3个节点的拓扑。不使用显示在图5-6中的开销值，链路开销值现在是c(x,y)=3，c(y,z)=6，c(z,x)=4。在距离向量表初始化后和在同步版本的距离向量算法每次迭代后，计算它的距离向量表（如我们以前对图5-6讨论时所做的那样）。<br />
</p>

<pre class="example" id="orgf24e880">
    y
   / \
3 /   \ 6
 /  4  \
x-------z
</pre>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-right">x</td>
<td class="org-right">y</td>
<td class="org-right">z</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-right">0</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">y</td>
<td class="org-right">3</td>
<td class="org-right">0</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">z</td>
<td class="org-right">4</td>
<td class="org-right">6</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org3648d75" class="outline-4">
<h4 id="org3648d75">P9 无穷计数与链路开销减小</h4>
<div class="outline-text-4" id="text-org3648d75">
<ul class="org-ul">
<li><p>
考虑距离向量路由选择中的无穷计数问题。如果我们减小一条链路的开销，将会出现无穷计数问题吗？<br />
</p>

<p>
不会。<br />
</p></li>

<li><p>
为什么？<br />
</p>

<p>
因为链路开销减小不会造成环路。<br />
</p></li>

<li><p>
如果我们将没有链路的两个节点连接起来，会出现什么情况？<br />
</p>

<p>
将没有链路的两个节点连接起来，相当于将链路开销从无限大减少到有限大。<br />
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org2a2372c" class="outline-4">
<h4 id="org2a2372c">P10 距离向量算法的收敛性</h4>
<div class="outline-text-4" id="text-org2a2372c">
<p>
讨论图5-6中的距离向量算法，距离向量D(x)中的每个值不是递增的并且最终将在有限步中稳定下来。<br />
</p>

<p>
在每一次迭代中，节点基于Bellman-Ford方程更新（减少）距离向量中的一些值，在这一过程中没有数值的增加。如果没有更新，那么就不会有消息被发送出去。因此，D(x)是非递增的。由于这些路径的开销是有限的，那么最终距离向量将在有限的步骤中得到稳定。<br />
</p>
</div>
</div>

<div id="outline-container-org9bae0fc" class="outline-4">
<h4 id="org9bae0fc">P11 距离向量算法的计算过程</h4>
<div class="outline-text-4" id="text-org9bae0fc">
<p>
考虑图5-7。假定有另一台路由器w，与路由器y和z连接。所有链路的开销给定如下：c(x,y)=4, c(x,z)=50, c(y,w)=1, c(z,w)=1, c(y,z)=3。假设在距离向量路由选择算法中使用了毒性逆转。<br />
</p>

<pre class="example" id="org6b84412">
    y
   /|\
 4/ | \1
 /  |  \
x   |3  w
 \  |  /
50\ | / 1
   \|/
    z
</pre>

<ol class="org-ol">
<li>当距离向量路由选择稳定时，路由器w、y和z向x通知它们之间的距离。它们告诉彼此什么样的距离值？<br /></li>
<li>现在假设x和y之间的链路开销增加到60。如果使用了毒性逆转，将会存在无穷计数问题吗？为什么？如果存在无穷计数问题，距离向量路由选择需要多少次迭代才能再次到达稳定状态？评估你的答案。<br /></li>
<li>如果c(y,x)从4变化到60，怎样修改c(y,z)使得不存在无穷计数问题。<br /></li>
</ol>


<ol class="org-ol">
<li>&#x00ad;<br /></li>

<li><p>
&#x00ad;<br />
</p>

<pre class="example" id="org6b59ec8">
    y
   /|\
60/ | \1
 /  |  \
x   |3  w
 \  |  /
50\ | / 1
   \|/
    z
</pre>

<p>
<a href="img/ch5-p11.pdf">img/ch5-p11.pdf</a><br />
</p></li>

<li>去掉y与z之间的链路。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org2fe322a" class="outline-4">
<h4 id="org2fe322a">P12</h4>
<div class="outline-text-4" id="text-org2fe322a">
<p>
描述在BGP中是如何检测路径中的环路的。<br />
</p>

<p>
BGP路由器使用AS-PATH属性来检测和防止通告环路。如果一台路由器在路径列表中看到包含了它自己的AS，它将拒绝该通告。<br />
</p>
</div>
</div>

<div id="outline-container-orgcfcabf2" class="outline-4">
<h4 id="orgcfcabf2">P13</h4>
<div class="outline-text-4" id="text-orgcfcabf2">
<p>
BGP路由器将总是选择具有最短AS路径长度的无环路由吗？评估你的答案。<br />
</p>

<p>
不一定，在BGP的路由选择算法中本地偏好规则的优先级高于最短AS-PATH。<br />
</p>
</div>
</div>

<div id="outline-container-orgbe39078" class="outline-4">
<h4 id="orgbe39078">P14 eBGP和iBGP</h4>
<div class="outline-text-4" id="text-orgbe39078">
<p>
考虑下图所示的网络。假定AS3和AS2正在运行OSPF作为其AS内部路由选择协议。假定AS1和AS4正在运行RIP作为其AS内部路由选择协议。假定AS间路由选择协议使用的是eBGP和iBGP。假定最初在AS2和AS4之间不存在物理链路。<br />
</p>

<ol class="org-ol">
<li>路由器3c从下列哪个路由选择协议学习到了前缀x: OSPF、RIP、eBGP或iBGP？<br /></li>
<li>路由器3a从哪个路由选择协议学习到了前缀x？<br /></li>
<li>路由器1c从哪个路由选择协议学习到了前缀x？<br /></li>
<li>路由器1d从哪个路由选择协议学习到了前缀x？<br /></li>
</ol>



<div id="orga6cadb6" class="figure">
<p><img src="img/ch5-p14.png" alt="ch5-p14.png" style="width:100%; max-width:470px;" /><br />
</p>
</div>

<ol class="org-ol">
<li>eBGP<br /></li>
<li>iBGP<br /></li>
<li>eBGP<br /></li>
<li>iBGP<br /></li>
</ol>
</div>
</div>

<div id="outline-container-orgd46f6ba" class="outline-4">
<h4 id="orgd46f6ba">P15</h4>
<div class="outline-text-4" id="text-orgd46f6ba">
<p>
参考前面习题P14，一旦路由器1d知道了x的情况，它将一个表项(x, I)放入它的转发表中。<br />
</p>

<ol class="org-ol">
<li>对这个表项而言，I将等于I<sub>1</sub>还是I<sub>2</sub>？用一句话解释其原因。<br /></li>
<li>现在假定在AS2和AS4之间有一条物理链路，显示为图中的虚线。假定路由器1d知道经AS2以及经AS3能够访问到x。I将设登为I<sub>1</sub>还是I<sub>2</sub>？用一句话解释其原因。<br /></li>
<li>现在假定有另一个AS，它称为AS5，其位于路径AS2和AS4之间（没有显示在图中）。假定路由器1d知道经AS2 AS5 AS4以及经过AS3 AS4能够访问到x。I将设置为I<sub>1</sub>还是I<sub>2</sub>？用一句话解释其原因。<br /></li>
</ol>


<ol class="org-ol">
<li>I<sub>1</sub>，因为这是到网关1c的最低开销路径。<br /></li>
<li>I<sub>2</sub>，根据热土豆算法选择网关1b。<br /></li>
<li>I<sub>1</sub>，根据最短AS-PATH。<br /></li>
</ol>
</div>
</div>

<div id="outline-container-org0c2e591" class="outline-4">
<h4 id="org0c2e591">P16</h4>
<div class="outline-text-4" id="text-org0c2e591">
<p>
考虑下面的网络。ISP B为地区ISP A提供国家级主干服务。ISP C为地区ISP D提供国家级主干服务。每个ISP由一个AS组成。B和C使用BGP，在两个地方互相对等。考虑从A到D的流量。B愿意将流量交给C传给西海岸（使得C将承载跨越整个国家的流量开销），而C愿意经其东海<br />
岸与B对等的站点得到这些流量（使得B将承载跨越整个国家的流量）。C可能会使用什么样的BGP机制，使得B将通过东海岸对等点传递A到D的流量？要回答这个问题，你需要钻研BGP规范。<br />
</p>


<div id="orgc38bfc5" class="figure">
<p><img src="img/ch5-p16.png" alt="ch5-p16.png" style="width:100%; max-width:320px;" /><br />
</p>
</div>

<p>
C只通告通过东海岸的对等点到D的路径。<br />
</p>
</div>
</div>

<div id="outline-container-org2f5da61" class="outline-4">
<h4 id="org2f5da61">P17</h4>
<div class="outline-text-4" id="text-org2f5da61">
<p>
在图5-13中，考虑到达桩网络W、X和Y的路径信息。基于W与X处的可用信息，它们分别看到的网络拓扑是什么？评估你的答案。Y所见的拓扑视图如下图所示。<br />
</p>


<div id="org0c847ed" class="figure">
<p><img src="img/fig5-13.png" alt="fig5-13.png" style="width:100%; max-width:340px;" /><br />
</p>
</div>


<div id="orgdd95703" class="figure">
<p><img src="img/ch5-p17.png" alt="ch5-p17.png" style="width:100%; max-width:340px;" /><br />
</p>
</div>


<div id="org6b161df" class="figure">
<p><img src="img/ch5-p17a.png" alt="ch5-p17a.png" style="width:100%; max-width:270px;" /><br />
</p>
</div>
</div>
</div>

<div id="outline-container-orga6b575d" class="outline-4">
<h4 id="orga6b575d">P18 P2P与BGP</h4>
<div class="outline-text-4" id="text-orga6b575d">
<p>
考虑图5-13。B将不会基于BGP路由选择，经过X以Y为目的地转发流量。但是有某些极为流行的应用程序，其数据分组先朝向X，然后再流向Y。指出一种这样的应用程序，描述数据分组是如何沿着这条未由BGP路由选择所给定的路径流动的。<br />
</p>


<div id="org0c238a3" class="figure">
<p><img src="img/fig5-13.png" alt="fig5-13.png" style="width:100%; max-width:340px;" /><br />
</p>
</div>

<blockquote>
<p>
BitTorrent file sharing and Skype P2P applications.<br />
</p>

<p>
Consider a BitTorrent file sharing network in which peer 1, 2, and 3 are in stub networks W, X, and Y respectively. Due the mechanism of BitTorrent’s file sharing, it is quire possible that peer 2 gets data chunks from peer 1 and then forwards those data chunks to 3. This is equivalent to B forwarding data that is finally destined to stub network Y.<br />
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org633a7f1" class="outline-4">
<h4 id="org633a7f1">P19</h4>
<div class="outline-text-4" id="text-org633a7f1">
<p>
在图5-13中，假定有另一个桩网络V，它为ISP A的客户。假设B和C具有对等关系，并且A是B和C的客户。假设A希望让发向W的流量仅来自B，并且发向V的流量来自B或C。A如何向B和C通告其路由？C收到什么样的AS路由？<br />
</p>


<div id="org90ea294" class="figure">
<p><img src="img/ch5-p19.png" alt="ch5-p19.png" style="width:100%; max-width:250px;" /><br />
</p>
</div>

<p>
A向B通告：AW、AV<br />
A向C通告：AV<br />
C收到的AS路由：AV、BAV、BAW<br />
</p>
</div>
</div>

<div id="outline-container-org69615aa" class="outline-4">
<h4 id="org69615aa">P20 BGP通告与策略</h4>
<div class="outline-text-4" id="text-org69615aa">
<p>
假定AS X和Z不直接连接，但与AS Y连接。进一步假定X与Y具有对等协定，Y与Z具有对等协定。最后，假定Z要传送所有Y的流量但不传送X的流量。BGP允许Z实现这种策略吗？<br />
</p>

<p>
Z如果要传送Y的流量，那么就要向其通告，这样Y可以选择Z这条路径传送分组。在这之后Y可以将通过Z的路由信息通告给X，Z对Y的这种行为是无能为力的。<br />
</p>
</div>
</div>

<div id="outline-container-org8a21f06" class="outline-4">
<h4 id="org8a21f06">P21 SNMP的请求响应和陷阱方式</h4>
<div class="outline-text-4" id="text-org8a21f06">
<p>
考虑在管理实体和被管设备之间发生通信的两种方式：请求响应方式和陷阱方式。从以下方面考虑这两种方式的优缺点：①开销；②当异常事件出现时通知的时间；③对于管理实体和设备之间丢失报文的健壮性。<br />
</p>

<p>
以交换报文的数量来衡量，请求响应方式通常需要更多的开销。首先，管理实体接收一条信息发送需要两个报文：请求和回答。陷阱方式只发送一个报文。更进一步，管理实体如果需要知道某一个特定事件是否发生，需要一直向被管设备发送请求来询问。而陷阱方式只需要在发生事件时发送一条报文。<br />
</p>

<p>
陷阱方式会在事件发生时立即通知管理实体。而通过轮询方式，管理实体需要在事件发生和管理实体发现事件发生之间等待半个轮询周期（平均）。<br />
</p>

<p>
如果一个陷阱消息丢失了，被管设备将不会再发送一个副本。如果一个请求信息或其响应丢失，管理实体可以在有需要的情况下重新发送请求。<br />
</p>
</div>
</div>

<div id="outline-container-org9f83d78" class="outline-4">
<h4 id="org9f83d78">P22 SNMP选择UDP而不是TCP</h4>
<div class="outline-text-4" id="text-org9f83d78">
<p>
在5.7节中我们看到，用不可靠的UDP数据报传输SNMP报文是更可取的方式。请考虑SNMP设计者选择UDP而不是TCP作为SNMP运输协议的理由。<br />
</p>

<p>
TCP相较于UDP提供了差错控制、报文按序和拥塞控制功能，但是要需要额外的开销。<br />
</p>

<p>
不需要差错控制，是因为每个请求都会产生一个响应。如果SNMP应用程序没有收到响应，它会重新发出请求。<br />
</p>

<p>
不需要报文按序，是因为每个请求和每个响应都作为一个单一的数据报传输。<br />
</p>

<p>
不需要拥塞控制，是因为最需要网络管理的时候通常是在网络压力大的时候，这时网络可能严重拥堵、丢包。如果SNMP在TCP上运行，TCP的拥堵控制会导致SNMP发送速率受限，在网络管理员需要发送SNMP信息的时候停止发送信息。<br />
</p>

<p>
参考：<br />
</p>

<p>
<a href="http://web.deu.edu.tr/doc/oreily/networking/tcpip/ch11_09.htm">TCP/IP Network Administration</a><br />
<a href="https://datatracker.ietf.org/doc/html/rfc1448#section-2.6">RFC1448#Transport Mappings</a><br />
</p>
</div>
</div>
</div>

<div id="outline-container-org09d3647" class="outline-3">
<h3 id="org09d3647"><span class="section-number-3">5.4.</span> 套接字编程作业 ICMP ping</h3>
<div class="outline-text-3" id="text-5-4">
<p>
<a href="code/ch5-icmp-ping/socket5-icmppinger.pdf">Socket Programming Assignment 5: ICMP Pinger</a><br />
</p>

<div class="org-src-container">
<pre class="src src-python"><span class="org-comment-delimiter">#</span><span class="org-comment">!/usr/bin/env python3</span>
<span class="org-doc">"""[summary]"""</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">pylint: disable=global-statement, invalid-name</span>

<span class="org-keyword">import</span> argparse
<span class="org-keyword">import</span> binascii
<span class="org-keyword">import</span> datetime
<span class="org-keyword">import</span> os
<span class="org-keyword">import</span> select
<span class="org-keyword">import</span> struct
<span class="org-keyword">import</span> sys
<span class="org-keyword">import</span> time
<span class="org-keyword">from</span> socket <span class="org-keyword">import</span> (AF_INET, SOCK_RAW, gethostbyname, getprotobyname, htons,
                    socket)

<span class="org-variable-name">ICMP_ECHO_REQUEST</span> = 8

<span class="org-variable-name">verbose</span> = <span class="org-constant">False</span>

<span class="org-keyword">def</span> <span class="org-function-name">checksum</span>(astr: <span class="org-builtin">bytes</span>) -&gt; <span class="org-builtin">int</span>:
    <span class="org-doc">"""Need no concern.</span>

<span class="org-doc">    See `Calculating checksum for ICMP echo request in Python`_.</span>

<span class="org-doc">    .. _Calculating checksum for ICMP echo request in Python:</span>
<span class="org-doc">       https://stackoverflow.com/a/55222144</span>
<span class="org-doc">    """</span>
    <span class="org-variable-name">csum</span> = 0
    <span class="org-variable-name">count_to</span> = (<span class="org-builtin">len</span>(astr) / 2) * 2  <span class="org-comment-delimiter"># </span><span class="org-comment">&#20808;&#22788;&#29702;&#21069;&#38754;&#30340;&#20598;&#25968;&#20010;8&#20301;</span>

    <span class="org-variable-name">count</span> = 0
    <span class="org-keyword">while</span> count &lt; count_to:
        <span class="org-comment-delimiter"># </span><span class="org-comment">Adjacent octets in the source_string are paired to form</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">16-bit integers</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">No need ord in python3</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">https://stackoverflow.com/a/50111388</span>
        <span class="org-variable-name">this_val</span> = (astr[count+1] &lt;&lt; 8) + astr[count]
        <span class="org-variable-name">csum</span> = csum + this_val
        <span class="org-variable-name">csum</span> = csum &amp; 0xffffffff  <span class="org-comment-delimiter"># </span><span class="org-comment">truncate the sum to 32-bits</span>
        <span class="org-variable-name">count</span> = count + 2

    <span class="org-comment-delimiter"># </span><span class="org-comment">In case of odd number of octets, add the remaining octet to the</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">sum.</span>
    <span class="org-keyword">if</span> count_to &lt; <span class="org-builtin">len</span>(astr):
        <span class="org-variable-name">csum</span> = csum + astr[<span class="org-builtin">len</span>(astr) - 1]
        <span class="org-variable-name">csum</span> = csum &amp; 0xffffffff

    <span class="org-comment-delimiter"># </span><span class="org-comment">&#39640;16&#20301;&#19982;&#20302;16&#20301;&#30456;&#21152;</span>
    <span class="org-variable-name">csum</span> = (csum &gt;&gt; 16) + (csum &amp; 0xffff)
    <span class="org-comment-delimiter"># </span><span class="org-comment">&#25226;&#39640;&#20301;&#28322;&#20986;&#21152;&#22238;&#20302;&#20301;&#65292;&#36824;&#26159;&#20570;1's complement sum</span>
    <span class="org-variable-name">csum</span> += csum &gt;&gt; 16
    <span class="org-variable-name">answer</span> = ~csum
    <span class="org-variable-name">answer</span> = answer &amp; 0xffff
    <span class="org-variable-name">answer</span> = answer &gt;&gt; 8 | (answer &lt;&lt; 8 &amp; 0xff00)
    <span class="org-keyword">return</span> answer


<span class="org-keyword">def</span> <span class="org-function-name">receive_one_ping</span>(my_socket: socket, the_id: <span class="org-builtin">int</span>, timeout: <span class="org-builtin">int</span>, dest_addr: <span class="org-builtin">str</span>) -&gt; <span class="org-constant">None</span>:
    <span class="org-doc">"""Receive the structure ICMP_ECHO_REPLY and fetch the information."""</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">Python&#30340;select()&#20989;&#25968;&#26159;&#37096;&#32626;&#24213;&#23618;&#25805;&#20316;&#31995;&#32479;&#30340;&#30452;&#25509;&#25509;&#21475;&#12290;&#23427;&#30417;&#35270;&#30528;&#22871;</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">&#25509;&#23383;&#12289;&#25171;&#24320;&#30340;&#25991;&#20214;&#21644;&#31649;&#36947;&#30452;&#21040;&#23427;&#20204;&#21464;&#24471;&#21487;&#35835;&#21487;&#20889;&#25110;&#26377;&#38169;&#35823;&#21457;&#29983;&#12290;</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">https://learnku.com/docs/pymotw/select-wait-for-io-efficiently/3429#5dd208</span>
    <span class="org-variable-name">readable</span>, <span class="org-variable-name">_</span>, <span class="org-variable-name">_</span> = select.select([my_socket], [], [], timeout)

    <span class="org-keyword">if</span> readable == []:  <span class="org-comment-delimiter"># </span><span class="org-comment">Timeout</span>
        <span class="org-builtin">print</span>(<span class="org-string">"Request timed out."</span>)
        <span class="org-keyword">return</span>

    time_received = time.time()
    <span class="org-variable-name">rec_packet</span>, <span class="org-variable-name">addr</span> = my_socket.recvfrom(1024)
    dt = datetime.datetime.fromtimestamp(time_received)
    dt = dt.strftime(<span class="org-string">'%H:%M.%f'</span>)
    vprint(f<span class="org-string">'Received at </span>{dt}<span class="org-string">\n  from: </span>{addr}<span class="org-string">\n  packet: </span>{binascii.hexlify(rec_packet)}<span class="org-string">'</span>)

    <span class="org-comment-delimiter">#</span><span class="org-comment">Fill in start</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Fetch the ICMP header from the IP packet</span>
    icmp_content = rec_packet[20:]
    <span class="org-variable-name">_</span>, <span class="org-variable-name">_</span>, <span class="org-variable-name">_</span>, <span class="org-variable-name">_</span>, <span class="org-variable-name">_</span>, <span class="org-variable-name">data</span> = struct.unpack(<span class="org-string">'bbHHhd'</span>, icmp_content)
    <span class="org-builtin">print</span>(f<span class="org-string">'time=</span>{(time_received-data)*1000:.3f}<span class="org-string"> ms'</span>)
    <span class="org-comment-delimiter">#</span><span class="org-comment">Fill in end</span>


<span class="org-keyword">def</span> <span class="org-function-name">send_one_ping</span>(my_socket: socket, dest_addr: <span class="org-builtin">str</span>, the_id: <span class="org-builtin">int</span>) -&gt; <span class="org-constant">None</span>:
    <span class="org-doc">"""send_one_ping"""</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Header is type (8), code (8), checksum (16), id (16), sequence (16)</span>

    my_checksum = 0
    <span class="org-comment-delimiter"># </span><span class="org-comment">Make a dummy header with a 0 checksum.</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">struct -- Interpret strings as packed binary data</span>
    header = struct.pack(<span class="org-string">"bbHHh"</span>, ICMP_ECHO_REQUEST, 0, my_checksum, the_id, 1)
    data = struct.pack(<span class="org-string">"d"</span>, time.time())
    <span class="org-comment-delimiter"># </span><span class="org-comment">Calculate the checksum on the data and the dummy header.</span>
    my_checksum = checksum(header + data)

    <span class="org-comment-delimiter"># </span><span class="org-comment">Get the right checksum, and put in the header</span>
    <span class="org-keyword">if</span> sys.platform == <span class="org-string">'darwin'</span>:
        my_checksum = htons(my_checksum) &amp; 0xffff
        <span class="org-comment-delimiter"># </span><span class="org-comment">Convert 16-bit integers from host to network byte order.</span>
    <span class="org-keyword">else</span>:
        my_checksum = htons(my_checksum)

    vprint(f<span class="org-string">'Checksum: </span>{my_checksum:x}<span class="org-string">'</span>)
    header = struct.pack(<span class="org-string">"bbHHh"</span>, ICMP_ECHO_REQUEST, 0, my_checksum, the_id, 1)
    packet = header + data

    vprint(f<span class="org-string">'Send packet: </span>{binascii.hexlify(packet)}<span class="org-string">'</span>)

    <span class="org-comment-delimiter"># </span><span class="org-comment">AF_INET address must be tuple, not str</span>
    my_socket.sendto(packet, (dest_addr, 1))
    <span class="org-comment-delimiter"># </span><span class="org-comment">Both LISTS and TUPLES consist of a number of</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">which can be referenced by their position number within the object</span>


<span class="org-keyword">def</span> <span class="org-function-name">do_one_ping</span>(dest_addr: <span class="org-builtin">str</span>, timeout: <span class="org-builtin">int</span>) -&gt; <span class="org-constant">None</span>:
    <span class="org-doc">"""do_one_ping"""</span>
    icmp = getprotobyname(<span class="org-string">"icmp"</span>)
    <span class="org-comment-delimiter"># </span><span class="org-comment">SOCK_RAW is a powerful socket type. For more details see:</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">http://sock-raw.org/papers/sock_raw</span>

    <span class="org-comment-delimiter">#</span><span class="org-comment">Fill in start</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Create Socket here</span>
    my_socket: socket = socket(family=AF_INET, <span class="org-builtin">type</span>=SOCK_RAW, proto=icmp)
    <span class="org-comment-delimiter">#</span><span class="org-comment">Fill in end</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">Return the current process i</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">0xFFFF&#21462;&#20302;16&#20301;</span>
    my_id = os.getpid() &amp; 0xFFFF
    send_one_ping(my_socket, dest_addr, my_id)
    receive_one_ping(my_socket, my_id, timeout, dest_addr)

    my_socket.close()


<span class="org-keyword">def</span> <span class="org-function-name">ping</span>(host: <span class="org-builtin">str</span>, timeout: <span class="org-builtin">int</span> = 1) -&gt; <span class="org-constant">None</span>:
    <span class="org-doc">"""Ping host with timeout."""</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">timeout=1 means: If one second goes by without a reply from the</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">server, the client assumes that either the client&#8217;s ping or the</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">server&#8217;s pong is lost</span>
    dest = gethostbyname(host)
    <span class="org-builtin">print</span>(f<span class="org-string">'(</span>{dest}<span class="org-string">):'</span>)

    <span class="org-comment-delimiter"># </span><span class="org-comment">Send ping requests to a server separated by approximately one</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">second</span>
    <span class="org-keyword">while</span> 1:
        do_one_ping(dest, timeout)
        time.sleep(1)  <span class="org-comment-delimiter"># </span><span class="org-comment">one second</span>

<span class="org-keyword">def</span> <span class="org-function-name">vprint</span>(s: <span class="org-builtin">str</span>) -&gt; <span class="org-constant">None</span>:
    <span class="org-doc">"""Print only verbose"""</span>
    <span class="org-keyword">if</span> verbose:
        <span class="org-builtin">print</span>(s)
    <span class="org-keyword">else</span>:
        <span class="org-keyword">pass</span>

<span class="org-keyword">def</span> <span class="org-function-name">main</span>() -&gt; <span class="org-constant">None</span>:
    <span class="org-doc">"""main"""</span>
    parser = argparse.ArgumentParser(description=<span class="org-string">'Process some integers.'</span>)
    parser.add_argument(<span class="org-string">"host"</span>)
    parser.add_argument(<span class="org-string">"-v"</span>, <span class="org-string">"--verbose"</span>, action=<span class="org-string">"store_true"</span>)
    args = parser.parse_args()
    <span class="org-keyword">global</span> verbose
    verbose = args.verbose
    <span class="org-builtin">print</span>(f<span class="org-string">'Ping </span>{args.host}<span class="org-string">'</span>, end=<span class="org-string">' '</span>)
    ping(args.host)


<span class="org-keyword">if</span> <span class="org-builtin">__name__</span> == <span class="org-string">"__main__"</span>:
    main()
</pre>
</div>
</div>
</div>

<div id="outline-container-org9189175" class="outline-3">
<h3 id="org9189175"><span class="section-number-3">5.5.</span> 编程作业 分布式异步距离向量路由选择算法</h3>
<div class="outline-text-3" id="text-5-5">
<p>
<a href="http://lass.cs.umass.edu/~shenoy/courses/spring00/653/homeworks/prog1.html">Implemented a distributed, asynchronous distance vector routing algorithm</a><br />
</p>
</div>

<div id="outline-container-org60bed5e" class="outline-4">
<h4 id="org60bed5e">Basic</h4>
<div class="outline-text-4" id="text-org60bed5e">
<p>
关键代码如下：<br />
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>node.c</label><pre class="src src-c"><span class="org-type">void</span> <span class="org-function-name">rtinit</span>(<span class="org-type">int</span> <span class="org-variable-name">node</span>,
            <span class="org-keyword">struct</span> <span class="org-type">distance_table</span> *<span class="org-variable-name">dt</span>,
            <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">neighbors</span>[],
            <span class="org-type">int</span> <span class="org-variable-name">neighbor_num</span>,
            <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">costs_to_nodes_init</span>[]) {
    printf(<span class="org-string">"Router%d init\n"</span>, node);

    <span class="org-comment-delimiter">/*</span><span class="org-comment">1.&#21021;&#22987;&#21270;&#33258;&#24049;&#30340;&#36317;&#31163;&#21521;&#37327;&#65292;&#20854;&#20313;&#33410;&#28857;&#21021;&#22987;&#21270;&#20026;&#8734;</span><span class="org-comment-delimiter">*/</span>
    <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; NODE_NUM; ++i) {
        <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">j</span> = 0; j &lt; NODE_NUM; ++j) {
            dt-&gt;costs[i][j] = INFINITY;
        }
    }
    memcpy(dt-&gt;costs[node], costs_to_nodes_init, <span class="org-keyword">sizeof</span>(dt-&gt;costs[node]));
    printf(<span class="org-string">"    current dt is\n"</span>);
    printdt(dt);

    <span class="org-comment-delimiter">/*</span><span class="org-comment">2.&#25226;&#33258;&#24049;&#30340;&#36317;&#31163;&#21521;&#37327;&#21457;&#36865;&#32473;&#37051;&#23621;</span><span class="org-comment-delimiter">*/</span>
    send_dt_to_neighbors(node, dt, neighbors, neighbor_num);
}

<span class="org-type">void</span> <span class="org-function-name">rtupdate</span>(<span class="org-type">int</span> <span class="org-variable-name">node</span>,
              <span class="org-keyword">struct</span> <span class="org-type">distance_table</span> *<span class="org-variable-name">dt</span>,
              <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">neighbors</span>[],
              <span class="org-type">int</span> <span class="org-variable-name">neighbor_num</span>,
              <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">costs_to_neighbor</span>[],
              <span class="org-keyword">const</span> <span class="org-keyword">struct</span> <span class="org-type">rtpkt</span> *<span class="org-variable-name">rcvdpkt</span>) {
    printf(<span class="org-string">"Router%d receive "</span>, node);
    print_rtpkt(rcvdpkt);

    <span class="org-comment-delimiter">/*</span><span class="org-comment">1.&#22312;&#36317;&#31163;&#34920;&#20013;&#26356;&#26032;&#25910;&#21040;&#30340;&#36317;&#31163;&#21521;&#37327;</span><span class="org-comment-delimiter">*/</span>
    <span class="org-type">int</span> <span class="org-variable-name">sourceid</span> = rcvdpkt-&gt;sourceid;
    memcpy(dt-&gt;costs[sourceid], rcvdpkt-&gt;mincost, <span class="org-keyword">sizeof</span>(dt-&gt;costs[sourceid]));

    <span class="org-type">bool</span> <span class="org-variable-name">dt_updated</span> = <span class="org-constant">false</span>;

    <span class="org-comment-delimiter">/*</span><span class="org-comment">2.&#35745;&#31639;&#21040;&#33410;&#28857;i&#21040;&#36317;&#31163;&#26159;&#21542;&#38656;&#35201;&#26356;&#26032;</span><span class="org-comment-delimiter">*/</span>
    <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; NODE_NUM; i++) {
        <span class="org-comment-delimiter">/* </span><span class="org-comment">0to1 = min{c(0,1)+D1(1), c(0,2)+D2(1), c(0,3)+D3(1)}</span><span class="org-comment-delimiter"> */</span>

        <span class="org-keyword">if</span> (i == node) <span class="org-keyword">continue</span>; <span class="org-comment-delimiter">/*</span><span class="org-comment">&#30446;&#26631;&#26159;&#33258;&#36523;&#30340;&#26102;&#20505;&#65292;&#32467;&#26524;&#26159;0</span><span class="org-comment-delimiter">*/</span>
        printf(<span class="org-string">"    recalculate cost to router%d\n"</span>, i);

        <span class="org-comment-delimiter">/*</span><span class="org-comment">2.1.&#37325;&#26032;&#35745;&#31639;&#32463;&#30001;&#25152;&#26377;&#37051;&#23621;&#21040;i&#30340;&#36335;&#24452;</span><span class="org-comment-delimiter">*/</span>
        <span class="org-type">int</span> <span class="org-variable-name">current_cost</span> = dt-&gt;costs[node][i];
        printf(<span class="org-string">"    current cost is %d\n"</span>, current_cost);

        <span class="org-type">int</span> *<span class="org-variable-name">candidates</span> = malloc(neighbor_num * <span class="org-keyword">sizeof</span>(<span class="org-type">int</span>));

        <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">j</span> = 0; j &lt; neighbor_num; ++j) {
            <span class="org-type">int</span> <span class="org-variable-name">c</span> = costs_to_neighbor[j] + dt-&gt;costs[neighbors[j]][i];
            printf(<span class="org-string">"    via %d to %d cost is %d\n"</span>, neighbors[j], i, c);
            candidates[j] = c;
        }

        <span class="org-comment-delimiter">/*</span><span class="org-comment">2.2.&#27604;&#36739;&#26159;&#21542;&#38656;&#35201;&#26356;&#26032;</span><span class="org-comment-delimiter">*/</span>
        qsort(candidates, neighbor_num, <span class="org-keyword">sizeof</span>(<span class="org-type">int</span>), compare);

        <span class="org-keyword">if</span> (candidates[0] != current_cost) {
            printf(<span class="org-string">"    update cost to router%d from %d to %d\n"</span>, i, current_cost, candidates[0]);
            dt-&gt;costs[node][i] = candidates[0];
            printf(<span class="org-string">"    now dt is\n"</span>);
            printdt(dt);
            dt_updated = <span class="org-constant">true</span>;
        } <span class="org-keyword">else</span> {
            printf(<span class="org-string">"    no better cost\n"</span>);
        }
        free(candidates);
    }
    <span class="org-keyword">if</span> (dt_updated) send_dt_to_neighbors(node, dt, neighbors, neighbor_num);
}

<span class="org-keyword">static</span> <span class="org-type">void</span> <span class="org-function-name">send_dt_to_neighbors</span>(<span class="org-type">int</span> <span class="org-variable-name">node</span>,
                                 <span class="org-keyword">struct</span> <span class="org-type">distance_table</span> *<span class="org-variable-name">dt</span>,
                                 <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">neighbors</span>[],
                                 <span class="org-type">int</span> <span class="org-variable-name">neighbor_num</span>) {
    printf(<span class="org-string">"Router%d send "</span>, node);
    <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; neighbor_num; i++) {
        <span class="org-keyword">if</span> (neighbors[i] == node) <span class="org-keyword">continue</span>; <span class="org-comment-delimiter">/*</span><span class="org-comment">&#19981;&#38656;&#35201;&#23545;&#33258;&#24049;&#21457;&#36865;</span><span class="org-comment-delimiter">*/</span>
        <span class="org-keyword">struct</span> <span class="org-type">rtpkt</span> <span class="org-variable-name">sndpkt</span> = {};
        creatertpkt(&amp;sndpkt, node, neighbors[i], dt-&gt;costs[node]);
        <span class="org-keyword">if</span> (i == 0) {
            printf(<span class="org-string">"{%d %d %d %d} to"</span>,
                   sndpkt.mincost[0], sndpkt.mincost[1],
                   sndpkt.mincost[2], sndpkt.mincost[3]);
        }
        printf(<span class="org-string">" router%d"</span>, neighbors[i]);
        tolayer2(sndpkt);
        message_count += 1;
    }
    printf(<span class="org-string">"\n"</span>);
}
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>node0.c</label><pre class="src src-c"><span class="org-preprocessor">#define</span> <span class="org-variable-name">ME</span> 0                              <span class="org-comment-delimiter">/*</span><span class="org-comment">&#25351;&#26126;&#33258;&#36523;&#26159;&#21738;&#20010;&#33410;&#28857;</span><span class="org-comment-delimiter">*/</span>
<span class="org-preprocessor">#define</span> <span class="org-variable-name">NEIGHBOR_NUM</span> 3                    <span class="org-comment-delimiter">/*</span><span class="org-comment">&#37051;&#23621;&#33410;&#28857;&#25968;&#37327;</span><span class="org-comment-delimiter">*/</span>

<span class="org-keyword">static</span> <span class="org-keyword">struct</span> <span class="org-type">distance_table</span> <span class="org-variable-name">dt</span>;                         <span class="org-comment-delimiter">/*</span><span class="org-comment">&#36317;&#31163;&#34920;</span><span class="org-comment-delimiter">*/</span>
<span class="org-keyword">static</span> <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">neighbors</span>[] = {1, 2, 3};                <span class="org-comment-delimiter">/*</span><span class="org-comment">&#25152;&#26377;&#37051;&#23621;&#33410;&#28857;</span><span class="org-comment-delimiter">*/</span>
<span class="org-keyword">static</span> <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">costs_to_neighbor</span>[] = {1, 3, 7};        <span class="org-comment-delimiter">/*</span><span class="org-comment">&#21040;&#30456;&#24212;&#37051;&#23621;&#33410;&#28857;&#30340;&#36317;&#31163;</span><span class="org-comment-delimiter">*/</span>
<span class="org-keyword">static</span> <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">costs_to_nodes_init</span>[] = {0, 1, 3, 7};   <span class="org-comment-delimiter">/*</span><span class="org-comment">&#21021;&#22987;&#21270;&#25152;&#29992;&#30340;&#21040;&#25152;&#26377;&#33410;&#28857;&#30340;&#36317;&#31163;&#65292;&#25353;&#29031;0&#12289;1&#12289;2&#12289;3&#30340;&#39034;&#24207;</span><span class="org-comment-delimiter">*/</span>

<span class="org-type">void</span> <span class="org-function-name">rtinit0</span>() {
    rtinit(ME, &amp;dt, neighbors, NEIGHBOR_NUM, costs_to_nodes_init);
}

<span class="org-type">void</span> <span class="org-function-name">rtupdate0</span>(<span class="org-keyword">struct</span> <span class="org-type">rtpkt</span> *<span class="org-variable-name">rcvdpkt</span>) {
    rtupdate(ME, &amp;dt, neighbors, NEIGHBOR_NUM, costs_to_neighbor, rcvdpkt);
}
</pre>
</div>

<p>
下面的输出展示了节点3收到节点0的distance vector后更新自己的distance table，然后向邻居发送的过程：<br />
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>a.txt</label><pre class="src src-shell">Router3 init
    current dt is
                    to
          |    0     1     2     3
      ----|-----------------------
         0|  999   999   999   999
    from 1|  999   999   999   999
         2|  999   999   999   999
         3|    7   999     2     0
Router3 send {7 999 2 0} to router0 router2
MAIN: rcv event, <span class="org-variable-name">t</span>=0.420, at 3 src: 0, dest: 3, contents:   0   1   3   7
Router3 receive rtpkt: {sourceid: 0, destid: 3, mincost: 0 1 3 7}
    recalculate cost to router0
    current cost is 7
    via 0 to 0 cost is 7
    via 2 to 0 cost is 1001
    no better cost
    recalculate cost to router1
    current cost is 999
    via 0 to 1 cost is 8
    via 2 to 1 cost is 1001
    update cost to router1 from 999 to 8
    now dt is
                    to
          |    0     1     2     3
      ----|-----------------------
         0|    0     1     3     7
    from 1|  999   999   999   999
         2|  999   999   999   999
         3|    7     8     2     0
    recalculate cost to router2
    current cost is 2
    via 0 to 2 cost is 10
    via 2 to 2 cost is 1001
    no better cost
Router3 send {7 8 2 0} to router0 router2
</pre>
</div>

<p>
最终的路由表如下所示：<br />
</p>

<div class="org-src-container">
<pre class="src src-shell">                to
      |    0     1     2     3
  ----|-----------------------
     0|    0     1     2     4
from 1|    1     0     1     3
     2|    3     1     0     2
     3|    5     3     2     0
</pre>
</div>

<p>
总共发送了32个报文完成了计算。<br />
</p>

<div class="org-src-container">
<pre class="src src-shell">MAIN: rcv event, <span class="org-variable-name">t</span>=10000.000, at -1MAIN: rcv event, <span class="org-variable-name">t</span>=20000.000, at 0
Total message sent: 32
Simulator terminated at <span class="org-variable-name">t</span>=20000.000000, no packets<span class="org-keyword"> in</span> medium
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc9ac83e" class="outline-4">
<h4 id="orgc9ac83e">Advanced</h4>
<div class="outline-text-4" id="text-orgc9ac83e">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>node.c</label><pre class="src src-c">PRIVATE <span class="org-type">bool</span>
<span class="org-function-name">recalculate</span>(<span class="org-type">int</span> <span class="org-variable-name">node</span>, <span class="org-keyword">struct</span> <span class="org-type">distance_table</span> *<span class="org-variable-name">dt</span>, <span class="org-keyword">const</span> <span class="org-type">int</span> *<span class="org-variable-name">neighbors</span>, <span class="org-type">int</span> <span class="org-variable-name">neighbor_num</span>, <span class="org-keyword">const</span> <span class="org-type">int</span> *<span class="org-variable-name">costs_to_neighbor</span>) {
    <span class="org-type">bool</span> <span class="org-variable-name">dt_updated</span>;

    <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">i</span> = 0; i &lt; NODE_NUM; i++) {
        <span class="org-comment-delimiter">/*</span><span class="org-comment">&#21040;&#30446;&#26631;&#33410;&#28857;i</span><span class="org-comment-delimiter">*/</span>
        <span class="org-comment-delimiter">/* </span><span class="org-comment">0to1 = min{c(0,1)+D1(1), c(0,2)+D2(1), c(0,3)+D3(1)}</span><span class="org-comment-delimiter"> */</span>

        <span class="org-keyword">if</span> (i == node) <span class="org-keyword">continue</span>; <span class="org-comment-delimiter">/*</span><span class="org-comment">&#30446;&#26631;&#26159;&#33258;&#36523;&#30340;&#26102;&#20505;&#65292;&#32467;&#26524;&#26159;0</span><span class="org-comment-delimiter">*/</span>
        printf(<span class="org-string">"    recalculate cost to router%d\n"</span>, i);

        <span class="org-comment-delimiter">/*</span><span class="org-comment">2.1.&#37325;&#26032;&#35745;&#31639;&#32463;&#30001;&#25152;&#26377;&#37051;&#23621;&#21040;i&#30340;&#36335;&#24452;</span><span class="org-comment-delimiter">*/</span>
        <span class="org-type">int</span> <span class="org-variable-name">current_cost</span> = dt-&gt;costs[node][i];
        printf(<span class="org-string">"        current cost is %d\n"</span>, current_cost);

        <span class="org-type">int</span> *<span class="org-variable-name">candidates</span> = malloc(neighbor_num * <span class="org-keyword">sizeof</span>(<span class="org-type">int</span>));
        <span class="org-keyword">for</span> (<span class="org-type">int</span> <span class="org-variable-name">j</span> = 0; j &lt; neighbor_num; ++j) {
            <span class="org-type">int</span> <span class="org-variable-name">c</span> = costs_to_neighbor[j] + dt-&gt;costs[neighbors[j]][i];
            printf(<span class="org-string">"        via %d to %d cost is %d\n"</span>, neighbors[j], i, c);
            candidates[j] = c;
        }

        <span class="org-comment-delimiter">/*</span><span class="org-comment">2.2.&#27604;&#36739;&#26159;&#21542;&#38656;&#35201;&#26356;&#26032;</span><span class="org-comment-delimiter">*/</span>
        qsort(candidates, neighbor_num, <span class="org-keyword">sizeof</span>(<span class="org-type">int</span>), compare);

        <span class="org-keyword">if</span> (candidates[0] != current_cost) {
            <span class="org-comment-delimiter">/*</span><span class="org-comment">&#21482;&#35201;&#19981;&#21516;&#20110;&#21407;&#26469;&#30340;&#36317;&#31163;&#23601;&#26356;&#26032;&#65292;&#22312;&#38142;&#36335;&#36317;&#31163;&#21457;&#29983;&#21464;&#21270;&#26102;&#65292;&#36825;&#20010;&#26032;&#35745;&#31639;&#20986;&#30340;&#32467;&#26524;&#21487;&#33021;&#27604;&#21407;&#26469;&#30340;&#22823;</span><span class="org-comment-delimiter">*/</span>

            printf(<span class="org-string">"        update cost to router%d from %d to %d\n"</span>,
                   i, current_cost, candidates[0]);

            dt-&gt;costs[node][i] = candidates[0];
            printf(<span class="org-string">"        now dt1 is\n"</span>);
            printdt(dt, 2);

            dt_updated = <span class="org-constant">true</span>;
        } <span class="org-keyword">else</span> {
            printf(<span class="org-string">"        no better cost\n"</span>);
        }
        free(candidates);
    }
    <span class="org-keyword">return</span> dt_updated;
}
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>node.c</label><pre class="src src-c">PUBLIC <span class="org-type">void</span>
<span class="org-function-name">linkhandler</span>(<span class="org-type">int</span> <span class="org-variable-name">node</span>, <span class="org-keyword">struct</span> <span class="org-type">distance_table</span> *<span class="org-variable-name">dt</span>, <span class="org-keyword">const</span> <span class="org-type">int</span> <span class="org-variable-name">neighbors</span>[], <span class="org-type">int</span> <span class="org-variable-name">neighbor_num</span>, <span class="org-type">int</span> <span class="org-variable-name">costs_to_neighbor</span>[],
            <span class="org-type">int</span> <span class="org-variable-name">linkid</span>, <span class="org-type">int</span> <span class="org-variable-name">newcost</span>) {
    printf(<span class="org-string">"Router%d to router%d's cost changes to %d\n"</span>, node, linkid, newcost);

    <span class="org-type">size_t</span> <span class="org-variable-name">neighbor_index</span> = find_index(neighbors, neighbor_num, linkid);

    costs_to_neighbor[neighbor_index] = newcost;

    <span class="org-type">bool</span> <span class="org-variable-name">dt_updated</span> = recalculate(node, dt, neighbors, neighbor_num, costs_to_neighbor);

    <span class="org-keyword">if</span> (dt_updated) send_dt_to_neighbors(node, dt, neighbors, neighbor_num);
}
</pre>
</div>

<p>
最终结果：<br />
</p>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>a.txt</label><pre class="src src-shell">Total of 80 messages sent
dt0:
                    to
          |    0     1     2     3
      ----|-----------------------
         0|    0     1     2     4
    from 1|    1     0     1     3
         2|    2     1     0     2
         3|    4     3     2     0

dt1:
                    to
          |    0     1     2     3
      ----|-----------------------
         0|    0     1     2     4
    from 1|    1     0     1     3
         2|    2     1     0     2
         3|  999   999   999   999

dt2:
                    to
          |    0     1     2     3
      ----|-----------------------
         0|    0     1     2     4
    from 1|    1     0     1     3
         2|    2     1     0     2
         3|    4     3     2     0

dt3:
                    to
          |    0     1     2     3
      ----|-----------------------
         0|    0     1     2     4
    from 1|  999   999   999   999
         2|    2     1     0     2
         3|    4     3     2     0
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgaac2cae" class="outline-3">
<h3 id="orgaac2cae"><span class="section-number-3">5.6.</span> Wireshark实验：ICMP</h3>
<div class="outline-text-3" id="text-5-6">
<p>
<a href="code/ch5-ws-icmp/wireshark-icmp-v7.0.pdf">Wireshark Lab: ICMP v7.0</a><br />
</p>
</div>
<div id="outline-container-orgcf11288" class="outline-4">
<h4 id="orgcf11288">ICMP and Ping</h4>
<div class="outline-text-4" id="text-orgcf11288">
<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     28 0.874593       192.168.8.100         143.89.12.134         ICMP     98     Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0x752d, <span class="org-variable-name">seq</span>=0/0, <span class="org-variable-name">ttl</span>=64 (<span class="org-type">reply</span> <span class="org-variable-name">in</span> 32)

Frame 28: 98 bytes on wire (784 bits), 98 bytes captured (784 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-function-name">Dst</span>: 143.89.12.134
Internet Control Message Protocol
    Type: 8 (Echo (ping) request)
    Code: 0
    Checksum: 0xb065 [correct]
    [Checksum Status: Good]
    Identifier (BE): 29997 (0x752d)
    <span class="org-function-name">Identifier</span> (LE): 11637 (0x2d75)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 0 (0x0000)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 0 (0x0000)
    [Response frame: 32]
    Timestamp from icmp data: Nov 26, 2021 10:05:36.214230000 CST
    [Timestamp from icmp data (relative): 0.000053000 seconds]
    Data (48 bytes)

0000  08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17   ................
0010  18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27   ........ <span class="org-negation-char">!</span><span class="org-warning">"</span><span class="org-string">#$%&amp;'</span>
0020  28 29 2a 2b 2c 2d 2e 2f 30 31 32 33 34 35 36 37   ()*+,-./01234567

No.     Time           Source                Destination           Protocol Length Info
     32 0.992264       143.89.12.134         192.168.8.100         ICMP     98     Echo (ping) <span class="org-type">reply</span>    <span class="org-variable-name">id</span>=0x752d, <span class="org-variable-name">seq</span>=0/0, <span class="org-variable-name">ttl</span>=48 (<span class="org-type">request</span> <span class="org-variable-name">in</span> 28)

Frame 32: 98 bytes on wire (784 bits), 98 bytes captured (784 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), <span class="org-function-name">Dst</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 143.89.12.134, <span class="org-function-name">Dst</span>: 192.168.8.100
Internet Control Message Protocol
    Type: 0 (Echo (ping) reply)
    Code: 0
    Checksum: 0xb865 [correct]
    [Checksum Status: Good]
    Identifier (BE): 29997 (0x752d)
    <span class="org-function-name">Identifier</span> (LE): 11637 (0x2d75)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 0 (0x0000)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 0 (0x0000)
    [Request frame: 28]
    [Response time: 117.671 ms]
    Timestamp from icmp data: Nov 26, 2021 10:05:36.214230000 CST
    [Timestamp from icmp data (relative): 0.117724000 seconds]
    Data (48 bytes)

0000  08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17   ................
0010  18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27   ........ <span class="org-negation-char">!</span><span class="org-warning">"</span><span class="org-string">#$%&amp;'</span>
0020  28 29 2a 2b 2c 2d 2e 2f 30 31 32 33 34 35 36 37   ()*+,-./01234567
</pre>
</div>

<ol class="org-ol">
<li>What is the IP address of your host? What is the IP address of the destination host?<br />
192.168.8.100 143.89.12.134<br /></li>

<li><p>
Why is it that an ICMP packet does not have source and destination port numbers?<br />
</p>

<blockquote>
<p>
The ICMP packet does not have source and destination port numbers because it was designed to communicate network-layer information between hosts and routers, not between application layer processes.<br />
</p>

<p>
Each ICMP packet has a "Type" and a "Code". The Type/Code combination identifies the specific message being received. Since the network software itself interprets all ICMP messages, no port numbers are needed to direct the ICMP message to an application layer process.<br />
</p>

<p>
&#x2013; <a href="https://www.howtouselinux.com/post/icmp-port-number">Exploring ICMP Port Number with Example</a><br />
</p>
</blockquote></li>

<li>Examine one of the ping request packets sent by your host.<br />

<ul class="org-ul">
<li><p>
What are the ICMP type and code numbers?<br />
</p>

<p>
Type: 8 (Echo (ping) request)<br />
Code: 0<br />
</p></li>

<li><p>
What other fields does this ICMP packet have?<br />
</p>

<p>
Checksum: 0xb065 [correct]<br />
Identifier (BE): 29997 (0x752d)<br />
Identifier (LE): 11637 (0x2d75)<br />
Sequence Number (BE): 0 (0x0000)<br />
Sequence Number (LE): 0 (0x0000)<br />
Timestamp from icmp data: Nov 26, 2021 10:05:36.214230000 CST<br />
</p>

<p>
<a href="https://osqa-ask.wireshark.org/questions/3172/icmp-sequence-number-be-vs-le/">ICMP Sequence Number (BE) vs (LE)</a><br />
</p></li>

<li><p>
How many bytes are the checksum, sequence number and identifier fields?<br />
</p>

<p>
2, 2, 2.<br />
</p></li>
</ul></li>

<li>Examine the corresponding ping reply packet.<br />

<ul class="org-ul">
<li><p>
What are the ICMP type and code numbers?<br />
</p>

<p>
Type: 0 (Echo (ping) reply)<br />
Code: 0<br />
</p></li>

<li><p>
What other fields does this ICMP packet have?<br />
</p>

<p>
Checksum: 0xb865 [correct]<br />
Identifier (BE): 29997 (0x752d)<br />
Identifier (LE): 11637 (0x2d75)<br />
Sequence Number (BE): 0 (0x0000)<br />
Sequence Number (LE): 0 (0x0000)<br />
Timestamp from icmp data: Nov 26, 2021 10:05:36.214230000 CST<br />
</p></li>

<li><p>
How many bytes are the checksum, sequence number and identifier fields?<br />
</p>

<p>
2, 2, 2.<br />
</p></li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org89b8b84" class="outline-4">
<h4 id="org89b8b84">ICMP and Traceroute</h4>
<div class="outline-text-4" id="text-org89b8b84">
<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     13 1.729387       192.168.8.100         128.93.162.83         ICMP     86     Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0xb3dd, <span class="org-variable-name">seq</span>=1/256, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 13: 86 bytes on wire (688 bits), 86 bytes captured (688 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-function-name">Dst</span>: 128.93.162.83
Internet Control Message Protocol
    Type: 8 (Echo (ping) request)
    Code: 0
    Checksum: 0x4421 [correct]
    [Checksum Status: Good]
    Identifier (BE): 46045 (0xb3dd)
    <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 1 (0x0001)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 256 (0x0100)
    [No response seen]
    Data (44 bytes)

0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0020  00 00 00 00 00 00 00 00 00 00 00 00               ............

No.     Time           Source                Destination           Protocol Length Info
     14 1.757246       192.168.8.1           192.168.8.100         ICMP     114    Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 14: 114 bytes on wire (912 bits), 114 bytes captured (912 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), <span class="org-function-name">Dst</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.1, <span class="org-function-name">Dst</span>: 192.168.8.100
Internet Control Message Protocol
    Type: 11 (Time-to-live exceeded)
    Code: 0 (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)
    Checksum: 0xf4ff [correct]
    [Checksum Status: Good]
    Unused: 00000000
    Internet Protocol Version 4, Src: 192.168.8.100, Dst: 128.93.162.83
    Internet Control Message Protocol
        Type: 8 (Echo (ping) request)
        Code: 0
        Checksum: 0x4421 [unverified] [in ICMP error packet]
        [Checksum Status: Unverified]
        Identifier (BE): 46045 (0xb3dd)
        <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
        <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 1 (0x0001)
        <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 256 (0x0100)
        Data (44 bytes)

0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0020  00 00 00 00 00 00 00 00 00 00 00 00               ............

No.     Time           Source                Destination           Protocol Length Info
     21 1.847671       192.168.8.100         128.93.162.83         ICMP     86     Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0xb3dd, <span class="org-variable-name">seq</span>=4/1024, <span class="org-variable-name">ttl</span>=2 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 21: 86 bytes on wire (688 bits), 86 bytes captured (688 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-function-name">Dst</span>: 128.93.162.83
Internet Control Message Protocol
    Type: 8 (Echo (ping) request)
    Code: 0
    Checksum: 0x441e [correct]
    [Checksum Status: Good]
    Identifier (BE): 46045 (0xb3dd)
    <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 4 (0x0004)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 1024 (0x0400)
    [No response seen]
    Data (44 bytes)

0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0020  00 00 00 00 00 00 00 00 00 00 00 00               ............

No.     Time           Source                Destination           Protocol Length Info
     32 4.856018       192.168.8.100         128.93.162.83         ICMP     86     Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0xb3dd, <span class="org-variable-name">seq</span>=7/1792, <span class="org-variable-name">ttl</span>=3 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 32: 86 bytes on wire (688 bits), 86 bytes captured (688 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-function-name">Dst</span>: 128.93.162.83
Internet Control Message Protocol
    Type: 8 (Echo (ping) request)
    Code: 0
    Checksum: 0x441b [correct]
    [Checksum Status: Good]
    Identifier (BE): 46045 (0xb3dd)
    <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 7 (0x0007)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 1792 (0x0700)
    [No response seen]
    Data (44 bytes)

0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0020  00 00 00 00 00 00 00 00 00 00 00 00               ............

No.     Time           Source                Destination           Protocol Length Info
     33 4.917614       192.168.208.129       192.168.8.100         ICMP     70     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 33: 70 bytes on wire (560 bits), 70 bytes captured (560 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), <span class="org-function-name">Dst</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.208.129, <span class="org-function-name">Dst</span>: 192.168.8.100
Internet Control Message Protocol
    Type: 11 (Time-to-live exceeded)
    Code: 0 (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)
    Checksum: 0xf4ff [correct]
    [Checksum Status: Good]
    Unused: 00000000
    Internet Protocol Version 4, Src: 192.168.8.100, Dst: 128.93.162.83
    Internet Control Message Protocol
        Type: 8 (Echo (ping) request)
        Code: 0
        Checksum: 0x441b [unverified] [in ICMP error packet]
        [Checksum Status: Unverified]
        Identifier (BE): 46045 (0xb3dd)
        <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
        <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 7 (0x0007)
        <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 1792 (0x0700)
</pre>
</div>

<ol class="org-ol">
<li value="5"><p>
What is the IP address of your host? What is the IP address of the target destination host?<br />
</p>

<p>
192.168.8.100 128.93.162.83<br />
</p></li>

<li><p>
If ICMP sent UDP packets instead (as in Unix/Linux), would the IP protocol number still be 01 for the probe packets? If not, what would it be?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
      3 0.124183       192.168.8.100         128.93.162.83         UDP      66     45897 &#8594; 33435 Len=24
      4 0.145618       192.168.8.1           192.168.8.100         ICMP     94     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)
      7 0.176555       192.168.8.100         128.93.162.83         UDP      66     45897 &#8594; 33436 Len=24
      8 0.205526       192.168.8.1           192.168.8.100         ICMP     94     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)
      9 0.205729       192.168.8.100         128.93.162.83         UDP      66     45897 &#8594; 33437 Len=24
     10 0.235273       192.168.8.1           192.168.8.100         ICMP     94     Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)
     11 0.235383       192.168.8.100         128.93.162.83         UDP      66     45897 &#8594; 33438 Len=24
     14 1.236027       192.168.8.100         128.93.162.83         UDP      66     45897 &#8594; 33439 Len=24
     16 2.241239       192.168.8.100         128.93.162.83         UDP      66     45897 &#8594; 33440 Len=24
     18 3.242600       192.168.8.100         128.93.162.83         UDP      66     45897 &#8594; 33441 Len=24
</pre>
</div>

<p>
从33435开始递增。<br />
</p>

<blockquote>
<p>
On a typical *nix system it uses UDP and sends traffic to port 33434 by default.<br />
&#x2013; <a href="https://www.redhat.com/sysadmin/ping-traceroute-netstat">Ping, traceroute, and netstat</a><br />
</p>
</blockquote></li>

<li><p>
Examine the ICMP echo packet in your screenshot. Is this different from the ICMP ping query packets in the first half of this lab? If yes, how so?<br />
</p>

<p>
traceroute发送的ICMP echo与ping的区别：<br />
</p>
<ol class="org-ol">
<li>没有包含发送的时间戳。<br /></li>
<li>Sequence Number不再是0。<br /></li>
<li>Data没有包含数据（全是0）。<br /></li>
</ol></li>

<li><p>
Examine the ICMP error packet in your screenshot. It has more fields than the ICMP echo packet. What is included in those fields?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     13 1.729387       192.168.8.100         128.93.162.83         ICMP     86     Echo (ping) <span class="org-type">request</span>  <span class="org-variable-name">id</span>=0xb3dd, <span class="org-variable-name">seq</span>=1/256, <span class="org-variable-name">ttl</span>=1 (no <span class="org-type">response</span> <span class="org-variable-name">found</span><span class="org-negation-char">!</span>)

Frame 13: 86 bytes on wire (688 bits), 86 bytes captured (688 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), <span class="org-function-name">Dst</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-variable-name">Dst</span>: 128.93.162.83
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 72
    Identification: 0xb3de (46046)
    Flags: 0x00
    ...0 0000 0000 0000 = Fragment Offset: 0
    Time to Live: 1
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1a1a [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.8.100
    Destination Address: 128.93.162.83
Internet Control Message Protocol
    Type: 8 (Echo (ping) request)
    Code: 0
    Checksum: 0x4421 [correct]
    [Checksum Status: Good]
    Identifier (BE): 46045 (0xb3dd)
    <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 1 (0x0001)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 256 (0x0100)
    [No response seen]
    Data (44 bytes)

0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0020  00 00 00 00 00 00 00 00 00 00 00 00               ............

No.     Time           Source                Destination           Protocol Length Info
     14 1.757246       192.168.8.1           192.168.8.100         ICMP     114    Time-to-live exceeded (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)

Frame 14: 114 bytes on wire (912 bits), 114 bytes captured (912 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), <span class="org-function-name">Dst</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 192.168.8.1, <span class="org-variable-name">Dst</span>: 192.168.8.100
    0100 .... = Version: 4
    .... 0101 = Header Length: 20 bytes (5)
    Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0xc0 (DSCP: CS6, ECN: Not-ECT)
    <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 100
    Identification: 0x2112 (8466)
    Flags: 0x00
    ...0 0000 0000 0000 = Fragment Offset: 0
    Time to Live: 64
    Protocol: ICMP (1)
    <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0xc711 [validation disabled]
    [Header checksum status: Unverified]
    Source Address: 192.168.8.1
    Destination Address: 192.168.8.100
Internet Control Message Protocol
    Type: 11 (Time-to-live exceeded)
    Code: 0 (Time to live exceeded <span class="org-type">in</span> <span class="org-variable-name">transit</span>)
    Checksum: 0xf4ff [correct]
    [Checksum Status: Good]
    Unused: 00000000
    Internet Protocol Version 4, <span class="org-variable-name">Src</span>: 192.168.8.100, <span class="org-variable-name">Dst</span>: 128.93.162.83
        0100 .... = Version: 4
        .... 0101 = Header Length: 20 bytes (5)
        Differentiated <span class="org-type">Services</span> <span class="org-function-name">Field</span>: 0x00 (DSCP: CS0, ECN: Not-ECT)
        <span class="org-type">Total</span> <span class="org-function-name">Length</span>: 72
        Identification: 0xb3de (46046)
        Flags: 0x00
        ...0 0000 0000 0000 = Fragment Offset: 0
        Time to Live: 1
        Protocol: ICMP (1)
        <span class="org-type">Header</span> <span class="org-variable-name">Checksum</span>: 0x1a1a [validation disabled]
        [Header checksum status: Unverified]
        Source Address: 192.168.8.100
        Destination Address: 128.93.162.83
    Internet Control Message Protocol
        Type: 8 (Echo (ping) request)
        Code: 0
        Checksum: 0x4421 [unverified] [in ICMP error packet]
        [Checksum Status: Unverified]
        Identifier (BE): 46045 (0xb3dd)
        <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
        <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 1 (0x0001)
        <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 256 (0x0100)
        Data (44 bytes)

0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0020  00 00 00 00 00 00 00 00 00 00 00 00               ............
</pre>
</div>

<p>
包含了导致ICMP error报文的IP首部和ICMP报文。<br />
</p></li>

<li><p>
Examine the last three ICMP packets received by the source host. How are these packets different from the ICMP error packets? Why are they different?<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
    167 44.847336      128.93.162.83         192.168.8.100         ICMP     86     Echo (ping) <span class="org-type">reply</span>    <span class="org-variable-name">id</span>=0xb3dd, <span class="org-variable-name">seq</span>=53/13568, <span class="org-variable-name">ttl</span>=47 (<span class="org-type">request</span> <span class="org-variable-name">in</span> 166)

Frame 167: 86 bytes on wire (688 bits), 86 bytes captured (688 bits) on <span class="org-type">interface</span> <span class="org-variable-name">en4</span>, <span class="org-variable-name">id</span> 0
Ethernet II, <span class="org-function-name">Src</span>: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), <span class="org-function-name">Dst</span>: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet <span class="org-type">Protocol</span> <span class="org-variable-name">Version</span> 4, <span class="org-variable-name">Src</span>: 128.93.162.83, <span class="org-function-name">Dst</span>: 192.168.8.100
Internet Control Message Protocol
    Type: 0 (Echo (ping) reply)
    Code: 0
    Checksum: 0x4bed [correct]
    [Checksum Status: Good]
    Identifier (BE): 46045 (0xb3dd)
    <span class="org-function-name">Identifier</span> (LE): 56755 (0xddb3)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (BE): 53 (0x0035)
    <span class="org-type">Sequence</span> <span class="org-function-name">Number</span> (LE): 13568 (0x3500)
    [Request frame: 166]
    [Response time: 299.016 ms]
    Data (44 bytes)

0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0020  00 00 00 00 00 00 00 00 00 00 00 00               ............
</pre>
</div>

<p>
ICMP error的Type和Code是11、0（TTL过期），最后源主机收到的ICMP报文的Type和Code是0、0（回显回答）。<br />
</p></li>

<li><p>
Within the tracert measurements, is there a link whose delay is significantly longer than others? Refer to the screenshot in Figure 4, is there a link whose delay is significantly longer than others? On the basis of the router names, can you guess the location of the two routers on the end of this link?<br />
</p>

<p>
第10跳的时延显著增大。<br />
奥贝维埃（法语：Aubervilliers）是法国法兰西岛大区塞纳-圣但尼省的一个镇，位于巴黎郊区。<br />
巴尼奥莱（法语：Bagnolet）是法国法兰西岛大区塞纳-圣但尼省的一个市镇。<br />
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org0e86947" class="outline-4">
<h4 id="org0e86947">Extra Credit</h4>
<div class="outline-text-4" id="text-org0e86947">
<p>
This ping program, unlike the standard ping program, sends UDP probe packets rather than ICMP probe packets.<br />
</p>

<div class="org-src-container">
<pre class="src src-c">No.     Time           Source                Destination           Protocol Length Info
     43 3.980875       127.0.0.1             127.0.0.1             LLC      55     I P, N(R)=51, N(S)=55; DSAP 0x50 Individual, SSAP 0x68 Response

Frame 43: 55 bytes on wire (440 bits), 55 bytes captured (440 bits) on <span class="org-type">interface</span> <span class="org-variable-name">lo0</span>, <span class="org-variable-name">id</span> 0
Null/Loopback
Internet Protocol Version 4, <span class="org-variable-name">Src</span>: 127.0.0.1, <span class="org-variable-name">Dst</span>: 127.0.0.1
User Datagram Protocol, <span class="org-variable-name">Src</span> Port: 54265, <span class="org-variable-name">Dst</span> Port: 12000
    Source Port: 54265
    Destination Port: 12000
    Length: 31
    Checksum: 0xfe32 [unverified]
    [Checksum Status: Unverified]
    [Stream index: 0]
    [Timestamps]
    UDP payload (23 bytes)
Logical-Link Control
Data (19 bytes)

0000  02 00 00 00 45 00 00 33 17 54 00 00 40 11 00 00   ....E..3.T..@...
0010  7f 00 00 01 7f 00 00 01 d3 f9 2e e0 00 1f fe 32   ...............2
0020  50 69 6e 67 20 30 33 20 31 33 3a 35 34 3a 33 31   Ping 03 13:54:31
0030  2e 31 39 37 30 36 34                              .197064

No.     Time           Source                Destination           Protocol Length Info
     44 3.980951       127.0.0.1             127.0.0.1             LLC      55     I P, <span class="org-function-name">N</span>(R)=35, N(S)=39; DSAP 0x50 Individual, SSAP 0x48 Response

Frame 44: 55 bytes on wire (440 bits), 55 bytes captured (440 bits) on <span class="org-type">interface</span> <span class="org-variable-name">lo0</span>, <span class="org-variable-name">id</span> 0
Null/Loopback
Internet Protocol Version 4, <span class="org-variable-name">Src</span>: 127.0.0.1, <span class="org-variable-name">Dst</span>: 127.0.0.1
User Datagram Protocol, <span class="org-variable-name">Src</span> Port: 12000, <span class="org-variable-name">Dst</span> Port: 54265
    Source Port: 12000
    Destination Port: 54265
    Length: 31
    Checksum: 0xfe32 [unverified]
    [Checksum Status: Unverified]
    [Stream index: 0]
    [Timestamps]
    UDP payload (23 bytes)
Logical-Link Control
Data (19 bytes)

0000  02 00 00 00 45 00 00 33 83 53 00 00 40 11 00 00   ....E..3.S..@...
0010  7f 00 00 01 7f 00 00 01 2e e0 d3 f9 00 1f fe 32   ...............2
0020  50 49 4e 47 20 30 33 20 31 33 3a 35 34 3a 33 31   PING 03 13:54:31
0030  2e 31 39 37 30 36 34                              .197064
</pre>
</div>

<p>
第一个 UDP 报文从端口 54265 发往端口 12000，载荷是自定义的 ping 消息 “Ping 03 13:54:31.197064”。接收到的 UDP 报文回显了发送过去的消息。<br />
</p>
</div>
</div>
</div>

<div id="outline-container-org036fe44" class="outline-3">
<h3 id="org036fe44"><span class="section-number-3">5.7.</span> Wireshark 实验：DHCP</h3>
<div class="outline-text-3" id="text-5-7">
<p>
<a href="code/ch5-ws-dhcp/wireshark-dhcp-v7.0.pdf">Wireshark Lab: DHCP v7.0</a><br />
</p>

<p>
macOS 对应实验中 Windows 系统的操作是（在设置→网络，每一步需要点击应用保存修改）：<br />
</p>

<ol class="org-ol">
<li>配置 IPv4: 关闭<br /></li>
<li>Begin Wireshark packet capture.<br /></li>
<li>配置 IPv4: 使用 DHCP<br /></li>
<li>高级 → DHCP 续租<br /></li>
<li>配置 IPv4: 关闭<br /></li>
<li>配置 IPv4: 使用 DHCP<br /></li>
<li>Stop Wireshark packet capture.<br /></li>
</ol>


<p>
实验中提供的<a href="code/ch5-ws-dhcp/dhcp-ethereal-trace-1">trace</a>，实验得到的<a href="code/ch5-ws-dhcp/dhcp.pcapng">trace</a>。<br />
</p>


<ol class="org-ol">
<li><p>
Are DHCP messages sent over UDP or TCP?<br />
</p>

<p>
UDP<br />
</p>


<div id="org8dce75f" class="figure">
<p><img src="img/ch5-ws-dhcp-1.png" alt="ch5-ws-dhcp-1.png" style="width:100%; max-width:900px;" /><br />
</p>
</div></li>

<li><p>
&#x00ad;<br />
</p>

<div class="org-src-container">
<pre class="src src-shell">No.     Time           Source                Destination           Protocol Length Info
      4 4.676705       0.0.0.0               255.255.255.255       DHCP     342    DHCP Discover - Transaction ID 0x2bacfd62

Frame 4: 342 bytes on wire (2736 bits), 342 bytes captured (2736 bits) on interface en4, id 0
Ethernet II, Src: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), Dst: Broadcast (ff:ff:ff:ff:ff:ff)
Internet Protocol Version 4, Src: 0.0.0.0, Dst: 255.255.255.255
User Datagram Protocol, Src Port: 68, Dst Port: 67
Dynamic Host Configuration Protocol (Discover)
    Message type: Boot Request (1)
    Hardware type: Ethernet (0x01)
    Hardware address length: 6
    Hops: 0
    Transaction ID: 0x2bacfd62
    Seconds elapsed: 0
    Bootp flags: 0x0000 (Unicast)
    Client IP address: 0.0.0.0
    Your (client) IP address: 0.0.0.0
    Next server IP address: 0.0.0.0
    Relay agent IP address: 0.0.0.0
    Client MAC address: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
    Client hardware address padding: 00000000000000000000
    Server host name not given
    Boot file name not given
    Magic cookie: DHCP
    Option: (53) DHCP Message Type (Discover)
    Option: (55) Parameter Request List
    Option: (57) Maximum DHCP Message Size
    Option: (61) Client identifier
    Option: (51) IP Address Lease Time
    Option: (12) Host Name
    Option: (255) End
    Padding: 000000000000000000000000

No.     Time           Source                Destination           Protocol Length Info
      5 4.709892       192.168.8.1           192.168.8.120         DHCP     346    DHCP Offer    - Transaction ID 0x2bacfd62

Frame 5: 346 bytes on wire (2768 bits), 346 bytes captured (2768 bits) on interface en4, id 0
Ethernet II, Src: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), Dst: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet Protocol Version 4, Src: 192.168.8.1, Dst: 192.168.8.120
User Datagram Protocol, Src Port: 67, Dst Port: 68
Dynamic Host Configuration Protocol (Offer)
    Message type: Boot Reply (2)
    Hardware type: Ethernet (0x01)
    Hardware address length: 6
    Hops: 0
    Transaction ID: 0x2bacfd62
    Seconds elapsed: 0
    Bootp flags: 0x0000 (Unicast)
    Client IP address: 0.0.0.0
    Your (client) IP address: 192.168.8.120
    Next server IP address: 0.0.0.0
    Relay agent IP address: 0.0.0.0
    Client MAC address: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
    Client hardware address padding: 00000000000000000000
    Server host name not given
    Boot file name not given
    Magic cookie: DHCP
    Option: (53) DHCP Message Type (Offer)
    Option: (54) DHCP Server Identifier (192.168.8.1)
    Option: (51) IP Address Lease Time
    Option: (58) Renewal Time Value
    Option: (59) Rebinding Time Value
    Option: (1) Subnet Mask (255.255.255.0)
    Option: (3) Router
    Option: (6) Domain Name Server
    Option: (43) Vendor-Specific Information
    Option: (255) End
    Padding: 00

No.     Time           Source                Destination           Protocol Length Info
     16 5.713360       0.0.0.0               255.255.255.255       DHCP     342    DHCP Request  - Transaction ID 0x2bacfd62

Frame 16: 342 bytes on wire (2736 bits), 342 bytes captured (2736 bits) on interface en4, id 0
Ethernet II, Src: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00), Dst: Broadcast (ff:ff:ff:ff:ff:ff)
Internet Protocol Version 4, Src: 0.0.0.0, Dst: 255.255.255.255
User Datagram Protocol, Src Port: 68, Dst Port: 67
Dynamic Host Configuration Protocol (Request)
    Message type: Boot Request (1)
    Hardware type: Ethernet (0x01)
    Hardware address length: 6
    Hops: 0
    Transaction ID: 0x2bacfd62
    Seconds elapsed: 1
    Bootp flags: 0x0000 (Unicast)
    Client IP address: 0.0.0.0
    Your (client) IP address: 0.0.0.0
    Next server IP address: 0.0.0.0
    Relay agent IP address: 0.0.0.0
    Client MAC address: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
    Client hardware address padding: 00000000000000000000
    Server host name not given
    Boot file name not given
    Magic cookie: DHCP
    Option: (53) DHCP Message Type (Request)
    Option: (55) Parameter Request List
    Option: (57) Maximum DHCP Message Size
    Option: (61) Client identifier
    Option: (50) Requested IP Address (192.168.8.120)
    Option: (54) DHCP Server Identifier (192.168.8.1)
    Option: (12) Host Name
    Option: (255) End
    Padding: 000000000000

No.     Time           Source                Destination           Protocol Length Info
     17 5.750134       192.168.8.1           192.168.8.120         DHCP     346    DHCP ACK      - Transaction ID 0x2bacfd62

Frame 17: 346 bytes on wire (2768 bits), 346 bytes captured (2768 bits) on interface en4, id 0
Ethernet II, Src: HuaweiDe_68:6c:29 (94:e9:ee:68:6c:29), Dst: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
Internet Protocol Version 4, Src: 192.168.8.1, Dst: 192.168.8.120
User Datagram Protocol, Src Port: 67, Dst Port: 68
Dynamic Host Configuration Protocol (ACK)
    Message type: Boot Reply (2)
    Hardware type: Ethernet (0x01)
    Hardware address length: 6
    Hops: 0
    Transaction ID: 0x2bacfd62
    Seconds elapsed: 0
    Bootp flags: 0x0000 (Unicast)
    Client IP address: 0.0.0.0
    Your (client) IP address: 192.168.8.120
    Next server IP address: 0.0.0.0
    Relay agent IP address: 0.0.0.0
    Client MAC address: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)
    Client hardware address padding: 00000000000000000000
    Server host name not given
    Boot file name not given
    Magic cookie: DHCP
    Option: (53) DHCP Message Type (ACK)
    Option: (54) DHCP Server Identifier (192.168.8.1)
    Option: (51) IP Address Lease Time
    Option: (58) Renewal Time Value
    Option: (59) Rebinding Time Value
    Option: (1) Subnet Mask (255.255.255.0)
    Option: (3) Router
    Option: (6) Domain Name Server
    Option: (43) Vendor-Specific Information
    Option: (255) End
    Padding: 00
</pre>
</div>

<ul class="org-ul">
<li><p>
Draw a timing datagram illustrating the sequence of the first four-packet Discover/Offer/Request/ACK DHCP exchange between the client and server. For each packet, indicated the source and destination port numbers.<br />
</p>


<div id="orgc9d4c5b" class="figure">
<p><img src="img/ch5-ws-dhcp-2.png" alt="ch5-ws-dhcp-2.png" style="width:100%; max-width:540px;" /><br />
</p>
</div></li>

<li><p>
Are the port numbers the same as in the example given in this lab assignment?<br />
</p>

<p>
相同<br />
</p></li>
</ul></li>

<li><p>
What is the link-layer (e.g., Ethernet) address of your host?<br />
</p>

<p>
Client MAC address: HuaweiTe_1f:00:00 (00:1e:10:1f:00:00)<br />
</p></li>

<li><p>
What values in the DHCP discover message differentiate this message from the DHCP request message?<br />
</p>

<p>
Option: (53) DHCP Message Type<br />
</p>

<p>
这两种消息不同的字段如下：<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">discover</th>
<th scope="col" class="org-right">request</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Seconds elapsed</td>
<td class="org-left">0</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">Option: (53) DHCP Message Type</td>
<td class="org-left">Discover</td>
<td class="org-right">Request</td>
</tr>

<tr>
<td class="org-left">Option: (51) IP Address Lease Time</td>
<td class="org-left">90 days</td>
<td class="org-right">/</td>
</tr>

<tr>
<td class="org-left">Option: (50) Requested IP Address</td>
<td class="org-left">/</td>
<td class="org-right">192.168.8.120</td>
</tr>

<tr>
<td class="org-left">Option: (54) DHCP Server Identifier</td>
<td class="org-left">/</td>
<td class="org-right">192.168.8.1</td>
</tr>
</tbody>
</table></li>

<li>&#x00ad;<br />
<ul class="org-ul">
<li><p>
What is the value of the Transaction-ID in each of the first four (Discover/Offer/Request/ACK) DHCP messages?<br />
</p>

<p>
Transaction ID: 0x2bacfd62<br />
</p></li>

<li><p>
What are the values of the Transaction-ID in the second set (Request/ACK) set of DHCP messages?<br />
</p>

<p>
Transaction ID: 0x2bacfd63<br />
</p></li>

<li><p>
What is the purpose of the Transaction-ID field?<br />
</p>

<p>
Transaction ID, a random number chosen by the client, used by the client and server to associate messages and responses between a client and a server.<br />
</p></li>
</ul></li>

<li><p>
A host uses DHCP to obtain an IP address, among other things. But a host’s IP address is not confirmed until the end of the four-message exchange! If the IP address is not set until the end of the four-message exchange, then what values are used in the IP datagrams in the four-message exchange? For each of the four DHCP messages (Discover/Offer/Request/ACK DHCP), indicate the source and destination IP addresses that are carried in the encapsulating IP datagram.<br />
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">Src</th>
<th scope="col" class="org-right">Dst</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Discover</td>
<td class="org-right">0.0.0.0</td>
<td class="org-right">255.255.255.255</td>
</tr>

<tr>
<td class="org-left">Offer</td>
<td class="org-right">192.168.8.1</td>
<td class="org-right">192.168.8.120</td>
</tr>

<tr>
<td class="org-left">Request</td>
<td class="org-right">0.0.0.0</td>
<td class="org-right">255.255.255.255</td>
</tr>

<tr>
<td class="org-left">ACK</td>
<td class="org-right">192.168.8.1</td>
<td class="org-right">192.168.8.120</td>
</tr>
</tbody>
</table></li>

<li><p>
What is the IP address of your DHCP server?<br />
</p>

<p>
192.168.8.1<br />
</p></li>

<li><p>
What IP address is the DHCP server offering to your host in the DHCP Offer message? Indicate which DHCP message contains the offered DHCP address.<br />
</p>

<p>
Your (client) IP address: 192.168.8.120<br />
</p></li>

<li><p>
In the example screenshot in this assignment, there is no relay agent between the host and the DHCP server. What values in the trace indicate the absence of a relay agent? Is there a relay agent in your experiment? If so what is the IP address of the agent?<br />
</p>

<p>
Relay agent IP address: 0.0.0.0<br />
</p></li>

<li><p>
Explain the purpose of the router and subnet mask lines in the DHCP offer message.<br />
</p>

<p>
The subnet mask line tells the client which subnet mask to use.<br />
</p>

<p>
The router line indicates where the client should send messages by default.<br />
</p></li>

<li><p>
In the DHCP trace file noted in footnote 2, the DHCP server offers a specific IP address to the client (see also question 8. above). In the client’s response to the first server OFFER message, does the client accept this IP address? Where in the client’s RESPONSE is the client’s requested address?<br />
</p>

<p>
Yes.<br />
Option: (50) Requested IP Address (192.168.1.101)<br />
</p></li>

<li><p>
Explain the purpose of the lease time. How long is the lease time in your experiment?<br />
</p>

<p>
This option is used in a client request (DHCPDISCOVER or DHCPREQUEST) to allow the client to request a lease time for the IP address.  In a server reply (DHCPOFFER), a DHCP server uses this option to specify the lease time it is willing to offer.<br />
</p>

<p>
Option: (51) IP Address Lease Time<br />
  Length: 4<br />
  IP Address Lease Time: (86400s) 1 day<br />
</p></li>

<li><p>
What is the purpose of the DHCP release message? Does the DHCP server issue an acknowledgment of receipt of the client’s DHCP request? What would happen if the client’s DHCP release message is lost?<br />
</p>

<p>
If the client no longer requires use of its assigned network address (e.g., the client is gracefully shut down), the client sends a DHCPRELEASE message to the server.<br />
</p></li>

<li><p>
Clear the bootp filter from your Wireshark window. Were any ARP packets sent or received during the DHCP packet-exchange period? If so, explain the purpose of those ARP packets.<br />
</p>

<p>
The client collects DHCPOFFER messages over a period of time, selects one DHCPOFFER message from the incoming DHCPOFFER messages.<br />
</p>

<p>
The client may perform a check on the suggested address to ensure that the address is not already in use.<br />
</p>

<p>
For example, if the client is on a network that supports ARP, the client may issue an ARP request for the suggested request.  When broadcasting an ARP request for the suggested address, the client must fill in its own hardware address as the sender's hardware address, and 0 as the sender's IP address, to avoid confusing ARP caches in other hosts on the same subnet.<br />
</p>

<p>
Once the DHCPACK message from the server arrives, the client is initialized and moves to BOUND state. The client SHOULD broadcast an ARP reply to announce the client's new IP address and clear any outdated ARP cache entries in hosts on the client's subnet.<br />
</p>


<div id="org21ea8c7" class="figure">
<p><img src="img/ch5-ws-dhcp-14.png" alt="ch5-ws-dhcp-14.png" style="width:100%; max-width:900px;" /><br />
</p>
</div></li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Shi-Chao Xia</p>
<p class="date">Created: 2021-12-07 Tue 12:21</p>
</div>
</body>
</html>
